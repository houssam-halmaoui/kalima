<html>
    <head>
        <meta charset="utf-8">
        
            <script src="lib/bindings/utils.js"></script>
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.2/dist/dist/vis-network.min.css" integrity="sha512-WgxfT5LWjfszlPHXRmBWHkV2eceiWTOBvrKCNbdgDYTHrT2AeLCGbF4sZlZw3UMN3WtL0tGUoIAKsu8mllg/XA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
            <script src="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.2/dist/vis-network.min.js" integrity="sha512-LnvoEWDFrqGHlHmDD2101OrLcbsfkrzoSpvtSQtxK3RMnRV0eOkhhBN2dXHKRrUU8p2DGRTk35n4O8nWSVe1mQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
            
        
<center>
<h1></h1>
</center>

<!-- <link rel="stylesheet" href="../node_modules/vis/dist/vis.min.css" type="text/css" />
<script type="text/javascript" src="../node_modules/vis/dist/vis.js"> </script>-->
        <link
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6"
          crossorigin="anonymous"
        />
        <script
          src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
          integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
          crossorigin="anonymous"
        ></script>


        <center>
          <h1></h1>
        </center>
        <style type="text/css">

             #mynetwork {
                 width: 100%;
                 height: 100vh;
                 background-color: #ffffff;
                 border: 1px solid lightgray;
                 position: relative;
                 float: left;
             }

             

             

             
        </style>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>


	body, html {margin: 0; padding: 0; height: 100%; overflow: hidden;} 
 	
  	#mynetwork {height: 100vh !important; width: 100% !important;}


 

    .vis-tooltip {
        position: absolute;
        background-color: rgba(255, 241, 200, 1) !important;
        color: black !important;
        border-radius: 8px;
        padding: 12px;
        font-size: 22px;
        font-weight: 700;
        box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.8);
        white-space: normal !important;
        word-wrap: break-word;
        overflow-wrap: break-word;
        max-width: 80vw;
        
        max-height: 80vh;
        overflow-y: auto !important;
        -webkit-overflow-scrolling: touch;
        
        direction: ltr;
        text-align: left;
        
        z-index: 9999 !important;
        pointer-events: auto !important;
    }
    
    .scroll-buttons {
        position: absolute;
        right: 50px;
        top: 50%;
        transform: translateY(-50%);
        display: flex;
        flex-direction: column;
        z-index: 10000;
        opacity: 0.8;
    }
    
    .scroll-up, .scroll-down {
        width: 30px;
        height: 30px;
        background: #888;
        color: white;
        display: flex;
        justify-content: center;
        align-items: center;
        border-radius: 50%;
        margin: 5px 0;
        cursor: pointer;
        user-select: none;
        font-weight: bold;
    }

       


        .controls {
            position: absolute;
            bottom: 10px;
            left: 10px;
            z-index: 999;
            display: flex;
            gap: 10px;
        }
        .control-btn {
            background: rgba(255,255,255,0.8);
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 5px 10px;
            cursor: pointer;
        }
        @media (max-width: 768px) {
            .control-btn {padding: 8px 12px;}
        }
    </style>
    </head>
    


    <body>
        <div class="card" style="width: 100%">
            
            
            <div id="mynetwork" class="card-body"></div>
        </div>

        
        

        <script type="text/javascript">

              // initialize global variables.
              var edges;
              var nodes;
              var allNodes;
              var allEdges;
              var nodeColors;
              var originalNodes;
              var network;
              var container;
              var options, data;
              var filter = {
                  item : '',
                  property : '',
                  value : []
              };

              

              

              // This method is responsible for drawing the graph, returns the drawn network
              function drawGraph() {
                  var container = document.getElementById('mynetwork');

                  

                  // parsing and collecting nodes and edges from the python
                  nodes = new vis.DataSet([{"font": {"vadjust": -70.5}, "group": 1, "id": 2, "label": "CAN 2025 : le Maroc...", "shape": "dot", "size": 47, "title": "CAN 2025 : le Maroc instaure une AEVM pour les supporters du continent\nSource: fr.hespress.com", "url": "https://fr.hespress.com/442190-can-2025-le-maroc-instaure-une-aevm-pour-les-supporters-du-continent.html", "x": 0, "y": 0}, {"font": {"vadjust": -70.5}, "group": 4, "id": 23, "label": "Averses orageuses localement fortes avec...", "shape": "dot", "size": 47, "title": "Averses orageuses localement fortes avec rafales de vent ce dimanche dans plusieurs r\u00e9gions du Maroc\nSource: lematin.ma", "url": "https://lematin.ma/regions/averses-orageuses-localement-fortes-avec-rafales-de-vent-ce-dimanche/302839", "x": 0, "y": 0}, {"font": {"vadjust": -88.5}, "group": 2, "id": 26, "label": "Le pr\u00e9sident de la FIFA...", "shape": "dot", "size": 59, "title": "Le pr\u00e9sident de la FIFA \u00e9merveill\u00e9 par le Grand Stade de Tanger\nSource: lematin.ma", "url": "https://lematin.ma/sports/le-president-de-la-fifa-visite-le-grand-stade-de-tanger/302766", "x": 0, "y": 0}, {"font": {"vadjust": -88.5}, "group": 4, "id": 50, "label": "Maroc : Averses orageuses localement...", "shape": "dot", "size": 59, "title": "Maroc : Averses orageuses localement fortes avec rafales de vent dimanche\nSource: www.yabiladi.com", "url": "https://www.yabiladi.com/articles/details/176903/maroc-averses-orageuses-localement-fortes.html", "x": 0, "y": 0}, {"font": {"vadjust": -70.5}, "group": 4, "id": 65, "label": "Alerte m\u00e9t\u00e9o : Averses orageuses...", "shape": "dot", "size": 47, "title": "Alerte m\u00e9t\u00e9o : Averses orageuses et rafales de vent ce dimanche\nSource: www.lavieeco.com", "url": "https://www.lavieeco.com/au-royaume/alerte-meteo-averses-orageuses-et-rafales-de-vent-ce-dimanche/", "x": 0, "y": 0}, {"font": {"vadjust": -88.5}, "group": 2, "id": 70, "label": "Gianni Infantino visite le Grand...", "shape": "dot", "size": 59, "title": "Gianni Infantino visite le Grand Stade de Tanger\nSource: www.lavieeco.com", "url": "https://www.lavieeco.com/videos/gianni-infantino-visite-le-grand-stade-de-tanger/", "x": 0, "y": 0}, {"font": {"vadjust": -88.5}, "group": 2, "id": 88, "label": "FRMF | Le pr\u00e9sident de...", "shape": "dot", "size": 59, "title": "FRMF | Le pr\u00e9sident de la FIFA M. Gianni Infantino en visite au Grand Stade de Tanger\nSource: www.lereporter.ma", "url": "https://www.lereporter.ma/frmf-le-president-de-la-fifa-m-gianni-infantino-en-visite-au-grand-stade-de-tanger/", "x": 0, "y": 0}, {"font": {"vadjust": -70.5}, "group": 3, "id": 94, "label": "LdC de la CAF :...", "shape": "dot", "size": 47, "title": "LdC de la CAF : l\u2019AS FAR s\u2019impose face au Real Banjul (2-0)\nSource: fr.hespress.com", "url": "https://fr.hespress.com/442201-ldc-de-la-caf-las-far-simpose-face-au-real-banjul-2-0.html", "x": 0, "y": 0}, {"font": {"vadjust": -106.5}, "group": 0, "id": 104, "label": "80\u00e8 Assembl\u00e9e g\u00e9n\u00e9rale de l\u0027ONU...", "shape": "dot", "size": 71, "title": "80\u00e8 Assembl\u00e9e g\u00e9n\u00e9rale de l\u0027ONU : Aziz Akhannouch pr\u00e9side la d\u00e9l\u00e9gation du Maroc\nSource: www.lopinion.ma", "url": "https://www.lopinion.ma/80e-Assemblee-generale-de-l-ONU-Aziz-Akhannouch-preside-la-delegation-du-Maroc_a72028.html", "x": 0, "y": 0}, {"font": {"vadjust": -70.5}, "group": 3, "id": 114, "label": "Ligue des champions de la...", "shape": "dot", "size": 47, "title": "Ligue des champions de la CAF (1er tour pr\u00e9liminaire aller): L\u2019AS FAR bat le Real de Banjul\nSource: www.yabiladi.com", "url": "https://www.yabiladi.com/articles/details/176933/ligue-champions-tour-preliminaire-aller.html", "x": 0, "y": 0}, {"font": {"vadjust": -106.5}, "group": 0, "id": 116, "label": "Aziz Akhannouch pr\u00e9side la d\u00e9l\u00e9gation...", "shape": "dot", "size": 71, "title": "Aziz Akhannouch pr\u00e9side la d\u00e9l\u00e9gation du Maroc \u00e0 la 80e Assembl\u00e9e g\u00e9n\u00e9rale de l\u0027ONU\nSource: www.yabiladi.com", "url": "https://www.yabiladi.com/articles/details/176930/aziz-akhannouch-preside-delegation-maroc.html", "x": 0, "y": 0}, {"font": {"vadjust": -70.5}, "group": 1, "id": 120, "label": "CAN 2025 au Maroc :...", "shape": "dot", "size": 47, "title": "CAN 2025 au Maroc : Pr\u00e9cisions sur l\u2019Autorisation Electronique de voyage pour certains pays africains\nSource: www.yabiladi.com", "url": "https://www.yabiladi.com/articles/details/176914/2025-maroc-precisions-l-autorisation-electronique.html", "x": 0, "y": 0}, {"font": {"vadjust": -106.5}, "group": 0, "id": 121, "label": "Assembl\u00e9e g\u00e9n\u00e9rale de l\u2019ONU :...", "shape": "dot", "size": 71, "title": "Assembl\u00e9e g\u00e9n\u00e9rale de l\u2019ONU : Akhannouch pr\u00e9side la d\u00e9l\u00e9gation du Maroc \u00e0 la 80\u00e8 session\nSource: www.lavieeco.com", "url": "https://www.lavieeco.com/pouvoirs/assemblee-generale-de-lonu-akhannouch-preside-la-delegation-du-maroc-a-la-80e-session/", "x": 0, "y": 0}, {"font": {"vadjust": -106.5}, "group": 0, "id": 129, "label": "Sur Hautes Instructions de SM...", "shape": "dot", "size": 71, "title": "Sur Hautes Instructions de SM le Roi, M. Akhannouch pr\u00e9side la d\u00e9l\u00e9gation du Maroc \u00e0 la 80\u00e8 AG de l\u2019ONU\nSource: www.lereporter.ma", "url": "https://www.lereporter.ma/sur-hautes-instructions-de-sm-le-roi-m-akhannouch-preside-la-delegation-du-maroc-a-la-80e-ag-de-lonu/", "x": 0, "y": 0}, {"borderWidth": 3, "fixed": true, "font": {"bold": true, "color": "#000", "size": 26}, "group": 1, "id": "comm_label_1", "label": "A l\u2019approche de la 35\u1d49\nCoupe d\u2019Afrique des Nations (CAN),...", "mass": 5, "physics": false, "shape": "box", "title": "A l\u2019approche de la 35\u1d49 Coupe d\u2019Afrique des Nations (CAN), que le Maroc accueillera du 21 d\u00e9cembre 2025 au 18 janvier 2026, le Royaume d\u00e9ploie de nouvelles mesures pour encadrer l\u2019afflux attendu de supporters du continent. [fr.hespress.com]\n-------------------------------------------------\nAfin de g\u00e9rer efficacement lafflux de supporters traversant les fronti\u00e8res et de garantir une logistique sans faille, le pays a d\u00e9cid\u00e9 de mettre en place une proc\u00e9dure simplifi\u00e9e pour lobtention de l\u2019Autorisation \u00c9lectronique de Voyage au Maroc (AEVM). [www.yabiladi.com]"}, {"borderWidth": 3, "fixed": true, "font": {"bold": true, "color": "#000", "size": 26}, "group": 4, "id": "comm_label_4", "label": "Des averses orageuses (20 \u00e0\n30 mm) localement fortes avec...", "mass": 5, "physics": false, "shape": "box", "title": "Des averses orageuses (20 \u00e0 30 mm) localement fortes avec rafales de vent sous orages sont pr\u00e9vues de 14h \u00e0 22h dans les provinces de Jerada, Figuig, Boulemane, Midelt, Ouarzazate. [lematin.ma]\n-------------------------------------------------\nDes averses orageuses localement fortes avec rafales de vent sous orages sont attendues, ce dimanche, dans certaines provinces du Maroc, a annonc\u00e9 la Direction g\u00e9n\u00e9rale de la m\u00e9t\u00e9orologie (DGM). [www.yabiladi.com]\n-------------------------------------------------\nDes averses orageuses localement fortes avec rafales de vent sous orages sont attendues, ce dimanche, dans certaines provinces du Royaume, a annonc\u00e9 la Direction g\u00e9n\u00e9rale de la m\u00e9t\u00e9orologie (DGM). [www.lavieeco.com]"}, {"borderWidth": 3, "fixed": true, "font": {"bold": true, "color": "#000", "size": 26}, "group": 2, "id": "comm_label_2", "label": "Fouzi Lekjaa, pr\u00e9sident de la\nFRMF et Younes Tazi, Wali...", "mass": 5, "physics": false, "shape": "box", "title": "Fouzi Lekjaa, pr\u00e9sident de la FRMF et Younes Tazi, Wali de la r\u00e9gion de Tanger-T\u00e9touan-Al Hoceima, les respons. [lematin.ma]\n-------------------------------------------------\nLe pr\u00e9sident de la F\u00e9d\u00e9ration internationale de football (FIFA), a visit\u00e9 le Grand Stade de Tanger afin de suivre l\u2019\u00e9tat d\u2019avancement des travaux en cours, qui sont \"sur le point d\u2019\u00eatre achev\u00e9s dans un d\u00e9lai record\", a indiqu\u00e9 samedi la F\u00e9d\u00e9ration royale marocaine de football (FRMF). [www.lavieeco.com]\n-------------------------------------------------\nM. Gianni Infantino a effectu\u00e9 une visite dans la ville de Tanger, aux c\u00f4t\u00e9s de M. Fouzi Lekjaa, pr\u00e9sident de la F\u00e9d\u00e9ration Royale Marocaine de Football, afin de suivre l\u2019\u00e9tat d\u2019avancement des travaux en cours au Grand Stade de Tanger, qui sont sur le point d\u2019\u00eatre achev\u00e9s dans un d\u00e9lai record, en pr\u00e9sence de M. [www.lereporter.ma]"}, {"borderWidth": 3, "fixed": true, "font": {"bold": true, "color": "#000", "size": 26}, "group": 3, "id": "comm_label_3", "label": "L\u2019AS FAR a parfaitement lanc\u00e9\nsa campagne africaine en s\u2019imposant...", "mass": 5, "physics": false, "shape": "box", "title": "L\u2019AS FAR a parfaitement lanc\u00e9 sa campagne africaine en s\u2019imposant 2-0 contre le Real Banjul de Gambie, dimanche au stade olympique de Rabat, lors du match aller du premier tour pr\u00e9liminaire de la Ligue des champions africaine. [fr.hespress.com]\n-------------------------------------------------\nL\u2019AS FAR a bien entam\u00e9 sa campagne africaine en battant les gambiens du Real de Banjul par 2 buts \u00e0 0, dimanche sur la pelouse du stade olympique de Rabat, en match aller du premier tour pr\u00e9liminaire de la Ligue des champions de la CAF. [www.yabiladi.com]"}, {"borderWidth": 3, "fixed": true, "font": {"bold": true, "color": "#000", "size": 26}, "group": 0, "id": "comm_label_0", "label": "Sur Hautes Instructions de Sa\nMajest\u00e9 le Roi Mohammed VI,...", "mass": 5, "physics": false, "shape": "box", "title": "Sur Hautes Instructions de Sa Majest\u00e9 le Roi Mohammed VI, le Chef du gouvernement, M. Aziz Akhannouch, pr\u00e9side la d\u00e9l\u00e9gation du Maroc \u00e0 la 80\u00e8 session de l\u2019Assembl\u00e9e g\u00e9n\u00e9rale des Nations Unies qui se tient \u00e0 New York. [www.lopinion.ma]\n-------------------------------------------------\nSur hautes instructions du roi Mohammed VI, le chef du gouvernement Aziz Akhannouch, pr\u00e9side la d\u00e9l\u00e9gation du Maroc \u00e0 la 80e session de l\u2019Assembl\u00e9e g\u00e9n\u00e9rale des Nations unies qui se tient \u00e0 New York. [www.yabiladi.com]\n-------------------------------------------------\nSur Hautes Instructions de Sa Majest\u00e9 le Roi Mohammed VI, le Chef du gouvernement, Aziz Akhannouch, pr\u00e9side la d\u00e9l\u00e9gation du Maroc \u00e0 la 80\u00e8 session de l\u2019Assembl\u00e9e g\u00e9n\u00e9rale des Nations Unies qui se tient \u00e0 New York. [www.lavieeco.com]\n-------------------------------------------------\nSur Hautes Instructions de Sa Majest\u00e9 le Roi Mohammed VI, le Chef du gouvernement, M. Aziz Akhannouch, pr\u00e9side la d\u00e9l\u00e9gation du Maroc \u00e0 la 80\u00e8 session de l\u2019Assembl\u00e9e g\u00e9n\u00e9rale des Nations Unies qui se tient \u00e0 New York. [www.lereporter.ma]"}]);
                  edges = new vis.DataSet([{"font": {"align": "middle", "color": "#555555", "size": 18}, "from": 2, "length": 250, "title": "autorisation, electroniqu, accueillir, supporter, d\u00e9cembre", "to": 120, "width": 5}, {"font": {"align": "middle", "color": "#555555", "size": 18}, "from": 23, "length": 250, "title": "localement, dimanche, province, orageux, averse", "to": 50, "width": 5}, {"font": {"align": "middle", "color": "#555555", "size": 18}, "from": 26, "length": 250, "title": "pr\u00e9sident, infantino, tanger, cours, stade", "to": 70, "width": 5}, {"font": {"align": "middle", "color": "#555555", "size": 18}, "from": 26, "length": 250, "title": "effectuer, pr\u00e9sident, infantino, tanger, visite", "to": 88, "width": 5}, {"font": {"align": "middle", "color": "#555555", "size": 18}, "from": 50, "length": 250, "title": "m\u00e9t\u00e9orologie, localement, direction, dimanche, province", "to": 65, "width": 5}, {"font": {"align": "middle", "color": "#555555", "size": 18}, "from": 70, "length": 250, "title": "avancement, f\u00e9d\u00e9ration, infantino, pr\u00e9sident, football", "to": 88, "width": 5}, {"font": {"align": "middle", "color": "#555555", "size": 18}, "from": 94, "length": 250, "title": "pr\u00e9liminaire, olympique, dimanche, africain, champion", "to": 114, "width": 5}, {"font": {"align": "middle", "color": "#555555", "size": 18}, "from": 104, "length": 250, "title": "gouvernement, instruction, akhannouch, d\u00e9l\u00e9gation, assembl\u00e9e", "to": 116, "width": 5}, {"font": {"align": "middle", "color": "#555555", "size": 18}, "from": 104, "length": 250, "title": "gouvernement, instruction, d\u00e9l\u00e9gation, akhannouch, assembl\u00e9e", "to": 121, "width": 5}, {"font": {"align": "middle", "color": "#555555", "size": 18}, "from": 104, "length": 250, "title": "gouvernement, instruction, d\u00e9l\u00e9gation, akhannouch, assembl\u00e9e", "to": 129, "width": 5}, {"font": {"align": "middle", "color": "#555555", "size": 18}, "from": 116, "length": 250, "title": "gouvernement, instruction, akhannouch, d\u00e9l\u00e9gation, assembl\u00e9e", "to": 121, "width": 5}, {"font": {"align": "middle", "color": "#555555", "size": 18}, "from": 116, "length": 250, "title": "gouvernement, instruction, accompagner, coop\u00e9ration, d\u00e9l\u00e9gation", "to": 129, "width": 5}, {"font": {"align": "middle", "color": "#555555", "size": 18}, "from": 121, "length": 250, "title": "gouvernement, instruction, d\u00e9l\u00e9gation, akhannouch, assembl\u00e9e", "to": 129, "width": 5}]);

                  nodeColors = {};
                  allNodes = nodes.get({ returnType: "Object" });
                  for (nodeId in allNodes) {
                    nodeColors[nodeId] = allNodes[nodeId].color;
                  }
                  allEdges = edges.get({ returnType: "Object" });
                  // adding nodes and edges to the graph
                  data = {nodes: nodes, edges: edges};

                  var options = {"nodes": {"font": {"size": 16, "align": "middle"}, "scaling": {"min": 10, "max": 30}}, "edges": {"color": {"inherit": true}, "smooth": {"type": "continuous"}, "font": {"size": 10, "align": "middle"}, "label": {"enabled": true}}, "physics": {"solver": "forceAtlas2Based", "forceAtlas2Based": {"gravitationalConstant": -150, "centralGravity": 0.008, "springLength": 100, "springConstant": 0.08, "damping": 1.0, "avoidOverlap": 1.0}, "minVelocity": 0.75, "stabilization": {"enabled": true, "iterations": 200}}, "interaction": {"hover": true, "navigationButtons": false, "multiselect": true, "tooltipDelay": 300, "dragNodes": true}};

                  


                  

                  network = new vis.Network(container, data, options);

                  

                  

                  


                  

                  return network;

              }
              drawGraph();
        </script>
    
<style>
    #info-icon {
        position: fixed;
        top: 10px;
        left: 10px;
        width: 24px;
        height: 24px;
        border-radius: 50%;
        background-color: #cccccc;
        color: white;
        font-weight: bold;
        font-family: Arial, sans-serif;
        text-align: center;
        line-height: 24px;
        cursor: pointer;
        z-index: 10000;
    }

    #tooltip {
        display: none;
        position: fixed;
        top: 10px;
        left: 45px;
        background-color: rgba(50,50,50,0.95);
        color: white;
        padding: 10px 14px;
        border-radius: 8px;
        font-size: 14px;
        max-width: 90vw;
        white-space: pre-wrap;
        word-wrap: break-word;
        box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        z-index: 10001;
    }

    @media (hover: hover) and (pointer: fine) {
        #info-icon:hover + #tooltip {
            display: block;
        }
    }
</style>

<div id="info-icon" onclick="toggleTooltip()">i</div>
<div id="tooltip">Carte générée par intelligence artificielle le 22/09/2025 à 06h19, à partir d'une analyse automatique de l'actualité. Elle met en évidence les sujets les plus traités par la presse ces dernières 24 heures. Prochaine mise à jour prévue à 12h30.</div>

<script>
    function toggleTooltip() {
        const tooltip = document.getElementById('tooltip');
        tooltip.style.display = (tooltip.style.display === 'block') ? 'none' : 'block';
    }

    // Cacher la tooltip quand on clique ailleurs
    document.addEventListener('click', function(event) {
        const icon = document.getElementById('info-icon');
        const tooltip = document.getElementById('tooltip');
        if (!icon.contains(event.target) && !tooltip.contains(event.target)) {
            tooltip.style.display = 'none';
        }
    });
</script>

    
    
    
    
    
    
    
    
    
    <script type="text/javascript">


        function positionCommunityLabels() {

            var communities = {};

            for (var nodeId in network.body.nodes) {
                var node = network.body.nodes[nodeId];

                if (nodeId.toString().indexOf('comm_label_') === 0) {
                    continue;
                }

                var groupId = node.options.group;
                if (groupId !== undefined) {
                    if (!communities[groupId]) {
                        communities[groupId] = {nodes: [], x: 0, y: 0};
                    }
                    communities[groupId].nodes.push(nodeId);
                    communities[groupId].x += node.x;
                    communities[groupId].y += node.y;
                }
            }


            for (var groupId in communities) {
                var comm = communities[groupId];
                var numNodes = comm.nodes.length;

                if (numNodes > 0) {
                    var centerX = comm.x / numNodes;
                    var centerY = comm.y / numNodes;
                    var labelId = 'comm_label_' + groupId;


                    if (network.body.nodes[labelId]) {
                        network.body.data.nodes.update({
                            id: labelId,
                            x: centerX,
                            y: centerY,
                            fixed: {
                                x: true,
                                y: true
                            }
                        });
                    } 
                }
            }
        }

        network.once("stabilized", function() {
            setTimeout(positionCommunityLabels, 100);
        });

        window.addEventListener('resize', function() {
            setTimeout(positionCommunityLabels, 50);
        });


        network.on("dragEnd", function(params) {
            setTimeout(positionCommunityLabels, 50);
        });

        network.on("afterDrawing", function() {
            if (!window.labelUpdateTimeout) {
                window.labelUpdateTimeout = setTimeout(function() {
                    positionCommunityLabels();
                    window.labelUpdateTimeout = null;
                }, 100);
            }
        });




        network.on("doubleClick", function(params) {
            if (params.nodes.length > 0) {
                var nodeId = params.nodes[0];
                var node = network.body.nodes[nodeId];
                var url = node.options.url;
                if (url && url !== '#') {
                    window.open(url, '_blank');
                }
            }
        });

        network.on("hold", function(params) {
            if (params.nodes.length > 0) {
                var nodeId = params.nodes[0];
                var node = network.body.nodes[nodeId];
                var url = node.options.url;
                if (url && url !== '#') {
                    window.open(url, '_blank');
                }
            }
        });

        function adjustForScreenSize() {
            var isMobile = window.innerWidth < 768;
            var options = {
                nodes: {
                    font: { size: isMobile ? 18 : 20 },
                    scaling: { min: isMobile ? 5 : 10, max: isMobile ? 20 : 30 }
                },
                physics: {
                    barnesHut: {
                        gravitationalConstant: isMobile ? -1000 : -2000,
                        springLength: isMobile ? 80 : 120
                    }
                }
            };
            network.setOptions(options);
        }






    function addScrollButtonsToTooltips() {
        const observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                if (mutation.addedNodes.length) {
                    Array.from(mutation.addedNodes).forEach(function(node) {
                        if (node.classList && node.classList.contains('vis-tooltip')) {
                            if (node.scrollHeight > node.clientHeight) {
                                const scrollButtons = document.createElement('div');
                                scrollButtons.className = 'scroll-buttons';
                                
                                const scrollUp = document.createElement('div');
                                scrollUp.className = 'scroll-up';
                                scrollUp.innerHTML = '▲';
                                scrollUp.onclick = function() {
                                    node.scrollBy(0, -50);
                                };
                                
                                const scrollDown = document.createElement('div');
                                scrollDown.className = 'scroll-down';
                                scrollDown.innerHTML = '▼';
                                scrollDown.onclick = function() {
                                    node.scrollBy(0, 50);
                                };
                                
                                scrollButtons.appendChild(scrollUp);
                                scrollButtons.appendChild(scrollDown);
                                node.appendChild(scrollButtons);
                            }
                        }
                    });
                }
            });
        });
        
        observer.observe(document.body, {
            childList: true,
            subtree: true
        });
    }
    
    
    
        window.addEventListener('load', adjustForScreenSize);
        window.addEventListener('resize', adjustForScreenSize);


    
    document.addEventListener('DOMContentLoaded', addScrollButtonsToTooltips);



    </script>
    </body>


    
    
</html>