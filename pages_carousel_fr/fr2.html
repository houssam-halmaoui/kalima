<!DOCTYPE html>
<html lang="ar" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); 
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title"> Les principales actualités des dernières 24 heures

</div>    
        <div class="header-subtitle"> Dernière mise à jour : 22/06/2025 - 18h27</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"></div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '5', 'title': 'Coupe du monde des clubs : WAC, Real, Man City ... Voici le programme de ce dimanche', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/430000-coupe-du-monde-des-clubs-wac-real-man-city-voici-le-programme-de-ce-dimanche.html', 'summary': 'Coupe du monde des clubs : WAC, Real, Man City . Voici le programme de ce dimanche. Des matchs à hautes intensités auront lieu ce dimanche, 22 juin, lors de la Coupe du Monde des Clubs, avec une multitude de champions potentiels sur le terrain, marqués par la deuxième apparition du représentant marocain, le Wydad de Casablanca. Le Real Madrid, Manchester City et la Juventus affronteront des outsiders du monde entier alors . ', 'size': 2}, {'id': '17', 'title': 'Mondial des clubs : WAC-Juventus, deuxième combat de David contre Goliath pour les Rouges', 'source': 'lematin.ma', 'link': 'https://lematin.ma/sports/mondial-des-clubs-wac-juventus-2eme-combat-de-david-contre-goliath/286892', 'summary': 'Mondial des clubs : WAC-Juventus, deuxième combat de David contre Goliath pour les Rouges. Auteur d’une bonne prestation face à Manchester City lors de son premier match du Mondial des clubs, le Wydad de Casablanca affronte un deuxième géant du football européen, ce dima.', 'size': 2}], 'main_title': 'Coupe du monde des clubs : WAC, Real, Man City ... Voici le programme de ce dimanche'}, {'community_id': '1', 'articles': [{'id': '7', 'title': "Trump entre en guerre contre l'Iran, des sites nucléaires clés frappés", 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/429996-trump-entre-en-guerre-contre-liran-des-sites-nucleaires-cles-frappes.html', 'summary': "Trump entre en guerre contre l'Iran, des sites nucléaires clés frappés. Les Etats-Unis ont bombardé dimanche trois sites névralgiques du programme nucléaire iranien, des frappes qui auront des « conséquences éternelles », a prévenu Téhéran, au dixième jour de la guerre entre l’Iran et Israël. L’agence de presse iranienne Irna a ensuite fait état du tir de 40 missiles sur Israël où 16 blessés ont été recensés par . ", 'size': 3}, {'id': '16', 'title': 'Les Etats-Unis ont frappé des sites nucléaires iraniens clés', 'source': 'lematin.ma', 'link': 'https://lematin.ma/monde/les-etats-unis-ont-frappe-des-sites-nucleaires-iraniens-cles/286901', 'summary': 'Les Etats-Unis ont frappé des sites nucléaires iraniens clés. Après avoir entretenu le doute pendant des jours sur une éventuelle attaque en Iran, réclamée par son allié israélien, le président américain Donald Trump a annoncé que les install.', 'size': 2}, {'id': '36', 'title': "\u200bAttaque américaine contre l'Iran : les principales réactions internationales", 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/\u200bAttaque-americaine-contre-l-Iran-les-principales-reactions-internationales_a68945.html', 'summary': "\u200bAttaque américaine contre l'Iran : les principales réactions internationales. Voici les premières réactions internationales à l'attaque américaine contre plusieurs sites nucléaires iraniens dimanche, par laquelle les Etats-Unis ont rejoint Israël dans sa guerre contre la République islamique.", 'size': 3}, {'id': '37', 'title': 'Les Etats-Unis ont frappé des sites nucléaires clés en Iran', 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/Les-Etats-Unis-ont-frappe-des-sites-nucleaires-cles-en-Iran_a68942.html', 'summary': 'Les Etats-Unis ont frappé des sites nucléaires clés en Iran. Les Etats-Unis ont bombardé dimanche trois sites névralgiques du programme nucléaire iranien, des frappes qui auront des "conséquences éternelles", a prévenu Téhéran, au dixième jour de la guerre entre l\'Iran et Israël.', 'size': 4}, {'id': '89', 'title': 'Les Etats-Unis annoncent avoir frappé des sites nucléaires en Iran', 'source': 'lnt.ma', 'link': 'https://lnt.ma/les-etats-unis-annoncent-avoir-frappe-des-sites-nucleaires-en-iran/', 'summary': 'Les Etats-Unis annoncent avoir frappé des sites nucléaires en Iran. Les Etats-Unis ont bombardé dimanche trois sites névralgiques du programme nucléaire iranien, des frappes qui auront des « conséquences éternelles », a prévenu Téhéran, au dixième jour de la guerre entre l’Iran et Israël. L’agence de presse iranienne Irna a ensuite fait état du tir de 40 missiles sur Israël où 16 blessés ont été recensés par . ', 'size': 3}], 'main_title': 'Les Etats-Unis ont frappé des sites nucléaires clés en Iran'}, {'community_id': '2', 'articles': [{'id': '10', 'title': 'La Mauritanie et le Sénégal à l’honneur à l’ouverture du 25e FICAK', 'source': 'lematin.ma', 'link': 'https://lematin.ma/culture/la-mauritanie-et-le-senegal-a-lhonneur-a-louverture-du-25e-ficak/286929', 'summary': 'La Mauritanie et le Sénégal à l’honneur à l’ouverture du 25e FICAK. Organisé sous le Haut Patronage de Sa Majesté le Roi Mohammed VI, ce rendez vous cinématographique de près de 50 ans, aspire à promouvoir la production cinématographique africaine,.', 'size': 2}, {'id': '168', 'title': 'Le Festival International du Cinéma Africain de Khouribga met à l’honneur la Mauritanie et le Sénégal', 'source': 'www.lereporter.ma', 'link': 'https://www.lereporter.ma/le-festival-international-du-cinema-africain-de-khouribga-met-a-lhonneur-la-mauritanie-et-le-senegal/', 'summary': 'Le Festival International du Cinéma Africain de Khouribga met à l’honneur la Mauritanie et le Sénégal. Le Festival International du Cinéma Africain de Khouribga (FICAK) a ouvert, samedi soir, les festivités de sa 25ᵉ édition (21-28 juin) par un hommage vibrant au cinéma mauritanien et sénégalais, les deux pays à l’honneur cette année. Organisé sous le Haut Patronage de Sa Majesté le Roi Mohammed VI, ce rendez vous cinématographique de près ', 'size': 2}], 'main_title': 'La Mauritanie et le Sénégal à l’honneur à l’ouverture du 25e FICAK'}, {'community_id': '3', 'articles': [{'id': '12', 'title': "Walid Regragui à l'honneur au Congrès des entraîneurs de la Fédération espagnole de football", 'source': 'lematin.ma', 'link': 'https://lematin.ma/sports/regragui-a-lhonneur-au-congres-des-entraineurs-de-la-rfef/286909', 'summary': "Walid Regragui à l'honneur au Congrès des entraîneurs de la Fédération espagnole de football. Ce congrès a connu la participation d’une vingtaine d’intervenants de renommée internationale, dont le sélectionneur des Lions de l’Atlas, en présence de représentants de la FIFA e.", 'size': 2}, {'id': '77', 'title': 'Walid Regragui participe au Congrès des entraîneurs de la Fédération espagnole de football', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/walid-regragui-participe-au-congres-des-entraineurs-de-la-federation-espagnole-de-football/', 'summary': 'Walid Regragui participe au Congrès des entraîneurs de la Fédération espagnole de football. Le sélectionneur national, Walid Regragui, a pris part, les 20 et 21 juin à Madrid, aux côtés de plus de 550 techniciens venus du monde entier, aux travaux du premier congrès international des entraîneurs de la Fédération royale espagnole de football (RFEF). Ce congrès a connu la participation d’une vingtaine d’intervenants de renommée internationale, dont .', 'size': 2}], 'main_title': "Walid Regragui à l'honneur au Congrès des entraîneurs de la Fédération espagnole de football"}, {'community_id': '5', 'articles': [{'id': '27', 'title': 'Abeer El Abed au Festival Gnaoua : un début gnaoui sur un chemin de passion', 'source': 'lematin.ma', 'link': 'https://lematin.ma/videos/abeer-el-abed-un-debut-gnaoui-sur-un-chemin-de-passion/286826', 'summary': 'Abeer El Abed au Festival Gnaoua : un début gnaoui sur un chemin de passion. À l’occasion de sa première participation au Festival Gnaoua et Musiques du Monde, la chanteuse marocaine Abeer El Abed revient sur son parcours audacieux, ses choix artistiques as.', 'size': 2}, {'id': '137', 'title': 'Fehd Benchemsi : « Le Gnaoua, c’est la magie de la transe partagée »', 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/Fehd-Benchemsi-Le-Gnaoua-c-est-la-magie-de-la-transe-partagee_a68954.html', 'summary': 'Fehd Benchemsi : « Le Gnaoua, c’est la magie de la transe partagée ». Après une première participation remarquée en 2023, Fehd Benchemsi signe son retour sur scène à l’occasion de la 26e édition du Festival Gnaoua et Musiques du Monde d’Essaouira, porté par la même énergie fusionnelle et l’envie de repousser les frontières musicales.', 'size': 3}, {'id': '173', 'title': 'Clôture en beauté de la 26e édition du Festival Gnaoua et Musiques du Monde à Essaouira', 'source': 'lnt.ma', 'link': 'https://lnt.ma/cloture-en-beaute-de-la-26e-edition-du-festival-gnaoua-et-musiques-du-monde-a-essaouira/', 'summary': 'Clôture en beauté de la 26e édition du Festival Gnaoua et Musiques du Monde à Essaouira. La 26e édition du Festival Gnaoua et Musiques du Monde s’est achevée samedi soir à Essaouira, à l’issue de trois jours de concerts, de rencontres et d’échanges culturels. L’événement a accueilli un large public venu assister à des performances mêlant les traditions musicales gnaouies à des sonorités issues de divers horizons. Organisé dans plusieurs espaces . ', 'size': 2}], 'main_title': 'Fehd Benchemsi : « Le Gnaoua, c’est la magie de la transe partagée »'}, {'community_id': '6', 'articles': [{'id': '55', 'title': 'La ministre française Aurore Bergé en visite officielle au Maroc du 23 au 25 juin', 'source': 'www.challenge.ma', 'link': 'https://www.challenge.ma/la-ministre-francaise-aurore-berge-en-visite-officielle-au-maroc-du-23-au-25-juin-305222/', 'summary': 'La ministre française Aurore Bergé en visite officielle au Maroc du 23 au 25 juin. Aurore Bergé, ministre de l’Égalité entre les femmes et les hommes et de la Lutte contre les discriminations, se rendra au Maroc du 23 au 25 juin 2025 courant. Elle aura l’occasion de s’entretenir avec plusieurs responsables politiques de haut niveau, parmi lesquels Nadia Fettah Alaoui, ministre de l’Economie et', 'size': 3}, {'id': '88', 'title': 'Déplacement de la ministre française Aurore Bergé du 23 au 25 juin', 'source': 'atlasinfo.fr', 'link': 'https://atlasinfo.fr/deplacement-de-la-ministre-francaise-aurore-berge-du-23-au-25-juin.html', 'summary': 'Déplacement de la ministre française Aurore Bergé du 23 au 25 juin. La ministre française de l’Égalité entre les femmes et les hommes et de la Lutte contre les discriminations, Aurore Bergé, se rendra au Maroc du 23 au 25 juin. L’article est apparu en premier sur .', 'size': 2}, {'id': '152', 'title': 'Maroc – France\xa0: La ministre Aurore Bergé en déplacement à Rabat, Casablanca et Marrakech', 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/169636/maroc-france-ministre-aurore-berge.html', 'summary': 'Maroc – France : La ministre Aurore Bergé en déplacement à Rabat, Casablanca et Marrakech. La ministre française de l’Égalité entre les femmes et les hommes et de la lutte contre les discriminations, Aurore Bergé, est en visite officielle au Maroc du 23 au 25 juin 2025, dans le cadre du partenariat d’exception renforcé, scellé entre les chefs d’Etats des deux pays. Elle aura des entretiens avec des responsables marocains de haut niveau, dont Nadia Fettah Alaoui, ministre marocaine de l’Economie et des finances, ou encore Naïma Ben Yahia, ministre de la Solidarité, de l’insertion sociale et de la famille.', 'size': 2}], 'main_title': 'La ministre française Aurore Bergé en visite officielle au Maroc du 23 au 25 juin'}, {'community_id': '7', 'articles': [{'id': '60', 'title': 'M.Akhannouch en direct d’Agadir : Le gouvernement poursuit son action avec détermination pour la mise en œuvre des chantiers de développement', 'source': 'aujourdhui.ma', 'link': 'https://aujourdhui.ma/actualite/m-akhannouch-en-direct-dagadir-le-gouvernement-poursuit-son-action-avec-determination-pour-la-mise-en-oeuvre-des-chantiers-de-developpement', 'summary': 'M.Akhannouch en direct d’Agadir : Le gouvernement poursuit son action avec détermination pour la mise en œuvre des chantiers de développement. Le gouvernement poursuit son action avec détermination et dévouement pour la mise en œuvre optimale des chantiers de développement lancés dans les différents domaines sous la conduite éclairée de SM le Roi Mohammed VI, a affirmé, samedi à Agadir, le président du Rassemblement national des indépendants (RNI), Aziz Akhannouch. S’exprimant lors de la 4ᵉ étape .', 'size': 2}, {'id': '76', 'title': 'Le gouvernement poursuit son action avec détermination pour la mise en œuvre des chantiers de développement', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/le-gouvernement-poursuit-son-action-avec-determination-pour-la-mise-en-oeuvre-des-chantiers-de-developpement/', 'summary': 'Le gouvernement poursuit son action avec détermination pour la mise en œuvre des chantiers de développement. Le gouvernement poursuit son action avec détermination et dévouement pour la mise en œuvre optimale des chantiers de développement lancés dans les différents domaines sous la conduite éclairée de SM le Roi Mohammed VI, a affirmé, samedi à Agadir, le président du Rassemblement national des indépendants (RNI), Aziz Akhannouch. S’exprimant lors de la 4ᵉ étape .', 'size': 2}], 'main_title': 'M.Akhannouch en direct d’Agadir : Le gouvernement poursuit son action avec détermination pour la mise en œuvre des chantiers de développement'}, {'community_id': '8', 'articles': [{'id': '90', 'title': 'Réchauffement climatique : Un bilan 2024 inquiétant pour le Maroc', 'source': 'lnt.ma', 'link': 'https://lnt.ma/rechauffement-climatique-des-chiffres-de-2024-inquietants-pour-le-maroc/', 'summary': 'Réchauffement climatique : Un bilan 2024 inquiétant pour le Maroc. La Direction générale de la météorologie (DGM) a présenté, vendredi 20 juin 2025 à Rabat, son rapport annuel sur l’état du climat au Maroc pour l’année 2024, lors d’une rencontre organisée en présence du ministre de l’Équipement et de l’Eau, Nizar Baraka. Ce document, publié pour la cinquième année consécutive, dresse un état des lieux . ', 'size': 2}, {'id': '110', 'title': 'Sécheresse, canicule et inondations : ce que révèle le Rapport annuel sur l’état du climat au Maroc', 'source': 'lematin.ma', 'link': 'https://lematin.ma/nation/climat-au-maroc-ce-que-revele-le-dernier-rapport-annuel/287016', 'summary': 'Sécheresse, canicule et inondations : ce que révèle le Rapport annuel sur l’état du climat au Maroc. La Direction générale de la météorologie (DGM) a levé le voile, vendredi dernier à Rabat, sur les grandes tendances climatiques ayant marqué l’année 2024 au Maroc. Le constat est.', 'size': 2}], 'main_title': 'Réchauffement climatique : Un bilan 2024 inquiétant pour le Maroc'}, {'community_id': '4', 'articles': [{'id': '97', 'title': 'Iran-Israël-USA : les pays arabes "préoccupés", appellent à la retenue', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/430083-iran-israel-usa-les-pays-arabes-preoccupes-appellent-a-la-retenue.html', 'summary': 'Iran-Israël-USA : les pays arabes "préoccupés", appellent à la retenue. Plusieurs États arabes ont affirmé, dimanche, suivre avec préoccupation le développement des événements, suite à l’attaque menée par les États-Unis contre des sites nucléaires en Iran, appelant à la retenue pour éviter toute escalade. Ainsi,vles Émirats Arabes Unis ont exprimé leur préoccupation face à la persistance des tensions dans la région, dont l’attaque des installations . ', 'size': 2}, {'id': '118', 'title': "Attaque américaine contre l'Iran : les pays arabes suivent avec préoccupation les développements de la situation et appellent à la retenue", 'source': 'lematin.ma', 'link': 'https://lematin.ma/monde/attaque-americaine-contre-liran-les-pays-arabes-appellent-a-la-retenue/286991', 'summary': "Attaque américaine contre l'Iran : les pays arabes suivent avec préoccupation les développements de la situation et appellent à la retenue. Ainsi, l'Égypte a exprimé sa grande préoccupation face aux récents développements en Iran, dénonçant une escalade aux conséquences graves sur la paix et la sécurité.", 'size': 2}, {'id': '163', 'title': 'Attaque américaine contre l’Iran: Les pays arabes suivent avec préoccupation les développements de la situation et appellent à la retenue', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/attaque-americaine-contre-liran-les-pays-arabes-suivent-avec-preoccupation-les-developpements-de-la-situation-et-appellent-a-la-retenue/', 'summary': 'Attaque américaine contre l’Iran: Les pays arabes suivent avec préoccupation les développements de la situation et appellent à la retenue. Plusieurs États arabes ont affirmé, dimanche, suivre avec préoccupation le développement des événements, suite à l’attaque menée par les États-Unis contre des sites nucléaires en Iran, appelant à la retenue pour éviter toute escalade. Ainsi, l’Égypte a exprimé sa grande préoccupation face aux récents développements en Iran, dénonçant une escalade aux « conséquences graves » sur la .', 'size': 3}], 'main_title': 'Attaque américaine contre l’Iran: Les pays arabes suivent avec préoccupation les développements de la situation et appellent à la retenue'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
                        
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ? d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        // Fonction pour cacher le tooltip
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = '';
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
    
    
</body>




</html>
    