<!DOCTYPE html>
<html lang="ar" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); 
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title"> Les principales actualités des dernières 24 heures

</div>    
        <div class="header-subtitle"> Dernière mise à jour : 22/09/2025 - 06h19</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"></div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '1', 'articles': [{'id': '2', 'title': 'CAN 2025 : le Maroc instaure une AEVM pour les supporters du continent', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/442190-can-2025-le-maroc-instaure-une-aevm-pour-les-supporters-du-continent.html', 'summary': 'CAN 2025 : le Maroc instaure une AEVM pour les supporters du continent. A l’approche de la 35ᵉ Coupe d’Afrique des Nations (CAN), que le Maroc accueillera du 21 décembre 2025 au 18 janvier 2026, le Royaume déploie de nouvelles mesures pour encadrer l’afflux attendu de supporters du continent. Une Autorisation Electronique de Voyage au Maroc (AEVM) sera mise en place, visant à fluidifier les formalités frontalières et . ', 'size': 2}, {'id': '120', 'title': 'CAN 2025 au Maroc : Précisions sur l’Autorisation Electronique de voyage pour certains pays africains', 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/176914/2025-maroc-precisions-l-autorisation-electronique.html', 'summary': 'CAN 2025 au Maroc : Précisions sur l’Autorisation Electronique de voyage pour certains pays africains. Le Maroc se prépare à accueillir la 35e édition de la Coupe d’Afrique des Nations (CAN) du 21 décembre 2025 au 18 janvier 2026. Afin de gérer efficacement lafflux de supporters traversant les frontières et de garantir une logistique sans faille, le pays a décidé de mettre en place une procédure simplifiée pour lobtention de l’Autorisation Électronique de Voyage au Maroc (AEVM). Cette mesure concerne les ressortissants des pays africains exemptés de visa dentrée au Maroc.', 'size': 2}], 'main_title': 'CAN 2025 : le Maroc instaure une AEVM pour les supporters du continent'}, {'community_id': '4', 'articles': [{'id': '23', 'title': 'Averses orageuses localement fortes avec rafales de vent ce dimanche dans plusieurs régions du Maroc', 'source': 'lematin.ma', 'link': 'https://lematin.ma/regions/averses-orageuses-localement-fortes-avec-rafales-de-vent-ce-dimanche/302839', 'summary': 'Averses orageuses localement fortes avec rafales de vent ce dimanche dans plusieurs régions du Maroc. Des averses orageuses (20 à 30 mm) localement fortes avec rafales de vent sous orages sont prévues de 14h à 22h dans les provinces de Jerada, Figuig, Boulemane, Midelt, Ouarzazate.', 'size': 2}, {'id': '50', 'title': 'Maroc : Averses orageuses localement fortes avec rafales de vent dimanche', 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/176903/maroc-averses-orageuses-localement-fortes.html', 'summary': 'Maroc : Averses orageuses localement fortes avec rafales de vent dimanche. Des averses orageuses localement fortes avec rafales de vent sous orages sont attendues, ce dimanche, dans certaines provinces du Maroc, a annoncé la Direction générale de la météorologie (DGM).', 'size': 3}, {'id': '65', 'title': 'Alerte météo : Averses orageuses et rafales de vent ce dimanche', 'source': 'www.lavieeco.com', 'link': 'https://www.lavieeco.com/au-royaume/alerte-meteo-averses-orageuses-et-rafales-de-vent-ce-dimanche/', 'summary': 'Alerte météo : Averses orageuses et rafales de vent ce dimanche. Des averses orageuses localement fortes avec rafales de vent sous orages sont attendues, ce dimanche, dans certaines provinces du Royaume, a annoncé la Direction générale de la météorologie (DGM).', 'size': 2}], 'main_title': 'Maroc : Averses orageuses localement fortes avec rafales de vent dimanche'}, {'community_id': '2', 'articles': [{'id': '26', 'title': 'Le président de la FIFA émerveillé par le Grand Stade de Tanger', 'source': 'lematin.ma', 'link': 'https://lematin.ma/sports/le-president-de-la-fifa-visite-le-grand-stade-de-tanger/302766', 'summary': 'Le président de la FIFA émerveillé par le Grand Stade de Tanger. Au cours de cette visite, effectuée par M. Infantino aux côtés de MM. Fouzi Lekjaa, président de la FRMF et Younes Tazi, Wali de la région de Tanger-Tétouan-Al Hoceima, les respons.', 'size': 3}, {'id': '70', 'title': 'Gianni Infantino visite le Grand Stade de Tanger', 'source': 'www.lavieeco.com', 'link': 'https://www.lavieeco.com/videos/gianni-infantino-visite-le-grand-stade-de-tanger/', 'summary': 'Gianni Infantino visite le Grand Stade de Tanger. Le président de la Fédération internationale de football (FIFA), a visité le Grand Stade de Tanger afin de suivre l’état d’avancement des travaux en cours, qui sont "sur le point d’être achevés dans un délai record", a indiqué samedi la Fédération royale marocaine de football (FRMF).', 'size': 3}, {'id': '88', 'title': 'FRMF | Le président de la FIFA M. Gianni Infantino en visite au Grand Stade de Tanger', 'source': 'www.lereporter.ma', 'link': 'https://www.lereporter.ma/frmf-le-president-de-la-fifa-m-gianni-infantino-en-visite-au-grand-stade-de-tanger/', 'summary': 'FRMF | Le président de la FIFA M. Gianni Infantino en visite au Grand Stade de Tanger. M. Gianni Infantino a effectué une visite dans la ville de Tanger, aux côtés de M. Fouzi Lekjaa, président de la Fédération Royale Marocaine de Football, afin de suivre l’état d’avancement des travaux en cours au Grand Stade de Tanger, qui sont sur le point d’être achevés dans un délai record, en présence de M. ', 'size': 3}], 'main_title': 'Le président de la FIFA émerveillé par le Grand Stade de Tanger'}, {'community_id': '3', 'articles': [{'id': '94', 'title': 'LdC de la CAF : l’AS FAR s’impose face au Real Banjul (2-0)', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/442201-ldc-de-la-caf-las-far-simpose-face-au-real-banjul-2-0.html', 'summary': 'LdC de la CAF : l’AS FAR s’impose face au Real Banjul (2-0). L’AS FAR a parfaitement lancé sa campagne africaine en s’imposant 2-0 contre le Real Banjul de Gambie, dimanche au stade olympique de Rabat, lors du match aller du premier tour préliminaire de la Ligue des champions africaine. Les Militaires ont ouvert le score à la 28e minute par l’intermédiaire de Youssef El Fahli, avant de . ', 'size': 2}, {'id': '114', 'title': 'Ligue des champions de la CAF (1er tour préliminaire aller): L’AS FAR bat le Real de Banjul', 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/176933/ligue-champions-tour-preliminaire-aller.html', 'summary': 'Ligue des champions de la CAF (1er tour préliminaire aller): L’AS FAR bat le Real de Banjul. L’AS FAR a bien entamé sa campagne africaine en battant les gambiens du Real de Banjul par 2 buts à 0, dimanche sur la pelouse du stade olympique de Rabat, en match aller du premier tour préliminaire de la Ligue des champions de la CAF.', 'size': 2}], 'main_title': 'LdC de la CAF : l’AS FAR s’impose face au Real Banjul (2-0)'}, {'community_id': '0', 'articles': [{'id': '104', 'title': "80è Assemblée générale de l'ONU : Aziz Akhannouch préside la délégation du Maroc", 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/80e-Assemblee-generale-de-l-ONU-Aziz-Akhannouch-preside-la-delegation-du-Maroc_a72028.html', 'summary': "80è Assemblée générale de l'ONU : Aziz Akhannouch préside la délégation du Maroc. Sur Hautes Instructions de Sa Majesté le Roi Mohammed VI, le Chef du gouvernement, M. Aziz Akhannouch, préside la délégation du Maroc à la 80è session de l’Assemblée générale des Nations Unies qui se tient à New York.", 'size': 4}, {'id': '116', 'title': "Aziz Akhannouch préside la délégation du Maroc à la 80e Assemblée générale de l'ONU", 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/176930/aziz-akhannouch-preside-delegation-maroc.html', 'summary': "Aziz Akhannouch préside la délégation du Maroc à la 80e Assemblée générale de l'ONU. Sur hautes instructions du roi Mohammed VI, le chef du gouvernement Aziz Akhannouch, préside la délégation du Maroc à la 80e session de l’Assemblée générale des Nations unies qui se tient à New York. Il est accompagné par le ministre des Affaires étrangères, de la coopération africaine et des Marocains résidant à l’étranger, Nasser Bourita.", 'size': 4}, {'id': '121', 'title': 'Assemblée générale de l’ONU : Akhannouch préside la délégation du Maroc à la 80è session', 'source': 'www.lavieeco.com', 'link': 'https://www.lavieeco.com/pouvoirs/assemblee-generale-de-lonu-akhannouch-preside-la-delegation-du-maroc-a-la-80e-session/', 'summary': 'Assemblée générale de l’ONU : Akhannouch préside la délégation du Maroc à la 80è session. Sur Hautes Instructions de Sa Majesté le Roi Mohammed VI, le Chef du gouvernement, Aziz Akhannouch, préside la délégation du Maroc à la 80è session de l’Assemblée générale des Nations Unies qui se tient à New York.', 'size': 4}, {'id': '129', 'title': 'Sur Hautes Instructions de SM le Roi, M. Akhannouch préside la délégation du Maroc à la 80è AG de l’ONU', 'source': 'www.lereporter.ma', 'link': 'https://www.lereporter.ma/sur-hautes-instructions-de-sm-le-roi-m-akhannouch-preside-la-delegation-du-maroc-a-la-80e-ag-de-lonu/', 'summary': 'Sur Hautes Instructions de SM le Roi, M. Akhannouch préside la délégation du Maroc à la 80è AG de l’ONU. Sur Hautes Instructions de Sa Majesté le Roi Mohammed VI, le Chef du gouvernement, M. Aziz Akhannouch, préside la délégation du Maroc à la 80è session de l’Assemblée générale des Nations Unies qui se tient à New York. M. Akhannouch est accompagné à cette session par le ministre des Affaires étrangères, de la Coopération africaine ', 'size': 4}], 'main_title': "80è Assemblée générale de l'ONU : Aziz Akhannouch préside la délégation du Maroc"}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
                        
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ? d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        // Fonction pour cacher le tooltip
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = '';
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
    
    
</body>




</html>
    