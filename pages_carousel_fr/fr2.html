<!DOCTYPE html>
<html lang="ar" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); 
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title"> Les principales actualités des dernières 24 heures

</div>    
        <div class="header-subtitle"> Dernière mise à jour : 16/06/2025 - 06h25</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"></div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '1', 'title': 'Égalité femmes-hommes : le Maroc confronté à des écarts persistants', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/428867-egalite-femmes-hommes-le-maroc-confronte-a-des-ecarts-persistants.html', 'summary': 'Égalité femmes-hommes : le Maroc confronté à des écarts persistants. Malgré des avancées en matière d’éducation, le Maroc demeure à la traîne sur plusieurs fronts de l’égalité femmes-hommes, notamment en matière d’emploi, de représentativité politique et de droits fondamentaux. L’édition 2025 de l’Indice global de l’écart entre les genres (Global Gender Gap), élaboré par le Forum économique mondial, maintient le Maroc à la 137e position . ', 'size': 2}, {'id': '36', 'title': 'Égalité de genre : voici où en est le Maroc selon le «Global Gender Gap Index 2025»', 'source': 'lematin.ma', 'link': 'https://lematin.ma/nation/egalite-de-genre-voici-ou-en-est-le-maroc-global-gender-gap-index-2025/285396', 'summary': 'Égalité de genre : voici où en est le Maroc selon le «Global Gender Gap Index 2025». L’édition 2025 de l’Indice global de l’écart entre les genres, réalisé par le Forum économique mondial, dresse un tableau nuancé de la situation du Maroc. Classé au 137e rang sur 1.', 'size': 2}], 'main_title': 'Égalité femmes-hommes : le Maroc confronté à des écarts persistants'}, {'community_id': '8', 'articles': [{'id': '2', 'title': "Israël-l'Iran: Trump se dit ouvert à une médiation de Poutine", 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/428872-israel-liran-trump-se-dit-ouvert-a-une-mediation-de-poutine.html', 'summary': "Israël-l'Iran: Trump se dit ouvert à une médiation de Poutine. Donald Trump s’est dit dimanche « ouvert » à ce que le président russe Vladimir Poutine joue un rôle de médiateur dans le conflit entre Israël et l’Iran, dans lequel il « est possible » que les Etats-Unis s’impliquent. Le président américain a aussi assuré qu’il n’y avait « pas de date butoir » pour que les Iraniens reviennent à la . ", 'size': 2}, {'id': '123', 'title': 'Iran-Israël: Trump «\xa0ouvert\xa0» à une médiation de Poutine, dit «\xa0possible\xa0» une implication des Etats-Unis', 'source': 'www.challenge.ma', 'link': 'https://www.challenge.ma/iran-israel-trump-ouvert-a-une-mediation-de-poutine-dit-possible-une-implication-des-etats-unis-304791/', 'summary': 'Iran-Israël: Trump « ouvert » à une médiation de Poutine, dit « possible » une implication des Etats-Unis. Donald Trump s’est dit dimanche « ouvert » à ce que le président russe Vladimir Poutine joue un rôle de médiateur dans le conflit entre Israël et l’Iran, dans lequel il « est possible » que les Etats-Unis s’impliquent. Le président américain a aussi assuré qu’il n’y avait « pas de date butoir » pour que', 'size': 2}], 'main_title': "Israël-l'Iran: Trump se dit ouvert à une médiation de Poutine"}, {'community_id': '2', 'articles': [{'id': '5', 'title': 'Alerte météo: Grêle et averses orageuses dans plusieurs villes ce dimanche', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/428858-alerte-meteo-grele-et-averses-orageuses-dans-plusieurs-villes-ce-dimanche.html', 'summary': 'Alerte météo: Grêle et averses orageuses dans plusieurs villes ce dimanche. Des averses orageuses localement fortes avec chutes de grêle et rafales de vent sont prévues ce dimanche dans plusieurs provinces du Royaume, a annoncé la Direction générale de la météorologie (DGM). Ces averses (15-25 mm) sont attendues de 14H00 à 22H00 dans les provinces de Taza, Khouribga, Driouch, Jerada, Taourirt, Khémisset, Al Hoceima et Guercif, . ', 'size': 3}, {'id': '59', 'title': 'Averses orageuses localement fortes avec chutes de grêle et rafales de vent, ce dimanche dans plusieurs provinces', 'source': 'www.challenge.ma', 'link': 'https://www.challenge.ma/averses-orageuses-localement-fortes-avec-chutes-de-grele-et-rafales-de-vent-ce-dimanche-dans-plusieurs-provinces-304785/', 'summary': 'Averses orageuses localement fortes avec chutes de grêle et rafales de vent, ce dimanche dans plusieurs provinces. Des averses orageuses localement fortes avec chutes de grêle et rafales de vent sont prévues ce dimanche dans plusieurs provinces du Royaume, a annoncé la Direction générale de la météorologie (DGM). Ces averses (15-25 mm) sont attendues de 14H00 à 22H00 dans les provinces de Taza, Khouribga, Driouch, Jerada, Taourirt,', 'size': 4}, {'id': '77', 'title': 'Alerte météo : Averses orageuses localement fortes avec chutes de grêle et rafales de vent, ce dimanche', 'source': 'aujourdhui.ma', 'link': 'https://aujourdhui.ma/actualite/alerte-meteo-averses-orageuses-localement-fortes-avec-chutes-de-grele-et-rafales-de-vent-ce-dimanche', 'summary': 'Alerte météo : Averses orageuses localement fortes avec chutes de grêle et rafales de vent, ce dimanche. Des averses orageuses localement fortes avec chutes de grêle et rafales de vent sont prévues ce dimanche dans plusieurs provinces du Royaume, a annoncé la Direction générale de la météorologie (DGM). Ces averses (15-25 mm) sont attendues de 14H00 à 22H00 dans les provinces de Taza, Khouribga, Driouch, Jerada, Taourirt, Khémisset, Al Hoceima et Guercif, .', 'size': 3}], 'main_title': 'Averses orageuses localement fortes avec chutes de grêle et rafales de vent, ce dimanche dans plusieurs provinces'}, {'community_id': '3', 'articles': [{'id': '18', 'title': 'Alerte météo : orages, grêle et rafales attendus ce dimanche', 'source': 'lematin.ma', 'link': 'https://lematin.ma/regions/alerte-meteo-orages-grele-et-rafales-attendus-ce-dimanche/285552', 'summary': 'Alerte météo : orages, grêle et rafales attendus ce dimanche. Des averses orageuses localement fortes avec chutes de grêle et rafales de vent sont prévues ce dimanche dans plusieurs provinces du Royaume, a annoncé la Direction générale de la.', 'size': 4}, {'id': '85', 'title': 'Alerte météo\xa0: Averses orageuses, chutes de grêle et rafales de vent', 'source': 'www.lavieeco.com', 'link': 'https://www.lavieeco.com/influences/climat/alerte-meteo-averses-orageuses-chutes-de-grele-et-rafales-de-vent/', 'summary': 'Alerte météo : Averses orageuses, chutes de grêle et rafales de vent. La Direction générale de la météorologie annonce des averses orageuses localement fortes avec chutes de grêle et rafales de vent, ce dimanche, dans plusieurs provinces. Niveau de vigilance orange.', 'size': 2}, {'id': '117', 'title': 'Averses orageuses et rafales de vent, prévues dans plusieurs provinces du Royaume', 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/Averses-orageuses-et-rafales-de-vent-prevues-dans-plusieurs-provinces-du-Royaume_a68695.html', 'summary': 'Averses orageuses et rafales de vent, prévues dans plusieurs provinces du Royaume.', 'size': 2}], 'main_title': 'Alerte météo : orages, grêle et rafales attendus ce dimanche'}, {'community_id': '6', 'articles': [{'id': '22', 'title': 'S.A.R. la Princesse Lalla Asmaa préside la cérémonie de fin d’année scolaire 2024-2025 de la Fondation Lalla Asmaa', 'source': 'lematin.ma', 'link': 'https://lematin.ma/videos/fondation-lalla-asmaa-ceremonie-de-fin-dannee-scolaire/285546', 'summary': 'S.A.R. la Princesse Lalla Asmaa préside la cérémonie de fin d’année scolaire 2024-2025 de la Fondation Lalla Asmaa. Son Altesse Royale la Princesse Lalla Asmaa, Présidente de la Fondation Lalla Asmaa, a présidé, samedi au siège de la Fondation à Rabat, la cérémonie de fin d’année scolaire 2024-2.', 'size': 2}, {'id': '51', 'title': 'SAR la Princesse Lalla Asmaa préside la cérémonie de fin d’année scolaire 2024-2025 de la Fondation Lalla Asmaa', 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/SAR-la-Princesse-Lalla-Asmaa-preside-la-ceremonie-de-fin-d-annee-scolaire-2024-2025-de-la-Fondation-Lalla-Asmaa_a68674.html', 'summary': 'SAR la Princesse Lalla Asmaa préside la cérémonie de fin d’année scolaire 2024-2025 de la Fondation Lalla Asmaa. Son Altesse Royale la Princesse Lalla Asmaa, Présidente de la Fondation Lalla Asmaa, a présidé, samedi au siège de la Fondation à Rabat, la cérémonie de fin d’année scolaire 2024-2025 de cette Fondation, qui s’impose aujourd’hui comme une référence nationale et continentale dans l’accompagnement des enfants sourds et malentendants.', 'size': 2}], 'main_title': 'S.A.R. la Princesse Lalla Asmaa préside la cérémonie de fin d’année scolaire 2024-2025 de la Fondation Lalla Asmaa'}, {'community_id': '1', 'articles': [{'id': '54', 'title': 'Banque Populaire et Attijariwafa Bank parmi les 2000 plus grandes entreprises selon Forbes', 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/Banque-Populaire-et-Attijariwafa-Bank-parmi-les-2000-plus-grandes-entreprises-selon-Forbes_a68670.html', 'summary': 'Banque Populaire et Attijariwafa Bank parmi les 2000 plus grandes entreprises selon Forbes. Selon le classement « The Global 2000 » du magazine Forbes, deux banques marocaines figurent dans le classement des 2000 plus grandes compagnies du monde en 2025. Détails.', 'size': 2}, {'id': '73', 'title': 'Attijariwafa Bank et Banque Populaire dans le classement Forbes Global 2000 de 2025', 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/168980/attijariwafa-bank-banque-populaire-dans.html', 'summary': 'Attijariwafa Bank et Banque Populaire dans le classement Forbes Global 2000 de 2025. Deux banques marocaines font partie de la 23e édition du prestigieux classement «Global 2000» de Forbes, qui répertorie les plus grandes entreprises mondiales pour lannée 2025 : Attijariwafa Bank et Banque Centrale Populaire.', 'size': 2}], 'main_title': 'Banque Populaire et Attijariwafa Bank parmi les 2000 plus grandes entreprises selon Forbes'}, {'community_id': '7', 'articles': [{'id': '92', 'title': 'L’Agence nationale des eaux et forêts appelle à la vigilance face au risque d’incendies dans plusieurs régions du Royaume', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/lagence-nationale-des-eaux-et-forets-appelle-a-la-vigilance-face-au-risque-dincendies-dans-plusieurs-regions-du-royaume/', 'summary': 'L’Agence nationale des eaux et forêts appelle à la vigilance face au risque d’incendies dans plusieurs régions du Royaume. L’Agence nationale des eaux et forêts (ANEF) a lancé, dimanche, un appel à la vigilance aux riverains des forêts, aux citoyens estivants et visiteurs ainsi qu’aux personnes travaillant en milieux forestiers, afin de prendre les précautions nécessaires pour éviter les départs de feux de forêts. Cette population est également appelée à alerter rapidement les autorités .', 'size': 2}, {'id': '110', 'title': 'Feux de forêt: Appel à la vigilance aux citoyens et travailleurs', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/428896-feux-de-foret-appel-a-la-vigilance-aux-citoyens-et-travailleurs.html', 'summary': 'Feux de forêt: Appel à la vigilance aux citoyens et travailleurs. L’Agence nationale des eaux et forêts (ANEF) a lancé, dimanche, un appel à la vigilance aux riverains des forêts, aux citoyens estivants et visiteurs ainsi qu’aux personnes travaillant en milieux forestiers, afin de prendre les précautions nécessaires pour éviter les départs de feux de forêts. Cette population est également appelée à alerter rapidement les autorités . ', 'size': 2}], 'main_title': 'L’Agence nationale des eaux et forêts appelle à la vigilance face au risque d’incendies dans plusieurs régions du Royaume'}, {'community_id': '5', 'articles': [{'id': '94', 'title': 'L’Espagne augmente son soutien à l’OMS avec une contribution de 5,25 millions d’euros', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/lespagne-augmente-son-soutien-a-loms-avec-une-contribution-de-525-millions-deuros/', 'summary': 'L’Espagne augmente son soutien à l’OMS avec une contribution de 5,25 millions d’euros. L’Agence espagnole de coopération internationale au développement (AECID) et l’Organisation mondiale de la santé (OMS) ont signé, samedi, un nouvel accord et une contribution de 5,25 millions d’euros pour soutenir les principales initiatives de l’OMS. « L’Espagne est depuis longtemps un partenaire proche et fidèle de l’OMS et de la santé mondiale », a déclaré le Directeur .', 'size': 2}, {'id': '105', 'title': "L'Espagne augmente sa contribution à l'OMS", 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/428884-lespagne-augmente-sa-contribution-a-loms.html', 'summary': "L'Espagne augmente sa contribution à l'OMS. L’Agence espagnole de coopération internationale au développement (AECID) et l’Organisation mondiale de la santé (OMS) ont signé, samedi, un nouvel accord et une contribution de 5,25 millions d’euros pour soutenir les principales initiatives de l’OMS. « L’Espagne est depuis longtemps un partenaire proche et fidèle de l’OMS et de la santé mondiale », a déclaré le Directeur . ", 'size': 2}], 'main_title': 'L’Espagne augmente son soutien à l’OMS avec une contribution de 5,25 millions d’euros'}, {'community_id': '4', 'articles': [{'id': '98', 'title': 'Températures prévues pour le lundi 16 juin 2025', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/temperatures-prevues-pour-le-lundi-16-juin-2025/', 'summary': 'Températures prévues pour le lundi 16 juin 2025. Voici les températures minimales et maximales prévues par la Direction générale de la météorologie pour le lundi 16 juin 2025 : Min Max – Oujda 23 36 – Bouarfa 23 36 – Al Hoceima 19 27 – Tétouan 19 26 – Sebta 20 23 – Mellilia 21 25 – Tanger 22 31 – Kénitra 20 .', 'size': 2}, {'id': '102', 'title': 'Les températures attendues ce lundi 16 juin 2025', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/428904-les-temperatures-attendues-ce-lundi-16-juin-2025.html', 'summary': 'Les températures attendues ce lundi 16 juin 2025. Voici les températures minimales et maximales prévues par la Direction générale de la météorologie pour le lundi 16 juin 2025 : Min Max – Oujda 23 36 – Bouarfa 23 36 – Al Hoceima 19 27 – Tétouan 19 26 – Sebta 20 23 – Mellilia 21 25 – Tanger 22 31 – Kénitra 20 . ', 'size': 2}], 'main_title': 'Températures prévues pour le lundi 16 juin 2025'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
                        
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ? d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        // Fonction pour cacher le tooltip
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = '';
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
    
    
</body>




</html>
    