<!DOCTYPE html>
<html lang="ar" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); 
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title"> Les principales actualités des dernières 24 heures

</div>    
        <div class="header-subtitle"> Dernière mise à jour : 25/08/2025 - 06h22</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"></div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '1', 'articles': [{'id': '9', 'title': 'Grèce : Ayoub El Kaabi démarre fort et offre la victoire à l’Olympiakos', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/438516-grece-ayoub-el-kaabi-demarre-fort-et-offre-la-victoire-a-lolympiakos.html', 'summary': 'Grèce : Ayoub El Kaabi démarre fort et offre la victoire à l’Olympiakos. Ayoub El Kaabi a parfaitement lancé sa saison avec l’Olympiakos en championnat grec. Titulaire samedi soir face à l’Asteras Tripolis lors de la première journée de Super League, l’avant-centre de 32 ans a joué un rôle décisif dans le succès de son équipe (2-0). Aligné d’entrée, El Kaabi s’est distingué par son activité constante dans . ', 'size': 2}, {'id': '12', 'title': 'Ayoub El Kaabi ouvre son compteur avec l’Olympiakos', 'source': 'lematin.ma', 'link': 'https://lematin.ma/sports/ayoub-el-kaabi-ouvre-son-compteur-avec-lolympiakos/297827', 'summary': 'Ayoub El Kaabi ouvre son compteur avec l’Olympiakos. Aligné d’entrée et présent durant l’intégralité de la rencontre face à l’Asteras Tripolis, Ayoub El Kaabi s’est montré fidèle à sa réputation : un attaquant mobile, insistant, qui.', 'size': 2}], 'main_title': 'Grèce : Ayoub El Kaabi démarre fort et offre la victoire à l’Olympiakos'}, {'community_id': '2', 'articles': [{'id': '22', 'title': "Les classes préparatoires du Lydex de Benguérir, l'une des meilleures au monde pour intégrer les grandes écoles d’ingénieurs", 'source': 'lematin.ma', 'link': 'https://lematin.ma/enseignement/benguerir-lydex-rivalise-avec-les-meilleures-prepas-au-monde-les-echos/297834', 'summary': "Les classes préparatoires du Lydex de Benguérir, l'une des meilleures au monde pour intégrer les grandes écoles d’ingénieurs. À 70 kilomètres au nord de Marrakech, aux portes de Benguérir, «la prépa est désormais une sérieuse concurrente aux prestigieuses classes du lycée privé Sainte-Geneviève à Versaill.", 'size': 2}, {'id': '76', 'title': 'Maroc : Le Lydex de Benguerir , l’une des meilleures classes préparatoires au monde pour intégrer les plus grandes écoles d’ingénieurs (Les Echos)', 'source': 'atlasinfo.fr', 'link': 'https://atlasinfo.fr/maroc-le-lydex-de-benguerir-lune-des-meilleures-classes-preparatoires-au-monde-pour-integrer-les-plus-grandes-ecoles-dingenieurs-les-echos.html', 'summary': 'Maroc : Le Lydex de Benguerir , l’une des meilleures classes préparatoires au monde pour intégrer les plus grandes écoles d’ingénieurs (Les Echos). En à peine dix ans, les classes préparatoires du Lycée Mohammed VI d’excellence de Benguérir (Lydex) sont devenues l’une des meilleures au monde pour accéder aux plus grandes écoles d’ingénieurs, écrit le quotidien français d’information économique et financière « Les Echos ». A 70 kilomètres au nord de Marrakech, aux portes de Benguerir, « la prépa est désormais . L’article est apparu en premier sur .', 'size': 2}], 'main_title': "Les classes préparatoires du Lydex de Benguérir, l'une des meilleures au monde pour intégrer les grandes écoles d’ingénieurs"}, {'community_id': '3', 'articles': [{'id': '27', 'title': 'Aïd Al Mawlid Annabaoui célébré le vendredi 05 septembre', 'source': 'lematin.ma', 'link': 'https://lematin.ma/nation/aid-al-mawlid-annabaoui-celebre-le-vendredi-05-septembre/297708', 'summary': 'Aïd Al Mawlid Annabaoui célébré le vendredi 05 septembre. Dans un communiqué, le ministère indique que l’observation du croissant lunaire du mois de Rabie-I 1447 a eu lieu le samedi 29 Safar 1447 de l’hégire, correspondant au 23 août 2025.', 'size': 4}, {'id': '49', 'title': 'Aid Al Mawlid célébré le 5 septembre. Un jour férié ou deux ? Ce que prévoit la loi', 'source': 'www.challenge.ma', 'link': 'https://www.challenge.ma/aid-al-mawlid-celebre-le-5-septembre-un-jour-ferie-ou-deux-ce-que-prevoit-la-loi-308971/', 'summary': 'Aid Al Mawlid célébré le 5 septembre. Un jour férié ou deux ? Ce que prévoit la loi. Au Maroc, le mois de Rabie-I 1447 de l’hégire débutera le lundi 25 août 2025 et Aïd Al Mawlid Annabaoui sera célébré le vendredi 5 septembre, annonce le ministère des Habous et des Affaires islamiques. « Avons-nous droit à un jour de congé ou plutôt deux ? » Cette question que se', 'size': 4}, {'id': '56', 'title': 'Le 1er Rabie-I 1447 correspond au lundi 25 août, Aïd Al Mawlid Annabaoui célébré le vendredi 05 septembre', 'source': 'aujourdhui.ma', 'link': 'https://aujourdhui.ma/actualite/le-1er-rabie-i-1447-correspond-au-lundi-25-aout-aid-al-mawlid-annabaoui-celebre-le-vendredi-05-septembre', 'summary': 'Le 1er Rabie-I 1447 correspond au lundi 25 août, Aïd Al Mawlid Annabaoui célébré le vendredi 05 septembre. Le mois de Rabie-I 1447 de l’hégire débutera le lundi 25 août 2025 et Aïd Al Mawlid Annabaoui sera célébré le vendredi 05 septembre, a annoncé, samedi soir, le ministère des Habous et des Affaires islamiques. Dans un communiqué, le ministère indique que l’observation du croissant lunaire du mois de Rabie-I 1447 a eu lieu .', 'size': 5}, {'id': '75', 'title': 'Aïd Al Mawlid Annabaoui sera célébré le vendredi 05 septembre', 'source': 'atlasinfo.fr', 'link': 'https://atlasinfo.fr/maroc-aid-al-mawlid-annabaoui-sera-celebre-le-vendredi-05-septembre.html', 'summary': 'Aïd Al Mawlid Annabaoui sera célébré le vendredi 05 septembre. Le mois de Rabie-I 1447 de l’hégire débutera le lundi 25 août 2025 et Aïd Al Mawlid Annabaoui sera célébré le vendredi 05 septembre, a annoncé samedi soir à Rabat le ministère des Habous et des Affaires islamiques. Dans un communiqué, le ministère indique que l’observation du croissant lunaire du mois de Rabie-I 1447 a . L’article est apparu en premier sur .', 'size': 5}, {'id': '80', 'title': 'Aïd Al Mawlid Annabaoui célébré le 5 septembre au Maroc', 'source': 'lnt.ma', 'link': 'https://lnt.ma/aid-al-mawlid-annabaoui-celebre-le-5-septembre-au-maroc/', 'summary': 'Aïd Al Mawlid Annabaoui célébré le 5 septembre au Maroc. Le mois de Rabie-I 1447 de l’hégire débutera le lundi 25 août 2025 et Aïd Al Mawlid Annabaoui sera célébré le vendredi 05 septembre, a annoncé, samedi soir, le ministère des Habous et des Affaires islamiques. Dans un communiqué, le ministère indique que l’observation du croissant lunaire du mois de Rabie-I 1447 a eu lieu . ', 'size': 5}], 'main_title': 'Le 1er Rabie-I 1447 correspond au lundi 25 août, Aïd Al Mawlid Annabaoui célébré le vendredi 05 septembre'}, {'community_id': '4', 'articles': [{'id': '29', 'title': 'Le 20ème Festival international des arts urbains, du 6 au 15 septembre', 'source': 'lematin.ma', 'link': 'https://lematin.ma/culture/le-20eme-festival-international-des-arts-urbains-du-6-au-15-septembre/297686', 'summary': 'Le 20ème Festival international des arts urbains, du 6 au 15 septembre. Plus de 800 artistes et athlètes marocains et étrangers prendront part à ce festival, devenu au fil des ans un moment fort qui réunit artistes, danseurs, rappeurs et professi.', 'size': 2}, {'id': '58', 'title': 'Plus de 800 artistes au 20ème Festival international des arts urbains', 'source': 'www.libe.ma', 'link': 'https://www.libe.ma/Plus-de-800-artistes-au-20eme-Festival-international-des-arts-urbains_a155386.html', 'summary': 'Plus de 800 artistes au 20ème Festival international des arts urbains.', 'size': 2}], 'main_title': 'Le 20ème Festival international des arts urbains, du 6 au 15 septembre'}, {'community_id': '5', 'articles': [{'id': '48', 'title': 'Port d’Essaouira: les prises des bateaux baissent lourdement à fin juillet', 'source': 'www.challenge.ma', 'link': 'https://www.challenge.ma/port-dessaouira-les-prises-des-bateaux-baissent-lourdement-a-fin-juillet-308976/', 'summary': 'Port d’Essaouira: les prises des bateaux baissent lourdement à fin juillet. Les débarquements des produits de la pêche côtière et artisanale au niveau du port d’Essaouira ont enregistré, durant les sept premiers mois de l’année en cours, une baisse de 30% en poids et de 1% en valeur, selon l’Office national des pêches (ONP). Les quantités débarquées dans ce port se', 'size': 2}, {'id': '83', 'title': 'Port d’Essaouira : Baisse de 30% des débarquements de la pêche à fin juillet', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/438559-port-dessaouira-baisse-de-30-des-debarquements-de-la-peche-a-fin-juillet.html', 'summary': 'Port d’Essaouira : Baisse de 30% des débarquements de la pêche à fin juillet. Les débarquements des produits de la pêche côtière et artisanale au niveau du port d’Essaouira ont enregistré, durant les sept premiers mois de l’année en cours, une baisse de 30% en poids et de 1% en valeur, selon l’Office national des pêches (ONP). Les quantités débarquées dans ce port se sont établies à fin juillet . ', 'size': 2}], 'main_title': 'Port d’Essaouira: les prises des bateaux baissent lourdement à fin juillet'}, {'community_id': '8', 'articles': [{'id': '51', 'title': 'Aéroport Mohammed V : Arrestation d’un ressortissant turc\xa0pour trafic de cocaïne', 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/174859/aeroport-mohammed-arrestation-d-un-ressortissant.html', 'summary': 'Aéroport Mohammed V : Arrestation d’un ressortissant turc pour trafic de cocaïne. Les éléments de la sûreté nationale de l’aéroport international Mohammed V de Casablanca ont interpellé, vendredi, un ressortissant turc faisant l’objet d’un mandat d’arrêt international émis par les autorités judiciaires allemandes, a-t-on appris de source sécuritaire.', 'size': 2}, {'id': '54', 'title': 'Aéroport Mohammed V : Interpellation d’un ressortissant turc faisant l’objet d’un mandat d’arrêt international', 'source': 'aujourdhui.ma', 'link': 'https://aujourdhui.ma/actualite/aeroport-mohammed-v-interpellation-dun-ressortissant-turc-faisant-lobjet-dun-mandat-darret-international', 'summary': 'Aéroport Mohammed V : Interpellation d’un ressortissant turc faisant l’objet d’un mandat d’arrêt international. Les éléments de la sûreté nationale de l’aéroport international Mohammed V de Casablanca ont interpellé, vendredi, un ressortissant turc faisant l’objet d’un mandat d’arrêt international émis par les autorités judiciaires allemandes, a-t-on appris de source sécuritaire. Le mis en cause (43 ans) a été appréhendé immédiatement à son arrivée à bord d’un vol en provenance .', 'size': 2}], 'main_title': 'Aéroport Mohammed V : Arrestation d’un ressortissant turc\xa0pour trafic de cocaïne'}, {'community_id': '7', 'articles': [{'id': '71', 'title': 'Vol Lyon-Porto : un passager tente d’entrer dans le cockpit, l’avion fait demi-tour', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/vol-lyon-porto-un-passager-tente-dentrer-dans-le-cockpit-lavion-fait-demi-tour/', 'summary': 'Vol Lyon-Porto : un passager tente d’entrer dans le cockpit, l’avion fait demi-tour. Pris de « mal de l’air » et de « bouffées délirantes », un passager a tenté, vendredi soir, d’entrer dans le cockpit sur un vol Lyon-Porto de la compagnie EasyJet, contraignant l’avion à faire demi-tour, rapportent les médias de l’hexagone. Selon la presse qui cite la compagnie et la police française, la tentative d’intrusion est survenue peu après .', 'size': 2}, {'id': '78', 'title': 'Un passager tente d’entrer dans le cockpit sur un vol Lyon-Porto, l’avion fait demi-tour', 'source': 'atlasinfo.fr', 'link': 'https://atlasinfo.fr/pris-de-mal-de-lair-un-passager-tente-dentrer-dans-le-cockpit-sur-un-vol-lyon-porto-lavion-fait-demi-tour.html', 'summary': 'Un passager tente d’entrer dans le cockpit sur un vol Lyon-Porto, l’avion fait demi-tour. Pris de « mal de l’air » et de « bouffées délirantes », un passager a tenté vendredi soir d’entrer dans le cockpit sur un vol Lyon-Porto de la compagnie EasyJet, contraignant l’avion à faire demi-tour, rapportent les médias de l’hexagone. Selon la presse qui cite la compagnie et la police française, la tentative d’intrusion est survenue peu après . L’article est apparu en premier sur .', 'size': 2}], 'main_title': 'Vol Lyon-Porto : un passager tente d’entrer dans le cockpit, l’avion fait demi-tour'}, {'community_id': '0', 'articles': [{'id': '86', 'title': 'Roi Mohammed VI: Le Maroc a toujours inscrit son action extérieure dans le respect du droit international', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/438556-roi-mohammed-vi-le-maroc-a-toujours-inscrit-son-action-exterieure-dans-le-respect-du-droit-international.html', 'summary': 'Roi Mohammed VI: Le Maroc a toujours inscrit son action extérieure dans le respect du droit international. Le Royaume du Maroc a toujours inscrit son action extérieure dans une démarche légaliste, structurée, fondée sur le respect du droit international et des principes de la Charte des Nations Unies, a affirmé le Roi Mohammed VI. « Il n’y a pas d’ordre viable sans règles. C’est dans cette conviction que s’ancre la diplomatie marocaine », a . ', 'size': 2}, {'id': '105', 'title': 'Mohammed VI : «\xa0Il n’y a pas d’ordre viable sans règles. C’est dans cette conviction que s’ancre la diplomatie marocaine\xa0»', 'source': 'atlasinfo.fr', 'link': 'https://atlasinfo.fr/mohammed-vi-le-maroc-a-toujours-inscrit-son-action-exterieure-dans-une-demarche-legaliste-structuree-fondee-sur-le-respect-du-droit-international-et-des-principes-de-la-charte-des-nations-unies.html', 'summary': 'Mohammed VI : « Il n’y a pas d’ordre viable sans règles. C’est dans cette conviction que s’ancre la diplomatie marocaine ». Le Royaume du Maroc a toujours inscrit son action extérieure dans une démarche légaliste, structurée, fondée sur le respect du droit international et des principes de la Charte des Nations Unies, a affirmé le Roi Mohammed VI. « Il n’y a pas d’ordre viable sans règles. C’est dans cette conviction que s’ancre la diplomatie marocaine », a . L’article est apparu en premier sur .', 'size': 2}], 'main_title': 'Roi Mohammed VI: Le Maroc a toujours inscrit son action extérieure dans le respect du droit international'}, {'community_id': '6', 'articles': [{'id': '103', 'title': 'SM Le Roi adresse un Message aux participants à la 82e session de l’Institut de Droit International', 'source': 'www.lavieeco.com', 'link': 'https://www.lavieeco.com/au-royaume/evenement/sm-le-roi-adresse-un-message-aux-participants-a-la-82e-session-de-linstitut-de-droit-international/', 'summary': 'SM Le Roi adresse un Message aux participants à la 82e session de l’Institut de Droit International. Sa Majesté le Roi Mohammed VI a adressé un Message aux participants à la 82e session de l’Institut de Droit International, qui a ouvert ses travaux, dimanche au siège de l’Académie du Royaume du Maroc, à Rabat.', 'size': 3}, {'id': '107', 'title': 'Le Roi Mohammed VI adresse un message aux participants à la 82e session de l’Institut de Droit International (Texte intégral)', 'source': 'atlasinfo.fr', 'link': 'https://atlasinfo.fr/le-roi-mohammed-vi-adresse-un-message-aux-participants-a-la-82e-session-de-linstitut-de-droit-international-texte-integral.html', 'summary': 'Le Roi Mohammed VI adresse un message aux participants à la 82e session de l’Institut de Droit International (Texte intégral). Le Roi Mohammed VI a adressé un Message aux participants à la 82e session de l’Institut de Droit International, qui a ouvert ses travaux dimanche au siège de l’Académie du Royaume du Marocà Rabat. Voici le texte intégral du Message Royal, dont lecture a été donnée par le président de l’Institut de Droit International, Mohamed . L’article est apparu en premier sur .', 'size': 3}, {'id': '109', 'title': 'SM le Roi adresse un Message aux participants à la 82e session de l’Institut de Droit International', 'source': 'www.lereporter.ma', 'link': 'https://www.lereporter.ma/sm-le-roi-adresse-un-message-aux-participants-a-la-82e-session-de-linstitut-de-droit-international/', 'summary': 'SM le Roi adresse un Message aux participants à la 82e session de l’Institut de Droit International. Sa Majesté le Roi Mohammed VI, que Dieu L’assiste, a adressé un Message aux participants à la 82e session de l’Institut de Droit International, qui a ouvert ses travaux, dimanche au siège de l’Académie du Royaume du Maroc, à Rabat. Voici le texte intégral du Message Royal, dont lecture a été donnée par le président ', 'size': 3}], 'main_title': 'SM Le Roi adresse un Message aux participants à la 82e session de l’Institut de Droit International'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
                        
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ? d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        // Fonction pour cacher le tooltip
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = '';
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
    
    
</body>




</html>
    