<!DOCTYPE html>
<html lang="ar" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); 
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title"> Les principales actualités des dernières 24 heures

</div>    
        <div class="header-subtitle"> Dernière mise à jour : 28/09/2025 - 06h15</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"></div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '5', 'title': "Bourita: Le soutien à l'initiative d'autonomie marocaine au Sahara s'est renforcée à l'AG de l'ONU", 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/443032-bourita-le-soutien-a-linitiative-dautonomie-marocaine-au-sahara-sest-renforcee-a-lag-de-lonu.html', 'summary': "Bourita: Le soutien à l'initiative d'autonomie marocaine au Sahara s'est renforcée à l'AG de l'ONU. Le ministre des Affaires étrangères, de la Coopération africaine et des Marocains résidant à l’étranger, Nasser Bourita, a souligné, vendredi à New York, que la participation marocaine à la semaine de haut niveau de la 80è session de l’Assemblée générale de l’ONU a permis de renforcer davantage la dynamique internationale impulsée par le Roi Mohammed . ", 'size': 4}, {'id': '61', 'title': "Nasser Bourita : Le soutien international au plan marocain d'autonomie renforcé à l'AG de l'ONU", 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/177426/nasser-bourita-soutien-international-plan.html', 'summary': "Nasser Bourita : Le soutien international au plan marocain d'autonomie renforcé à l'AG de l'ONU. Le ministre des Affaires étrangères, de la Coopération africaine et des Marocains résidant à l’étranger, Nasser Bourita, a souligné, vendredi à New York, que la participation marocaine à la semaine de haut niveau de la 80è session de l’Assemblée générale de l’ONU a permis de renforcer davantage la dynamique internationale impulsée par le roi Mohammed VI en soutien au plan d’autonomie et à la souveraineté du Maroc sur son Sahara.", 'size': 4}, {'id': '99', 'title': 'Série d’entretiens de Nasser Bourita en marge de la 80è session de l’AG de l’ONU', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/serie-dentretiens-de-nasser-bourita-en-marge-de-la-80e-session-de-lag-de-lonu/', 'summary': 'Série d’entretiens de Nasser Bourita en marge de la 80è session de l’AG de l’ONU. Le ministre des Affaires étrangères, de la Coopération africaine et des Marocains résidant à l’étranger, Nasser Bourita, a eu, vendredi à New York, une série d’entretiens bilatéraux, en marge de la 80è session de l’Assemblée générale des Nations Unies. M. Bourita s’est ainsi entretenu avec la Directrice générale de l’Organisation internationale pour les migrations (OIM), .', 'size': 4}, {'id': '146', 'title': 'AG de l’ONU : Bourita fait le point sur la semaine diplomatique du Maroc', 'source': 'lnt.ma', 'link': 'https://lnt.ma/ag-de-lonu-bourita-fait-le-point-sur-la-semaine-diplomatique-du-maroc/', 'summary': 'AG de l’ONU : Bourita fait le point sur la semaine diplomatique du Maroc. En marge de la 80e Assemblée générale de l’ONU, le ministre des Affaires étrangères, de la Coopération africaine et des Marocains résidant à l’étranger, Nasser Bourita, a affirmé que le Maroc s’implique activement dans les initiatives visant à répondre aux grandes problématiques mondiales — paix et sécurité, développement, migration, climat et lutte antiterroriste. Fort de . ', 'size': 4}], 'main_title': "Bourita: Le soutien à l'initiative d'autonomie marocaine au Sahara s'est renforcée à l'AG de l'ONU"}, {'community_id': '9', 'articles': [{'id': '10', 'title': 'L’élite mondiale et marocaine s’aligne sur le 10 KM International de Casablanca ce dimanche', 'source': 'lematin.ma', 'link': 'https://lematin.ma/sports/lelite-mondiale-brille-au-10-km-international-de-casablanca-ce-dimanche/304253', 'summary': 'L’élite mondiale et marocaine s’aligne sur le 10 KM International de Casablanca ce dimanche. Casablanca se met à l’heure du sport de haut niveau avec le 10 KM International by WeCasablanca, qui accueillera ce dimanche une pléiade d’athlètes de renommée mondiale. Chez les d.', 'size': 2}, {'id': '64', 'title': 'Un plateau exceptionnel d’athlètes internationaux et marocains pour le 10 KM International by WeCasablanca', 'source': 'aujourdhui.ma', 'link': 'https://aujourdhui.ma/videos/un-plateau-exceptionnel-dathletes-internationaux-et-marocains-pour-le-10-km-international-by-wecasablanca', 'summary': 'Un plateau exceptionnel d’athlètes internationaux et marocains pour le 10 KM International by WeCasablanca. Le « 10KM International by WeCasablanca » prévu dimanche s’apprête à accueillir un plateau exceptionnel d’athlètes internationaux et marocains, ont annoncé vendredi les organisateurs. Parmi les athlètes féminines, la tête d’affiche sera l’Éthiopienne Likina Amebaw Ayel, référence mondiale sur le semi-marathon et le 10 km, ont indiqué les organisateurs lors d’une conférence de presse dédiée à la .', 'size': 2}], 'main_title': 'L’élite mondiale et marocaine s’aligne sur le 10 KM International de Casablanca ce dimanche'}, {'community_id': '8', 'articles': [{'id': '22', 'title': 'Croissance : La BERD anticipe +4,2 % pour le Maroc en 2025', 'source': 'lematin.ma', 'link': 'https://lematin.ma/economie/croissance-de-42-au-maroc-en-2025-selon-la-berd/304183', 'summary': 'Croissance : La BERD anticipe +4,2 % pour le Maroc en 2025. Selon le dernier rapport de la Banque européenne pour la reconstruction et le développement (BERD), la croissance économique dans la région du sud et de l’est de la Méditerranée (S.', 'size': 2}, {'id': '118', 'title': 'La BERD anticipe une croissance de 4,2 % pour le Maroc en 2025', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/442976-la-berd-anticipe-une-croissance-de-42-pour-le-maroc-en-2025.html', 'summary': 'La BERD anticipe une croissance de 4,2 % pour le Maroc en 2025. La Banque européenne pour la reconstruction et le développement (BERD) prévoit que le Maroc continuera de croître à un rythme supérieur à celui de ses voisins de la région sud et est de la Méditerranée. Avec un taux attendu de 4,2 % en 2025, le Royaume confirme sa position de moteur économique régional, soutenu par . ', 'size': 2}], 'main_title': 'Croissance : La BERD anticipe +4,2 % pour le Maroc en 2025'}, {'community_id': '7', 'articles': [{'id': '25', 'title': 'Remise des certificats à la 2ème promotion du programme de Financement sur les Marchés des Capitaux', 'source': 'lematin.ma', 'link': 'https://lematin.ma/videos/marches-des-capitaux-remise-des-certificats-a-la-2eme-promotion/304173', 'summary': 'Remise des certificats à la 2ème promotion du programme de Financement sur les Marchés des Capitaux. La Bourse de Casablanca, en partenariat avec l’Ordre des Experts-Comptables du Maroc (OEC) et son Institut de Formation, a célébré la remise des certificats de la deuxième promotio.', 'size': 2}, {'id': '115', 'title': 'Stratégies de financement : la deuxième promotion d’experts-comptables certifiée', 'source': 'lnt.ma', 'link': 'https://lnt.ma/strategies-de-financement-la-deuxieme-promotion-dexperts-comptables-certifiee/', 'summary': 'Stratégies de financement : la deuxième promotion d’experts-comptables certifiée. Le Conseil national de l’Ordre des experts-comptables (OEC), l’Institut de formation de l’OEC et la Bourse de Casablanca ont célébré, au siège de la place casablancaise, la remise des certificats à la deuxième promotion du Certificat professionnel en Stratégies de financement sur les marchés des capitaux. Vingt experts-comptables, issus de différentes régions du Royaume, ont . ', 'size': 2}], 'main_title': 'Remise des certificats à la 2ème promotion du programme de Financement sur les Marchés des Capitaux'}, {'community_id': '6', 'articles': [{'id': '27', 'title': 'Sahara : Le Portugal réaffirme son plein soutien à l’initiative marocaine d’autonomie', 'source': 'lematin.ma', 'link': 'https://lematin.ma/nation/le-portugal-reaffirme-son-soutien-a-linitiative-marocaine-dautonomie/304160', 'summary': 'Sahara : Le Portugal réaffirme son plein soutien à l’initiative marocaine d’autonomie. Lors d’une séance à l’Assemblée de la République (parlement), le PSD a souligné que la position du Portugal « ne laisse place à aucune ambiguïté », en rappelant que le gouvernement.', 'size': 2}, {'id': '54', 'title': 'Le Portugal réaffirme son plein soutien à l’initiative marocaine d’autonomie pour le Sahara', 'source': 'telquel.ma', 'link': 'https://telquel.ma/instant-t/2025/09/26/le-portugal-reaffirme-son-plein-soutien-a-linitiative-marocaine-dautonomie-pour-le-sahara_1952766/', 'summary': 'Le Portugal réaffirme son plein soutien à l’initiative marocaine d’autonomie pour le Sahara. Le Groupe parlementaire du Parti social-démocrate (PSD), qui dirige la coalition de droite au pouvoir au Portugal, a réitéré, vendredi, son soutien à l’initiative marocaine d’autonomie pour le Sahara comme la base la plus sérieuse, crédible et constructive pour régler ce différend régional. Lors d’une séance à l’Assemblée de la République (parlement), le PSD a.', 'size': 2}], 'main_title': 'Sahara : Le Portugal réaffirme son plein soutien à l’initiative marocaine d’autonomie'}, {'community_id': '5', 'articles': [{'id': '53', 'title': 'United Airlines renforce sa liaison directe entre Marrakech et New York pour l’hiver 2025-2026', 'source': 'telquel.ma', 'link': 'https://telquel.ma/instant-t/2025/09/26/united-airlines-renforce-sa-liaison-directe-entre-marrakech-et-new-york-pour-lhiver-2025-2026_1952769/', 'summary': 'United Airlines renforce sa liaison directe entre Marrakech et New York pour l’hiver 2025-2026. La compagnie aérienne américaine United Airlines a annoncé le renforcement de sa liaison saisonnière sans escale entre Marrakech et New York/Newark, avec une augmentation de plus de 43 % de l’offre de sièges pour l’hiver 2025-2026. À compter de la reprise des vols le 26 octobre prochain, United augmentera les fréquences entre Marrakech et New.', 'size': 3}, {'id': '58', 'title': 'United Airlines renforce son offre hivernale entre New York et Marrakech', 'source': 'www.challenge.ma', 'link': 'https://www.challenge.ma/united-airlines-renforce-son-offre-hivernale-entre-new-york-et-marrakech-310639/', 'summary': 'United Airlines renforce son offre hivernale entre New York et Marrakech. United Airlines, première compagnie à opérer des vols sans escale entre Marrakech et les États-Unis, a décidé de renforcer la liaison entre la Cité ocre et New York,', 'size': 3}, {'id': '90', 'title': 'Aérien : United Airlines augmente sa liaison entre Marrakech et New York', 'source': 'www.lavieeco.com', 'link': 'https://www.lavieeco.com/au-royaume/scans/aerien-united-airlines-augmente-sa-liaison-entre-marrakech-et-new-york/', 'summary': 'Aérien : United Airlines augmente sa liaison entre Marrakech et New York. La compagnie aérienne américaine United Airlines a annoncé le renforcement de sa liaison saisonnière sans escale entre Marrakech et New York/Newark, avec une augmentation de plus de 43% de l’offre de sièges pour l’hiver 2025-2026.', 'size': 3}], 'main_title': 'United Airlines renforce sa liaison directe entre Marrakech et New York pour l’hiver 2025-2026'}, {'community_id': '1', 'articles': [{'id': '65', 'title': 'ANME : installation du nouveau bureau exécutif', 'source': 'aujourdhui.ma', 'link': 'https://aujourdhui.ma/actualite/anme-installation-du-nouveau-bureau-executif', 'summary': 'ANME : installation du nouveau bureau exécutif. Le bureau exécutif de l’Association nationale des médias et des éditeurs (ANME) a tenu sa première réunion, marquant l’amorce d’une nouvelle phase organisationnelle dans un esprit de continuité, imprégné d’un sens élevé de responsabilité commune. Outre la formation du bureau exécutif et la nomination de ses membres, cette réunion a été l’occasion de définir les .', 'size': 2}, {'id': '113', 'title': 'Après la réélection de son Président, l’ANME installe son nouveau Bureau Executif', 'source': 'www.lereporter.ma', 'link': 'https://www.lereporter.ma/apres-la-reelection-de-son-president-lanme-installe-son-nouveau-bureau-executif/', 'summary': 'Après la réélection de son Président, l’ANME installe son nouveau Bureau Executif. Après la réélection de son Président, Driss Chahtane, jeudi 18 septembre 2025, l’ANME a installé son nouveau Bureau Executif ce vendredi 26 septembre. Le bureau exécutif de l’Association nationale des médias et des éditeurs (ANME) a tenu sa première réunion, marquant l’amorce d’une nouvelle phase organisationnelle dans un esprit de continuité, imprégné d’un sens élevé ', 'size': 2}], 'main_title': 'ANME : installation du nouveau bureau exécutif'}, {'community_id': '2', 'articles': [{'id': '80', 'title': 'Le Maroc retrouve son statut d’Investment grade', 'source': 'www.lavieeco.com', 'link': 'https://www.lavieeco.com/argent/le-maroc-retrouve-son-statut-dinvestment-grade/', 'summary': 'Le Maroc retrouve son statut d’Investment grade. L’agence de notation Standard & Poor’s a reclassé le Royaume dans la catégorie Investment grade suite à la révision à la hausse de sa note souveraine.', 'size': 2}, {'id': '94', 'title': 'Standard & Poor’s revoit à la hausse la note souveraine du Maroc', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/standard-poors-revoit-a-la-hausse-la-note-souveraine-du-maroc/', 'summary': 'Standard & Poor’s revoit à la hausse la note souveraine du Maroc. L’agence de notation américaine, Standard & Poor’s, a révisé à la hausse la note souveraine du Maroc à BBB-/A-3, en reclassant de nouveau le Royaume au niveau de la catégorie “Investment grade”. La décision de l’agence américaine, prise au terme d’une mission effectuée au Royaume en septembre courant, s’explique par la résilience de l’économie marocaine .', 'size': 2}], 'main_title': 'Le Maroc retrouve son statut d’Investment grade'}, {'community_id': '4', 'articles': [{'id': '83', 'title': 'Maroc-USA: Washington réaffirme son appui à la souveraineté du Maroc sur son Sahara', 'source': 'www.lavieeco.com', 'link': 'https://www.lavieeco.com/pouvoirs/diplomatie/maroc-usa-washington-reaffirme-son-appui-a-la-souverainete-du-maroc-sur-son-sahara/', 'summary': 'Maroc-USA: Washington réaffirme son appui à la souveraineté du Maroc sur son Sahara. Le Conseiller spécial du Président Trump réaffirme le soutien des États-Unis à la souveraineté du Maroc sur son Sahara et au Plan d’autonomie comme seule solution durable, tout en encourageant les investissements américains dans les Provinces du Sud et en renforçant le partenariat stratégique avec Rabat.', 'size': 2}, {'id': '98', 'title': 'Le Conseiller spécial du Président Trump réaffirme le soutien des États-Unis à la souveraineté du Maroc sur son Sahara et au Plan d’autonomie', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/le-conseiller-special-du-president-trump-reaffirme-le-soutien-des-etats-unis-a-la-souverainete-du-maroc-sur-son-sahara-et-au-plan-dautonomie/', 'summary': 'Le Conseiller spécial du Président Trump réaffirme le soutien des États-Unis à la souveraineté du Maroc sur son Sahara et au Plan d’autonomie. M. Massad Boulos, Conseiller spécial pour l’Afrique du Président des Etats-Unis, a réaffirmé, vendredi, le soutien de Washington à la souveraineté du Maroc sur son Sahara et au Plan marocain d’autonomie comme « la seule base pour une solution juste et durable » à ce différend régional. Dans un message publié sur la plateforme X suite à .', 'size': 2}], 'main_title': 'Maroc-USA: Washington réaffirme son appui à la souveraineté du Maroc sur son Sahara'}, {'community_id': '3', 'articles': [{'id': '96', 'title': 'ONU: Le «\xa0Hub Morocco Digital for Sustainable Development\xa0» reflète l’engagement du Maroc envers l’Afrique et le monde arabe', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/onu-le-hub-morocco-digital-for-sustainable-development-reflete-lengagement-du-maroc-envers-lafrique-et-le-monde-arabe/', 'summary': 'ONU: Le « Hub Morocco Digital for Sustainable Development » reflète l’engagement du Maroc envers l’Afrique et le monde arabe. Le Chef du gouvernement, Aziz Akhannouch, a souligné, vendredi à New York, que le « Hub Morocco Digital for Sustainable Development » (D4SD), lancé à l’ONU par le Maroc, reflète l’engagement ferme du Royaume, sous le leadership de Sa Majesté le Roi Mohammed VI, en faveur de l’accélération de la transformation numérique de l’Afrique et du monde .', 'size': 2}, {'id': '126', 'title': 'Hub Morocco Digital : le Maroc lance à l’ONU une plateforme pour accélérer la transformation numérique en Afrique et dans le monde arabe', 'source': 'lematin.ma', 'link': 'https://lematin.ma/nation/le-maroc-lance-une-plateforme-pour-accelerer-la-transformation-numerique/304190', 'summary': 'Hub Morocco Digital : le Maroc lance à l’ONU une plateforme pour accélérer la transformation numérique en Afrique et dans le monde arabe. En droite ligne de la Vision de Sa Majesté le Roi Mohammed VI, le Maroc a lancé officiellement, vendredi à New York, le Hub Morocco Digital for Sustainable Development.', 'size': 3}, {'id': '145', 'title': 'New York : lancement du « Hub Morocco Digital for Sustainable Development » pour accélérer la transformation numérique en Afrique et dans le monde arabe', 'source': 'lnt.ma', 'link': 'https://lnt.ma/new-york-lancement-du-hub-morocco-digital-for-sustainable-development-pour-accelerer-la-transformation-numerique-en-afrique-et-dans-le-monde-arabe/', 'summary': 'New York : lancement du « Hub Morocco Digital for Sustainable Development » pour accélérer la transformation numérique en Afrique et dans le monde arabe. Le Maroc a officiellement lancé le « Hub Morocco Digital for Sustainable Development » (D4SD), une plateforme régionale destinée à impulser la transformation numérique inclusive et durable en Afrique et dans la région arabe. L’initiative, portée par le ministère de la Transition numérique et de la Réforme de l’administration en partenariat avec le Programme des . ', 'size': 2}], 'main_title': 'Hub Morocco Digital : le Maroc lance à l’ONU une plateforme pour accélérer la transformation numérique en Afrique et dans le monde arabe'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
                        
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ? d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        // Fonction pour cacher le tooltip
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = '';
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
    
    
</body>




</html>
    