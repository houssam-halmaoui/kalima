<!DOCTYPE html>
<html lang="ar" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); 
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title"> Les principales actualités des dernières 24 heures

</div>    
        <div class="header-subtitle"> Dernière mise à jour : 28/07/2025 - 06h33</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"></div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '4', 'articles': [{'id': '8', 'title': 'Tanger Med: une tentative de trafic de plus de 4 tonnes de Chira déjouée', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/435231-tanger-med-une-tentative-de-trafic-de-plus-de-4-tonnes-de-chira-dejouee.html', 'summary': 'Tanger Med: une tentative de trafic de plus de 4 tonnes de Chira déjouée. Les éléments de la Sûreté nationale et des douanes opérant au port de Tanger Med ont réussi, dans les premières heures de la matinée de ce dimanche 27 juillet, à déjouer une tentative de trafic de 4 tonnes et 374 kilogrammes de résine de cannabis (chira) à bord d’un camion de transport international de marchandises. . ', 'size': 2}, {'id': '21', 'title': 'Saisie de plus de 4 tonnes de chira au port Tanger Med', 'source': 'lematin.ma', 'link': 'https://lematin.ma/regions/saisie-de-plus-de-4-tonnes-de-chira-au-port-tanger-med/293470', 'summary': 'Saisie de plus de 4 tonnes de chira au port Tanger Med. Les opérations conjointes de contrôle menées par les services de la Sûreté nationale et de la Douane ont permis la saisie de cette importante cargaison de stupéfiants, soigneusemen.', 'size': 4}, {'id': '55', 'title': 'Tanger Med : Saisie de plus de 4 tonnes de chira dans un camion à destination de l’Europe', 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/172808/tanger-saisie-plus-tonnes-chira.html', 'summary': 'Tanger Med : Saisie de plus de 4 tonnes de chira dans un camion à destination de l’Europe. Les éléments de la Sûreté nationale et de la Douane opérant au port de Tanger Med ont mis en échec, aux premières heures de dimanche, une tentative de trafic de 4,374 tonnes de chira à bord d’un camion de transport international de marchandises. Les opérations conjointes de contrôle menées par les services de la Sûreté nationale et de la Douane ont permis la saisie de cette importante cargaison de stupéfiants, soigneusement dissimulée dans un chargement de fruits transporté par une remorque tirée par un camion immatriculé au Maroc, en partance pour un port européen, apprend la MAP de source sécuritaire.', 'size': 4}, {'id': '68', 'title': 'Tanger : mise en échec d’une tentative de trafic de plus de 4 tonnes de chira', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/tanger-mise-en-echec-dune-tentative-de-trafic-de-plus-de-4-tonnes-de-chira/', 'summary': 'Tanger : mise en échec d’une tentative de trafic de plus de 4 tonnes de chira. Les éléments de la Sûreté nationale et de la Douane opérant au port de Tanger Med ont mis en échec, aux premières heures de dimanche, une tentative de trafic de 4,374 tonnes de chira à bord d’un camion de transport international de marchandises. Les opérations conjointes de contrôle menées par les services de la Sûreté .', 'size': 5}, {'id': '110', 'title': 'Tanger : Mise en échec d’une tentative de trafic de plus de 4 tonnes de chira', 'source': 'www.lavieeco.com', 'link': 'https://www.lavieeco.com/au-royaume/tanger-mise-en-echec-dune-tentative-de-trafic-de-plus-de-4-tonnes-de-chira/', 'summary': 'Tanger : Mise en échec d’une tentative de trafic de plus de 4 tonnes de chira. Les opérations conjointes de contrôle menées par les services de la Sûreté nationale et de la Douane ont permis la saisie de cette importante cargaison de stupéfiants, soigneusement dissimulée dans un chargement de fruits transporté par une remorque tirée par un camion immatriculé au Maroc, en partance pour un port européen.', 'size': 4}], 'main_title': 'Tanger : mise en échec d’une tentative de trafic de plus de 4 tonnes de chira'}, {'community_id': '1', 'articles': [{'id': '26', 'title': 'S.M. le Roi félicite les membres de la sélection nationale de football pour leur brillant parcours à la CAN féminine', 'source': 'lematin.ma', 'link': 'https://lematin.ma/activites-royales/sm-le-roi-felicite-les-membres-de-la-selection-nationale-feminine/293402', 'summary': "S.M. le Roi félicite les membres de la sélection nationale de football pour leur brillant parcours à la CAN féminine. Dans ce message, le Souverain affirme avoir suivi avec une grande fierté le brillant parcours de l’équipe nationale à la Coupe d'Afrique des Nations féminine 2024, couronné par.", 'size': 5}, {'id': '47', 'title': 'SM le Roi félicite les membres de la sélection nationale de football pour leur brillant parcours à la CAN féminine 2024', 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/SM-le-Roi-felicite-les-membres-de-la-selection-nationale-de-football-pour-leur-brillant-parcours-a-la-CAN-feminine-2024_a70313.html', 'summary': 'SM le Roi félicite les membres de la sélection nationale de football pour leur brillant parcours à la CAN féminine 2024. \u200bSa Majesté le Roi Mohammed VI, que Dieu L’assiste, a adressé un message de félicitations aux membres de la sélection nationale féminine de football pour leur brillant parcours à la Coupe d’Afrique des Nations féminine de football 2024.', 'size': 5}, {'id': '71', 'title': 'S.M. le Roi félicite les membres de la sélection nationale de football pour leur brillant parcours à la CAN féminine 2024', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/s-m-le-roi-felicite-les-membres-de-la-selection-nationale-de-football/', 'summary': 'S.M. le Roi félicite les membres de la sélection nationale de football pour leur brillant parcours à la CAN féminine 2024. Sa Majesté le Roi Mohammed VI, que Dieu L’assiste, a adressé un message de félicitations aux membres de la sélection nationale féminine de football pour leur brillant parcours à la Coupe d’Afrique des Nations féminine de football 2024. Dans ce message, le Souverain affirme avoir suivi avec une grande fierté le brillant parcours de l’équipe .', 'size': 5}, {'id': '76', 'title': 'Le Roi Mohammed VI félicite la sélection nationale de football pour leur brillant parcours à la CAN féminine 2024', 'source': 'atlasinfo.fr', 'link': 'https://atlasinfo.fr/coupe-dafrique-des-nations-feminine-de-football-2024.html', 'summary': 'Le Roi Mohammed VI félicite la sélection nationale de football pour leur brillant parcours à la CAN féminine 2024. Le Roi Mohammed VI a adressé un message de félicitations aux membres de la sélection nationale féminine de football pour leur brillant parcours à la Coupe d’Afrique des Nations féminine de football 2024. Dans ce message, le souverain affirme avoir suivi avec une grande fierté le brillant parcours de l’équipe nationale à la Coupe d’Afrique . L’article est apparu en premier sur .', 'size': 5}, {'id': '79', 'title': 'SM le Roi félicite la sélection nationale de football pour leur brillant parcours à la CAN féminine 2024', 'source': 'www.lereporter.ma', 'link': 'https://www.lereporter.ma/sm-le-roi-felicite-la-selection-nationale-de-football-pour-leur-brillant-parcours-a-la-can-feminine-2024/', 'summary': 'SM le Roi félicite la sélection nationale de football pour leur brillant parcours à la CAN féminine 2024. Sa Majesté le Roi Mohammed VI, que Dieu L’assiste, a adressé un message de félicitations aux membres de la sélection nationale féminine de football pour leur brillant parcours à la Coupe d’Afrique des Nations féminine de football 2024. Dans ce message, le Souverain affirme avoir suivi avec une grande fierté le brillant parcours de l’équipe ', 'size': 5}], 'main_title': 'S.M. le Roi félicite les membres de la sélection nationale de football pour leur brillant parcours à la CAN féminine'}, {'community_id': '3', 'articles': [{'id': '30', 'title': 'Football : Inauguration du Bureau Afrique de la FIFA au Maroc', 'source': 'lematin.ma', 'link': 'https://lematin.ma/videos/football-inauguration-du-bureau-afrique-de-la-fifa-au-maroc/293384', 'summary': "Football : Inauguration du Bureau Afrique de la FIFA au Maroc. Le bureau Afrique de la Fédération internationale de football (FIFA) a été inauguré, samedi au complexe Mohammed VI de football, lors d'une cérémonie présidée par le président.", 'size': 2}, {'id': '108', 'title': 'Inauguration au complexe Mohammed VI de football du bureau Afrique de la FIFA', 'source': 'www.libe.ma', 'link': 'https://www.libe.ma/Inauguration-au-complexe-Mohammed-VI-de-football-du-bureau-Afrique-de-la-FIFA_a154806.html', 'summary': 'Inauguration au complexe Mohammed VI de football du bureau Afrique de la FIFA.', 'size': 2}], 'main_title': 'Football : Inauguration du Bureau Afrique de la FIFA au Maroc'}, {'community_id': '0', 'articles': [{'id': '70', 'title': 'Températures prévues pour le lundi 28 juillet 2025', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/temperatures-prevues-pour-le-lundi-28-juillet-2025/', 'summary': 'Températures prévues pour le lundi 28 juillet 2025. Voici les températures minimales et maximales prévues par la Direction générale de la météorologie pour le lundi 28 juillet 2025 : Min Max – Oujda 19 40 – Bouarfa 21 38 – Al Hoceima 22 35 – Tétouan 22 37 – Sebta 20 33 – Mellilia 21 31 – Tanger 22 29 – Kénitra 19 .', 'size': 2}, {'id': '85', 'title': 'Les températures attendues ce lundi 28 juillet 2025', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/435277-les-temperatures-attendues-ce-lundi-28-juillet-2025.html', 'summary': 'Les températures attendues ce lundi 28 juillet 2025. Voici les températures minimales et maximales prévues par la Direction générale de la météorologie pour le lundi 28 juillet 2025 : Min Max – Oujda 19 40 – Bouarfa 21 38 – Al Hoceima 22 35 – Tétouan 22 37 – Sebta 20 33 – Mellilia 21 31 – Tanger 22 29 – Kénitra 19 . ', 'size': 2}], 'main_title': 'Températures prévues pour le lundi 28 juillet 2025'}, {'community_id': '2', 'articles': [{'id': '78', 'title': 'Désillusion pour les marocaines, qui s’inclinent en finale de la CAN 2024 contre le Nigéria', 'source': 'atlasinfo.fr', 'link': 'https://atlasinfo.fr/desillusion-pour-les-marocaines-qui-sinclinent-en-finale-de-la-can-2024-contre-le-nigeria.html', 'summary': 'Désillusion pour les marocaines, qui s’inclinent en finale de la CAN 2024 contre le Nigéria. La sélection nationale féminine du Nigeria a remporté la finale de la Coupe d’Afrique des Nations 2024 face aux Lionnes de l’Atlas au Stade olympique de Rabat. L’article est apparu en premier sur .', 'size': 2}, {'id': '83', 'title': 'Finale de la CAN féminine 2024 : le Maroc s’incline de justesse face au Nigeria', 'source': 'lnt.ma', 'link': 'https://lnt.ma/finale-de-la-can-feminine-2024-le-maroc-sincline-de-justesse-face-au-nigeria/', 'summary': 'Finale de la CAN féminine 2024 : le Maroc s’incline de justesse face au Nigeria. La sélection féminine marocaine de football a livré une prestation engagée et techniquement solide lors de la finale de la Coupe d’Afrique des Nations (CAN) 2024, organisée au Maroc, mais s’est inclinée face à l’équipe du Nigeria sur le score de 3 à 2, samedi soir au stade olympique de Rabat. Ce résultat, bien que . ', 'size': 2}], 'main_title': 'Désillusion pour les marocaines, qui s’inclinent en finale de la CAN 2024 contre le Nigéria'}, {'community_id': '5', 'articles': [{'id': '95', 'title': 'Arrivée au Maroc de la Première Dame de la République du Salvador Mme Gabriela Rodriguez De Bukele', 'source': 'lematin.ma', 'link': 'https://lematin.ma/nation/arrivee-au-maroc-de-la-premiere-dame-de-la-republique-du-salvador/293561', 'summary': "Arrivée au Maroc de la Première Dame de la République du Salvador Mme Gabriela Rodriguez De Bukele. À sa descente d'avion à l’aéroport de Rabat-Salé, Mme Gabriela Rodriguez De Bukele a été accueillie par Son Altesse Royale la Princesse Lalla Asmaa.Après avoir passé en revue u.", 'size': 4}, {'id': '109', 'title': 'Arrivée au Maroc de la Première Dame du Salvador, Mme Gabriela Rodriguez De Bukele', 'source': 'www.lavieeco.com', 'link': 'https://www.lavieeco.com/pouvoirs/diplomatie/arrivee-au-maroc-de-la-premiere-dame-du-salvador-mme-gabriela-rodriguez-de-bukele/', 'summary': 'Arrivée au Maroc de la Première Dame du Salvador, Mme Gabriela Rodriguez De Bukele. La Première Dame de la République du Salvador, Mme Gabriela Rodriguez De Bukele, est arrivée, dimanche à Salé, pour une visite de travail au Maroc.', 'size': 4}, {'id': '113', 'title': 'Arrivée au Maroc de la Première Dame de la République du Salvador Mme Gabriela Rodriguez De Bukele pour une visite de travail dans le Royaume', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/arrivee-au-maroc-de-la-premiere-dame-de-la-republique-du-salvador/', 'summary': 'Arrivée au Maroc de la Première Dame de la République du Salvador Mme Gabriela Rodriguez De Bukele pour une visite de travail dans le Royaume. La Première Dame de la République du Salvador, Mme Gabriela Rodriguez De Bukele, est arrivée, dimanche à Salé, pour une visite de travail au Maroc. À sa descente d’avion à l’aéroport de Rabat-Salé, Mme Gabriela Rodriguez De Bukele a été accueillie par Son Altesse Royale la Princesse Lalla Asmaa. Après avoir passé en revue une .', 'size': 4}, {'id': '114', 'title': 'Arrivée au Maroc de la Première Dame de la République du Salvador Mme Gabriela Rodriguez De Bukele pour une visite de travail', 'source': 'atlasinfo.fr', 'link': 'https://atlasinfo.fr/arrivee-au-maroc-de-la-premiere-dame-de-la-republique-du-salvador-mme-gabriela-rodriguez-de-bukele-pour-une-visite-de-travail-dans-le-royaume.html', 'summary': 'Arrivée au Maroc de la Première Dame de la République du Salvador Mme Gabriela Rodriguez De Bukele pour une visite de travail. La Première Dame de la République du Salvador, Mme Gabriela Rodriguez De Bukele, est arrivée dimanche à Salé pour une visite de travail au Maroc. À sa descente d’avion à l’aéroport de Rabat-Salé, Mme Gabriela Rodriguez De Bukele a été accueillie par la Princesse Lalla Asmaa. Après avoir passé en revue une section des Forces . L’article est apparu en premier sur .', 'size': 4}], 'main_title': 'Arrivée au Maroc de la Première Dame de la République du Salvador Mme Gabriela Rodriguez De Bukele'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
                        
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ? d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        // Fonction pour cacher le tooltip
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = '';
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
    
    
</body>




</html>
    