<!DOCTYPE html>
<html lang="ar" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); 
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title"> Les principales actualités des dernières 24 heures

</div>    
        <div class="header-subtitle"> Dernière mise à jour : 21/07/2025 - 12h27</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"></div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '0', 'title': "Le temps qu'il fera ce lundi 21 juillet 2025", 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/434283-le-temps-quil-fera-ce-lundi-21-juillet-2025.html', 'summary': "Le temps qu'il fera ce lundi 21 juillet 2025. Voici les prévisions météorologiques établies par la Direction générale de la météorologie pour le lundi 21 juillet 2025 – Temps assez chaud sur le sud des provinces du Sud, le sud-est, l’oriental et les plaines de Tadla. – Nuages bas avec formations brumeuses sur les plaines nord, les cotes centre et l’ouest des provinces du . ", 'size': 2}, {'id': '116', 'title': 'Les prévisions du lundi 21 juillet', 'source': 'www.challenge.ma', 'link': 'https://www.challenge.ma/les-previsions-du-lundi-21-juillet-307038/', 'summary': 'Les prévisions du lundi 21 juillet. Voici les prévisions météorologiques établies par la Direction générale de la météorologie pour le lundi 21 juillet 2025 : – Temps assez chaud sur le sud des provinces du Sud, le sud-est, l’oriental et les plaines de Tadla. – Nuages bas avec formations brumeuses sur les plaines nord, les cotes', 'size': 2}], 'main_title': "Le temps qu'il fera ce lundi 21 juillet 2025"}, {'community_id': '1', 'articles': [{'id': '14', 'title': '1.000 milliards de dirhams de capitalisation à la Bourse de Casablanca !', 'source': 'lematin.ma', 'link': 'https://lematin.ma/economie/1000-milliards-de-dirhams-de-capitalisation-a-la-bourse-de-casablanca/291997', 'summary': '1.000 milliards de dirhams de capitalisation à la Bourse de Casablanca !. La séance de ce vendredi a été animée par des échanges atteignant 466 millions de dirhams sur le marché central. En tête des valeurs les plus actives, Attijariwafa Bank a drainé à.', 'size': 2}, {'id': '151', 'title': 'La Bourse de Casablanca franchit les 1 000 milliards de dirhams', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/la-bourse-de-casablanca-franchit-les-1-000-milliards-de-dirhams/', 'summary': 'La Bourse de Casablanca franchit les 1 000 milliards de dirhams. Le cap symbolique du billion de dirhams de capitalisation boursière a été franchi. La Bourse de Casablanca affiche désormais une capitalisation globale de 1 007 milliards de dirhams (MMDH), traduisant une certaine résilience des valeurs cotées dans un contexte économique encore incertain. Derrière ce chiffre record se dessinent toutefois des déséquilibres structurels persistants dans la .', 'size': 2}], 'main_title': '1.000 milliards de dirhams de capitalisation à la Bourse de Casablanca !'}, {'community_id': '8', 'articles': [{'id': '29', 'title': 'C’est officiel : Neil El Aynaoui rejoint l’AS Roma avec un contrat jusqu’en 2030', 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/C-est-officiel-Neil-El-Aynaoui-rejoint-l-AS-Roma-avec-un-contrat-jusqu-en-2030_a70099.html', 'summary': 'C’est officiel : Neil El Aynaoui rejoint l’AS Roma avec un contrat jusqu’en 2030. Neil El Aynaoui rejoint officiellement l’AS Roma en provenance du RC Lens. Le milieu de terrain marocain de 24 ans portera le numéro 8.', 'size': 3}, {'id': '99', 'title': "L'AS Roma recrute le milieu de terrain marocain Neil El Aynaoui", 'source': 'lematin.ma', 'link': 'https://lematin.ma/sports/las-roma-recrute-le-milieu-de-terrain-marocain-neil-el-aynaoui/292267', 'summary': "L'AS Roma recrute le milieu de terrain marocain Neil El Aynaoui. L'AS Roma est heureuse d'annoncer le recrutement définitif de Neil El Aynaoui en provenance de Lens (.) Bienvenue à Rome, Neil !, a indiqué dimanche soir le c.", 'size': 2}, {'id': '121', 'title': 'Officiel : Neil El Aynaoui rejoint l’AS Roma', 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/172213/officiel-neil-aynaoui-rejoint-l-as.html', 'summary': 'Officiel : Neil El Aynaoui rejoint l’AS Roma. LAS Roma a recruté le milieu de terrain marocain Neil El Aynaoui en provenance de léquipe française du RC Lens, a annoncé le club de la capitale italienne.', 'size': 2}], 'main_title': 'C’est officiel : Neil El Aynaoui rejoint l’AS Roma avec un contrat jusqu’en 2030'}, {'community_id': '3', 'articles': [{'id': '56', 'title': 'Gaza : Troisième phase de la campagne marocaine d’aide humanitaire', 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/172182/gaza-troisieme-phase-campagne-marocaine.html', 'summary': 'Gaza : Troisième phase de la campagne marocaine d’aide humanitaire. L’Agence Bayt Mal Al-Qods Acharif a procédé, samedi, dans le camp d’Al-Bureij à l’est de Gaza, à la mise en œuvre de la troisième phase de la campagne marocaine d’aide humanitaire destinée aux familles déplacées les plus nécessiteuses de la bande de Gaza, avec le soutien financier de l’Association marocaine d’appui à la reconstruction en Palestine.', 'size': 2}, {'id': '85', 'title': 'L’Agence Bayt Mal Al-Qods Acharif lance la 3e phase de sa campagne d’aide humanitaire dans la bande de Gaza', 'source': 'www.lereporter.ma', 'link': 'https://www.lereporter.ma/lagence-bayt-mal-al-qods-acharif-lance-la-3e-phase-de-sa-campagne-daide-humanitaire-dans-la-bande-de-gaza/', 'summary': 'L’Agence Bayt Mal Al-Qods Acharif lance la 3e phase de sa campagne d’aide humanitaire dans la bande de Gaza. L’Agence Bayt Mal Al-Qods Acharif a procédé, samedi, dans le camp d’Al-Bureij à l’est de Gaza, à la mise en œuvre de la troisième phase de la campagne marocaine d’aide humanitaire destinée aux familles déplacées les plus nécessiteuses de la bande de Gaza, avec le soutien financier de l’Association marocaine d’appui à la reconstruction en ', 'size': 2}], 'main_title': 'Gaza : Troisième phase de la campagne marocaine d’aide humanitaire'}, {'community_id': '4', 'articles': [{'id': '59', 'title': 'Dédiée aux agendas de développement centrés sur l’Afrique : 6 millions de dollars pour une plateforme signée UM6P-Unesco-Fondation OCP', 'source': 'aujourdhui.ma', 'link': 'https://aujourdhui.ma/economie/dediee-aux-agendas-de-developpement-centres-sur-lafrique-6-millions-de-dollars-pour-une-plateforme-signee-um6p-unesco-fondation-ocp', 'summary': 'Dédiée aux agendas de développement centrés sur l’Afrique : 6 millions de dollars pour une plateforme signée UM6P-Unesco-Fondation OCP. Coopération : L’Université Mohammed VI Polytechnique (UM6P), l’Unesco et la Fondation OCP ont signé, vendredi à Paris, un accord ouvrant un nouveau chapitre de leur collaboration pour la période 2025-2027, en activant une plateforme triangulaire dédiée aux agendas de développement centrés sur l’Afrique, avec un engagement financier de 6 millions de dollars. Signé par Mostapha .', 'size': 2}, {'id': '159', 'title': 'Projets en Afrique : UM6P, UNESCO et Fondation OCP renforcent leur alliance', 'source': 'leseco.ma', 'link': 'https://leseco.ma/maroc/projets-en-afrique-um6p-unesco-et-fondation-ocp-renforcent-leur-alliance.html', 'summary': 'Projets en Afrique : UM6P, UNESCO et Fondation OCP renforcent leur alliance. L’Université Mohammed VI Polytechnique (UM6P), l’UNESCO et la Fondation OCP ont scellé une nouvelle étape de leur partenariat stratégique pour la période 2025-2027, avec un engagement financier de 6 millions de dollars. ', 'size': 2}], 'main_title': 'Dédiée aux agendas de développement centrés sur l’Afrique : 6 millions de dollars pour une plateforme signée UM6P-Unesco-Fondation OCP'}, {'community_id': '5', 'articles': [{'id': '73', 'title': 'Le Maroc se positionne comme un « marché stratégique » pour l’Argentine, selon le ministère des AE', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/le-maroc-se-positionne-comme-un-marche-strategique-pour-largentine-selon-le-ministere-des-ae/', 'summary': 'Le Maroc se positionne comme un « marché stratégique » pour l’Argentine, selon le ministère des AE. Le Maroc se positionne comme un « marché stratégique » pour l’internationalisation des produits argentins, indique le ministère argentin des Affaires étrangères et du commerce international, qui a programmé une mission commerciale multisectorielle au Royaume prévue les 7 et 8 octobre prochain. Dans une invitation lancée sur le site du ministère aux entreprises argentines désireuses .', 'size': 2}, {'id': '111', 'title': 'Le Maroc se positionne comme un “marché stratégique” pour l’Argentine', 'source': 'telquel.ma', 'link': 'https://telquel.ma/instant-t/2025/07/21/le-maroc-se-positionne-comme-un-marche-strategique-pour-largentine_1943169/', 'summary': 'Le Maroc se positionne comme un “marché stratégique” pour l’Argentine. Le Maroc se positionne comme un “marché stratégique” pour l’internationalisation des produits argentins, indique le ministère argentin des Affaires étrangères et du commerce international, qui a programmé une mission commerciale multisectorielle au Royaume prévue les 7 et 8 octobre prochain. Dans une invitation lancée sur le site du ministère aux entreprises argentines désireuses de participer.', 'size': 2}], 'main_title': 'Le Maroc se positionne comme un « marché stratégique » pour l’Argentine, selon le ministère des AE'}, {'community_id': '7', 'articles': [{'id': '87', 'title': 'Agriculture: La BAD approuve un financement de 100 millions d’euros au Maroc', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/434320-agriculture-la-bad-approuve-un-financement-de-100-millions-deuros-au-maroc.html', 'summary': 'Agriculture: La BAD approuve un financement de 100 millions d’euros au Maroc. Le Conseil d’administration du Groupe de la Banque africaine de développement (BAD) a approuvé un financement de 100 millions d’euros (M€) au Maroc pour mettre en œuvre le Programme d’appui à l’agriculture solidaire inclusive des femmes et des jeunes (PAASIFEJ). Le projet vise à générer des opportunités durables pour les femmes et les jeunes, à . ', 'size': 5}, {'id': '110', 'title': "100 millions d'euros de la BAD pour une agriculture inclusive des femmes et des jeunes au Maroc", 'source': 'telquel.ma', 'link': 'https://telquel.ma/instant-t/2025/07/21/100-millions-deuros-de-la-bad-pour-une-agriculture-inclusive-des-femmes-et-des-jeunes-au-maroc_1943181/', 'summary': "100 millions d'euros de la BAD pour une agriculture inclusive des femmes et des jeunes au Maroc. Le Conseil d’administration du Groupe de la Banque africaine de développement (BAD) a approuvé un financement de 100 millions d’euros au Maroc pour mettre en œuvre le Programme d’appui à l’agriculture solidaire inclusive des femmes et des jeunes (PAASIFEJ). Le projet vise à générer des opportunités durables pour les femmes et les jeunes, à renforcer.", 'size': 5}, {'id': '126', 'title': '100 millions d’euros accordés par la BAD pour appuyer l’agriculture inclusive des femmes et des jeunes au Maroc', 'source': 'aujourdhui.ma', 'link': 'https://aujourdhui.ma/economie/100-millions-deuros-accordes-par-la-bad-pour-appuyer-lagriculture-inclusive-des-femmes-et-des-jeunes-au-maroc', 'summary': '100 millions d’euros accordés par la BAD pour appuyer l’agriculture inclusive des femmes et des jeunes au Maroc. Le Conseil d’administration de la Banque africaine de développement (BAD) a approuvé un financement de 100 millions d’euros en faveur du Maroc pour la mise en œuvre du Programme d’appui à l’agriculture solidaire inclusive des femmes et des jeunes (PAASIFEJ). Ce programme vise à générer des opportunités durables pour les femmes et les jeunes en .', 'size': 5}, {'id': '147', 'title': 'La BAD accorde 100 M€ au Maroc pour l’agriculture solidaire', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/la-bad-accorde-100-me-au-maroc-pour-lagriculture-solidaire/', 'summary': 'La BAD accorde 100 M€ au Maroc pour l’agriculture solidaire. Le Conseil d’administration du Groupe de la Banque africaine de développement (BAD) a approuvé un financement de 100 millions d’euros (M€) au Maroc pour mettre en œuvre le Programme d’appui à l’agriculture solidaire inclusive des femmes et des jeunes (PAASIFEJ). Le projet vise à générer des opportunités durables pour les femmes et les jeunes, à .', 'size': 5}, {'id': '168', 'title': 'BAD accorde 100 M€ au Maroc pour booster l’agriculture inclusive des femmes et des jeunes', 'source': 'lnt.ma', 'link': 'https://lnt.ma/bad-accorde-100-me-au-maroc-pour-booster-lagriculture-inclusive-des-femmes-et-des-jeunes/', 'summary': 'BAD accorde 100 M€ au Maroc pour booster l’agriculture inclusive des femmes et des jeunes. Le Conseil d’administration du Groupe de la Banque africaine de développement (BAD) a approuvé un financement de 100 millions d’euros (M€) au Maroc pour mettre en œuvre le Programme d’appui à l’agriculture solidaire inclusive des femmes et des jeunes (PAASIFEJ). Le projet vise à générer des opportunités durables pour les femmes et les jeunes, à . ', 'size': 5}], 'main_title': 'Agriculture: La BAD approuve un financement de 100 millions d’euros au Maroc'}, {'community_id': '2', 'articles': [{'id': '88', 'title': 'Sahara: La Macédoine du Nord soutient le plan d\'autonomie comme "unique" base de règlement', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/434330-sahara-la-macedoine-du-nord-soutient-le-plan-dautonomie-comme-unique-base-de-reglement.html', 'summary': 'Sahara: La Macédoine du Nord soutient le plan d\'autonomie comme "unique" base de règlement. La République de Macédoine du Nord « considère le Plan d’Autonomie, présenté par le Royaume du Maroc en 2007, comme l’unique base pour le règlement de ce différend ». Cette position a été exprimée dans la Déclaration Conjointe, signée par le ministre des Affaires étrangères, de la Coopération africaine et des Marocains résidant à l’étranger, Nasser Bourita, . ', 'size': 3}, {'id': '134', 'title': 'Sahara marocain: La Macédoine du Nord appuie le Plan d’autonomie, «\xa0unique base pour le règlement de ce différend\xa0»', 'source': 'www.lavieeco.com', 'link': 'https://www.lavieeco.com/pouvoirs/sahara-marocain-la-macedoine-du-nord-appuie-le-plan-dautonomie-unique-base-pour-le-reglement-de-ce-differend/', 'summary': 'Sahara marocain: La Macédoine du Nord appuie le Plan d’autonomie, « unique base pour le règlement de ce différend ». Cette position a été exprimée dans la Déclaration conjointe signée par le ministre des Affaires étrangères, Nasser Bourita, et le ministre des Affaires étrangères et du Commerce extérieur de la République de Macédoine du Nord, Timčo Mucunski, à l’issue de leur rencontre, lundi à Skopje.', 'size': 3}, {'id': '145', 'title': 'Sahara marocain: La République de Macédoine du Nord', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/sahara-marocain-la-republique-de-macedoine-du-nord/', 'summary': 'Sahara marocain: La République de Macédoine du Nord. La République de Macédoine du Nord « considère le Plan d’Autonomie, présenté par le Royaume du Maroc en 2007, comme l’unique base pour le règlement de ce différend ». Cette position a été exprimée dans la Déclaration Conjointe, signée par le ministre des Affaires étrangères, de la Coopération africaine et des Marocains résidant à l’étranger, Nasser Bourita, .', 'size': 3}], 'main_title': 'Sahara: La Macédoine du Nord soutient le plan d\'autonomie comme "unique" base de règlement'}, {'community_id': '9', 'articles': [{'id': '90', 'title': 'Tanger Med : 25 kilos de cocaïne interceptés dans un conteneur frigorifique', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/434323-tanger-med-25-kilos-de-cocaine-interceptes-dans-un-conteneur-frigorifique.html', 'summary': 'Tanger Med : 25 kilos de cocaïne interceptés dans un conteneur frigorifique. Les éléments de la police du port de Tanger Med ont mis la main sur une importante cargaison de drogue ce dimanche 20 juillet. Une opération de contrôle de routine s’est transformée en coup de filet majeur avec la découverte de 25 kilogrammes de cocaïne pure, habilement dissimulés dans le système de réfrigération d’un conteneur . ', 'size': 2}, {'id': '118', 'title': 'Tanger Med : 25 kilos de cocaïne saisis dans un conteneur à destination des Pays-Bas', 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/172223/tanger-kilos-cocaine-saisis-dans.html', 'summary': 'Tanger Med : 25 kilos de cocaïne saisis dans un conteneur à destination des Pays-Bas. Les forces de lordre opérant dans la zone sécuritaire du port de Tanger Med ont réussi à déjouer une tentative de trafic international, dimanche 20 juillet. Selon une source sécuritaire, lopération a permis la saisie de 25 kilogrammes de cocaïne brute dissimulée dans un conteneur de fret international.', 'size': 2}], 'main_title': 'Tanger Med : 25 kilos de cocaïne interceptés dans un conteneur frigorifique'}, {'community_id': '6', 'articles': [{'id': '112', 'title': 'Casablanca : le parquet dément les allégations de vol d’organes évoquées dans une vidéo', 'source': 'telquel.ma', 'link': 'https://telquel.ma/instant-t/2025/07/21/casablanca-le-parquet-dement-les-allegations-de-vol-dorganes-evoquees-dans-une-video_1943172/', 'summary': 'Casablanca : le parquet dément les allégations de vol d’organes évoquées dans une vidéo. Le procureur général du roi près la Cour d’appel de Casablanca a démenti les accusations relayées dans une vidéo virale, selon lesquelles un vol d’organes aurait été commis sur un jeune homme décédé dans un accident de la route en 2021. Ces allégations sont, selon le parquet, « fausses et dénuées de tout fondement »..', 'size': 2}, {'id': '166', 'title': 'Affaire du don d’organes: le parquet de Casablanca dément les accusations de vol', 'source': 'lnt.ma', 'link': 'https://lnt.ma/affaire-du-don-dorganes-le-parquet-de-casablanca-dement-les-accusations-de-vol/', 'summary': 'Affaire du don d’organes: le parquet de Casablanca dément les accusations de vol. Le Procureur général du Roi près la Cour d’Appel de Casablanca a souligné que les allégations d’une femme, relatées dans une vidéo relayée sur des réseaux sociaux, prétendant le vol d’organes de son fils, décédé dans un accident de la circulation en 2021, sont fausses et dénuées de tout fondement. Dans un communiqué, le procureur . ', 'size': 2}], 'main_title': 'Casablanca : le parquet dément les allégations de vol d’organes évoquées dans une vidéo'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
                        
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ? d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        // Fonction pour cacher le tooltip
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = '';
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
    
    
</body>




</html>
    