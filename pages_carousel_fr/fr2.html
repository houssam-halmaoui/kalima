<!DOCTYPE html>
<html lang="ar" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); 
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title"> Les principales actualités des dernières 24 heures

</div>    
        <div class="header-subtitle"> Dernière mise à jour : 23/08/2025 - 06h23</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"></div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '8', 'title': 'Le FBI perquisitionne le domicile de John Bolton ancien conseiller du président Trump', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/438371-le-fbi-perquisitionne-le-domicile-de-john-bolton-ancien-conseiller-du-president-trump.html', 'summary': 'Le FBI perquisitionne le domicile de John Bolton ancien conseiller du président Trump. La police fédérale américaine (FBI) perquisitionne vendredi le domicile de John Bolton, ancien conseiller de Donald Trump à la sécurité nationale lors du premier mandat du républicain. L’ancien conseiller, devenu critique de la politique sécuritaire et étrangère du président, est soupçonné d’avoir révélé des informations protégées par le secret défense. Les perquisitions ont débuté à . ', 'size': 2}, {'id': '131', 'title': 'USA : Le FBI perquisitionne le domicile de John Bolton', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/usa-le-fbi-perquisitionne-le-domicile-de-john-bolton/', 'summary': 'USA : Le FBI perquisitionne le domicile de John Bolton. La Police fédérale américaine (FBI) a perquisitionné, vendredi, le domicile de l’ancien conseiller à la sécurité nationale de la Maison Blanche, John Bolton, dans la banlieue de Washington. La perquisition est liée à une enquête sur la fuite de documents classifiés, selon des sources policières citées par les médias locaux. « Personne n’est au-dessus de la .', 'size': 2}], 'main_title': 'Le FBI perquisitionne le domicile de John Bolton ancien conseiller du président Trump'}, {'community_id': '16', 'articles': [{'id': '32', 'title': 'Viol présumé d’un enfant à El Jadida : le CNDH exige justice et tolérance zéro', 'source': 'lematin.ma', 'link': 'https://lematin.ma/societe/viol-presume-dun-enfant-a-el-jadida-le-cndh-exige-justice/297443', 'summary': 'Viol présumé d’un enfant à El Jadida : le CNDH exige justice et tolérance zéro. Le Conseil national des droits de l’Homme (CNDH) a annoncé qu’il continue de suivre de près l’affaire d’un enfant victime présumée d’un viol d’une extrême gravité, révélée par un e.', 'size': 2}, {'id': '76', 'title': "Viol collectif d'un mineur : le CNDH réclame un durcissement des peines pour les agressions sexuelles", 'source': 'telquel.ma', 'link': 'https://telquel.ma/instant-t/2025/08/22/viol-collectif-dun-mineur-le-cndh-reclame-un-durcissement-des-peines-pour-les-agressions-sexuelles_1947235/', 'summary': "Viol collectif d'un mineur : le CNDH réclame un durcissement des peines pour les agressions sexuelles. Le Conseil national des droits de l’homme (CNDH) a annoncé poursuivre son suivi rapproché de l’affaire concernant l’affaire du viol collectif d’un mineur de 13 ans au Moussem de Moulay Abdellah. Cinq personnes ont déjà été placées en garde à vue et présentées devant le procureur général près le tribunal de première instance d’El Jadida,.", 'size': 2}], 'main_title': 'Viol présumé d’un enfant à El Jadida : le CNDH exige justice et tolérance zéro'}, {'community_id': '2', 'articles': [{'id': '34', 'title': 'Mondial 2026 : le match Maroc-Niger se jouera au Complexe Moulay Abdellah', 'source': 'lematin.ma', 'link': 'https://lematin.ma/sports/mondial-2026-le-match-maroc-niger-se-jouera-au-complexe-moulay-abdellah/297433', 'summary': 'Mondial 2026 : le match Maroc-Niger se jouera au Complexe Moulay Abdellah. La Fédération royale marocaine de football (FRMF) a annoncé jeudi que le Complexe Sportif Prince Moulay Abdellah à Rabat accueillera le match opposant l’équipe du Maroc au Niger, d.', 'size': 3}, {'id': '49', 'title': 'Le Stade Prince Moulay Abdellah va accueillir le match Maroc-Niger', 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/Le-Stade-Prince-Moulay-Abdellah-va-accueillir-le-match-Maroc-Niger_a71001.html', 'summary': 'Le Stade Prince Moulay Abdellah va accueillir le match Maroc-Niger. Le Complexe Sportif Prince Moulay Abdellah de Rabat va accueillir la rencontre des éliminatoires pour la Coupe du Monde 2026, opposant les Lions de l’Atlas au Niger, a annoncé la Fédération Royale Marocaine de Football (FRMF).', 'size': 3}, {'id': '69', 'title': 'Rabat : le Complexe Prince Moulay Abdellah inauguré le 5 septembre pour le match Maroc-Niger', 'source': 'telquel.ma', 'link': 'https://telquel.ma/instant-t/2025/08/22/maroc-niger-le-complexe-prince-moulay-abdellah-rouvre-ses-portes-le-5-septembre-pour-les-eliminatoires-du-mondial_1947306/', 'summary': 'Rabat : le Complexe Prince Moulay Abdellah inauguré le 5 septembre pour le match Maroc-Niger. La Fédération royale marocaine de football (FRMF) a annoncé la tenue du match Maroc-Niger le vendredi 5 septembre au Complexe sportif Prince Moulay Abdellah de Rabat. La rencontre, comptant pour les qualifications africaines à la Coupe du monde 2026, servira d’inauguration officielle du stade reconstruit. Le coup d’envoi est programmé à 20h00, selon le calendrier.', 'size': 3}], 'main_title': 'Mondial 2026 : le match Maroc-Niger se jouera au Complexe Moulay Abdellah'}, {'community_id': '13', 'articles': [{'id': '39', 'title': 'Sécurité routière : le contrôle des cyclomoteurs au speedomètre reporté', 'source': 'lematin.ma', 'link': 'https://lematin.ma/nation/securite-routiere-le-controle-des-cyclomoteurs-au-speedometre-reporte/297411', 'summary': 'Sécurité routière : le contrôle des cyclomoteurs au speedomètre reporté. Le ministère du Transport et de la Logistique a annoncé, jeudi, le report de l’entrée en vigueur de la procédure unifiée visant à contrôler la conformité des cyclomoteurs à l’aide.', 'size': 2}, {'id': '60', 'title': 'Cyclomoteurs : le ministère du Transport suspend la campagne de contrôle', 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/Cyclomoteurs-le-ministere-du-Transport-suspend-la-campagne-de-controle_a70988.html', 'summary': 'Cyclomoteurs : le ministère du Transport suspend la campagne de contrôle. \u200bLe ministère du Transport et de la Logistique a annoncé la décision de reporter l’application de la procédure unifiée pour encadrer les opérations de contrôle de la conformité des cyclomoteurs à l’aide d’un appareil de mesure de vitesse (speedomètre).', 'size': 5}, {'id': '90', 'title': 'Contrôle des cyclomoteurs : le ministère reporte la procédure de vérification', 'source': 'www.challenge.ma', 'link': 'https://www.challenge.ma/controle-des-cyclomoteurs-le-ministere-reporte-la-procedure-de-verification-308878/', 'summary': 'Contrôle des cyclomoteurs : le ministère reporte la procédure de vérification. Le ministère du Transport et de la Logistique a annoncé la décision de reporter l’application de la procédure unifiée pour encadrer les opérations de contrôle de la conformité des cyclomoteurs à l’aide d’un appareil de mesure de vitesse (speedomètre). Ce même ministère informe le grand public qu’il avait décidé de', 'size': 4}, {'id': '109', 'title': 'Report de la mise en œuvre de la procédure encadrant les opérations de contrôle de conformité des cyclomoteurs à l’aide d’un appareil de mesure de vitesse', 'source': 'aujourdhui.ma', 'link': 'https://aujourdhui.ma/actualite/report-de-la-mise-en-oeuvre-de-la-procedure-encadrant-les-operations-de-controle-de-conformite-des-cyclomoteurs-a-laide-dun-appareil-de-mesure-de-vitesse', 'summary': 'Report de la mise en œuvre de la procédure encadrant les opérations de contrôle de conformité des cyclomoteurs à l’aide d’un appareil de mesure de vitesse. Le ministère du Transport et de la Logistique a annoncé la décision de reporter l’application de la procédure unifiée pour encadrer les opérations de contrôle de la conformité des cyclomoteurs à l’aide d’un appareil de mesure de vitesse (speedomètre). Dans un communiqué rendu public jeudi, le ministère informe le grand public qu’il avait décidé de .', 'size': 4}, {'id': '153', 'title': 'Cyclomoteurs trafiqués: le ministère accorde un sursis avant la répression', 'source': 'lnt.ma', 'link': 'https://lnt.ma/cyclomoteurs-trafiques-le-ministere-accorde-un-sursis-avant-la-repression/', 'summary': 'Cyclomoteurs trafiqués: le ministère accorde un sursis avant la répression. Le ministère du Transport et de la Logistique a annoncé la décision de reporter l’application de la procédure unifiée pour encadrer les opérations de contrôle de la conformité des cyclomoteurs à l’aide d’un appareil de mesure de vitesse (speedomètre). Dans un communiqué rendu public jeudi, le ministère informe le grand public qu’il avait décidé de . ', 'size': 4}], 'main_title': 'Cyclomoteurs : le ministère du Transport suspend la campagne de contrôle'}, {'community_id': '10', 'articles': [{'id': '40', 'title': 'L’initiative royale en faveur de Gaza suscite une vague de reconnaissance internationale', 'source': 'lematin.ma', 'link': 'https://lematin.ma/nation/linitiative-royale-pour-gaza-suscite-une-onde-mondiale-de-reconnaissance/297406', 'summary': 'L’initiative royale en faveur de Gaza suscite une vague de reconnaissance internationale. Des personnalités maqdessies ont hautement salué l’Initiative de Sa Majesté le Roi Mohammed VI, Président du Comité Al-Qods, d’envoyer une aide humanitaire supplémentaire à la popu.', 'size': 2}, {'id': '61', 'title': 'Des personnalités maqdessies saluent hautement l’Initiative de SM le Roi d’envoyer une aide humanitaire supplémentaire aux habitants de Gaza', 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/Des-personnalites-maqdessies-saluent-hautement-l-Initiative-de-SM-le-Roi-d-envoyer-une-aide-humanitaire-supplementaire_a70987.html', 'summary': 'Des personnalités maqdessies saluent hautement l’Initiative de SM le Roi d’envoyer une aide humanitaire supplémentaire aux habitants de Gaza. \u200bDes personnalités maqdessies ont hautement salué l’Initiative de Sa Majesté le Roi Mohammed VI, Président du Comité Al-Qods, d’envoyer une aide humanitaire supplémentaire à la population de Gaza, louant un Geste Royal noble visant à soutenir la résilience des habitants de la Bande face aux conditions difficiles auxquelles ils sont confrontés.', 'size': 2}], 'main_title': 'L’initiative royale en faveur de Gaza suscite une vague de reconnaissance internationale'}, {'community_id': '5', 'articles': [{'id': '48', 'title': 'John Bolton, l’avocat du Polisario aux Etats-Unis, dans le viseur du FBI', 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/John-Bolton-l-avocat-du-Polisario-aux-Etats-Unis-dans-le-viseur-du-FBI_a71002.html', 'summary': "John Bolton, l’avocat du Polisario aux Etats-Unis, dans le viseur du FBI. L'ancien conseiller de Donald Trump, John Bolton, est visé par le FBI qui a perquisitionné son domicile sur fond de soupçon de fuite d'informations classifiées dont il avait possession. Un coup dur pour l'Algérie qui voit son principal allié à Washington empêtré dans un bourbier judiciaire. Détails.", 'size': 2}, {'id': '117', 'title': 'Sahara\xa0: Le FBI perquisitionne le domicile du principal lobbyiste algérien à Washington', 'source': 'www.lavieeco.com', 'link': 'https://www.lavieeco.com/pouvoirs/sahara-le-fbi-perquisitionne-le-domicile-du-principal-lobbyiste-algerien-a-washington/', 'summary': "Sahara : Le FBI perquisitionne le domicile du principal lobbyiste algérien à Washington. Le principal allié de l’Algérie et du Polisario aux États-Unis, John Bolton, fait actuellement l'objet d'une enquête judiciaire. Un coup dur pour le régime algérien et ses protégés.", 'size': 2}], 'main_title': 'John Bolton, l’avocat du Polisario aux Etats-Unis, dans le viseur du FBI'}, {'community_id': '7', 'articles': [{'id': '52', 'title': "\u200bSidi Ifni: Avortement d'une tentative de trafic international de drogues et d'immigration illégale et saisie d'une tonne et 922 kg de chira", 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/\u200bSidi-Ifni-Avortement-d-une-tentative-de-trafic-international-de-drogues-et-d-immigration-illegale-et-saisie-d-une_a70997.html', 'summary': "\u200bSidi Ifni: Avortement d'une tentative de trafic international de drogues et d'immigration illégale et saisie d'une tonne et 922 kg de chira. Les éléments de la sûreté nationale de la ville de Sidi Ifni ont avorté, aux premières heures de vendredi, une tentative de trafic international de drogues et d'immigration illégale à travers les voies maritimes et saisi une tonne et 922 kg de chira, a-t-on appris de source sécuritaire.", 'size': 3}, {'id': '75', 'title': 'Sidi Ifni : près de deux tonnes de résine de cannabis saisies', 'source': 'telquel.ma', 'link': 'https://telquel.ma/instant-t/2025/08/22/sidi-ifni-pres-de-deux-tonnes-de-resine-de-cannabis-saisies_1947253/', 'summary': 'Sidi Ifni : près de deux tonnes de résine de cannabis saisies. Les éléments de la sûreté nationale de la ville de Sidi Ifni ont avorté, aux premières heures de vendredi, une tentative de trafic international de drogues et d’immigration illégale à travers les voies maritimes et saisi une tonne et 922 kg de chira, a-t-on appris de source sécuritaire. Les interventions policières ont permis la saisie.', 'size': 4}, {'id': '94', 'title': 'Sidi Ifni : Saisie de près de 2t de haschisch\xa0destiné au\xa0trafic international', 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/174782/sidi-ifni-saisie-pres-haschisch.html', 'summary': 'Sidi Ifni : Saisie de près de 2t de haschisch destiné au trafic international. Les éléments de la sûreté nationale de la ville de Sidi Ifni ont mis en échec, aux premières heures de vendredi, une tentative de trafic international de drogues et dimmigration irrégulière par voies maritimes et saisi 1 tonne et 922 kg de résine de cannabis, a-t-on appris de source sécuritaire.', 'size': 3}, {'id': '123', 'title': 'Sidi Ifni : Saisie de deux tonnes de chira lors d’une opération d’immigration illégale', 'source': 'www.lavieeco.com', 'link': 'https://www.lavieeco.com/au-royaume/sidi-ifni-saisie-de-deux-tonnes-de-chira-lors-dune-operation-dimmigration-illegale/', 'summary': "Sidi Ifni : Saisie de deux tonnes de chira lors d’une opération d’immigration illégale. Les interventions policières ont permis la saisie d'un canot pneumatique équipé de deux moteurs, sur une plage située à environ cinq kilomètres de Sidi Ifni en direction de la ville de Tiznit, avec à bord sept personnes et des jerricanes d'essence, en plus de 50 ballots de drogue d'un poids total d'une tonne et 922 kg.", 'size': 2}], 'main_title': 'Sidi Ifni : près de deux tonnes de résine de cannabis saisies'}, {'community_id': '1', 'articles': [{'id': '53', 'title': "Imouzzer : un policier tué à l'arme blanche par un individu atteint de troubles psychiatriques", 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/Imouzzer-un-policier-tue-a-l-arme-blanche-par-un-individu-atteint-de-troubles-psychiatriques_a70998.html', 'summary': "Imouzzer : un policier tué à l'arme blanche par un individu atteint de troubles psychiatriques. Les éléments de la sûreté nationale du commissariat de police de la ville d'Imouzzer ont procédé, jeudi dans la soirée, à l'arrestation d'un individu, âgé de 63 ans et présentant des signes de troubles mentaux et d'agressivité, après qu'il se soit rendu coupable d'une agression physique à l'arme blanche contre un fonctionnaire de police, entraînant le décès de ce dernier, a appris la MAP de source sécuritaire.", 'size': 4}, {'id': '79', 'title': "Imouzzer : un policier tué à l'arme blanche par un homme souffrant de troubles mentaux", 'source': 'telquel.ma', 'link': 'https://telquel.ma/instant-t/2025/08/22/imouzzer-un-policier-tue-a-larme-blanche-par-un-homme-souffrant-de-troubles-mentaux_1947217/', 'summary': "Imouzzer : un policier tué à l'arme blanche par un homme souffrant de troubles mentaux. Un policier chargé de la circulation a été tué jeudi soir à Imouzzer par un homme de 63 ans présentant des troubles mentaux. Le suspect, sans domicile fixe et aux antécédents psychiatriques, a été arrêté sur place après avoir agressé la victime à l’arme blanche sans motif apparent. Les éléments de la sûreté nationale du.", 'size': 2}, {'id': '106', 'title': "Imouzzer : Arrestation d'un individu après l'agression mortelle d'un policier", 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/174734/imouzzer-arrestation-d-un-individu-apres.html', 'summary': "Imouzzer : Arrestation d'un individu après l'agression mortelle d'un policier. Les éléments de la sûreté nationale du commissariat de police de la ville dImouzzer ont procédé, jeudi dans la soirée, à larrestation dun individu, âgé de 63 ans et présentant des signes de troubles mentaux et dagressivité. Lhomme sest rendu coupable dune agression physique à larme blanche contre un fonctionnaire de police, entraînant le décès de ce dernier, a-t-on appris de source sécuritaire.", 'size': 4}, {'id': '134', 'title': 'Imouzzer: Arrestation d’un individu présentant des signes de troubles mentaux après l’agression mortelle d’un fonctionnaire de police', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/imouzzer-arrestation-dun-individu-presentant-des-signes-de-troubles/', 'summary': 'Imouzzer: Arrestation d’un individu présentant des signes de troubles mentaux après l’agression mortelle d’un fonctionnaire de police. Les éléments de la sûreté nationale du commissariat de police de la ville d’Imouzzer ont procédé, jeudi dans la soirée, à l’arrestation d’un individu, âgé de 63 ans et présentant des signes de troubles mentaux et d’agressivité, après qu’il se soit rendu coupable d’une agression physique à l’arme blanche contre un fonctionnaire de police, entraînant .', 'size': 4}, {'id': '155', 'title': 'Imouzzer: un policier tué lors d’une agression à l’arme blanche, le suspect arrêté', 'source': 'lnt.ma', 'link': 'https://lnt.ma/imouzzer-un-policier-tue-lors-dune-agression-a-larme-blanche-le-suspect-arrete/', 'summary': 'Imouzzer: un policier tué lors d’une agression à l’arme blanche, le suspect arrêté. Les éléments de la sûreté nationale du commissariat de police de la ville d’Imouzzer ont procédé, jeudi dans la soirée, à l’arrestation d’un individu, âgé de 63 ans et présentant des signes de troubles mentaux et d’agressivité, après qu’il se soit rendu coupable d’une agression physique à l’arme blanche contre un fonctionnaire de police, entraînant . ', 'size': 5}], 'main_title': 'Imouzzer: un policier tué lors d’une agression à l’arme blanche, le suspect arrêté'}, {'community_id': '9', 'articles': [{'id': '67', 'title': 'Benguerir : le Lydex rivalise avec les meilleures prépas françaises, selon “Les Échos”', 'source': 'telquel.ma', 'link': 'https://telquel.ma/instant-t/2025/08/22/benguerir-le-lydex-rivalise-avec-les-meilleures-prepas-francaises-selon-les-echos_1947325/', 'summary': 'Benguerir : le Lydex rivalise avec les meilleures prépas françaises, selon “Les Échos”. En dix ans seulement, les classes préparatoires du Lycée Mohammed VI d’excellence de Benguerir (Lydex) sont devenues un concurrent sérieux des prestigieuses prépas françaises, écrit le quotidien français “Les Échos”. Avec 12% d’admis à Polytechnique depuis 2020, l’établissement marocain rivalise désormais avec les prestigieux lycées parisiens Louis-le-Grand et Henri-IV. En à peine dix ans, les.', 'size': 2}, {'id': '119', 'title': 'Classes préparatoires : Le quotidien français «Les Echos » braque ses projecteurs sur le Lydex', 'source': 'www.lavieeco.com', 'link': 'https://www.lavieeco.com/affaires/carriere/classes-preparatoires-le-quotidien-francais-les-echos-braque-ses-projecteurs-sur-le-lydex/', 'summary': 'Classes préparatoires : Le quotidien français «Les Echos » braque ses projecteurs sur le Lydex. En à peine dix ans, les classes préparatoires du Lycée Mohammed VI d’excellence de Benguérir (Lydex) sont devenues l\'une des meilleures au monde pour accéder aux plus grandes écoles d\'ingénieurs, écrit le quotidien français d’information économique et financière "Les Echos".', 'size': 3}, {'id': '166', 'title': "Un média français souligne l'excellence de classe mondiale des classes préparatoires du Lycée Mohammed VI", 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/438388-un-media-francais-souligne-lexcellence-de-classe-mondiale-des-classes-preparatoires-du-lycee-mohammed-vi.html', 'summary': "Un média français souligne l'excellence de classe mondiale des classes préparatoires du Lycée Mohammed VI. En à peine dix ans, les classes préparatoires du Lycée Mohammed VI d’excellence de Benguérir (Lydex) sont devenues l’une des meilleures au monde pour accéder aux plus grandes écoles d’ingénieurs, écrit le quotidien français d’information économique et financière « Les Echos ». A 70 kilomètres au nord de Marrakech, aux portes de Benguerir, « la prépa est désormais . ", 'size': 2}], 'main_title': 'Classes préparatoires : Le quotidien français «Les Echos » braque ses projecteurs sur le Lydex'}, {'community_id': '18', 'articles': [{'id': '71', 'title': 'Port de Safi : hausse de 33% des débarquements de la pêche à fin juillet', 'source': 'telquel.ma', 'link': 'https://telquel.ma/instant-t/2025/08/22/port-de-safi-hausse-de-33-des-debarquements-de-la-peche-a-fin-juillet_1947294/', 'summary': 'Port de Safi : hausse de 33% des débarquements de la pêche à fin juillet. Avec 29.264 tonnes débarquées pour une valeur de 221 millions de dirhams, le port de Safi enregistre une croissance de plus de 30% de son activité de pêche côtière et artisanale sur les sept premiers mois de l’année. Les débarquements des produits de la pêche côtière et artisanale au niveau du port de Safi ont.', 'size': 2}, {'id': '87', 'title': 'Port de Safi : les débarquements de pêche bondissent à fin juillet', 'source': 'www.challenge.ma', 'link': 'https://www.challenge.ma/port-de-safi-les-debarquements-de-peche-bondissent-a-fin-juillet-308896/', 'summary': 'Port de Safi : les débarquements de pêche bondissent à fin juillet. Les débarquements des produits de la pêche côtière et artisanale au port de Safi ont enregistré, durant les sept premiers mois de l’année en cours, une hausse de 33 % en poids et de 32 % en valeur, selon l’Office national des pêches (ONP). Les quantités débarquées dans ce port', 'size': 2}], 'main_title': 'Port de Safi : hausse de 33% des débarquements de la pêche à fin juillet'}, {'community_id': '11', 'articles': [{'id': '72', 'title': 'Peines alternatives : la loi 43.22 entre officiellement en vigueur', 'source': 'telquel.ma', 'link': 'https://telquel.ma/instant-t/2025/08/22/peines-alternatives-la-loi-43-22-entre-officiellement-en-vigueur_1947292/', 'summary': 'Peines alternatives : la loi 43.22 entre officiellement en vigueur. Entrée en vigueur ce vendredi 22 août, la loi n°43.22 relative aux peines alternatives ouvre au pouvoir judiciaire un éventail de mesures destinées à remplacer, pour certains délits, la peine privative de liberté par des sanctions non-carcérales. Adopté et publié au Bulletin officiel l’été précédent, le texte vise à réduire la surpopulation carcérale et à.', 'size': 2}, {'id': '173', 'title': 'Les peines alternatives officiellement en application dès ce vendredi', 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/Les-peines-alternatives-officiellement-en-application-des-ce-vendredi_a71009.html', 'summary': 'Les peines alternatives officiellement en application dès ce vendredi. La loi n°43.22 relative aux peines alternatives est entrée en vigueur ce vendredi 22 août, introduisant une nouvelle philosophie dans la justice pénale marocaine. Cette réforme a pour objectif de réduire la récidive, d’atténuer la surpopulation carcérale et de replacer la réinsertion au centre du système judiciaire, en dépassant une approche exclusivement répressive. Eclairage.', 'size': 2}], 'main_title': 'Peines alternatives : la loi 43.22 entre officiellement en vigueur'}, {'community_id': '6', 'articles': [{'id': '91', 'title': 'Les prévisions du vendredi 22 août 2025', 'source': 'www.challenge.ma', 'link': 'https://www.challenge.ma/les-previsions-du-vendredi-22-aout-2025-308872/', 'summary': 'Les prévisions du vendredi 22 août 2025. Voici les prévisions météorologiques établies par la Direction générale de la météorologie pour ce vendredi 22 août 2025. -Temps assez chaud sur les plaines intérieures Nord et Centres, la vallée de Moulouya, le Sud-Est et l’Est des provinces Sahariennes. -Ondées et orages possibles sur l’extrême Sud du pays. -Ciel peu', 'size': 2}, {'id': '157', 'title': "Le temps qu'il fera ce samedi 23 août 2025", 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/438410-le-temps-quil-fera-ce-samedi-23-aout-2025.html', 'summary': "Le temps qu'il fera ce samedi 23 août 2025. Voici les prévisions météorologiques établies par la Direction générale de la météorologie pour le samedi 23 août 2025 – Temps assez chaud sur le Sud-Est et l’intérieur des provinces sahariennes. – Averses orageuses sur les Haut et Moyen Atlas. – Ondées et orages sur les versants Sud-Est, les Hauts plateaux et l’extrême Sud du pays. . ", 'size': 2}], 'main_title': 'Les prévisions du vendredi 22 août 2025'}, {'community_id': '4', 'articles': [{'id': '98', 'title': 'La reprogrammation de cellules sanguines ouvre les possibilités thérapeutiques et de recherches', 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/174765/reprogrammation-cellules-sanguines-ouvre-possibilites.html', 'summary': 'La reprogrammation de cellules sanguines ouvre les possibilités thérapeutiques et de recherches. L’annonce par la Fondation Mohammed VI des sciences et de la santé (FM6SS) de la réussite de la reprogrammation de cellules sanguines périphériques humaines (PBMCs) en cellules souches pluripotentes induites (iPS), ouvre de vastes possibilités thérapeutiques et de recherches, a affirmé, jeudi, le directeur du Centre Mohammed VI de la recherche et de l’innovation, Saber Boutayeb.', 'size': 2}, {'id': '151', 'title': 'Avancée majeure: FM6SS transforme des cellules sanguines en cellules souches iPS', 'source': 'lnt.ma', 'link': 'https://lnt.ma/avancee-majeure-fm6ss-transforme-des-cellules-sanguines-en-cellules-souches-ips/', 'summary': 'Avancée majeure: FM6SS transforme des cellules sanguines en cellules souches iPS. La Fondation Mohammed VI des Sciences et de la Santé (FM6SS) a annoncé avoir réussi, pour la première fois au Maroc, la reprogrammation de cellules sanguines périphériques humaines (PBMCs) en cellules souches pluripotentes induites (iPS), marquant ainsi une avancée scientifique majeure et historique. Cette avancée stratégique ouvre la voie à la création d’une plateforme nationale . ', 'size': 2}], 'main_title': 'La reprogrammation de cellules sanguines ouvre les possibilités thérapeutiques et de recherches'}, {'community_id': '14', 'articles': [{'id': '108', 'title': 'Femmes dans les opérations de paix de l’ONU : Clôture à Agadir d’une session de formation au profit de militaires issues de 14 pays', 'source': 'aujourdhui.ma', 'link': 'https://aujourdhui.ma/actualite/femmes-dans-les-operations-de-paix-de-lonu-cloture-a-agadir-dune-session-de-formation-au-profit-de-militaires-issues-de-14-pays', 'summary': 'Femmes dans les opérations de paix de l’ONU : Clôture à Agadir d’une session de formation au profit de militaires issues de 14 pays. Une session de formation destinée aux femmes dans les opérations militaires de paix de l’ONU, a pris fin vendredi, au siège de l’Etat-Major des Forces Armées Royales (FAR) de la Zone Sud à Agadir. La clôture de cette formation tenue conformément aux Hautes Instructions de Sa Majesté le Roi Mohammed VI, Chef suprême et Chef .', 'size': 2}, {'id': '146', 'title': 'FAR | Clôture à Agadir de la formation dédiée aux femmes dans les missions de paix de l’ONU', 'source': 'www.lereporter.ma', 'link': 'https://www.lereporter.ma/far-cloture-a-agadir-de-la-formation-dediee-aux-femmes-dans-les-missions-de-paix-de-lonu/', 'summary': 'FAR | Clôture à Agadir de la formation dédiée aux femmes dans les missions de paix de l’ONU. Une session de formation destinée aux femmes dans les opérations militaires de paix de l’ONU, a pris fin vendredi, au siège de l’Etat-Major des Forces Armées Royales (FAR) de la Zone Sud à Agadir. La clôture de cette formation tenue conformément aux Hautes Instructions de Sa Majesté le Roi Mohammed VI, Chef suprême et Chef ', 'size': 2}], 'main_title': 'Femmes dans les opérations de paix de l’ONU : Clôture à Agadir d’une session de formation au profit de militaires issues de 14 pays'}, {'community_id': '15', 'articles': [{'id': '116', 'title': 'Finances publiques: Un déficit budgétaire de 55 MMDH à fin juillet 2025', 'source': 'www.lavieeco.com', 'link': 'https://www.lavieeco.com/argent/budget/finances-publiques-un-deficit-budgetaire-de-55-mmdh-a-fin-juillet-2025/', 'summary': 'Finances publiques: Un déficit budgétaire de 55 MMDH à fin juillet 2025. Les recettes, ont enregistré un taux de réalisation de 57,4% par rapport aux prévisions de la Loi de Finances (LF), en hausse de 14,5% par rapport à fin juillet 2024, soit +28,7 MMDH.', 'size': 2}, {'id': '177', 'title': 'Les recettes fiscales progressent de 15,9% à fin juillet 2025', 'source': 'www.challenge.ma', 'link': 'https://www.challenge.ma/les-recettes-fiscales-progressent-de-159-a-fin-juillet-2025-308923/', 'summary': 'Les recettes fiscales progressent de 15,9% à fin juillet 2025. Les recettes fiscales ont atteint plus de 201,8 milliards de dirhams (MMDH) à fin juillet 2025, en hausse de 15,9% comparativement à la même période un an auparavant, selon le ministère de l’Économie et des Finances. Ces recettes ont affiché un taux de réalisation de 63,1% par rapport aux prévisions', 'size': 2}], 'main_title': 'Finances publiques: Un déficit budgétaire de 55 MMDH à fin juillet 2025'}, {'community_id': '3', 'articles': [{'id': '124', 'title': 'Développement durable : Les Chefs d’État africains et du Japon saluent les initiatives africaines lancées par Sa Majesté le Roi', 'source': 'www.lavieeco.com', 'link': 'https://www.lavieeco.com/au-royaume/evenement/developpement-durable-les-chefs-detat-africains-et-du-japon-saluent-les-initiatives-africaines-lancees-par-sa-majeste-le-roi/', 'summary': "Développement durable : Les Chefs d’État africains et du Japon saluent les initiatives africaines lancées par Sa Majesté le Roi. Dans la Déclaration finale sanctionnant les travaux de la 9e Conférence internationale de Tokyo sur le développement de l’Afrique (TICAD-9), les Chefs d’État et de gouvernement ont particulièrement apprécié le rôle pionnier du Souverain dans la promotion d'initiatives continentales majeures liées au climat et à la migration.", 'size': 3}, {'id': '144', 'title': 'Les Chefs d’État africains et du Japon saluent les initiatives africaines lancées par le Roi Mohammed VI en matière de climat et de migration (Déclaration finale)', 'source': 'atlasinfo.fr', 'link': 'https://atlasinfo.fr/les-chefs-detat-africains-et-du-japon-saluent-les-initiatives-africaines-lancees-par-le-roi-en-matiere-de-climat-et-de-migration-declaration-finale.html', 'summary': 'Les Chefs d’État africains et du Japon saluent les initiatives africaines lancées par le Roi Mohammed VI en matière de climat et de migration (Déclaration finale). Les Chefs d’État et de gouvernement de l’Afrique et du Japon ont salué, vendredi à Yokohama, plusieurs initiatives lancées par le Roi Mohammed VI, soulignant le rôle pionnier du Souverain dans la promotion d’initiatives continentales majeures liées au climat, à la migration et au développement durable de l’Afrique. Dans la Déclaration finale sanctionnant les travaux . L’article est apparu en premier sur .', 'size': 3}, {'id': '148', 'title': 'TICAD 9 | Les dirigeants africains et japonais saluent les initiatives de SM le Roi sur le climat et la migration', 'source': 'www.lereporter.ma', 'link': 'https://www.lereporter.ma/ticad-9-les-dirigeants-africains-et-japonais-saluent-les-initiatives-de-sm-le-roi-sur-le-climat-et-la-migration/', 'summary': 'TICAD 9 | Les dirigeants africains et japonais saluent les initiatives de SM le Roi sur le climat et la migration. Les Chefs d’État et de gouvernement de l’Afrique et du Japon ont salué, vendredi à Yokohama, plusieurs initiatives lancées par Sa Majesté le Roi Mohammed VI, soulignant le rôle pionnier du Souverain dans la promotion d’initiatives continentales majeures liées au climat, à la migration et au développement durable de l’Afrique. Dans la Déclaration finale sanctionnant ', 'size': 3}], 'main_title': 'Développement durable : Les Chefs d’État africains et du Japon saluent les initiatives africaines lancées par Sa Majesté le Roi'}, {'community_id': '17', 'articles': [{'id': '127', 'title': 'Fès: Plus de 300 MDH pour moderniser le réseau d’assainissement liquide', 'source': 'www.lavieeco.com', 'link': 'https://www.lavieeco.com/au-royaume/fes-plus-de-300-mdh-pour-moderniser-le-reseau-dassainissement-liquide/', 'summary': 'Fès: Plus de 300 MDH pour moderniser le réseau d’assainissement liquide. Plus de 300 millions de Dirhams (MDH) ont été mobilisés pour la réalisation de deux projets structurants relatifs à la protection de la ville de Fès contre les inondations et la mise à niveau de son réseau de gestion des eaux usées.', 'size': 2}, {'id': '162', 'title': 'Fès se dote de deux projets pour la lutte contre les inondations et la gestion des eaux usées', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/438399-fes-se-dote-de-deux-projets-pour-la-lutte-contre-les-inondations-et-la-gestion-des-eaux-usees.html', 'summary': 'Fès se dote de deux projets pour la lutte contre les inondations et la gestion des eaux usées. Plus de 300 millions de Dirhams (MDH) ont été mobilisés pour la réalisation de deux projets structurants relatifs à la protection de la ville de Fès contre les inondations et la mise à niveau de son réseau de gestion des eaux usées. Ces projets ont été lancés, jeudi, par le Wali de la région Fès-Meknès, . ', 'size': 2}], 'main_title': 'Fès: Plus de 300 MDH pour moderniser le réseau d’assainissement liquide'}, {'community_id': '12', 'articles': [{'id': '150', 'title': 'CHAN 2025: Sektioui promet des Lions de l’Atlas déterminés face à la Tanzanie', 'source': 'lnt.ma', 'link': 'https://lnt.ma/chan-2025-sektioui-promet-des-lions-de-latlas-determines-face-a-la-tanzanie/', 'summary': 'CHAN 2025: Sektioui promet des Lions de l’Atlas déterminés face à la Tanzanie. Le sélectionneur national, Tarik Sektioui a affirmé, jeudi à Dar Es Salaam, que la motivation et la détermination des joueurs sur le terrain sont les clés pour remporter le match face à la Tanzanie, prévu vendredi au stade Benjamin Mkapa, pour le compte des quarts de finale du Championnat d’Afrique des nations de football (CHAN). . ', 'size': 5}, {'id': '176', 'title': 'Championnat d’Afrique des Nations (CHAN): le Maroc dans le dernier carré', 'source': 'www.challenge.ma', 'link': 'https://www.challenge.ma/championnat-dafrique-des-nations-chan-le-maroc-dans-le-dernier-carre-308928/', 'summary': 'Championnat d’Afrique des Nations (CHAN): le Maroc dans le dernier carré. La sélection marocaine a décroché son billet pour les demi-finales du Championnat d’Afrique des nations de football des joueurs locaux (CHAN) locaux, en dominant son homologue tanzanienne par 1 but à 0, en quart de finale disputé vendredi 22 août à Dar Es Salaam. Oussama Lamlioui a inscrit le but', 'size': 5}, {'id': '184', 'title': 'CHAN 2024 : Le Maroc bat la Tanzanie\xa0et file en demi-finale', 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/174794/chan-2024-maroc-tanzanie-file.html', 'summary': 'CHAN 2024 : Le Maroc bat la Tanzanie et file en demi-finale. La sélection marocaine des joueurs locaux sest qualifiée pour les demi-finales du Championnat dAfrique des nations de football (CHAN), en battant son homologue tanzanienne par 1 but à 0, en quart de finale disputé vendredi à Dar Es Salaam.', 'size': 5}, {'id': '186', 'title': 'CHAN-2024: Le Maroc bat la Tanzanie et va en demi-finale', 'source': 'aujourdhui.ma', 'link': 'https://aujourdhui.ma/une/chan-2024-le-maroc-bat-la-tanzanie-et-va-en-demi-finale', 'summary': 'CHAN-2024: Le Maroc bat la Tanzanie et va en demi-finale. La sélection marocaine des joueurs locaux s’est qualifiée pour les demi-finales du Championnat d’Afrique des nations de football (CHAN), en battant son homologue tanzanienne par 1 but à 0, en quart de finale disputé vendredi à Dar Es Salaam. Oussama Lamlioui a inscrit le but de victoire des Lions de l’Atlas à la 65e minute .', 'size': 5}, {'id': '192', 'title': 'CHAN-2024 : Le Maroc bat la Tanzanie (1-0), va en demi-finale', 'source': 'atlasinfo.fr', 'link': 'https://atlasinfo.fr/chan-2024-le-maroc-bat-la-tanzanie-1-0-va-en-demi-finale.html', 'summary': 'CHAN-2024 : Le Maroc bat la Tanzanie (1-0), va en demi-finale. La sélection marocaine des joueurs locaux s’est qualifiée pour les demi-finales du Championnat d’Afrique des nations de football (CHAN), en battant son homologue tanzanienne par 1 but à 0, en quart de finale disputé vendredi à Dar Es Salaam. Oussama Lamlioui a inscrit le but de victoire des Lions de l’Atlas à la 65e minute . L’article est apparu en premier sur .', 'size': 5}], 'main_title': 'CHAN 2025: Sektioui promet des Lions de l’Atlas déterminés face à la Tanzanie'}, {'community_id': '8', 'articles': [{'id': '159', 'title': 'Coupe du monde 2026 : le tirage au sort fixé au 5 décembre à Washington', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/438436-coupe-du-monde-2026-le-tirage-au-sort-fixe-au-5-decembre-a-washington.html', 'summary': 'Coupe du monde 2026 : le tirage au sort fixé au 5 décembre à Washington. Le tirage au sort de la Coupe du monde 2026, qui se tiendra en Amérique du Nord du 11 juin au 19 juillet, est fixé au 5 décembre 2025 au Kennedy Center, le célèbre centre culturel de Washington, a annoncé vendredi l’ancien président des États-Unis, Donald Trump. Cette annonce a été faite lors d’une rencontre . ', 'size': 2}, {'id': '169', 'title': 'Mondial 2026: Tirage au sort le 5 décembre à Washington', 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/Mondial-2026-Tirage-au-sort-le-5-decembre-a-Washington_a71013.html', 'summary': 'Mondial 2026: Tirage au sort le 5 décembre à Washington. Le président des États-Unis, Donald Trump, a annoncé ce vendredi que le tirage au sort de la phase de groupes de la Coupe du monde 2026 se déroulera le 5 décembre prochain au Kennedy Center, à Washington.', 'size': 2}], 'main_title': 'Coupe du monde 2026 : le tirage au sort fixé au 5 décembre à Washington'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
                        
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ? d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        // Fonction pour cacher le tooltip
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = '';
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
    
    
</body>




</html>
    