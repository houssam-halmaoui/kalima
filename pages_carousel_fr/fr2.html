<!DOCTYPE html>
<html lang="ar" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); 
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title"> Les principales actualités des dernières 24 heures

</div>    
        <div class="header-subtitle"> Dernière mise à jour : 06/07/2025 - 18h27</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"></div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '2', 'articles': [{'id': '1', 'title': 'USA: Elon Musk lance son parti politique', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/432082-usa-elon-musk-lance-son-parti-politique.html', 'summary': 'USA: Elon Musk lance son parti politique. Un temps proche de Donald Trump avant de se brouiller avec lui, le multimilliardaire Elon Musk a annoncé samedi la création de sa propre formation politique, présentée comme une alternative aux deux partis américains dominants, démocrate et républicain. « Aujourd’hui, le parti de l’Amérique est créé pour vous rendre votre liberté », a écrit le patron de . ', 'size': 3}, {'id': '10', 'title': 'Elon Musk lance sa formation politique, le "parti de l\'Amérique"', 'source': 'lematin.ma', 'link': 'https://lematin.ma/monde/elon-musk-lance-sa-formation-politique-le-parti-de-lamerique/289468', 'summary': 'Elon Musk lance sa formation politique, le "parti de l\'Amérique". Vent debout contre le projet de loi budgétaire du président américain, dont il dénonce l\'impact sur les finances publiques, Elon Musk avait promis ces derniers jours de lancer.', 'size': 2}, {'id': '55', 'title': 'USA: Elon Musk annonce la création d’un nouveau parti politique', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/usa-elon-musk-annonce-la-creation-dun-nouveau-parti-politique/', 'summary': 'USA: Elon Musk annonce la création d’un nouveau parti politique. Le milliardaire américain Elon Musk a annoncé, samedi, la création du parti politique « America Party » (Parti de l’Amérique), au lendemain de la promulgation par le président Donald Trump d’une nouvelle loi budgétaire. Ancien conseiller de Trump, Musk avait exprimé son opposition au projet de loi de finances et menacé de créer une nouvelle formation politique .', 'size': 2}], 'main_title': 'USA: Elon Musk lance son parti politique'}, {'community_id': '1', 'articles': [{'id': '7', 'title': "Le temps qu'il fera ce dimanche 6 juillet 2025", 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/432021-le-temps-quil-fera-ce-dimanche-6-juillet-2025.html', 'summary': "Le temps qu'il fera ce dimanche 6 juillet 2025. Voici les prévisions météorologiques établies par la Direction générale de la météorologie pour le dimanche 6 juillet 2025 : – Temps assez chaud à chaud sur le Sud-Est, l’intérieur des provinces du Sud, l’Oriental, le Saiss, les plaines de Tadla et Rehamna. – Nuages bas assez denses avec brume ou brouillard près des côtes. – . ", 'size': 2}, {'id': '63', 'title': 'Prévisions météorologiques pour le dimanche 6 juillet 2025', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/previsions-meteorologiques-pour-le-dimanche-6-juillet-2025/', 'summary': 'Prévisions météorologiques pour le dimanche 6 juillet 2025. Voici les prévisions météorologiques établies par la Direction générale de la météorologie pour le dimanche 6 juillet 2025 : – Temps assez chaud à chaud sur le Sud-Est, l’intérieur des provinces du Sud, l’Oriental, le Saiss, les plaines de Tadla et Rehamna. – Nuages bas assez denses avec brume ou brouillard près des côtes. – .', 'size': 2}], 'main_title': "Le temps qu'il fera ce dimanche 6 juillet 2025"}, {'community_id': '0', 'articles': [{'id': '15', 'title': 'Tanger change les règles du stationnement : fin du sabot et gratuité pour les personnes handicapées', 'source': 'lematin.ma', 'link': 'https://lematin.ma/regions/tanger-change-les-regles-du-stationnement-fin-du-sabot/289439', 'summary': 'Tanger change les règles du stationnement : fin du sabot et gratuité pour les personnes handicapées. Dans un communiqué officiel, la commune de Tanger a annoncé l’entrée en vigueur de la décision n° 2022/1357 relative à l’organisation du stationnement payant dans le cadre d’une ge.', 'size': 4}, {'id': '30', 'title': "Commune de Tanger: Mise en place d'un nouveau système de stationnement basé sur l'efficacité et la transparence", 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/Commune-de-Tanger-Mise-en-place-d-un-nouveau-systeme-de-stationnement-base-sur-l-efficacite-et-la-transparence_a69509.html', 'summary': "Commune de Tanger: Mise en place d'un nouveau système de stationnement basé sur l'efficacité et la transparence. La commune de Tanger a annoncé l’entrée en vigueur, à partir du 9 juillet, d’une décision règlementaire relative à l’organisation du stationnement des véhicules, selon les nomes d’efficacité, de digitalisation et de transparence, en sus de l'amélioration de la relation avec les usagers.", 'size': 4}, {'id': '50', 'title': 'Tanger : Mise en place d’un nouveau système de stationnement des véhicules', 'source': 'www.lavieeco.com', 'link': 'https://www.lavieeco.com/au-royaume/scans/tanger-mise-en-place-dun-nouveau-systeme-de-stationnement-des-vehicules/', 'summary': "Tanger : Mise en place d’un nouveau système de stationnement des véhicules. La commune de Tanger a annoncé l’entrée en vigueur, à partir du 9 juillet, d’une décision règlementaire relative à l’organisation du stationnement des véhicules, selon les nomes d’efficacité, de digitalisation et de transparence, en sus de l'amélioration de la relation avec les usagers.", 'size': 4}, {'id': '71', 'title': 'La commune de Tanger instaure de nouvelles normes de stationnement', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/432070-la-commune-de-tanger-instaure-de-nouvelles-normes-de-stationnement.html', 'summary': 'La commune de Tanger instaure de nouvelles normes de stationnement. La commune de Tanger a annoncé l’entrée en vigueur, à partir du 9 juillet, d’une décision règlementaire relative à l’organisation du stationnement des véhicules, selon les nomes d’efficacité, de digitalisation et de transparence, en sus de l’amélioration de la relation avec les usagers. La commune a précisé, dans un communiqué, que cette décision stipule que . ', 'size': 4}], 'main_title': 'Tanger change les règles du stationnement : fin du sabot et gratuité pour les personnes handicapées'}, {'community_id': '3', 'articles': [{'id': '28', 'title': 'Mondial des Clubs : Hakimi décisif, le PSG écarte le Bayern et rejoint les demi-finales', 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/Mondial-des-Clubs-Hakimi-decisif-le-PSG-ecarte-le-Bayern-et-rejoint-les-demi-finales_a69511.html', 'summary': 'Mondial des Clubs : Hakimi décisif, le PSG écarte le Bayern et rejoint les demi-finales. Le PSG s’est imposé face au Bayern Munich (2-0) en quart de finale du Mondial des clubs, malgré deux expulsions. Doué et Dembélé ont marqué les buts parisiens.', 'size': 2}, {'id': '65', 'title': 'Le Paris Saint-Germain d’Achraf Hakimi signe une nouvelle victoire', 'source': 'atlasinfo.fr', 'link': 'https://atlasinfo.fr/le-paris-saint-germain-dachraf-hakimi-signe-une-nouvelle-victoire.html', 'summary': 'Le Paris Saint-Germain d’Achraf Hakimi signe une nouvelle victoire. Le PSG a battu le Bayern de Munich et se qualifie en demi-finale de la Coupe du Monde des Clubs. L’article est apparu en premier sur .', 'size': 3}, {'id': '78', 'title': "Achraf Hakimi continue de redéfinir le poste de latéral droit à l'occasion du Mondialito", 'source': 'lematin.ma', 'link': 'https://lematin.ma/sports/achraf-hakimi-continue-de-redefinir-le-poste-de-lateral-droit/289543', 'summary': "Achraf Hakimi continue de redéfinir le poste de latéral droit à l'occasion du Mondialito. Samedi, en quarts de finale de la Coupe du Monde des Clubs FIFA 2025, le Paris Saint-Germain menait face au Bayern Munich sur le score de 1-0 jusqu’à la 90e minute, avec deux joueu.", 'size': 2}], 'main_title': 'Le Paris Saint-Germain d’Achraf Hakimi signe une nouvelle victoire'}, {'community_id': '6', 'articles': [{'id': '31', 'title': "Billetterie sportive : La Sonarges s'engage à garantir un accès transparent, équitable et non discriminatoire (Conseil de la concurrence)", 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/Billetterie-sportive-La-Sonarges-s-engage-a-garantir-un-acces-transparent-equitable-et-non-discriminatoire-Conseil-de_a69508.html', 'summary': "Billetterie sportive : La Sonarges s'engage à garantir un accès transparent, équitable et non discriminatoire (Conseil de la concurrence). Le Conseil de la concurrence annonce que la Société Nationale de Réalisation et de Gestion des Équipements Sportifs (Sonarges) s’est engagée à garantir un accès transparent, équitable et non discriminatoire aux prestations de billetterie pour l’utilisation de ses infrastructures.", 'size': 3}, {'id': '42', 'title': 'Billetterie sportive : la Sonarges s’engage à garantir un accès transparent, équitable et non discriminatoire', 'source': 'www.challenge.ma', 'link': 'https://www.challenge.ma/billetterie-sportive-la-sonarges-sengage-a-garantir-un-acces-transparent-equitable-et-non-discriminatoire-306171/', 'summary': 'Billetterie sportive : la Sonarges s’engage à garantir un accès transparent, équitable et non discriminatoire. Le Conseil de la concurrence annonce que la Société Nationale de Réalisation et de Gestion des Équipements Sportifs (Sonarges) s’est engagée à garantir un accès transparent, équitable et non discriminatoire aux prestations de billetterie pour l’utilisation de ses infrastructures. «Après plusieurs échanges avec les parties concernées dans un esprit de', 'size': 3}, {'id': '66', 'title': 'Billetteries sportives : Les engagements de la Sonarges', 'source': 'lnt.ma', 'link': 'https://lnt.ma/billetteries-sportives-les-engagements-de-la-sonarges/', 'summary': 'Billetteries sportives : Les engagements de la Sonarges. Le Conseil de la concurrence a annoncé, vendredi, que la Société Nationale de Réalisation et de Gestion des Équipements Sportifs (Sonarges) a pris un ensemble d’engagements visant à garantir un accès transparent, équitable et non discriminatoire aux prestations de billetterie liées à l’utilisation des infrastructures sportives qu’elle gère. Selon un communiqué publié à cet effet, . ', 'size': 3}], 'main_title': "Billetterie sportive : La Sonarges s'engage à garantir un accès transparent, équitable et non discriminatoire (Conseil de la concurrence)"}, {'community_id': '4', 'articles': [{'id': '68', 'title': 'Négociations indirectes entre Israël et Hamas avant une rencontre avec Trump', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/432114-negociations-indirectes-entre-israel-et-hamas-avant-une-rencontre-avec-trump.html', 'summary': 'Négociations indirectes entre Israël et Hamas avant une rencontre avec Trump. Des négociations indirectes entre Israël et le Hamas palestinien commencent dimanche à Doha pour tenter de trouver un accord sur une trêve à Gaza et une libération d’otages, à la veille d’une rencontre entre Benjamin Netanyahu et Donald Trump. Dans le même temps, la Défense civile locale a annoncé la mort de 14 Palestiniens dans . ', 'size': 2}, {'id': '82', 'title': 'Trêve à Gaza: négociations attendues à Doha avant une rencontre Netanyahu-Trump', 'source': 'lematin.ma', 'link': 'https://lematin.ma/monde/treve-a-gaza-negociations-attendues-a-doha/289511', 'summary': 'Trêve à Gaza: négociations attendues à Doha avant une rencontre Netanyahu-Trump. Dans le même temps, la Défense civile locale a annoncé la mort de 14 Palestiniens dans de nouvelles frappes israéliennes dans le territoire palestinien assiégé, affamé et dévasté p.', 'size': 2}], 'main_title': 'Négociations indirectes entre Israël et Hamas avant une rencontre avec Trump'}, {'community_id': '5', 'articles': [{'id': '98', 'title': 'Patrice Motsepe : La CAN 2024 féminine «sera la plus mémorable de toutes»', 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/170943/patrice-motsepe-2024-feminine-sera.html', 'summary': 'Patrice Motsepe : La CAN 2024 féminine «sera la plus mémorable de toutes». Le président de la Confédération africaine de football (CAF), Patrice Motsepe, a souligné, samedi à Salé, que la Coupe d’Afrique des nations (CAN 2024) féminine, qui se tient au Maroc, sera la plus mémorable de toutes les éditions de cette compétition continentale.', 'size': 2}, {'id': '106', 'title': 'CAN féminine (Maroc-2024): «\xa0Cette édition sera la plus mémorable de toutes\xa0»', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/can-feminine-maroc-2024-cette-edition-sera-la-plus-memorable-de-toutes/', 'summary': 'CAN féminine (Maroc-2024): « Cette édition sera la plus mémorable de toutes ». Le président de la Confédération Africaine de Football (CAF), Patrice Motsepe, a souligné, samedi à Salé, que la Coupe d’Afrique des Nations (CAN) féminine, qui se tient dans le Royaume, sera la plus mémorable de toutes les éditions de cette compétition continentale. « Cette édition sera, sans aucun doute, la plus réussie et la plus mémorable .', 'size': 2}], 'main_title': 'Patrice Motsepe : La CAN 2024 féminine «sera la plus mémorable de toutes»'}, {'community_id': '7', 'articles': [{'id': '99', 'title': 'CAN 2024 féminine : Le Maroc tire son épingle du jeu face à la Zambie', 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/170941/2024-feminine-maroc-tire-epingle.html', 'summary': 'CAN 2024 féminine : Le Maroc tire son épingle du jeu face à la Zambie. La sélection marocaine féminine de football et son homologue zambienne se sont quittées sur un nul (2-2), en match comptant pour la première journée du groupe A de la Coupe d’Afrique des nations (CAN 2024), samedi soir au stade olympique de Rabat.', 'size': 2}, {'id': '111', 'title': 'CAN 2024 : Les Lionnes débutent la compétition par un nul décroché in extremis', 'source': 'lnt.ma', 'link': 'https://lnt.ma/can-2024-les-lionnes-debutent-la-competition-par-un-nul-decroche-in-extremis/', 'summary': 'CAN 2024 : Les Lionnes débutent la compétition par un nul décroché in extremis. La sélection féminine marocaine de football a entamé sa campagne dans la Coupe d’Afrique des Nations (CAN) Maroc 2024 par un match nul (2-2) face à son homologue zambienne, samedi soir au stade Olympique de Rabat, dans le cadre de la première journée du groupe A. La rencontre a débuté de manière intense avec un . ', 'size': 2}], 'main_title': 'CAN 2024 féminine : Le Maroc tire son épingle du jeu face à la Zambie'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
                        
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ? d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        // Fonction pour cacher le tooltip
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = '';
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
    
    
</body>




</html>
    