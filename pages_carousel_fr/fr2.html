<!DOCTYPE html>
<html lang="ar" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); 
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title"> Les principales actualités des dernières 24 heures

</div>    
        <div class="header-subtitle"> Dernière mise à jour : 24/08/2025 - 12h25</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"></div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '6', 'articles': [{'id': '0', 'title': "Le temps qu'il fera ce dimanche 24 août 2025", 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/438487-le-temps-quil-fera-ce-dimanche-24-aout-2025.html', 'summary': "Le temps qu'il fera ce dimanche 24 août 2025. Voici les prévisions météorologiques établies par la Direction générale de la météorologie pour le dimanche 24 août 2025 – Temps assez chaud sur le Sud-Est et l’extrême Sud du pays. – Nuages bas fréquents la matinée près des côtes, avec brume, et bruine sur l’Ouest de la Méditerranée ainsi que sur le Nord-Ouest des provinces . ", 'size': 2}, {'id': '44', 'title': 'Les prévisions du samedi 23 août 2025', 'source': 'www.challenge.ma', 'link': 'https://www.challenge.ma/les-previsions-du-samedi-23-aout-2025-308938/', 'summary': 'Les prévisions du samedi 23 août 2025. Voici les prévisions météorologiques établies par la Direction générale de la météorologie pour ce samedi 23 août 2025. -Temps assez chaud sur le Sud-Est et l’intérieur des provinces sahariennes. -Averses orageuses sur les Haut et Moyen Atlas. -Ondées et orages sur les versants Sud-Est, les Hauts plateaux et l’extrême Sud', 'size': 2}], 'main_title': "Le temps qu'il fera ce dimanche 24 août 2025"}, {'community_id': '2', 'articles': [{'id': '3', 'title': 'Rissani : Un policier contraint d’utiliser son arme pour neutraliser un multirécidiviste armé', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/438490-rissani-un-policier-contraint-dutiliser-son-arme-pour-neutraliser-un-multirecidiviste-arme.html', 'summary': 'Rissani : Un policier contraint d’utiliser son arme pour neutraliser un multirécidiviste armé. Un inspecteur de police relevant du district provincial de Rissani a dû faire usage, vendredi, de son arme de service afin de mettre fin à la menace représentée par un individu de 28 ans, multirécidiviste, en état de forte agitation et armé d’une arme blanche. L’homme avait mis en danger la vie de plusieurs citoyens . ', 'size': 4}, {'id': '33', 'title': '\u200bRissani: Un inspecteur de police fait usage de son arme de service pour neutraliser un individu ayant mis en danger la vie des citoyens et des éléments de la police (source sécuritaire)', 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/\u200bRissani-Un-inspecteur-de-police-fait-usage-de-son-arme-de-service-pour-neutraliser-un-individu-ayant-mis-en-danger-la_a71024.html', 'summary': "\u200bRissani: Un inspecteur de police fait usage de son arme de service pour neutraliser un individu ayant mis en danger la vie des citoyens et des éléments de la police (source sécuritaire). Un inspecteur de police, en fonction au district provincial de la police de Rissani, a été contraint, vendredi, de faire usage de son arme de service pour neutraliser le danger émanant d'un multirécidiviste (28 ans) en état de forte agitation ayant mis en danger la vie des citoyens et des éléments de la police en utilisant une arme blanche.", 'size': 4}, {'id': '60', 'title': 'Rissani : un policier neutralise un individu dangereux en utilisant son arme de service', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/rissani-un-policier-neutralise-un-individu-dangereux-en-utilisant-son-arme-de-service/', 'summary': 'Rissani : un policier neutralise un individu dangereux en utilisant son arme de service. Un inspecteur de police, en fonction au district provincial de la police de Rissani, a été contraint, vendredi, de faire usage de son arme de service pour neutraliser le danger émanant d’un multirécidiviste (28 ans) en état de forte agitation ayant mis en danger la vie des citoyens et des éléments de la police en .', 'size': 4}, {'id': '72', 'title': 'Maroc : un inspecteur de police fait usage de son arme de service pour neutraliser un individu ayant mis en danger la vie des citoyens', 'source': 'atlasinfo.fr', 'link': 'https://atlasinfo.fr/maroc-un-inspecteur-de-police-fait-usage-de-son-arme-de-service-pour-neutraliser-un-individu-ayant-mis-en-danger-la-vie-des-citoyens-et-des-elements-de-la-police.html', 'summary': 'Maroc : un inspecteur de police fait usage de son arme de service pour neutraliser un individu ayant mis en danger la vie des citoyens. Un inspecteur de police en fonction au district provincial de la police de Rissani a été contraint vendredi de faire usage de son arme de service pour neutraliser le danger émanant d’un multirécidiviste (28 ans) en état de forte agitation ayant mis en danger la vie des citoyens et des éléments de la police en . L’article est apparu en premier sur .', 'size': 4}], 'main_title': 'Rissani : Un policier contraint d’utiliser son arme pour neutraliser un multirécidiviste armé'}, {'community_id': '0', 'articles': [{'id': '8', 'title': 'Le 1er Rabie-I 1447 correspond au lundi 25 août, Aïd Al Mawlid Annabaoui célébré le vendredi 5 septembre', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/438507-le-1er-rabie-i-1447-correspond-au-lundi-25-aout-aid-al-mawlid-annabaoui-celebre-le-vendredi-5-septembre.html', 'summary': 'Le 1er Rabie-I 1447 correspond au lundi 25 août, Aïd Al Mawlid Annabaoui célébré le vendredi 5 septembre. Le mois de Rabie-I 1447 de l’hégire débutera le lundi 25 août 2025 et Aïd Al Mawlid Annabaoui sera célébré le vendredi 5 septembre, a annoncé, samedi soir, le ministère des Habous et des Affaires islamiques. Dans un communiqué, le ministère indique que l’observation du croissant lunaire du mois de Rabie-I 1447 a eu lieu . ', 'size': 5}, {'id': '48', 'title': 'Le 1er Rabie I 1447 correspond au lundi 25 août, Aïd Al Mawlid Annabaoui sera\xa0 le 5 septembre', 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/174837/rabie-1447-correspond-lundi-aout.html', 'summary': 'Le 1er Rabie I 1447 correspond au lundi 25 août, Aïd Al Mawlid Annabaoui sera le 5 septembre. Le mois de Rabie I 1447 de l’hégire débutera le lundi 25 août 2025 et Aïd Al Mawlid Annabaoui sera célébré le vendredi 5 septembre, a annoncé, samedi soir, le ministère des Habous et des affaires islamiques.', 'size': 5}, {'id': '50', 'title': 'Le 1er Rabie-I 1447 correspond au lundi 25 août, Aïd Al Mawlid Annabaoui célébré le vendredi 05 septembre', 'source': 'aujourdhui.ma', 'link': 'https://aujourdhui.ma/actualite/le-1er-rabie-i-1447-correspond-au-lundi-25-aout-aid-al-mawlid-annabaoui-celebre-le-vendredi-05-septembre', 'summary': 'Le 1er Rabie-I 1447 correspond au lundi 25 août, Aïd Al Mawlid Annabaoui célébré le vendredi 05 septembre. Le mois de Rabie-I 1447 de l’hégire débutera le lundi 25 août 2025 et Aïd Al Mawlid Annabaoui sera célébré le vendredi 05 septembre, a annoncé, samedi soir, le ministère des Habous et des Affaires islamiques. Dans un communiqué, le ministère indique que l’observation du croissant lunaire du mois de Rabie-I 1447 a eu lieu .', 'size': 5}, {'id': '89', 'title': 'Aid Al Mawlid célébré le 5 septembre. Un jour férié ou deux ? Ce que prévoit la loi', 'source': 'www.challenge.ma', 'link': 'https://www.challenge.ma/aid-al-mawlid-celebre-le-5-septembre-un-jour-ferie-ou-deux-ce-que-prevoit-la-loi-308971/', 'summary': 'Aid Al Mawlid célébré le 5 septembre. Un jour férié ou deux ? Ce que prévoit la loi. Au Maroc, le mois de Rabie-I 1447 de l’hégire débutera le lundi 25 août 2025 et Aïd Al Mawlid Annabaoui sera célébré le vendredi 5 septembre, annonce le ministère des Habous et des Affaires islamiques. « Avons-nous droit à un jour de congé ou plutôt deux ? » Cette question que se', 'size': 5}, {'id': '98', 'title': 'Aïd Al Mawlid Annabaoui sera célébré le vendredi 05 septembre', 'source': 'atlasinfo.fr', 'link': 'https://atlasinfo.fr/maroc-aid-al-mawlid-annabaoui-sera-celebre-le-vendredi-05-septembre.html', 'summary': 'Aïd Al Mawlid Annabaoui sera célébré le vendredi 05 septembre. Le mois de Rabie-I 1447 de l’hégire débutera le lundi 25 août 2025 et Aïd Al Mawlid Annabaoui sera célébré le vendredi 05 septembre, a annoncé samedi soir à Rabat le ministère des Habous et des Affaires islamiques. Dans un communiqué, le ministère indique que l’observation du croissant lunaire du mois de Rabie-I 1447 a . L’article est apparu en premier sur .', 'size': 5}], 'main_title': 'Le 1er Rabie-I 1447 correspond au lundi 25 août, Aïd Al Mawlid Annabaoui célébré le vendredi 5 septembre'}, {'community_id': '3', 'articles': [{'id': '18', 'title': 'Mondial 2026 : le tirage au sort prévu le 5 décembre à Washington (Trump)', 'source': 'lematin.ma', 'link': 'https://lematin.ma/sports/mondial-2026-le-tirage-au-sort-prevu-le-5-decembre-a-washington/297659', 'summary': 'Mondial 2026 : le tirage au sort prévu le 5 décembre à Washington (Trump). Entouré du président de la FIFA, Gianni Infantino, au bureau ovale de la Maison Blanche, Donald Trump a précisé que le tirage au sort du prochain Mondial se déroulera au Kennedy Ce.', 'size': 2}, {'id': '43', 'title': 'Mondial 2026 : Donald Trump annonce le lieu du tirage au sort', 'source': 'www.challenge.ma', 'link': 'https://www.challenge.ma/mondial-2026-donald-trump-annonce-le-lieu-du-tirage-au-sort-308944/', 'summary': 'Mondial 2026 : Donald Trump annonce le lieu du tirage au sort. Le président américain Donald Trump a annoncé, vendredi, que le tirage au sort de la Coupe du Monde de football 2026, co-organisée par les Etats-Unis, le Canada et le Mexique, aura lieu le 5 décembre à Washington. Depuis le bureau ovale de la Maison Blanche, en présence du président de', 'size': 2}], 'main_title': 'Mondial 2026 : le tirage au sort prévu le 5 décembre à Washington (Trump)'}, {'community_id': '1', 'articles': [{'id': '57', 'title': 'Grippe aviaire : L’UE développe de nouveaux outils pour briser la propagation', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/grippe-aviaire-lue-developpe-de-nouveaux-outils-pour-briser-la-propagation/', 'summary': 'Grippe aviaire : L’UE développe de nouveaux outils pour briser la propagation. Le Centre commun de recherche (CCR) de l’Union européenne a annoncé, vendredi, avoir développé de nouveaux tests précis pouvant détecter spécifiquement la grippe aviaire hautement pathogène, qui a déjà infecté des millions d’oiseaux et apparaît aujourd’hui chez certains mammifères. Le CCR, en collaboration avec le Laboratoire de référence de l’Union européenne (EURL) pour la grippe .', 'size': 2}, {'id': '73', 'title': 'Grippe aviaire : l’UE développe de nouveaux outils pour briser la propagation', 'source': 'atlasinfo.fr', 'link': 'https://atlasinfo.fr/grippe-aviaire-lue-developpe-de-nouveaux-outils-pour-briser-la-propagation.html', 'summary': 'Grippe aviaire : l’UE développe de nouveaux outils pour briser la propagation. Le Centre commun de recherche (CCR) de l’Union européenne a annoncé, vendredi, avoir développé de nouveaux tests précis pouvant détecter spécifiquement la grippe aviaire hautement pathogène, qui a déjà infecté des millions d’oiseaux et apparaît aujourd’hui chez certains mammifères. Le CCR, en collaboration avec le Laboratoire de référence de l’Union européenne (EURL) pour la grippe . L’article est apparu en premier sur .', 'size': 2}], 'main_title': 'Grippe aviaire : L’UE développe de nouveaux outils pour briser la propagation'}, {'community_id': '4', 'articles': [{'id': '61', 'title': 'Températures prévues pour le dimanche 24 août 2025', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/temperatures-prevues-pour-le-dimanche-24-aout-2025/', 'summary': 'Températures prévues pour le dimanche 24 août 2025. Voici les températures minimales et maximales prévues par la Direction générale de la météorologie pour le dimanche 24 août 2025: Min Max Lire aussi : IA: Meta conclut un accord de plus de 10 milliards USD avec Google Cloud pour utiliser ses serveurs – Oujda 22 36 – Bouarfa 23 37 – Al Hoceima 21 26 .', 'size': 2}, {'id': '80', 'title': 'Les températures attendues ce dimanche 24 août 2025', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/438488-les-temperatures-attendues-ce-dimanche-24-aout-2025.html', 'summary': 'Les températures attendues ce dimanche 24 août 2025. Voici les températures minimales et maximales prévues par la Direction générale de la météorologie pour le dimanche 24 août 2025 Min Max – Oujda 22 36 – Bouarfa 23 37 – Al Hoceima 21 26 – Tétouan 21 28 – Sebta 21 26 – Mellilia 22 27 – Tanger 21 27 – Kénitra 20 27 . ', 'size': 2}], 'main_title': 'Températures prévues pour le dimanche 24 août 2025'}, {'community_id': '5', 'articles': [{'id': '68', 'title': 'Un passager tente d’entrer dans le cockpit sur un vol Lyon-Porto, l’avion fait demi-tour', 'source': 'atlasinfo.fr', 'link': 'https://atlasinfo.fr/pris-de-mal-de-lair-un-passager-tente-dentrer-dans-le-cockpit-sur-un-vol-lyon-porto-lavion-fait-demi-tour.html', 'summary': 'Un passager tente d’entrer dans le cockpit sur un vol Lyon-Porto, l’avion fait demi-tour. Pris de « mal de l’air » et de « bouffées délirantes », un passager a tenté vendredi soir d’entrer dans le cockpit sur un vol Lyon-Porto de la compagnie EasyJet, contraignant l’avion à faire demi-tour, rapportent les médias de l’hexagone. Selon la presse qui cite la compagnie et la police française, la tentative d’intrusion est survenue peu après . L’article est apparu en premier sur .', 'size': 2}, {'id': '94', 'title': 'Vol Lyon-Porto : un passager tente d’entrer dans le cockpit, l’avion fait demi-tour', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/vol-lyon-porto-un-passager-tente-dentrer-dans-le-cockpit-lavion-fait-demi-tour/', 'summary': 'Vol Lyon-Porto : un passager tente d’entrer dans le cockpit, l’avion fait demi-tour. Pris de « mal de l’air » et de « bouffées délirantes », un passager a tenté, vendredi soir, d’entrer dans le cockpit sur un vol Lyon-Porto de la compagnie EasyJet, contraignant l’avion à faire demi-tour, rapportent les médias de l’hexagone. Selon la presse qui cite la compagnie et la police française, la tentative d’intrusion est survenue peu après .', 'size': 2}], 'main_title': 'Un passager tente d’entrer dans le cockpit sur un vol Lyon-Porto, l’avion fait demi-tour'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
                        
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ? d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        // Fonction pour cacher le tooltip
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = '';
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
    
    
</body>




</html>
    