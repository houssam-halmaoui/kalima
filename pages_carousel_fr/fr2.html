<!DOCTYPE html>
<html lang="ar" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); 
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title"> Les principales actualités des dernières 24 heures

</div>    
        <div class="header-subtitle"> Dernière mise à jour : 29/09/2025 - 06h15</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"></div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '12', 'title': 'Le Maroc célèbre ce lundi l’anniversaire de S.A.R. la Princesse Lalla Asmaa', 'source': 'lematin.ma', 'link': 'https://lematin.ma/nation/le-maroc-celebre-ce-lundi-lanniversaire-de-sar-la-princesse-lalla-asmaa/304450', 'summary': 'Le Maroc célèbre ce lundi l’anniversaire de S.A.R. la Princesse Lalla Asmaa. Princesse au grand cœur, S.A.R. la Princesse Lalla Asmaa s’est engagée dès son jeune âge dans le militantisme social, en veillant en permanence au bien-être des enfants sourds-muet.', 'size': 2}, {'id': '91', 'title': 'Le peuple marocain célèbre lundi l’anniversaire de S.A.R. la Princesse Lalla Asmaa', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/le-peuple-marocain-celebre-lundi-lanniversaire-de-s-a-r-la-princesse-lalla-asmaa/', 'summary': 'Le peuple marocain célèbre lundi l’anniversaire de S.A.R. la Princesse Lalla Asmaa. La Famille Royale et, avec elle, le peuple marocain, célèbrent lundi l’anniversaire de SAR la Princesse Lalla Asmaa, une occasion de mettre en avant les différentes actions de Son Altesse Royale dans le domaine social et son engagement constant en faveur de l’amélioration des conditions des enfants à besoins spécifiques, notamment les enfants sourds-muets. Princesse .', 'size': 2}], 'main_title': 'Le Maroc célèbre ce lundi l’anniversaire de S.A.R. la Princesse Lalla Asmaa'}, {'community_id': '1', 'articles': [{'id': '28', 'title': 'ENSA d’Agadir : le tribunal administratif ordonne la réintégration des étudiants contestataires', 'source': 'lematin.ma', 'link': 'https://lematin.ma/enseignement/ensa-agadir-la-justice-reintegre-les-etudiants-exclus-apres-contestation/304352', 'summary': 'ENSA d’Agadir : le tribunal administratif ordonne la réintégration des étudiants contestataires. Le tribunal administratif d’Agadir a rendu, jeudi 25 septembre, un jugement en première instance favorable aux étudiants de l’École Nationale des Sciences Appliquées (Ensa) qui ava.', 'size': 2}, {'id': '115', 'title': 'ENSA d’Agadir : la justice impose la réintégration des étudiants exclus', 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/ENSA-d-Agadir-la-justice-impose-la-reintegration-des-etudiants-exclus_a72280.html', 'summary': 'ENSA d’Agadir : la justice impose la réintégration des étudiants exclus. Confrontée à un taux d’échec record et à des critiques sur ses méthodes d’évaluation, l’École nationale des sciences appliquées d’Agadir traverse une crise institutionnelle. Le tribunal administratif a ordonné la réintégration immédiate des étudiants contestataires, en attendant un jugement sur le fond.', 'size': 2}], 'main_title': 'ENSA d’Agadir : le tribunal administratif ordonne la réintégration des étudiants contestataires'}, {'community_id': '2', 'articles': [{'id': '37', 'title': 'Hub Morocco Digital : le Maroc lance à l’ONU une plateforme pour accélérer la transformation numérique en Afrique et dans le monde arabe', 'source': 'lematin.ma', 'link': 'https://lematin.ma/nation/le-maroc-lance-une-plateforme-pour-accelerer-la-transformation-numerique/304190', 'summary': 'Hub Morocco Digital : le Maroc lance à l’ONU une plateforme pour accélérer la transformation numérique en Afrique et dans le monde arabe. En droite ligne de la Vision de Sa Majesté le Roi Mohammed VI, le Maroc a lancé officiellement, vendredi à New York, le Hub Morocco Digital for Sustainable Development.', 'size': 2}, {'id': '100', 'title': 'New York : lancement du « Hub Morocco Digital for Sustainable Development » pour accélérer la transformation numérique en Afrique et dans le monde arabe', 'source': 'lnt.ma', 'link': 'https://lnt.ma/new-york-lancement-du-hub-morocco-digital-for-sustainable-development-pour-accelerer-la-transformation-numerique-en-afrique-et-dans-le-monde-arabe/', 'summary': 'New York : lancement du « Hub Morocco Digital for Sustainable Development » pour accélérer la transformation numérique en Afrique et dans le monde arabe. Le Maroc a officiellement lancé le « Hub Morocco Digital for Sustainable Development » (D4SD), une plateforme régionale destinée à impulser la transformation numérique inclusive et durable en Afrique et dans la région arabe. L’initiative, portée par le ministère de la Transition numérique et de la Réforme de l’administration en partenariat avec le Programme des . ', 'size': 2}], 'main_title': 'Hub Morocco Digital : le Maroc lance à l’ONU une plateforme pour accélérer la transformation numérique en Afrique et dans le monde arabe'}, {'community_id': '3', 'articles': [{'id': '38', 'title': 'Mondial U20 : les Lionceaux de l’Atlas commencent par un duel corsé face à l’Espagne', 'source': 'lematin.ma', 'link': 'https://lematin.ma/sports/mondial-u20-les-lionceaux-commencent-par-un-duel-face-a-lespagne/304279', 'summary': 'Mondial U20 : les Lionceaux de l’Atlas commencent par un duel corsé face à l’Espagne. Après plusieurs mois de préparation minutieuse, ponctués par un ultime stage au Chili, l’heure de vérité a enfin sonné pour les protégés de Mohamed Ouahbi. Dimanche soir, à 21 h, i.', 'size': 2}, {'id': '105', 'title': "U20: Ouahbi heureux de la victoire du Maroc contre l'Espagne", 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/443167-u20-ouahbi-heureux-de-la-victoire-du-maroc-contre-lespagne.html', 'summary': "U20: Ouahbi heureux de la victoire du Maroc contre l'Espagne. Le sélectionneur de l’équipe nationale des moins de 20 ans de football, Mohamed Ouahbi, s’est dit « heureux » de la victoire des Lionceaux de l’Atlas contre l’Espagne (2-0) pour le compte de la première journée du Groupe C du Mondial U20 qui se tient au Chili, assurant que ses joueurs ont fait preuve de . ", 'size': 2}], 'main_title': 'Mondial U20 : les Lionceaux de l’Atlas commencent par un duel corsé face à l’Espagne'}, {'community_id': '5', 'articles': [{'id': '67', 'title': 'Affaires et industrie : Le Maroc, «hub stratégique» selon le\xa0Département d’État américain', 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/177480/affaires-industrie-maroc-strategique-selon.html', 'summary': 'Affaires et industrie : Le Maroc, «hub stratégique» selon le Département d’État américain. Dans son rapport 2025 sur le climat dinvestissement au Maroc, publié cette semaine, le Département d’État américain met en avant les atouts majeurs et les opportunités d’investissement qui font du royaume un «hub régional stratégique pour les affaires et l’industrie».', 'size': 3}, {'id': '79', 'title': 'Investissement: Le Maroc, un «hub stratégique» selon le Département d’État américain', 'source': 'www.lavieeco.com', 'link': 'https://www.lavieeco.com/affaires/investissement-le-maroc-un-hub-strategique-selon-le-departement-detat-americain/', 'summary': "Investissement: Le Maroc, un «hub stratégique» selon le Département d’État américain. Dans la dernière livraison de son rapport sur le climat d'investissement, le Département d’Etat américain a mis en avant les atouts majeurs du Royaume dans le domaine, le qualifiant de hub stratégique pour les affaires et l’industrie.", 'size': 3}, {'id': '90', 'title': 'Le Département d’État américain met en avant les atouts du Maroc comme «\xa0hub stratégique\xa0» pour les affaires et l’industrie', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/le-departement-detat-americain-met-en-avant-les-atouts-du-maroc-comme-hub-strategique-pour-les-affaires-et-lindustrie/', 'summary': 'Le Département d’État américain met en avant les atouts du Maroc comme « hub stratégique » pour les affaires et l’industrie. Dans son rapport 2025 sur le climat d’investissement au Maroc, publié cette semaine, le Département d’État américain met en avant les atouts majeurs et les opportunités d’investissement qui font du Royaume un « hub régional stratégique pour les affaires et l’industrie ». Dans ce rapport couvrant plusieurs volets, notamment l’investissement, les politiques industrielles, le secteur financier et .', 'size': 3}], 'main_title': 'Affaires et industrie : Le Maroc, «hub stratégique» selon le\xa0Département d’État américain'}, {'community_id': '4', 'articles': [{'id': '87', 'title': 'L’école 1337 remporte le Moroccan Collegiate Programming Contest', 'source': 'www.lavieeco.com', 'link': 'https://www.lavieeco.com/tech/lecole-1337-remporte-le-moroccan-collegiate-programming-contest/', 'summary': "L’école 1337 remporte le Moroccan Collegiate Programming Contest. Organisé du 19 au 21 septembre à Rabat, le Moroccan Collegiate Programming Contest (MCPC) a mis aux prises 72 équipes issues d’écoles et d’universités de tout le Maroc. À l’issue de cette bataille numérique, c'est l'école 1337 qui a été sacrée.", 'size': 2}, {'id': '135', 'title': 'Maroc\xa0: L’école 1337 en tête du Moroccan Collegiate Programming Contest', 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/177501/maroc-l-ecole-1337-tete-moroccan.html', 'summary': 'Maroc : L’école 1337 en tête du Moroccan Collegiate Programming Contest. L’école de programmation 1337 s’est classé en tête du Moroccan Collegiate Programming Contest (MCPC), tenu du 19 au 21 septembre 2025 au campus de l’Université Mohammed VI polytechnique (UM6P) de Rabat. L’entraînement des étudiants participants pour l’établissement a été coordonné par Jalal Maaouni, lauréat de la même école et qui a accompagné les quatre équipes.', 'size': 2}], 'main_title': 'L’école 1337 remporte le Moroccan Collegiate Programming Contest'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
                        
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ? d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        // Fonction pour cacher le tooltip
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = '';
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
    
    
</body>




</html>
    