<!DOCTYPE html>
<html lang="ar" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); 
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title"> Les principales actualités des dernières 24 heures

</div>    
        <div class="header-subtitle"> Dernière mise à jour : 22/06/2025 - 06h24</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"></div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '1', 'title': 'Alerte météo : averses orageuses samedi et temps chaud de samedi à mercredi dans plusieurs régions', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/429953-alerte-meteo-averses-orageuses-samedi-et-temps-chaud-de-samedi-a-mercredi-dans-plusieurs-regions.html', 'summary': 'Alerte météo : averses orageuses samedi et temps chaud de samedi à mercredi dans plusieurs régions. La Direction générale de la météorologie (DGM), a annoncé de fortes averses orageuses avec grêle locale et rafales de vent prévues samedi, et un temps chaud, de samedi à mercredi, dans plusieurs provinces du Royaume. Dans un bulletin d’alerte de niveau de vigilance orange, la DGM précise que des averses orageuses (15-25 mm) avec grêle . ', 'size': 3}, {'id': '74', 'title': 'Alerte météo : Fortes averses orageuses samedi et temps chaud de samedi à mercredi', 'source': 'aujourdhui.ma', 'link': 'https://aujourdhui.ma/actualite/alerte-meteo-fortes-averses-orageuses-samedi-et-temps-chaud-de-samedi-a-mercredi', 'summary': 'Alerte météo : Fortes averses orageuses samedi et temps chaud de samedi à mercredi. De fortes averses orageuses avec grêle locale et rafales de vent sont prévues samedi, et un temps chaud sera enregistré, de samedi à mercredi, dans plusieurs provinces du Royaume, a annoncé la Direction générale de la météorologie (DGM). Des averses orageuses (15-25 mm) avec grêle locale et rafales de vent concerneront, samedi de 14h à .', 'size': 3}, {'id': '153', 'title': "Maroc : Jusqu'à 45°C de samedi à mercredi (bulletin d’alerte)", 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/169624/maroc-jusqu-a-samedi-mercredi-bulletin.html', 'summary': "Maroc : Jusqu'à 45°C de samedi à mercredi (bulletin d’alerte). De fortes averses orageuses avec grêle locale et rafales de vent sont prévues samedi, et un temps chaud sera enregistré, de samedi à mercredi, dans plusieurs provinces du Maroc, a annoncé la Direction générale de la météorologie (DGM).", 'size': 3}], 'main_title': 'Alerte météo : averses orageuses samedi et temps chaud de samedi à mercredi dans plusieurs régions'}, {'community_id': '8', 'articles': [{'id': '21', 'title': 'Jason Derulo enflamme l’ouverture du Casablanca Music Week', 'source': 'lematin.ma', 'link': 'https://lematin.ma/culture/jason-derulo-enflamme-louverture-du-casablanca-music-week/286819', 'summary': 'Jason Derulo enflamme l’ouverture du Casablanca Music Week. Le concert, tenu au stade La Casablancaise, a débuté par un imposant feu d’artifice, avant que l’artiste ne monte sur scène entouré de sa troupe de danseurs, venus spécialement pou.', 'size': 2}, {'id': '132', 'title': 'Casablanca Music Week : Jason Derulo ouvre la première édition par un concert à La Casablancaise', 'source': 'lnt.ma', 'link': 'https://lnt.ma/casablanca-music-week-jason-derulo-ouvre-la-premiere-edition-par-un-concert-a-la-casablancaise/', 'summary': 'Casablanca Music Week : Jason Derulo ouvre la première édition par un concert à La Casablancaise. La première édition du festival Casablanca Music Week (CMW) s’est ouverte vendredi soir par un concert de l’artiste américain Jason Derulo, sur la scène principale installée au stade La Casablancaise. Le spectacle, marqué par une mise en scène dynamique et un feu d’artifice inaugural, s’inscrit dans le cadre de la tournée mondiale de l’artiste, accompagné . ', 'size': 2}], 'main_title': 'Jason Derulo enflamme l’ouverture du Casablanca Music Week'}, {'community_id': '5', 'articles': [{'id': '22', 'title': 'France : inauguration du Consulat général du Maroc à Mantes-la-Jolie', 'source': 'lematin.ma', 'link': 'https://lematin.ma/nation/france-inauguration-du-consulat-general-du-maroc-a-mantes-la-jolie/286818', 'summary': 'France : inauguration du Consulat général du Maroc à Mantes-la-Jolie. L’ouverture de cette nouvelle représentation consulaire s’inscrit dans la stratégie du ministère des Affaires étrangères, de la Coopération africaine et des Marocains résidant à l’.', 'size': 5}, {'id': '69', 'title': 'France : Inauguration du consulat général du Maroc à Mantes-la-Jolie', 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/169593/france-inauguration-consulat-general-maroc.html', 'summary': 'France : Inauguration du consulat général du Maroc à Mantes-la-Jolie. Un nouveau consulat général du Maroc a été officiellement inauguré, vendredi, à Mantes-la-Jolie, en région parisienne, renforçant le réseau consulaire du royaume en France constitué désormais de 17 consulats, dans le cadre d’une dynamique de proximité, de modernisation et d’efficacité au service des ressortissants marocains.', 'size': 5}, {'id': '94', 'title': 'Maroc-France : Un nouveau consulat général inauguré en région parisienne', 'source': 'www.lavieeco.com', 'link': 'https://www.lavieeco.com/influences/maroc-france-un-nouveau-consulat-general-inaugure-en-region-parisienne/', 'summary': 'Maroc-France : Un nouveau consulat général inauguré en région parisienne. L’inauguration du Consulat général du Maroc à Mantes-la-Jolie porte le réseau consulaire à 17 consulats dans l’Hexagone. La communauté marocaine de la région parisienne ne peut qu’être heureuse de cette bonne nouvelle.', 'size': 5}, {'id': '121', 'title': 'Inauguration du nouveau consulat du Maroc à Mantes-la-Jolie', 'source': 'atlasinfo.fr', 'link': 'https://atlasinfo.fr/inauguration-du-nouveau-consulat-du-maroc-a-mantes-la-jolie.html', 'summary': 'Inauguration du nouveau consulat du Maroc à Mantes-la-Jolie. Le nouveau consulat général du Maroc à Mantes-la-Jolie a été officiellement inauguré vendredi, à Mantes-la-Jolie, en région parisienne, afin de renforcer le réseau consulaire du Royaume en France, portant le nombre à 17 consulats. L’ouverture de cette nouvelle représentation consulaire s’inscrit dans la stratégie du ministère des Affaires étrangères, de la Coopération africaine et des . L’article est apparu en premier sur .', 'size': 5}, {'id': '125', 'title': 'Yvelines | Inauguration d’un nouveau Consulat général du Maroc à Mantes-la-Jolie', 'source': 'www.lereporter.ma', 'link': 'https://www.lereporter.ma/yvelines-inauguration-dun-nouveau-consulat-general-du-maroc-a-mantes-la-jolie/', 'summary': 'Yvelines | Inauguration d’un nouveau Consulat général du Maroc à Mantes-la-Jolie. Un nouveau consulat général du Maroc a été officiellement inauguré, vendredi, à Mantes-la-Jolie, en région parisienne, renforçant le réseau consulaire du Royaume en France constitué désormais de 17 consulats, dans le cadre d’une dynamique de proximité, de modernisation et d’efficacité au service des ressortissants marocains. L’ouverture de cette nouvelle représentation consulaire s’inscrit dans la stratégie ', 'size': 5}], 'main_title': 'France : inauguration du Consulat général du Maroc à Mantes-la-Jolie'}, {'community_id': '2', 'articles': [{'id': '62', 'title': 'La ministre française Aurore Bergé en visite officielle au Maroc du 23 au 25 juin', 'source': 'www.challenge.ma', 'link': 'https://www.challenge.ma/la-ministre-francaise-aurore-berge-en-visite-officielle-au-maroc-du-23-au-25-juin-305222/', 'summary': 'La ministre française Aurore Bergé en visite officielle au Maroc du 23 au 25 juin. Aurore Bergé, ministre de l’Égalité entre les femmes et les hommes et de la Lutte contre les discriminations, se rendra au Maroc du 23 au 25 juin 2025 courant. Elle aura l’occasion de s’entretenir avec plusieurs responsables politiques de haut niveau, parmi lesquels Nadia Fettah Alaoui, ministre de l’Economie et', 'size': 2}, {'id': '109', 'title': 'Le Maroc accueille Aurore Bergé pour un dialogue sur les droits des femmes', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/aurore-berge-au-maroc-pour-une-alliance-feministe-renforcee/', 'summary': 'Le Maroc accueille Aurore Bergé pour un dialogue sur les droits des femmes. La ministre française de l’Égalité entre les femmes et les hommes et de la Lutte contre les discriminations, Aurore Bergé, va effectuer une visite officielle au Maroc du 23 au 25 juin 2025, dans le cadre du rapprochement stratégique amorcé entre Rabat et Paris depuis la visite d’État du président Emmanuel Macron en octobre 2024. .', 'size': 2}, {'id': '120', 'title': 'Déplacement de la ministre française Aurore Bergé du 23 au 25 juin', 'source': 'atlasinfo.fr', 'link': 'https://atlasinfo.fr/deplacement-de-la-ministre-francaise-aurore-berge-du-23-au-25-juin.html', 'summary': 'Déplacement de la ministre française Aurore Bergé du 23 au 25 juin. La ministre française de l’Égalité entre les femmes et les hommes et de la Lutte contre les discriminations, Aurore Bergé, se rendra au Maroc du 23 au 25 juin. L’article est apparu en premier sur .', 'size': 3}], 'main_title': 'Déplacement de la ministre française Aurore Bergé du 23 au 25 juin'}, {'community_id': '4', 'articles': [{'id': '64', 'title': 'Les prévisions du samedi 21 juin', 'source': 'www.challenge.ma', 'link': 'https://www.challenge.ma/les-previsions-du-samedi-21-juin-305205/', 'summary': 'Les prévisions du samedi 21 juin. Voici les prévisions météorologiques établies par la Direction générale de la météorologie pour le samedi 21 juin 2025. -Temps chaud sur le sud du Rif, le Saiss, la vallée de Moulouya, les plateaux de Phosphates et d’Oulmès, les plaines de Tadla, Rehamna, le Sud-Est et l’intérieur des provinces sahariennes. -Foyers', 'size': 3}, {'id': '111', 'title': 'Prévisions météorologiques pour le samedi 21 juin 2025', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/previsions-meteorologiques-pour-le-samedi-21-juin-2025/', 'summary': 'Prévisions météorologiques pour le samedi 21 juin 2025. Voici les prévisions météorologiques établies par la Direction générale de la météorologie pour le samedi 21 juin 2025: – Temps chaud sur le sud du Rif, le Saiss, la vallée de Moulouya, les plateaux de Phosphates et d’Oulmès, les plaines de Tadla, Rehamna, le Sud-Est et l’intérieur des provinces sahariennes. – Foyers orageux avec ondées .', 'size': 3}, {'id': '133', 'title': "Le temps qu'il fera ce dimanche 22 juin 2025", 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/427963-le-temps-quil-fera-ce-dimanche-22-juin-2025.html', 'summary': "Le temps qu'il fera ce dimanche 22 juin 2025. Voici les prévisions météorologiques établies par la Direction générale de la météorologie pour le dimanche 22 juin 2025 -Temps chaud sur le saïss, la vallée de Moulouya, les plaines de Tadla, Rehamna, le sud-est et l’intérieur des provinces sahariennes. -Formations brumeuses et nuages bas sur les plaines et les côtes nord et centre ainsi que . ", 'size': 3}], 'main_title': 'Les prévisions du samedi 21 juin'}, {'community_id': '3', 'articles': [{'id': '98', 'title': 'Coopération : La CGEM et les patronats de la CEMAC scellent un partenariat porteur', 'source': 'www.lavieeco.com', 'link': 'https://www.lavieeco.com/affaires/cooperation-la-cgem-et-les-patronats-de-la-cemac-scellent-un-partenariat-porteur/', 'summary': 'Coopération : La CGEM et les patronats de la CEMAC scellent un partenariat porteur. C’est à Laâyoune ce vendredi. La Confédération générale des entreprises du Maroc et les patronats de la Communauté économique et monétaire de l’Afrique centrale (CEMAC) ont signé une convention de coopération. Conjuguer le politique à l’économique, cela promet !', 'size': 2}, {'id': '126', 'title': 'Le rôle du secteur privé dans l’investissement et l’intégration interafricaine au centre des débats à Laâyoune', 'source': 'www.lereporter.ma', 'link': 'https://www.lereporter.ma/le-role-du-secteur-prive-dans-linvestissement-et-lintegration-interafricaine-au-centre-des-debats-a-laayoune/', 'summary': 'Le rôle du secteur privé dans l’investissement et l’intégration interafricaine au centre des débats à Laâyoune. Le rôle du secteur privé dans le développement des investissements, du commerce et de l’intégration économique entre le Maroc et les États membres de la Communauté économique et monétaire de l’Afrique centrale (CEMAC), a été au centre des débats lors d’un panel organisé vendredi à Laâyoune. Les participants à ce débat, initié dans le cadre ', 'size': 2}], 'main_title': 'Coopération : La CGEM et les patronats de la CEMAC scellent un partenariat porteur'}, {'community_id': '1', 'articles': [{'id': '104', 'title': 'Musiques gnaoua et rythmes amazighs enchantent le public du Festival d’Essaouira', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/musiques-gnaoua-et-rythmes-amazighs-enchantent-le-public-du-festival-dessaouira/', 'summary': 'Musiques gnaoua et rythmes amazighs enchantent le public du Festival d’Essaouira. Une fusion captivante entre l’esprit gnaoua et les rythmes amazighs a emporté, vendredi soir, le public passionné du Festival gnaoua et Musiques du Monde d’Essaouira, le temps d’un spectacle artistique riche et empreint de créativité à la scène de la plage. Lors de la deuxième soirée des festivités de la 26e édition de cet événement .', 'size': 2}, {'id': '119', 'title': 'Une fusion entre musique gnaoua et rythmes amazighs enchantent le public du Festival d’Essaouira', 'source': 'atlasinfo.fr', 'link': 'https://atlasinfo.fr/une-fusion-entre-musique-gnaoua-et-rythmes-amazighs-enchantent-le-public-du-festival-dessaouira.html', 'summary': 'Une fusion entre musique gnaoua et rythmes amazighs enchantent le public du Festival d’Essaouira. La fusion ensorcelante entre l’esprit gnaoua et les rythmes amazighs a enchanté, vendredi soir, le public nombreux du Festival gnaoua et Musiques du Monde d’Essaouira, le temps d’un spectacle artistique riche et empreint de créativité à la scène de la plage. Lors de la deuxième soirée des festivités de la 26e édition de cet événement . L’article est apparu en premier sur .', 'size': 2}], 'main_title': 'Musiques gnaoua et rythmes amazighs enchantent le public du Festival d’Essaouira'}, {'community_id': '7', 'articles': [{'id': '124', 'title': 'Forum des droits humains à Essaouira: la culture comme outil pour contrer la stigmatisation des migrants', 'source': 'atlasinfo.fr', 'link': 'https://atlasinfo.fr/forum-des-droits-humains-a-essaouira-la-culture-comme-outil-pour-contrer-la-stigmatisation-des-migrants.html', 'summary': 'Forum des droits humains à Essaouira: la culture comme outil pour contrer la stigmatisation des migrants. La 12e édition du Forum des droits humains s’est tenue vendredi à Essaouira sous le thème « Mobilités humaines et dynamiques culturelles » dans le cadre de la la 26ème édition du Festival Gnaoua et Musiques du Monde, en partenariat avec le Conseil de la communauté marocaine à l’étranger (CCME). Ce forum sur les mobilités humaines, qui . L’article est apparu en premier sur .', 'size': 2}, {'id': '131', 'title': 'Le 12ᵉ Forum des droits humains à Essaouira explore le lien entre mobilités humaines et dynamiques culturelles', 'source': 'lnt.ma', 'link': 'https://lnt.ma/le-12%e1%b5%89-forum-des-droits-humains-a-essaouira-explore-le-lien-entre-mobilites-humaines-et-dynamiques-culturelles/', 'summary': 'Le 12ᵉ Forum des droits humains à Essaouira explore le lien entre mobilités humaines et dynamiques culturelles. La 12ᵉ édition du Forum des droits humains s’est ouverte vendredi à Essaouira dans le cadre du Festival Gnaoua et Musiques du Monde. Organisé en partenariat avec le Conseil de la communauté marocaine à l’étranger (CCME), le Forum porte cette année sur le thème : « Mobilités humaines et dynamiques culturelles ». Prenant part à . ', 'size': 2}], 'main_title': 'Forum des droits humains à Essaouira: la culture comme outil pour contrer la stigmatisation des migrants'}, {'community_id': '6', 'articles': [{'id': '128', 'title': 'DGM | Présentation du rapport annuel sur l’état du climat au Maroc en 2024', 'source': 'www.lereporter.ma', 'link': 'https://www.lereporter.ma/dgm-presentation-du-rapport-annuel-sur-letat-du-climat-au-maroc-en-2024/', 'summary': 'DGM | Présentation du rapport annuel sur l’état du climat au Maroc en 2024. La Direction générale de la météorologie (DGM) a présenté, vendredi à Rabat, son rapport annuel sur l’état du climat au Maroc en 2024, lors d’une rencontre tenue en présence du ministre de l’Équipement et de l’Eau, Nizar Baraka. Publié par la DGM pour la cinquième année consécutive, ce rapport annuel fournit une analyse approfondie de l’évolution des ', 'size': 2}, {'id': '129', 'title': 'Réchauffement climatique : Un bilan 2024 inquiétant pour le Maroc', 'source': 'lnt.ma', 'link': 'https://lnt.ma/rechauffement-climatique-des-chiffres-de-2024-inquietants-pour-le-maroc/', 'summary': 'Réchauffement climatique : Un bilan 2024 inquiétant pour le Maroc. La Direction générale de la météorologie (DGM) a présenté, vendredi 20 juin 2025 à Rabat, son rapport annuel sur l’état du climat au Maroc pour l’année 2024, lors d’une rencontre organisée en présence du ministre de l’Équipement et de l’Eau, Nizar Baraka. Ce document, publié pour la cinquième année consécutive, dresse un état des lieux . ', 'size': 2}], 'main_title': 'DGM | Présentation du rapport annuel sur l’état du climat au Maroc en 2024'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
                        
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ? d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        // Fonction pour cacher le tooltip
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = '';
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
    
    
</body>




</html>
    