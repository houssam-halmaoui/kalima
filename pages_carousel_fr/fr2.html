<!DOCTYPE html>
<html lang="ar" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); 
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title"> Les principales actualités des dernières 24 heures

</div>    
        <div class="header-subtitle"> Dernière mise à jour : 29/06/2025 - 06h27</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"></div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '5', 'articles': [{'id': '6', 'title': 'Al Haouz : Nizar Baraka visite des projets hydrauliques', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/431028-al-haouz-nizar-baraka-visite-des-projets-hydrauliques.html', 'summary': 'Al Haouz : Nizar Baraka visite des projets hydrauliques. Le ministre de l’Equipement et de l’Eau, Nizar Baraka, a effectué, vendredi, une visite de terrain dans la province d’Al Haouz et ce, dans le cadre du projet de coopération maroco-allemande-danoise dans le secteur de l’eau « Territoires Durables-Modes de vies durables et résilients au Maroc ». Cette visite, au cours de laquelle Baraka était accompagné des . ', 'size': 3}, {'id': '27', 'title': 'Gestion de l’eau : Nizar Baraka suit l’avancement des chantiers à Al Haouz', 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/Gestion-de-l-eau-Nizar-Baraka-suit-l-avancement-des-chantiers-a-Al-Haouz_a69265.html', 'summary': 'Gestion de l’eau : Nizar Baraka suit l’avancement des chantiers à Al Haouz. Le ministre de l\'Equipement et de l\'Eau, Nizar Baraka, a effectué, vendredi, une visite de terrain dans la province d\'Al Haouz et ce, dans le cadre du projet de coopération maroco-allemande-danoise dans le secteur de l\'eau "Territoires Durables-Modes de vies durables et résilients au Maroc".', 'size': 3}, {'id': '74', 'title': 'Al Haouz : M. Baraka visite des projets hydrauliques et s’informe des actions du projet «\xa0Territoires durables\xa0»', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/al-haouz-m-baraka-visite-des-projets-hydrauliques-et-sinforme-des-actions-du-projet-territoires-durables/', 'summary': 'Al Haouz : M. Baraka visite des projets hydrauliques et s’informe des actions du projet « Territoires durables ». Le ministre de l’Equipement et de l’Eau, Nizar Baraka, a effectué, vendredi, une visite de terrain dans la province d’Al Haouz et ce, dans le cadre du projet de coopération maroco-allemande-danoise dans le secteur de l’eau « Territoires Durables-Modes de vies durables et résilients au Maroc ». Cette visite, au cours de laquelle M. Baraka était accompagné .', 'size': 3}], 'main_title': 'Al Haouz : Nizar Baraka visite des projets hydrauliques'}, {'community_id': '6', 'articles': [{'id': '19', 'title': 'Le Maroc et la Turquie renforcent leur coopération routière et maritime', 'source': 'lematin.ma', 'link': 'https://lematin.ma/economie/le-maroc-et-la-turquie-renforcent-leur-cooperation-routiere-et-maritime/288059', 'summary': 'Le Maroc et la Turquie renforcent leur coopération routière et maritime. Ces deux MoU ont été signés par le ministre du Transport et de la Logistique, Abdessamad Kayouh, qui conduit une délégation de haut niveau à ce forum international, et son homologu.', 'size': 3}, {'id': '26', 'title': 'Le Maroc et la Turquie signent un accord sur les corridors maritimes', 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/Le-Maroc-et-la-Turquie-signent-un-accord-sur-les-corridors-maritimes_a69266.html', 'summary': "Le Maroc et la Turquie signent un accord sur les corridors maritimes. Le Maroc et la Turquie ont signé, vendredi à Istanbul, en marge du Forum mondial sur la connectivité des transports, deux mémorandums d'entente (MoU) relatifs à la sécurité routière et aux corridors maritimes.", 'size': 3}, {'id': '49', 'title': 'Transport routier et maritime : Rabat et Ankara coopèrent', 'source': 'www.challenge.ma', 'link': 'https://www.challenge.ma/transport-routier-et-maritime-rabat-et-ankara-cooperent-305647/', 'summary': 'Transport routier et maritime : Rabat et Ankara coopèrent. Le Maroc et la Turquie ont signé, vendredi à Istanbul, en marge du Forum mondial sur la connectivité des transports, deux mémorandums d’entente (MoU) relatifs à la sécurité routière et aux corridors maritimes. Ces deux MoU ont été signés par le ministre du Transport et de la Logistique, Abdessamad Kayouh,', 'size': 4}, {'id': '82', 'title': 'Le Maroc et la Turquie signent deux MoU sur la sécurité routière et les corridors maritimes', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/le-maroc-et-la-turquie-signent-deux-mou-sur-la-securite-routiere-et-les-corridors-maritimes/', 'summary': 'Le Maroc et la Turquie signent deux MoU sur la sécurité routière et les corridors maritimes. Le Maroc et la Turquie ont signé, vendredi à Istanbul, en marge du Forum mondial sur la connectivité des transports, deux mémorandums d’entente (MoU) relatifs à la sécurité routière et aux corridors maritimes. Ces deux MoU ont été signés par le ministre du Transport et de la Logistique, Abdessamad Kayouh, qui conduit une délégation de .', 'size': 4}], 'main_title': 'Transport routier et maritime : Rabat et Ankara coopèrent'}, {'community_id': '0', 'articles': [{'id': '21', 'title': 'Zineb Mekouar remporte le prix Henri de Régnier 2025 pour son roman "Souviens-toi des abeilles"', 'source': 'lematin.ma', 'link': 'https://lematin.ma/culture/zineb-mekouar-remporte-le-prix-henri-de-regnier-2025/288060', 'summary': 'Zineb Mekouar remporte le prix Henri de Régnier 2025 pour son roman "Souviens-toi des abeilles". Zineb Mekouar a été récompensée dans la catégorie « Prix de soutien à la création littéraire », selon le palmarès 2025 de l\'Académie Française, dévoilé jeudi. Le palmarès conti.', 'size': 2}, {'id': '46', 'title': 'L’écrivaine marocaine Zineb Mekouar remporte le prix Henri de Régnier', 'source': 'www.challenge.ma', 'link': 'https://www.challenge.ma/lecrivaine-marocaine-zineb-mekouar-remporte-le-prix-henri-de-regnier-305664/', 'summary': 'L’écrivaine marocaine Zineb Mekouar remporte le prix Henri de Régnier. L’écrivaine Zineb Mekouar a remporté le prix Henri de Régnier 2025 de l’Académie Française pour son deuxième roman « Souviens-toi des abeilles », paru dans les éditions Gallimard, a annoncé la prestigieuse institution française qui œuvre pour le rayonnement des lettres. Zineb Mekouar a été récompensée dans la catégorie « Prix de', 'size': 2}], 'main_title': 'Zineb Mekouar remporte le prix Henri de Régnier 2025 pour son roman "Souviens-toi des abeilles"'}, {'community_id': '1', 'articles': [{'id': '34', 'title': "BCIJ : Arrestation d'une extrémiste de Daech en cours de préparation d'un attentat", 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/BCIJ-Arrestation-d-une-extremiste-de-Daech-en-cours-de-preparation-d-un-attentat_a69259.html', 'summary': 'BCIJ : Arrestation d\'une extrémiste de Daech en cours de préparation d\'un attentat. Le Bureau Central d’Investigations Judiciaires (BCIJ) a interpellé, vendredi, sur la base de renseignements précis fournis par la Direction Générale de la Surveillance du Territoire (DGST), une extrémiste affiliée à l\'organisation terroriste "Daech", poursuivant ses études dans l\'un des institut supérieurs techniques, pour son implication présumée dans la préparation et la planification de l\'exécution d’un plan terroriste extrêmement dangereux visant à porter gravement atteinte à l’ordre public.', 'size': 5}, {'id': '51', 'title': 'Rabat : arrestation d’une extrémiste affiliée à «\xa0Daech\xa0»', 'source': 'www.challenge.ma', 'link': 'https://www.challenge.ma/rabat-arrestation-dune-extremiste-affiliee-a-daech-305634/', 'summary': 'Rabat : arrestation d’une extrémiste affiliée à « Daech ». Le Bureau Central d’Investigations Judiciaires (BCIJ) a interpellé, vendredi, sur la base de renseignements précis fournis par la Direction Générale de la Surveillance du Territoire (DGST), une extrémiste affiliée à l’organisation terroriste « Daech », poursuivant ses études dans l’un des institut supérieurs techniques, pour son implication présumée dans la préparation et', 'size': 5}, {'id': '61', 'title': 'Rabat :  Interpellation d’une étudiante affiliée à "Daech" pour plan terroriste avorté (BCIJ)', 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/170246/rabat-interpellation-d-une-etudiante-affiliee.html', 'summary': 'Rabat : Interpellation d’une étudiante affiliée à "Daech" pour plan terroriste avorté (BCIJ). Le Bureau Central d’Investigations Judiciaires (BCIJ) a interpellé, vendredi à Rabat, une étudiante affiliée à lorganisation terroriste "Daech", pour son implication présumée dans la préparation et la planification d’un projet terroriste extrêmement dangereux visant à porter atteinte à l’ordre public.', 'size': 5}, {'id': '63', 'title': 'BCIJ: Interpellation à Rabat d’une extrémiste affiliée à Daech', 'source': 'aujourdhui.ma', 'link': 'https://aujourdhui.ma/actualite/bcij-interpellation-a-rabat-dune-extremiste-affiliee-a-daech', 'summary': 'BCIJ: Interpellation à Rabat d’une extrémiste affiliée à Daech. Le Bureau Central d’Investigations Judiciaires (BCIJ) a interpellé, vendredi, sur la base de renseignements précis fournis par la Direction Générale de la Surveillance du Territoire (DGST), une extrémiste affiliée à l’organisation terroriste « Daech », poursuivant ses études dans l’un des institut supérieurs techniques, pour son implication présumée dans la préparation et la planification de l’exécution d’un .', 'size': 5}, {'id': '81', 'title': 'Rabat : Une extrémiste affiliée à Daech arrêtée pour plan terroriste (BCIJ)', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/rabat-une-extremiste-affiliee-a-daech-arretee-pour-plan-terroriste-bcij/', 'summary': 'Rabat : Une extrémiste affiliée à Daech arrêtée pour plan terroriste (BCIJ). Le Bureau Central d’Investigations Judiciaires (BCIJ) a interpellé, vendredi, sur la base de renseignements précis fournis par la Direction Générale de la Surveillance du Territoire (DGST), une extrémiste affiliée à l’organisation terroriste « Daech », poursuivant ses études dans l’un des institut supérieurs techniques, pour son implication présumée dans la préparation et la planification de l’exécution d’un .', 'size': 5}], 'main_title': "BCIJ : Arrestation d'une extrémiste de Daech en cours de préparation d'un attentat"}, {'community_id': '4', 'articles': [{'id': '43', 'title': 'Benguérir : Interpellation de deux individus pour outrage à des policiers', 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/Benguerir-Interpellation-de-deux-individus-pour-outrage-a-des-policiers_a69249.html', 'summary': "Benguérir : Interpellation de deux individus pour outrage à des policiers. Suite aux informations erronées véhiculées sur des réseaux sociaux faisant état d’une prétendue interpellation arbitraire de deux individus à Benguérir, le Parquet près le tribunal de première instance de Benguérir a indiqué qu'il s'agit, en réalité, d'une interpellation légale de deux personnes en état d'ébriété manifeste, qui ont outragé des éléments de la police, commis des troubles et dégradé des installations à utilité publique.", 'size': 2}, {'id': '60', 'title': 'Benguérir : Deux individus interpellés pour outrage à agents, troubles et dégradations', 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/170247/benguerir-deux-individus-interpelles-pour.html', 'summary': 'Benguérir : Deux individus interpellés pour outrage à agents, troubles et dégradations. Le Parquet près le tribunal de première instance de Benguérir a précisé, vendredi, que l’interpellation de deux individus, relayée de manière erronée sur les réseaux sociaux comme étant arbitraire, s’est déroulée dans un cadre légal.', 'size': 2}], 'main_title': 'Benguérir : Interpellation de deux individus pour outrage à des policiers'}, {'community_id': '2', 'articles': [{'id': '54', 'title': 'Les prévisions du samedi 28 juin', 'source': 'www.challenge.ma', 'link': 'https://www.challenge.ma/les-previsions-du-samedi-28-juin-305620/', 'summary': 'Les prévisions du samedi 28 juin. Voici les prévisions météorologiques établies par la Direction générale de la météorologie pour le samedi 28 juin 2025. -Temps chaud à localement très chaud sur les côtes et les plaines Nord et Centre, les régions de l’Anti-Atlas, l’extrême Sud-Est et l’intérieur des provinces Sud. -Foyers orageux avec ondées ou averses', 'size': 2}, {'id': '84', 'title': "Le temps qu'il fera ce dimanche 29 juin 2025", 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/431025-le-temps-quil-fera-ce-dimanche-29-juin-2025.html', 'summary': "Le temps qu'il fera ce dimanche 29 juin 2025. Voici les prévisions météorologiques établies par la Direction générale de la météorologie pour le dimanche 29 juin 2025 – Temps chaud à localement très chaud sur les côtes et les plaines Nord et Centre, les régions de l’Atlas, l’extrême Sud-Est et l’intérieur des provinces Sud. – Nuages instables avec ondées éparses sur les Haut et . ", 'size': 2}], 'main_title': 'Les prévisions du samedi 28 juin'}, {'community_id': '3', 'articles': [{'id': '59', 'title': 'La diaspora marocaine mobilisée à Lyon pour renforcer la cybersécurité du royaume', 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/170250/diaspora-marocaine-mobilisee-lyon-pour.html', 'summary': 'La diaspora marocaine mobilisée à Lyon pour renforcer la cybersécurité du royaume. Le Consulat général du Maroc à Lyon a organisé une conférence le mercredi 25 juin, réunissant experts en technologies, figures de la diaspora et professionnels de la cybersécurité. Lobjectif : discuter du rôle stratégique des Marocains du monde dans la transition numérique du pays.', 'size': 2}, {'id': '76', 'title': 'Le Consulat du Maroc à Lyon mise sur la diaspora pour accélérer la transition numérique', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/le-consulat-du-maroc-a-lyon-mise-sur-la-diaspora-pour-accelerer-la-transition-numerique/', 'summary': 'Le Consulat du Maroc à Lyon mise sur la diaspora pour accélérer la transition numérique. Le Consulat général du Maroc à Lyon a placé la diaspora marocaine au centre des réflexions stratégiques sur la transformation numérique du Royaume. Une conférence inédite, tenue le 25 juin, a réuni experts, professionnels du numérique, représentants de fédérations sectorielles et membres influents de la communauté marocaine établie en France, autour du thème : « .', 'size': 2}], 'main_title': 'La diaspora marocaine mobilisée à Lyon pour renforcer la cybersécurité du royaume'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
                        
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ? d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        // Fonction pour cacher le tooltip
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = '';
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
    
    
</body>




</html>
    