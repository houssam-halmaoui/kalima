<!DOCTYPE html>
<html lang="ar" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); 
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title"> Les principales actualités des dernières 24 heures

</div>    
        <div class="header-subtitle"> Dernière mise à jour : 21/07/2025 - 06h32</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"></div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '0', 'title': 'Gaza : troisième phase de la campagne marocaine d’aide humanitaire', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/434260-gaza-troisieme-phase-de-la-campagne-marocaine-daide-humanitaire.html', 'summary': 'Gaza : troisième phase de la campagne marocaine d’aide humanitaire. L’Agence Bayt Mal Al-Qods Acharif a procédé, samedi, dans le camp d’Al-Bureij à l’est de Gaza, à la mise en œuvre de la troisième phase de la campagne marocaine d’aide humanitaire destinée aux familles déplacées les plus nécessiteuses de la bande de Gaza, avec le soutien financier de l’Association marocaine d’appui à la reconstruction en . ', 'size': 2}, {'id': '117', 'title': 'L’Agence Bayt Mal Al-Qods Acharif lance la 3e phase de sa campagne d’aide humanitaire dans la bande de Gaza', 'source': 'www.lereporter.ma', 'link': 'https://www.lereporter.ma/lagence-bayt-mal-al-qods-acharif-lance-la-3e-phase-de-sa-campagne-daide-humanitaire-dans-la-bande-de-gaza/', 'summary': 'L’Agence Bayt Mal Al-Qods Acharif lance la 3e phase de sa campagne d’aide humanitaire dans la bande de Gaza. L’Agence Bayt Mal Al-Qods Acharif a procédé, samedi, dans le camp d’Al-Bureij à l’est de Gaza, à la mise en œuvre de la troisième phase de la campagne marocaine d’aide humanitaire destinée aux familles déplacées les plus nécessiteuses de la bande de Gaza, avec le soutien financier de l’Association marocaine d’appui à la reconstruction en ', 'size': 2}], 'main_title': 'Gaza : troisième phase de la campagne marocaine d’aide humanitaire'}, {'community_id': '1', 'articles': [{'id': '16', 'title': 'CHAN : les Lions de Sektioui s’imposent en amical face au Burkina Faso', 'source': 'lematin.ma', 'link': 'https://lematin.ma/sports/chan-les-lions-de-sektioui-simposent-en-amical-face-au-burkina-faso/292217', 'summary': 'CHAN : les Lions de Sektioui s’imposent en amical face au Burkina Faso. La sélection nationale des joueurs locaux a signé, samedi dernier, une belle victoire (2-1) face au Burkina Faso en amical à Kénitra, dans le cadre des préparatifs du CHAN 2024. So.', 'size': 2}, {'id': '46', 'title': 'Match amical : La sélection du Maroc des locaux bat le Burkina Faso', 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/172170/match-amical-selection-maroc-locaux.html', 'summary': 'Match amical : La sélection du Maroc des locaux bat le Burkina Faso. L’équipe nationale des joueurs locaux (natifs de 2000 et plus) s’est imposée face à son homologue du Burkina Faso sur le score de 2 buts à 1, samedi au stade municipal de Kénitra, en match amical.', 'size': 2}], 'main_title': 'CHAN : les Lions de Sektioui s’imposent en amical face au Burkina Faso'}, {'community_id': '2', 'articles': [{'id': '69', 'title': 'Le Maroc est devenu un des centres mondiaux du football (Gianni Infantino)', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/le-maroc-est-devenu-un-des-centres-mondiaux-du-football-gianni-infantino/', 'summary': 'Le Maroc est devenu un des centres mondiaux du football (Gianni Infantino). Le Maroc est devenu un des centres mondiaux du football, a affirmé le président de la Fédération internationale de football (FIFA), Gianni Infantino. « Je suis très content et heureux d’être là. C’est toujours un bonheur et un plaisir d’être ici au Maroc, un pays qui vit et vibre au football tous les jours », a indiqué .', 'size': 3}, {'id': '72', 'title': 'Gianni Infantino: le Maroc est devenu un des centres mondiaux du football', 'source': 'atlasinfo.fr', 'link': 'https://atlasinfo.fr/gianni-infantino-le-maroc-est-devenu-un-des-centres-mondiaux-du-football.html', 'summary': 'Gianni Infantino: le Maroc est devenu un des centres mondiaux du football. Le Maroc est devenu un des centres mondiaux du football, a affirmé le président de la Fédération internationale de football (FIFA), Gianni Infantino. L’article est apparu en premier sur .', 'size': 3}, {'id': '79', 'title': 'Gianni Infantino : « Le Maroc est devenu un des centres mondiaux du football »', 'source': 'lnt.ma', 'link': 'https://lnt.ma/gianni-infantino-le-maroc-est-devenu-un-des-centres-mondiaux-du-football/', 'summary': 'Gianni Infantino : « Le Maroc est devenu un des centres mondiaux du football ». Le président de la Fédération internationale de football association (FIFA), Gianni Infantino, a salué samedi à Rabat le rôle central que joue désormais le Maroc dans le paysage mondial du football, soulignant les avancées remarquables enregistrées par le Royaume tant sur le plan des performances sportives que de l’organisation des compétitions internationales. « Je suis . ', 'size': 3}], 'main_title': 'Le Maroc est devenu un des centres mondiaux du football (Gianni Infantino)'}, {'community_id': '3', 'articles': [{'id': '80', 'title': 'L’UM6P, l’UNESCO et la Fondation OCP lancent une plateforme triangulaire pour les agendas de développement centrés sur l’Afrique', 'source': 'lnt.ma', 'link': 'https://lnt.ma/lum6p-lunesco-et-la-fondation-ocp-lancent-une-plateforme-triangulaire-pour-les-agendas-de-developpement-centres-sur-lafrique/', 'summary': 'L’UM6P, l’UNESCO et la Fondation OCP lancent une plateforme triangulaire pour les agendas de développement centrés sur l’Afrique. L’Université Mohammed VI Polytechnique (UM6P), l’UNESCO et la Fondation OCP ont scellé un partenariat stratégique pour la période 2025-2027 en activant une plateforme triangulaire dédiée aux agendas de développement centrés sur l’Afrique, avec un engagement financier de 6 millions de dollars. L’accord a été signé vendredi à Paris par Mostapha Terrab, président du Groupe OCP, . ', 'size': 2}, {'id': '112', 'title': 'Dédiée aux agendas de développement centrés sur l’Afrique : 6 millions de dollars pour une plateforme signée UM6P-Unesco-Fondation OCP', 'source': 'aujourdhui.ma', 'link': 'https://aujourdhui.ma/economie/dediee-aux-agendas-de-developpement-centres-sur-lafrique-6-millions-de-dollars-pour-une-plateforme-signee-um6p-unesco-fondation-ocp', 'summary': 'Dédiée aux agendas de développement centrés sur l’Afrique : 6 millions de dollars pour une plateforme signée UM6P-Unesco-Fondation OCP. Coopération : L’Université Mohammed VI Polytechnique (UM6P), l’Unesco et la Fondation OCP ont signé, vendredi à Paris, un accord ouvrant un nouveau chapitre de leur collaboration pour la période 2025-2027, en activant une plateforme triangulaire dédiée aux agendas de développement centrés sur l’Afrique, avec un engagement financier de 6 millions de dollars. Signé par Mostapha .', 'size': 2}], 'main_title': 'L’UM6P, l’UNESCO et la Fondation OCP lancent une plateforme triangulaire pour les agendas de développement centrés sur l’Afrique'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
                        
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ? d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        // Fonction pour cacher le tooltip
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = '';
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
    
    
</body>




</html>
    