<!DOCTYPE html>
<html lang="ar" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); 
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title"> Les principales actualités des dernières 24 heures

</div>    
        <div class="header-subtitle"> Dernière mise à jour : 14/07/2025 - 06h29</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"></div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '4', 'articles': [{'id': '30', 'title': 'Dakhla : la plage de Oum Labouir labellisée "Pavillon Bleu" pour la 13e année consécutive', 'source': 'lematin.ma', 'link': 'https://lematin.ma/regions/dakhla-la-plage-de-oum-labouir-labellisee-pavillon-bleu/290781', 'summary': 'Dakhla : la plage de Oum Labouir labellisée "Pavillon Bleu" pour la 13e année consécutive. Attribué annuellement par la Fondation pour l’Éducation à l’Environnement (FEE), le label “Pavillon Bleu” est porté au Maroc depuis 2002 par la Fondation Mohammed VI pour la Protec.', 'size': 2}, {'id': '91', 'title': 'Dakhla : la plage de Oum Labouir labellisée "Pavillon Bleu" pour la 13è année consécutive', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/433169-dakhla-la-plage-de-oum-labouir-labellisee-pavillon-bleu-pour-la-13e-annee-consecutive.html', 'summary': 'Dakhla : la plage de Oum Labouir labellisée "Pavillon Bleu" pour la 13è année consécutive. Le label international « Pavillon Bleu » a été hissé, samedi sur la plage de Oum Labouir à Dakhla, pour la 13è année consécutive. Attribué annuellement par la Fondation pour l’Éducation à l’Environnement (FEE), le label “Pavillon Bleu” est porté au Maroc depuis 2002 par la Fondation Mohammed VI pour la Protection de l’Environnement, présidée par la . ', 'size': 2}], 'main_title': 'Dakhla : la plage de Oum Labouir labellisée "Pavillon Bleu" pour la 13e année consécutive'}, {'community_id': '2', 'articles': [{'id': '31', 'title': 'CAN féminine 2024 : Coup de griffe décisif des Lionnes de l’Atlas', 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/CAN-feminine-2024-Coup-de-griffe-decisif-des-Lionnes-de-l-Atlas_a69810.html', 'summary': 'CAN féminine 2024 : Coup de griffe décisif des Lionnes de l’Atlas. \u200bPortée par une combativité exemplaire et une maîtrise tactique affirmée, la sélection nationale marocaine féminine s’est imposée avec brio face au Sénégal (1-0), samedi soir au stade Olympique de Rabat, validant ainsi son billet pour les quarts de finale de la Coupe d’Afrique des Nations féminine (Maroc-2024). Avec cette deuxième victoire en trois matchs, les Lionnes de l’Atlas terminent en tête du groupe « A », à égalité de points avec la Zambie (7 pts), mais avec une meilleure différence de buts.', 'size': 4}, {'id': '81', 'title': 'CAN féminine Maroc-2024 (Maroc/Sénégal 1-0) : Combatives, les Lionnes de l’Atlas aux quarts de finale', 'source': 'atlasinfo.fr', 'link': 'https://atlasinfo.fr/can-feminine-maroc-2024-maroc-senegal-1-0-combatives-les-lionnes-de-latlas-aux-quarts-de-finale.html', 'summary': 'CAN féminine Maroc-2024 (Maroc/Sénégal 1-0) : Combatives, les Lionnes de l’Atlas aux quarts de finale. La sélection marocaine, qui a fait preuve d’une grande combativité, s’est qualifiée pour les quarts de finale de la Coupe d’Afrique des nations féminine de football (Maroc-2024) en s’imposant face à son homologue sénégalaise sur le score de 1 but à 0, samedi soir au stade Olympique de Rabat, en match de la 3è journée . L’article est apparu en premier sur .', 'size': 4}, {'id': '89', 'title': 'CAN féminine : le Nigéria et l’Algérie en quart de finale', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/433312-can-feminine-le-nigeria-et-lalgerie-en-quart-de-finale.html', 'summary': 'CAN féminine : le Nigéria et l’Algérie en quart de finale. Les sélections nigériane et algérienne se sont qualifiées pour les quarts de finale de la Coupe d’Afrique des nations féminine de football (Maroc-2024), après leur match nul (0-0), dimanche au Stade Larbi Zaouli à Casablanca, pour le compte de la troisième et dernière journée du groupe B. Le Nigéria termine en tête du groupe avec . ', 'size': 4}, {'id': '117', 'title': 'CAN féminine : Le Maroc s’impose face au Sénégal et valide son ticket pour les quarts', 'source': 'lnt.ma', 'link': 'https://lnt.ma/can-feminine-le-maroc-simpose-face-au-senegal-et-valide-son-ticket-pour-les-quarts/', 'summary': 'CAN féminine : Le Maroc s’impose face au Sénégal et valide son ticket pour les quarts. La sélection nationale féminine de football s’est qualifiée pour les quarts de finale de la Coupe d’Afrique des nations féminine (Maroc-2024), en battant le Sénégal (1-0) lors du dernier match de la phase de groupes, samedi soir au stade Olympique de Rabat. Avec cette victoire, les Lionnes de l’Atlas terminent en tête du groupe A . ', 'size': 4}], 'main_title': 'CAN féminine 2024 : Coup de griffe décisif des Lionnes de l’Atlas'}, {'community_id': '6', 'articles': [{'id': '38', 'title': '\u200bVague de chaleur de mardi à vendredi dans plusieurs provinces du Royaume (bulletin d’alerte)', 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/\u200bVague-de-chaleur-de-mardi-a-vendredi-dans-plusieurs-provinces-du-Royaume-bulletin-d-alerte_a69799.html', 'summary': '\u200bVague de chaleur de mardi à vendredi dans plusieurs provinces du Royaume (bulletin d’alerte). Une vague de chaleur est prévue de mardi à vendredi prochain dans plusieurs provinces du Royaume, avec des températures oscillant entre 40 et 47°C, a annoncé la Direction générale de la météorologie (DGM).', 'size': 5}, {'id': '57', 'title': 'Vague de chaleur : Le mercure atteindra 47°C dans plusieurs provinces', 'source': 'aujourdhui.ma', 'link': 'https://aujourdhui.ma/actualite/vague-de-chaleur-le-mercure-atteindra-47c-dans-plusieurs-provinces', 'summary': 'Vague de chaleur : Le mercure atteindra 47°C dans plusieurs provinces. Une vague de chaleur est prévue de mardi à vendredi dans plusieurs provinces du Royaume, avec des températures oscillant entre 40 et 47°C, a annoncé la Direction générale de la météorologie (DGM). Ainsi, des températures variant entre 44 et 47°C seront ainsi enregistrées de mardi à vendredi, dans les provinces d’Errachidia, Zagora, Taroudant, Tata, Assa-Zag, .', 'size': 5}, {'id': '76', 'title': 'Maroc : vague de chaleur de mardi à vendredi dans plusieurs provinces du Royaume', 'source': 'atlasinfo.fr', 'link': 'https://atlasinfo.fr/maroc-vague-de-chaleur-de-mardi-a-vendredi-dans-plusieurs-provinces-du-royaume.html', 'summary': 'Maroc : vague de chaleur de mardi à vendredi dans plusieurs provinces du Royaume. Une vague de chaleur est prévue de mardi à vendredi prochain dans plusieurs provinces du Royaume, avec des températures oscillant entre 40 et 47°C, a annoncé la Direction générale de la météorologie (DGM). Ainsi, des températures variant entre 44 et 47°C seront ainsi enregistrées de mardi à vendredi, dans les provinces d’Errachidia, Zagora, Taroudant, Tata, . L’article est apparu en premier sur .', 'size': 5}, {'id': '112', 'title': 'Vague de chaleur de mardi à vendredi dans plusieurs provinces du Royaume', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/vague-de-chaleur-de-mardi-a-vendredi-dans-plusieurs-provinces-du-royaume-4/', 'summary': 'Vague de chaleur de mardi à vendredi dans plusieurs provinces du Royaume. Une vague de chaleur est prévue de mardi à vendredi prochain dans plusieurs provinces du Royaume, avec des températures oscillant entre 40 et 47°C, a annoncé la Direction générale de la météorologie (DGM). Ainsi, des températures variant entre 44 et 47°C seront ainsi enregistrées de mardi à vendredi, dans les provinces d’Errachidia, Zagora, Taroudant, Tata, .', 'size': 5}, {'id': '119', 'title': 'Météo : Une nouvelle vague de chaleur annoncée', 'source': 'lnt.ma', 'link': 'https://lnt.ma/meteo-une-nouvelle-vague-de-chaleur-annoncee-4/', 'summary': 'Météo : Une nouvelle vague de chaleur annoncée. Une vague de chaleur est prévue de mardi à vendredi prochain dans plusieurs provinces du Royaume, avec des températures oscillant entre 40 et 47°C, a annoncé la Direction générale de la météorologie (DGM). Ainsi, des températures variant entre 44 et 47°C seront ainsi enregistrées de mardi à vendredi, dans les provinces d’Errachidia, Zagora, Taroudant, Tata, . ', 'size': 5}], 'main_title': '\u200bVague de chaleur de mardi à vendredi dans plusieurs provinces du Royaume (bulletin d’alerte)'}, {'community_id': '3', 'articles': [{'id': '50', 'title': 'Plus de 311.600 candidats  décrochent leur baccalauréat en 2025', 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/Plus-de-311-600-candidats-decrochent-leur-baccalaureat-en-2025_a69787.html', 'summary': 'Plus de 311.600 candidats décrochent leur baccalauréat en 2025. Le ministère de l’Éducation nationale, du Préscolaire et des Sports a annoncé, samedi, que 311.625 candidats scolarisés de l’enseignement public et privé ont passé avec succès les épreuves des sessions ordinaire et de rattrapage au titre de l’année 2025.', 'size': 2}, {'id': '71', 'title': 'Plus de 311.600 candidats scolarisés décrochent leur baccalauréat en 2025', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/plus-de-311-600-candidats-scolarises-decrochent-leur-baccalaureat-en-2025/', 'summary': 'Plus de 311.600 candidats scolarisés décrochent leur baccalauréat en 2025. Le ministère de l’Éducation nationale, du Préscolaire et des Sports a annoncé, samedi, que 311.625 candidats scolarisés de l’enseignement public et privé ont passé avec succès les épreuves des sessions ordinaire et de rattrapage au titre de l’année 2025. Le taux de réussite dans les deux sessions a atteint 83,3%, contre 84,1% en 2024, soit .', 'size': 2}], 'main_title': 'Plus de 311.600 candidats  décrochent leur baccalauréat en 2025'}, {'community_id': '5', 'articles': [{'id': '66', 'title': 'Prévisions météorologiques pour le lundi 14 juillet 2025', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/previsions-meteorologiques-pour-le-lundi-14-juillet-2025/', 'summary': 'Prévisions météorologiques pour le lundi 14 juillet 2025. Voici les prévisions météorologiques établies par la Direction générale de la météorologie pour le lundi 14 juillet 2025 : – Hausse des températures avec un temps assez chaud à chaud sur les plaines Nord et Centre, le Saiss, le Sud-Est et l’intérieur des provinces sahariennes. Lire aussi : Le Nigeria et l’UE s’allient pour la promotion .', 'size': 2}, {'id': '83', 'title': "Le temps qu'il fera ce lundi 14 juillet 2025", 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/432782-le-temps-quil-fera-ce-lundi-14-juillet-2025.html', 'summary': "Le temps qu'il fera ce lundi 14 juillet 2025. Voici les prévisions météorologiques établies par la Direction générale de la météorologie pour le lundi 14 juillet 2025 – Hausse des températures avec un temps assez chaud à chaud sur les plaines Nord et Centre, le Saiss, le Sud-Est et l’intérieur des provinces sahariennes. – Nuages bas assez fréquents la matinée et la nuit sur . ", 'size': 2}], 'main_title': 'Prévisions météorologiques pour le lundi 14 juillet 2025'}, {'community_id': '1', 'articles': [{'id': '70', 'title': 'Singapour maintient sa position de premier centre maritime mondial', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/singapour-maintient-sa-position-de-premier-centre-maritime-mondial/', 'summary': 'Singapour maintient sa position de premier centre maritime mondial. Singapour a maintenu sa position en tant que premier centre maritime mondial pour la 12e année consécutive, selon le rapport 2025 de l’Indice de développement des centres maritimes internationaux Xinhua-Baltic (ISCDI). Le pays insulaire de l’Asie du Sud-Est s’est largement démarqué avec un score de 99,50 sur 100, précise le rapport qui évalue les principaux .', 'size': 2}, {'id': '78', 'title': 'Singapour maintient sa position de premier centre maritime mondial (Indice)', 'source': 'atlasinfo.fr', 'link': 'https://atlasinfo.fr/singapour-maintient-sa-position-de-premier-centre-maritime-mondial-indice.html', 'summary': "Singapour maintient sa position de premier centre maritime mondial (Indice). Singapour a maintenu sa position en tant que premier centre maritime mondial pour la 12e année consécutive, selon le rapport 2025 de l'Indice de développement des centres maritimes internationaux Xinhua-Baltic (ISCDI). L’article est apparu en premier sur .", 'size': 2}], 'main_title': 'Singapour maintient sa position de premier centre maritime mondial'}, {'community_id': '0', 'articles': [{'id': '75', 'title': 'Crash d’Air India: L’alimentation en carburant coupée juste avant l’accident', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/crash-dair-india-lalimentation-en-carburant-coupee-juste-avant-laccident/', 'summary': 'Crash d’Air India: L’alimentation en carburant coupée juste avant l’accident. Les interrupteurs d’alimentation en carburant des moteurs du Boeing 787-8 d’Air India, qui s’est écrasé le mois dernier à Ahmedabad, tuant 260 personnes, se sont mis en position « arrêt » quelques instants avant le crash, selon un rapport préliminaire publié samedi par le Bureau indien d’enquête sur les accidents aériens (AAIB). Ce document de 15 pages, .', 'size': 2}, {'id': '77', 'title': 'Crash d’Air India : L’alimentation en carburant coupée juste avant l’accident (Rapport préliminaire)', 'source': 'atlasinfo.fr', 'link': 'https://atlasinfo.fr/crash-dair-india-lalimentation-en-carburant-coupee-juste-avant-laccident-rapport-preliminaire.html', 'summary': 'Crash d’Air India : L’alimentation en carburant coupée juste avant l’accident (Rapport préliminaire). Les interrupteurs d’alimentation en carburant des moteurs du Boeing 787-8 d’Air India qui s’est écrasé le mois dernier à Ahmedabad tuant 260 personnes se sont mis en position « arrêt » quelques instants avant le crash, selon un rapport préliminaire publié samedi par le Bureau indien d’enquête sur les accidents aériens (AAIB). Ce document de 15 pages . L’article est apparu en premier sur .', 'size': 2}], 'main_title': 'Crash d’Air India: L’alimentation en carburant coupée juste avant l’accident'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
                        
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ? d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        // Fonction pour cacher le tooltip
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = '';
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
    
    
</body>




</html>
    