<!DOCTYPE html>
<html lang="ar" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); 
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title"> Les principales actualités des dernières 24 heures

</div>    
        <div class="header-subtitle"> Dernière mise à jour : 10/08/2025 - 18h28</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"></div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '4', 'title': 'Les températures attendues ce dimanche 10 août 2025', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/437115-les-temperatures-attendues-ce-dimanche-10-aout-2025.html', 'summary': 'Les températures attendues ce dimanche 10 août 2025. Voici les températures minimales et maximales prévues par la Direction générale de la météorologie pour le dimanche 10 août 2025 Min Max – Oujda 20 37 – Bouarfa 22 39 – Al Hoceima 22 26 – Tétouan 22 28 – Sebta 23 26 – Mellilia 20 27 – Tanger 23 30 – Kénitra 22 35 . ', 'size': 2}, {'id': '112', 'title': 'Températures prévues pour le lundi 11 août 2025', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/temperatures-prevues-pour-le-lundi-11-aout-2025/', 'summary': 'Températures prévues pour le lundi 11 août 2025. Voici les températures minimales et maximales prévues par la Direction générale de la météorologie pour le lundi 11 août 2025: Min Max – Oujda 20 37 – Bouarfa 24 37 – Al Hoceima 21 28 – Tétouan 22 30 – Sebta 24 27 – Mellilia 23 28 – Tanger 24 37 – Kénitra 22 47 .', 'size': 2}], 'main_title': 'Les températures attendues ce dimanche 10 août 2025'}, {'community_id': '1', 'articles': [{'id': '9', 'title': 'Hakimi : « Notre objectif est un deuxième titre consécutif en Ligue des champions, mais la mission ne sera pas facile »', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/437135-hakimi-notre-objectif-est-un-deuxieme-titre-consecutif-en-ligue-des-champions-mais-la-mission-ne-sera-pas-facile.html', 'summary': 'Hakimi : « Notre objectif est un deuxième titre consécutif en Ligue des champions, mais la mission ne sera pas facile ». L’international marocain du Paris Saint-Germain, Achraf Hakimi, a affirmé que son équipe ne se considérait pas comme la grande favorite pour remporter la Ligue des champions cette saison, malgré son sacre lors de la dernière édition. Dans une interview accordée à Canal+, le Lion de l’Atlas, en lice pour le Ballon d’Or cette année, a souligné . ', 'size': 2}, {'id': '102', 'title': 'Achraf Hakimi : «Je mérite le Ballon d’Or»', 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/173929/achraf-hakimi-merite-ballon-d-or.html', 'summary': 'Achraf Hakimi : «Je mérite le Ballon d’Or». L’international marocain Achraf Hakimi s’est confié sur ses espoirs de remporter le Ballon d’or, après une saison spectaculaire avec le Paris Saint-Germain (PSG). Dans un entretien avec Canal+, samedi, le joueur a évoqué un rêve qui pourrait se réaliser.', 'size': 2}], 'main_title': 'Hakimi : « Notre objectif est un deuxième titre consécutif en Ligue des champions, mais la mission ne sera pas facile »'}, {'community_id': '8', 'articles': [{'id': '11', 'title': "CAN : c'est un moment de rêve de pouvoir jouer avec le Maroc (Hakimi)", 'source': 'lematin.ma', 'link': 'https://lematin.ma/sports/can-cest-un-moment-de-reve-de-pouvoir-jouer-avec-le-maroc-hakimi/295806', 'summary': "CAN : c'est un moment de rêve de pouvoir jouer avec le Maroc (Hakimi). «Le Maroc m’a appelé quand j’étais à l’académie du Real Madrid, c’est le pays de mes parents. J’essaye d’aller à toutes les sélections, de rester prêt pour tout, quand la sélection.", 'size': 3}, {'id': '53', 'title': 'Achraf Hakimi : «\xa0c’est un moment de rêve de pouvoir jouer avec le Maroc pendant la CAN\xa0»', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/achraf-hakimi-cest-un-moment-de-reve-de-pouvoir-jouer-avec-le-maroc-pendant-la-can/', 'summary': 'Achraf Hakimi : « c’est un moment de rêve de pouvoir jouer avec le Maroc pendant la CAN ». La star internationale du Paris Saint-Germain (PSG) et le Lion de l’Atlas, Achraf Hakimi s’est dit fier de jouer au sein de l’équipe nationale marocaine dans différents challenges. «Le Maroc m’a appelé quand j’étais à l’académie du Real Madrid, c’est le pays de mes parents. J’essaye d’aller à toutes les sélections, de rester prêt pour .', 'size': 3}, {'id': '78', 'title': 'Hakimi : "c\'est un moment de rêve de pouvoir jouer avec le Maroc pendant la CAN', 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/437146-hakimi-cest-un-moment-de-reve-de-pouvoir-jouer-avec-le-maroc-pendant-la-can.html', 'summary': 'Hakimi : "c\'est un moment de rêve de pouvoir jouer avec le Maroc pendant la CAN. La star du Paris Saint-Germain (PSG) et le Lion de l’Atlas, Achraf Hakimi s’est dit fier de jouer au sein de l’équipe nationale marocaine dans différents challenges. «Le Maroc m’a appelé quand j’étais à l’académie du Real Madrid, c’est le pays de mes parents. J’essaye d’aller à toutes les sélections, de rester prêt pour tout, . ', 'size': 3}], 'main_title': "CAN : c'est un moment de rêve de pouvoir jouer avec le Maroc (Hakimi)"}, {'community_id': '6', 'articles': [{'id': '15', 'title': 'Message de condoléances de S.M. le Roi à la famille de feu Jamal Eddine Al Qadiri Boutchich, Cheikh de la Tariqa Qadirya Boutchichia', 'source': 'lematin.ma', 'link': 'https://lematin.ma/activites-royales/message-de-sm-le-roi-a-la-famille-de-feu-jamal-eddine-al-qadiri-boutchich/295789', 'summary': "Message de condoléances de S.M. le Roi à la famille de feu Jamal Eddine Al Qadiri Boutchich, Cheikh de la Tariqa Qadirya Boutchichia. Dans ce message, S.M. le Roi affirme avoir appris avec une profonde affliction la triste nouvelle de la disparition du Cheikh Jamal Eddine Al Qadiri Boutchich, que Dieu l'agrée.", 'size': 2}, {'id': '92', 'title': 'Message de condoléances de SM le Roi à la famille de feu Jamal Eddine Al Qadiri Boutchich, Cheikh de la Tariqa Qadirya Boutchichia', 'source': 'www.lopinion.ma', 'link': 'https://www.lopinion.ma/Message-de-condoleances-de-SM-le-Roi-a-la-famille-de-feu-Jamal-Eddine-Al-Qadiri-Boutchich-Cheikh-de-la-Tariqa-Qadirya_a70704.html', 'summary': 'Message de condoléances de SM le Roi à la famille de feu Jamal Eddine Al Qadiri Boutchich, Cheikh de la Tariqa Qadirya Boutchichia. SM le Roi Mohammed VI a adressé un message de condoléances et de compassion aux membres de la famille du Cheikh de la Tariqa Qadirya Boutchichia, Jamal Eddine Al Qadiri Boutchich.', 'size': 2}], 'main_title': 'Message de condoléances de S.M. le Roi à la famille de feu Jamal Eddine Al Qadiri Boutchich, Cheikh de la Tariqa Qadirya Boutchichia'}, {'community_id': '2', 'articles': [{'id': '34', 'title': 'En plein été, l’Éducation nationale et les syndicats se rencontrent pour aplanir les divergences', 'source': 'www.challenge.ma', 'link': 'https://www.challenge.ma/en-plein-ete-leducation-nationale-et-les-syndicats-se-rencontrent-pour-aplanir-les-divergences-308333/', 'summary': 'En plein été, l’Éducation nationale et les syndicats se rencontrent pour aplanir les divergences. Alors que la saison des vacances estivales bat son plein, le ministère de l’Éducation nationale, du Préscolaire et des Sports et les cinq syndicats de l’enseignement les plus représentatifs ont tenu une réunion du Comité supérieur du dialogue social sectoriel, histoire d’aborder la prochaine rentrée dans une atmosphère plus apaisée.', 'size': 2}, {'id': '50', 'title': 'Ministère de l’Éducation nationale-Syndicats : Réunion de suivi de l’application des accords de décembre 2023', 'source': 'www.lavieeco.com', 'link': 'https://www.lavieeco.com/au-royaume/ministere-de-leducation-nationale-syndicats-reunion-de-suivi-de-lapplication-des-accords-de-decembre-2023/', 'summary': 'Ministère de l’Éducation nationale-Syndicats : Réunion de suivi de l’application des accords de décembre 2023. Une réunion du Comité supérieur du dialogue social sectoriel entre le ministère de l’Éducation nationale, du Préscolaire et des Sports et les cinq syndicats de l’enseignement les plus représentatifs s’est tenue, mercredi dernier, pour faire le point sur la mise en œuvre des accords des 10 et 26 décembre 2023 ainsi que sur l’application du statut particulier des fonctionnaires de ce Département.', 'size': 3}, {'id': '55', 'title': 'Réunion entre le ministère de l’Éducation nationale et les syndicats pour suivre l’application des accords de décembre 2023', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/reunion-entre-le-ministere-de-leducation-nationale-et-les-syndicats-pour-suivre-lapplication-des-accords-de-decembre-2023/', 'summary': 'Réunion entre le ministère de l’Éducation nationale et les syndicats pour suivre l’application des accords de décembre 2023. Une réunion du Comité supérieur du dialogue social sectoriel entre le ministère de l’Éducation nationale, du Préscolaire et des Sports et les cinq syndicats de l’enseignement les plus représentatifs s’est tenue, mercredi dernier, pour faire le point sur la mise en œuvre des accords des 10 et 26 décembre 2023 ainsi que sur l’application du .', 'size': 2}], 'main_title': 'Ministère de l’Éducation nationale-Syndicats : Réunion de suivi de l’application des accords de décembre 2023'}, {'community_id': '5', 'articles': [{'id': '40', 'title': 'Maroc\xa0: les dépôts bancaires enregistrent une croissance à fin juin', 'source': 'www.challenge.ma', 'link': 'https://www.challenge.ma/maroc-les-depots-bancaires-enregistrent-une-croissance-a-fin-juin-308295/', 'summary': 'Maroc : les dépôts bancaires enregistrent une croissance à fin juin. Les dépôts auprès des banques se sont établis à 1 309 milliards de DH (MMDH) à fin juin 2025, enregistrant une hausse annuelle de 9,6%, indique Bank Al-Maghrib (BAM) dans son récent tableau de bord «Crédits-Dépôts bancaires». Dans le détail, les dépôts des ménages ont progressé de 6,6% pour atteindre', 'size': 2}, {'id': '68', 'title': 'BAM : Le crédit bancaire en progression de 5,8% à fin juin', 'source': 'lnt.ma', 'link': 'https://lnt.ma/bam-le-credit-bancaire-en-progression-de-58-a-fin-juin/', 'summary': 'BAM : Le crédit bancaire en progression de 5,8% à fin juin. L’encours du crédit bancaire a atteint 1.175,5 milliards de dirhams (MMDH) à fin juin 2025, en progression de 5,8 % sur un an, selon le tableau de bord « Crédits-Dépôts bancaires » publié par Bank Al-Maghrib (BAM). Cette évolution recouvre une hausse de 4,4 % des crédits aux agents non financiers et de 13,3 % . ', 'size': 2}], 'main_title': 'Maroc\xa0: les dépôts bancaires enregistrent une croissance à fin juin'}, {'community_id': '3', 'articles': [{'id': '52', 'title': 'Journée nationale des MRE : La digitalisation au centre des priorités', 'source': 'www.lavieeco.com', 'link': 'https://www.lavieeco.com/au-royaume/journee-nationale-des-mre-la-digitalisation-au-centre-des-priorites/', 'summary': 'Journée nationale des MRE : La digitalisation au centre des priorités. Le Maroc célèbre, dimanche, la Journée nationale des Marocains résidant à l\'étranger (MRE) sous le thème "Le chantier de la digitalisation : un levier pour renforcer les services de proximité au profit des Marocains du Monde".', 'size': 2}, {'id': '65', 'title': 'Journée nationale des Marocains résidant à l’étranger sous le signe de la digitalisation', 'source': 'atlasinfo.fr', 'link': 'https://atlasinfo.fr/journee-nationale-des-marocains-residant-a-letranger-sous-le-signe-de-la-digitalisation.html', 'summary': 'Journée nationale des Marocains résidant à l’étranger sous le signe de la digitalisation. Le Maroc célèbre dimanche la Journée nationale des Marocains résidant à l’étranger (MRE) sous le thème « Le chantier de la digitalisation : un levier pour renforcer les services de proximité au profit des Marocains du Monde », une occasion idoine pour renforcer les liens entre les MRE et leur pays d’origine, particulièrement dans un contexte marqué . L’article est apparu en premier sur .', 'size': 2}], 'main_title': 'Journée nationale des MRE : La digitalisation au centre des priorités'}, {'community_id': '4', 'articles': [{'id': '74', 'title': "CHAN 2025 : Le Maroc s'incline face au Kenya", 'source': 'fr.hespress.com', 'link': 'https://fr.hespress.com/437151-chan-2025-le-maroc-sincline-face-au-kenya.html', 'summary': "CHAN 2025 : Le Maroc s'incline face au Kenya. La sélection marocaine des joueurs locaux s’est inclinée face à son homologue kényane par 1 but à 0, en match de la 3è journée du groupe A du Championnat d’Afrique des nations (CHAN-2024), dimanche à Nairobi. Ambitieux de décrocher les trois points de la victoire, les éléments nationaux ont, dès l’entame de la rencontre, tenté . ", 'size': 3}, {'id': '83', 'title': 'CHAN 2025 : le Maroc s’incline face au Kenya (1-0)', 'source': 'lematin.ma', 'link': 'https://lematin.ma/sports/chan-2025-le-maroc-sincline-face-au-kenya-1-0/295875', 'summary': 'CHAN 2025 : le Maroc s’incline face au Kenya (1-0). Dans un match crucial de la troisième journée du groupe A du Championnat d’Afrique des Nations (CHAN) 2025, le Maroc s’est incliné 1-0 face au Kenya, pays co-organisateur, au Moi I.', 'size': 3}, {'id': '101', 'title': 'CHAN 2024 : Le Maroc encaisse une défaite face au Kenya', 'source': 'www.yabiladi.com', 'link': 'https://www.yabiladi.com/articles/details/173946/chan-2024-maroc-encaisse-defaite.html', 'summary': 'CHAN 2024 : Le Maroc encaisse une défaite face au Kenya. Les Lions de l’Atlas ont encaissé une défaite face au Kenya par 1 but à 0, en match de la troisième journée du groupe A du Championnat d’Afrique des nations (CHAN 2024), disputé dimanche au stade Kasarani à Nairobi.', 'size': 3}], 'main_title': "CHAN 2025 : Le Maroc s'incline face au Kenya"}, {'community_id': '7', 'articles': [{'id': '111', 'title': 'France : le gouvernement Bayrou veut supprimer deux jours fériés pour économiser 4,2 milliards dès 2026', 'source': 'maroc-diplomatique.net', 'link': 'https://maroc-diplomatique.net/france-le-gouvernement-bayrou-veut-supprimer-deux-jours-feries/', 'summary': 'France : le gouvernement Bayrou veut supprimer deux jours fériés pour économiser 4,2 milliards dès 2026. Le gouvernement français souhaite économiser 4,2 milliards d’euros dès 2026 en proposant la suppression de deux jours fériés, évoquée par le Premier ministre François Bayrou le 15 juillet dernier pour participer à l’effort budgétaire. Dans un document d’orientation adressé aux partenaires sociaux, relayé dimanche par la presse, le gouvernement Bayrou fait part de son intention .', 'size': 2}, {'id': '114', 'title': 'Le gouvernement Bayrou mise sur la suppression de deux jours fériés pour économiser 4,2 milliards d’euros dès 2026', 'source': 'atlasinfo.fr', 'link': 'https://atlasinfo.fr/le-gouvernement-bayrou-mise-sur-la-suppression-de-deux-jours-feries-pour-economiser-42-milliards-deuros-des-2026.html', 'summary': 'Le gouvernement Bayrou mise sur la suppression de deux jours fériés pour économiser 4,2 milliards d’euros dès 2026. Le gouvernement français souhaite économiser 4,2 milliards d’euros dès 2026 en proposant la suppression de deux jours fériés, évoquée par le Premier ministre François Bayrou le 15 juillet dernier pour participer à l’effort budgétaire. Dans un document d’orientation adressé aux partenaires sociaux, relayé dimanche par la presse, le gouvernement Bayrou fait part de son intention . L’article est apparu en premier sur .', 'size': 2}], 'main_title': 'France : le gouvernement Bayrou veut supprimer deux jours fériés pour économiser 4,2 milliards dès 2026'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
                        
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ? d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        // Fonction pour cacher le tooltip
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = '';
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
    
    
</body>




</html>
    