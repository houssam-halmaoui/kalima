<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 15/08/2025 - 18h28</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '6', 'articles': [{'id': '0', 'title': '50 قتيلا جراء أمطار غزيرة بباكستان', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/50-%d9%82%d8%aa%d9%8a%d9%84%d8%a7-%d8%ac%d8%b1%d8%a7%d8%a1-%d8%a3%d9%85%d8%b7%d8%a7%d8%b1-%d8%ba%d8%b2%d9%8a%d8%b1%d8%a9-%d8%a8%d8%a8%d8%a7%d9%83%d8%b3%d8%aa%d8%a7%d9%86-1609252.html', 'summary': '50 قتيلا جراء أمطار غزيرة بباكستان. قتل 50 شخصا على الأقل خلال 24 ساعة جراء الأمطار الغزيرة في شمال باكستان، حسبما أعلنت هيئات إدارة الكوارث اليوم الجمعة. وسُجلت غالبية الوفيات في ولاية خيبر بختونخوا الجبلية حيث قضى 43 شخصا، بحسب هيئة إدارة الكوارث في الولاية. وقُتل سبعة أشخاص في الشطر الذي تديره باكستان من كشمير، وفق هيئة إدارة الكوارث في الإقليم.  50 قتيلا جراء أمطار غزيرة بباكستان     - هسبريس جريدة إلكترونية مغربية .', 'size': 2}, {'id': '170', 'title': 'مصرع 50 شخصا جراء أمطار غزيرة في شمال باكستان', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%85%d8%b5%d8%b1%d8%b9-50-%d8%b4%d8%ae%d8%b5%d8%a7-%d8%ac%d8%b1%d8%a7%d8%a1-%d8%a3%d9%85%d8%b7%d8%a7%d8%b1-%d8%ba%d8%b2%d9%8a%d8%b1%d8%a9-%d9%81%d9%8a-%d8%b4%d9%85%d8%a7%d9%84-%d8%a8%d8%a7%d9%83/', 'summary': 'مصرع 50 شخصا جراء أمطار غزيرة في شمال باكستان. أعلنت هيئات إدارة الكوارث في باكستان، اليوم الجمعة، أن 50 شخصا على الأقل لقوا مصرعهم خلال الساعات الأربع والعشرين الماضية، جراء أمطار غزيرة ضربت شمال البلاد. وأوضحت السلطات أن غالبية الضحايا سجلت في ولاية خيبر بختونخوا الجبلية، حيث توفي 43 شخصا، فيما قتل سبعة آخرون في الشطر الذي تديره باكستان من إقليم كشمير.  مصرع 50 شخصا جراء أمطار غزيرة في شمال باكستان     .', 'size': 2}], 'main_title': '50 قتيلا جراء أمطار غزيرة بباكستان'}, {'community_id': '1', 'articles': [{'id': '17', 'title': 'حادث خطير بالمحمدية.. سقوط سيارة من فوق قنطرة “صابليط” بسبب السرعة المفرطة', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-649585.html', 'summary': 'حادث خطير بالمحمدية.. سقوط سيارة من فوق قنطرة “صابليط” بسبب السرعة المفرطة. هبة بريس شهدت مدينة المحمدية في الساعات الأولى من صباح اليوم الجمعة حادث سير مروع، بعد سقوط سيارة خفيفة من نوع "ديكابوطابل" من فوق قنطرة صابليط، ما أدى إلى انقلابها واستقرارها في مجرى الواد أسفل الجسر. وبحسب المعطيات الأولية، فإن السرعة المفرطة كانت السبب الرئيسي وراء الحادث، حيث فقد السائق السيطرة على السيارة، التي كانت على متنها ثلاثة أشخاص، مما أدى إلى انزلاقها وسقوطها بشكل خطير. وقد تدخلت عناصر الوقاية المدنية والسلطات المحلية على وجه السرعة، حيث تم نقل المصابين إلى المستشفى لتلقي العلاجات الضرورية، كما فتح تحقيق للكشف عن ظروف الحادث', 'size': 2}, {'id': '178', 'title': 'ثلاثة مصابين في سقوط سيارة ديكابوطابل من فوق قنطرة بالمحمدية', 'source': 'rue20.com', 'link': 'https://rue20.com/928773.html', 'summary': 'ثلاثة مصابين في سقوط سيارة ديكابوطابل من فوق قنطرة بالمحمدية.  | متابعة شهدت مدينة المحمدية، في الساعات الأولى من صباح اليوم الجمعة، حادثة سير خطيرة بعدما هوت سيارة من نوع “ديكابوطابل” من أعلى قنطرة صابليط، لتسقط في الوادي أسفلها. الحادث أسفر عن إصابة ثلاثة أشخاص كانوا على متن السيارة، وُصفت حالتهم بالخطيرة، حيث جرى نقلهم على وجه السرعة إلى المستشفى لتلقي العلاجات الضرورية. الخبر ثلاثة مصابين في سقوط سيارة ديكابوطابل من فوق قنطرة بالمحمدية  .', 'size': 2}], 'main_title': 'حادث خطير بالمحمدية.. سقوط سيارة من فوق قنطرة “صابليط” بسبب السرعة المفرطة'}, {'community_id': '2', 'articles': [{'id': '71', 'title': 'تسمم كحولي في الكويت يودي بحياة 13 شخصاً ويصيب العشرات بعاهات خطيرة', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/last/411040.html', 'summary': 'تسمم كحولي في الكويت يودي بحياة 13 شخصاً ويصيب العشرات بعاهات خطيرة. أعلنت وزارة الصحة الكويتية وفاة 13 شخصاً منذ السبت الماضي نتيجة تسمم كحولي ناتج عن تناول مشروبات ملوثة بمادة الميثانول، فيما يتلقى العشرات رعاية طبية', 'size': 2}, {'id': '236', 'title': 'الكويت.. ارتفاع حالات التسمم والوفيات الناتجة عن مشروبات كحولية فاسدة', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d9%83%d9%88%d9%8a%d8%aa-%d8%a7%d8%b1%d8%aa%d9%81%d8%a7%d8%b9-%d8%ad%d8%a7%d9%84%d8%a7%d8%aa-%d8%a7%d9%84%d8%aa%d8%b3%d9%85%d9%85-%d9%88%d8%a7%d9%84%d9%88%d9%81%d9%8a%d8%a7%d8%aa-%d8%a7/', 'summary': 'الكويت.. ارتفاع حالات التسمم والوفيات الناتجة عن مشروبات كحولية فاسدة. ارتفعت حالات التسمم الناتج عن مشروبات كحولية ملوثة بالميثانول في الكويت، إلى 160 حالة، حيث تم تسجيل معظم هذه الحالات لدى بعض الأجانب. وفي بيان جديد لها، أشارت وزارة الصحة الكويتية، إلى أنه تم تسجيل 23 حالة وفاة، لافتة إلى أن جميع الإصابات من جنسيات أسيوية. وأوضحت “الصحة الكويتية” أن معظم الحالات في …  الكويت.. ارتفاع حالات التسمم والوفيات الناتجة عن مشروبات كحولية فاسدة     .', 'size': 2}], 'main_title': 'تسمم كحولي في الكويت يودي بحياة 13 شخصاً ويصيب العشرات بعاهات خطيرة'}, {'community_id': '3', 'articles': [{'id': '119', 'title': 'تشريع جديد بحلول إنسانية وعلمية.. المغرب يطلق استراتيجية وطنية للحد من ظاهرة الكلاب الضالة', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/411088.html', 'summary': 'تشريع جديد بحلول إنسانية وعلمية.. المغرب يطلق استراتيجية وطنية للحد من ظاهرة الكلاب الضالة. في مواجهة استفحال ظاهرة الحيوانات الضالة، خاصة الكلاب، أطلق المغرب ورشًا تشريعيًا جديدًا يقوم على حلول علمية وإنسانية مستدامة، مستلهِمًا التجارب الدولية الناجحة وتوصيات المنظمة', 'size': 2}, {'id': '336', 'title': 'القانون 19.25.. مشروع لتحقيق التوازن بين حماية الحيوانات الضالة وسلامة المواطنين', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1092967.html', 'summary': 'القانون 19.25.. مشروع لتحقيق التوازن بين حماية الحيوانات الضالة وسلامة المواطنين. في خطوة تشريعية فارقة، وضع المغرب مشروع القانون رقم 19.25 المتعلق بحماية الحيوانات الضالة والوقاية من أخطارها، والذي يهدف إلى معالجة ظاهرة انتشار هذه الحيوانات عبر رؤية متوازنة تجمع بين ضمان سلامة المواطنين وصحتهم، وتطبيق معايير الرفق بالحيوان. يأتي هذا المشروع استجابة للجدل المجتمعي المتنامي والحوادث المتكررة المرتبطة بهجمات الكلاب الضالة وما ينجم عنها من ظهرت المقالة القانون 19.25.. مشروع لتحقيق التوازن بين حماية الحيوانات الضالة وسلامة المواطنين  .', 'size': 2}], 'main_title': 'تشريع جديد بحلول إنسانية وعلمية.. المغرب يطلق استراتيجية وطنية للحد من ظاهرة الكلاب الضالة'}, {'community_id': '4', 'articles': [{'id': '123', 'title': 'تخلاو على جثة حدى السبيطار.. أمن أكادير يوقف شخصين بشبهة التورط في وفاة مشكوك فيها', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%aa%d8%ae%d9%84%d8%a7%d9%88-%d8%b9%d9%84%d9%89-%d8%ac%d8%ab%d8%a9-%d8%ad%d8%af%d9%89-%d8%a7%d9%84%d8%b3%d8%a8%d9%8a%d8%b7%d8%a7%d8%b1-%d8%a3%d9%85%d9%86-%d8%a3%d9%83%d8%a7%d8%af%d9%8a%d8%b1/', 'summary': 'تخلاو على جثة حدى السبيطار.. أمن أكادير يوقف شخصين بشبهة التورط في وفاة مشكوك فيها. تمكنت عناصر المصلحة الولائية للشرطة القضائية بمدينة أكادير بتنسيق مع مصالح المديرية العامة لمراقبة التراب الوطني، في الساعات الأولى من صباح اليوم الجمعة (15 غشت)، من توقيف شخصين يبلغان من العمر 42 و51 سنة، للاشتباه في تورطهما في وفاة مشكوك فيها والتخلي عن الجثة بالقرب من أحد المستشفيات العمومية. وأفاد مصدر أمني، أنه حسب المعلومات', 'size': 2}, {'id': '298', 'title': 'العثور على جثة سيدة قرب مستشفى يستنفر أمن أكادير والتحريات تكشف عن مفاجأة', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/411090.html', 'summary': 'العثور على جثة سيدة قرب مستشفى يستنفر أمن أكادير والتحريات تكشف عن مفاجأة. تمكنت عناصر المصلحة الولائية للشرطة القضائية بمدينة أكادير بتنسيق مع مصالح المديرية العامة لمراقبة التراب الوطني، في الساعات الأولى من صباح اليوم الجمعة 15 غشت', 'size': 2}], 'main_title': 'تخلاو على جثة حدى السبيطار.. أمن أكادير يوقف شخصين بشبهة التورط في وفاة مشكوك فيها'}, {'community_id': '5', 'articles': [{'id': '167', 'title': 'الأمن يكشف لغز وفاة سيدة والتخلي عن جثتها قرب مستشفى بأكادير', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a7%d9%84%d8%a3%d9%85%d9%86-%d9%8a%d9%83%d8%b4%d9%81-%d9%84%d8%ba%d8%b2-%d9%88%d9%81%d8%a7%d8%a9-%d8%b3%d9%8a%d8%af%d8%a9-%d9%88%d8%a7%d9%84%d8%aa%d8%ae%d9%84%d9%8a-%d8%b9%d9%86-%d8%ac%d8%ab%d8%aa/', 'summary': 'الأمن يكشف لغز وفاة سيدة والتخلي عن جثتها قرب مستشفى بأكادير. أفاد مصدر أمني أن عناصر المصلحة الولائية للشرطة القضائية بمدينة أكادير، بتنسيق مع مصالح المديرية العامة لمراقبة التراب الوطني، تمكنت في الساعات الأولى من صباح اليوم الجمعة 15 غشت الجاري، من توقيف شخصين يبلغان من العمر 42 و51 سنة، وذلك للاشتباه في تورطهما في وفاة مشكوك فيها والتخلي عن الجثة بالقرب من أحد المستشفيات العمومية.  الأمن يكشف لغز وفاة سيدة والتخلي عن جثتها قرب مستشفى بأكادير     .', 'size': 2}, {'id': '374', 'title': 'الديستي والشرطة القضائية بأكادير يفكّان لغز جثة غامضة تُركت قرب مستشفى عمومي', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/225975/', 'summary': 'الديستي والشرطة القضائية بأكادير يفكّان لغز جثة غامضة تُركت قرب مستشفى عمومي. في عملية أمنية دقيقة، تمكنت عناصر المصلحة الولائية للشرطة القضائية بمدينة أكادير، بتنسيق وثيق مع مصالح المديرية العامة لمراقبة التراب الوطني (الديستي)، في الساعات الأولى من صباح اليوم الجمعة 15 غشت الجاري، من توقيف شخصين يبلغان من العمر 42 و51 سنة، للاشتباه في تورطهما في قضية وفاة مشبوهة والتخلي عن جثة بالقرب من أحد المستشفيات', 'size': 2}], 'main_title': 'الأمن يكشف لغز وفاة سيدة والتخلي عن جثتها قرب مستشفى بأكادير'}, {'community_id': '7', 'articles': [{'id': '171', 'title': 'توقعات الطقس.. سحب مصحوبة بكتل ضبابية بعدد من المناطق', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%aa%d9%88%d9%82%d8%b9%d8%a7%d8%aa-%d8%a3%d8%ad%d9%88%d8%a7%d9%84-%d8%a7%d9%84%d8%b7%d9%82%d8%b3-%d8%aa%d8%b4%d9%83%d9%84-%d8%b3%d8%ad%d8%a8-%d9%85%d8%b1%d9%81%d9%88%d9%82%d8%a9-%d8%a8%d9%83%d8%aa/', 'summary': 'توقعات الطقس.. سحب مصحوبة بكتل ضبابية بعدد من المناطق. تتوقع المديرية العامة للأرصاد الجوية، اليوم الجمعة، أن یظل الطقس حارا شیئا ما إلى حار محلیا بكل من السھول الداخلیة، والجنوب-الشرقي للبلاد وداخل الأقالیم الصحراویة. ويرتقب، خلال الصباح واللیل، تشكل سحب منخفضة مرفوقة بكتل من الضباب أو ببعض الأمطار الجد خفیفة وذلك بالقرب من سواحل المحیط الأطلسي وسواحل البحر الأبیض المتوسط، مع نزول زخات مطریة  توقعات الطقس.. سحب مصحوبة بكتل ضبابية بعدد من المناطق     .', 'size': 2}, {'id': '241', 'title': 'توقعات أحوال الطقس في العديد من مناطق المملكة اليوم الجمعة', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%aa%d9%88%d9%82%d8%b9%d8%a7%d8%aa-%d8%a3%d8%ad%d9%88%d8%a7%d9%84-%d8%a7%d9%84%d8%b7%d9%82%d8%b3-%d9%81%d9%8a-%d8%a7%d9%84%d8%b9%d8%af%d9%8a%d8%af-%d9%85%d9%86-%d9%85%d9%86%d8%a7%d8%b7%d9%82-99/', 'summary': 'توقعات أحوال الطقس في العديد من مناطق المملكة اليوم الجمعة. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليومه الجمعة، أن یظل الطقس حارا شیئا ما إلى حار محلیا بكل من السھول الداخلیة، والجنوب-الشرقي للبلاد وداخل الأقالیم الصحراویة. كما يرتقب، خلال الصباح واللیل، تشكل سحب منخفضة مرفوقة بكتل من الضباب أو ببعض الأمطار الجد خفیفة وذلك بالقرب من سواحل المحیط الأطلسي وسواحل البحر الأبیض المتوسط، …  توقعات أحوال الطقس في العديد من مناطق المملكة اليوم الجمعة     .', 'size': 2}], 'main_title': 'توقعات الطقس.. سحب مصحوبة بكتل ضبابية بعدد من المناطق'}, {'community_id': '0', 'articles': [{'id': '219', 'title': 'مؤسسة محمد السادس للعلوم والصحة تجري أول عملية زراعة كلية مع عدم توافق فصائل الدم ABO', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/225953/', 'summary': 'مؤسسة محمد السادس للعلوم والصحة تجري أول عملية زراعة كلية مع عدم توافق فصائل الدم ABO. أعلنت مؤسسة محمد السادس للعلوم والصحة، اليوم الثلاثاء بالدار البيضاء، عن إجراء بنجاح، أول عملية زراعة كلية مع عدم توافق فصائل الدم ABO على مستوى القارة الإفريقية. ويعد هذا التدخل الجراحي الهام ، الذي مكن من زراعة كلية بين متبرع ومتلق غير متطابقين في فصيلة الدم ، تقدما طبيا كبيرا، وثمرة تنسيق وثيق بين مصالح', 'size': 2}, {'id': '231', 'title': 'الأولى بإفريقيا: أول عملية زراعة كلْية مع عدم توافق فصائل الدم', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%a7%d9%84%d8%a3%d9%88%d9%84%d9%89-%d8%a8%d8%a5%d9%81%d8%b1%d9%8a%d9%82%d9%8a%d8%a7-%d8%a3%d9%88%d9%84-%d8%b9%d9%85%d9%84%d9%8a%d8%a9-%d8%b2%d8%b1%d8%a7%d8%b9%d8%a9-%d9%83%d9%84%d9%92%d9%8a%d8%a9/', 'summary': 'الأولى بإفريقيا: أول عملية زراعة كلْية مع عدم توافق فصائل الدم. المساء اليوم – الدار البيضاء: أعلنت مؤسسة محمد السادس للعلوم والصحة، يوم الثلاثاء بالدار البيضاء، عن إجراء بنجاح، أول عملية زراعة كلية مع عدم توافق فصائل الدم ABO على مستوى القارة الإفريقية. وتمت عملية زراعة', 'size': 2}], 'main_title': 'مؤسسة محمد السادس للعلوم والصحة تجري أول عملية زراعة كلية مع عدم توافق فصائل الدم ABO'}, {'community_id': '8', 'articles': [{'id': '300', 'title': 'نشرة إنذارية: موجة حر مع "الشركي" وزخات رعدية من الجمعة إلى الاثنين بعدد من مناطق المملكة', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/national/411093.html', 'summary': 'نشرة إنذارية: موجة حر مع "الشركي" وزخات رعدية من الجمعة إلى الاثنين بعدد من مناطق المملكة. أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل موجة حر مع "الشركي"، من اليوم الجمعة إلى غاية الاثنين المقبل، وزخات رعدية مصحوبة بتساقط للبرد وبهبات', 'size': 2}, {'id': '347', 'title': 'موجة حر مع “الشركي” من الجمعة إلى الاثنين بعدد من مناطق المملكة', 'source': 'soltana.ma', 'link': 'https://soltana.ma/1357647.html', 'summary': 'موجة حر مع “الشركي” من الجمعة إلى الاثنين بعدد من مناطق المملكة. أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل موجة حر مع «الشركي»، من اليوم الجمعة إلى غاية الاثنين المقبل، وزخات رعدية مصحوبة بتساقط للبرد وبهبات رياح، اليوم، بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة برتقالي، أنه من المرتقب تسجيل درجات حرارة تتراوح ما بين 42 و46 درجة، اليوم الجمعة، بكل', 'size': 3}, {'id': '392', 'title': 'نشرة إنذارية.. موجة حر مع الشركي وزخات رعدية بعدد من مناطق المملكة', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%86%d8%b4%d8%b1%d8%a9-%d8%a5%d9%86%d8%b0%d8%a7%d8%b1%d9%8a%d8%a9-%d9%85%d9%88%d8%ac%d8%a9-%d8%ad%d8%b1-%d9%85%d8%b9-%d8%a7%d9%84%d8%b4%d8%b1%d9%83%d9%8a-%d9%88%d8%b2%d8%ae%d8%a7%d8%aa-%d8%b1/', 'summary': 'نشرة إنذارية.. موجة حر مع الشركي وزخات رعدية بعدد من مناطق المملكة. كشفت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل موجة حر مع “الشركي”، من اليوم الجمعة إلى غاية الاثنين المقبل، وزخات رعدية مصحوبة بتساقط للبرد وبهبات رياح، اليوم، بعدد من مناطق المملكة. وأضافت المديرية، في نشرة إنذارية من مستوى يقظة برتقالي، أنه من المرتقب تسجيل درجات حرارة تتراوح ما بين 42 و46 درجة، اليوم …  نشرة إنذارية.. موجة حر مع الشركي وزخات رعدية بعدد من مناطق المملكة     .', 'size': 2}], 'main_title': 'موجة حر مع “الشركي” من الجمعة إلى الاثنين بعدد من مناطق المملكة'}, {'community_id': '9', 'articles': [{'id': '358', 'title': 'في زيارة إلى شفشاون.. أطفال القدس يتعرفون على محطة من محطات تاريخ المغرب', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/472820.html', 'summary': 'في زيارة إلى شفشاون.. أطفال القدس يتعرفون على محطة من محطات تاريخ المغرب. و.م.ع قام أطفال القدس، أمس الخميس، في إطار فعاليات الدورة 16 للمخيم الصيفي المنظم لفائدتهم، تحت الرعاية السامية للملك محمد السادس، بزيارة لمدينة شفشاون، محطة من المحطات التي يقفون فيها على تاريخ المغرب طيلة إقامتهم بالمملكة. وتعتبر مدينة شفشاون محطة مهمة في برنامج دورة “حارة المغاربة” للمخيم الصيفي لأطفال القدس، تعرف خلالها الأطفال المقدسيون ومؤطروهم …', 'size': 2}, {'id': '384', 'title': 'شفشاون.. أطفال القدس يتعرفون على محطة مهمة من تاريخ المغرب', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%b4%d9%81%d8%b4%d8%a7%d9%88%d9%86-%d8%a3%d8%b7%d9%81%d8%a7%d9%84-%d8%a7%d9%84%d9%82%d8%af%d8%b3-%d9%8a%d8%aa%d8%b9%d8%b1%d9%81%d9%88%d9%86-%d8%b9%d9%84%d9%89-%d9%85%d8%ad%d8%b7%d8%a9-%d9%85%d9%87/', 'summary': 'شفشاون.. أطفال القدس يتعرفون على محطة مهمة من تاريخ المغرب. زار أطفال القدس، أمس الخميس 14 غشت الجاري، في إطار فعاليات الدورة 16 للمخيم الصيفي المنظم لفائدتهم، تحت الرعاية السامية للملك محمد السادس، مدينة شفشاون، محطة من المحطات التي يقفون فيها على تاريخ المغرب طيلة إقامتهم بالمملكة. وتعدّ مدينة شفشاون محطة مهمة في برنامج دورة “حارة المغاربة” للمخيم الصيفي لأطفال القدس، تعرف خلالها …  شفشاون.. أطفال القدس يتعرفون على محطة مهمة من تاريخ المغرب     .', 'size': 2}], 'main_title': 'في زيارة إلى شفشاون.. أطفال القدس يتعرفون على محطة من محطات تاريخ المغرب'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    