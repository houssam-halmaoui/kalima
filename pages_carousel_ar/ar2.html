<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 14/09/2025 - 12h23</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '46', 'title': 'إحباط تهريب طن و300 كيلوغرام من المخدرات بتزنيت', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-657031.html', 'summary': 'إحباط تهريب طن و300 كيلوغرام من المخدرات بتزنيت. أحبطت المصالح الأمنية المختصة، صباح اليوم السبت 13 شتنبر 2025، محاولة تهريب كبرى للمخدرات بمنطقة أكلو قرب بولفضايل بإقليم تزنيت، بناءً على معلومات دقيقة قدمتها المديرية العامة لمراقبة التراب الوطني (DST). وأفادت المصادر الرسمية أن العملية ، التي نُفذت بواسطة دورية مشتركة ضمت جهاز القوات المساعدة والدرك الملكي والقوات المسلحة الملكية، وبالتنسيق مع السلطات المحلية، أسفرت عن حجز ما يقارب طنًا و300 كيلوغرام من مخدر الشيرا، كانت مهيأة للتهريب عبر البحر نحو جزر الكناري. وتندرج هذه العملية ضمن الجهود المستمرة للمصالح الأمنية لمحاربة تهريب المخدرات وحماية الأمن العام، مؤكدة فاعلية التنسيق بين مختلف الأجهزة الأمنية والسلطات المحلية لضمان التصدي لجميع أشكال التهريب والجريمة المنظمة. (الصورة تعبيرية)', 'size': 2}, {'id': '176', 'title': 'إحباط عملية تهريب طن و300 كيلوغرام من مخدر الشيرا قرب أكلو بتزنيت', 'source': 'rue20.com', 'link': 'https://rue20.com/936098.html', 'summary': 'إحباط عملية تهريب طن و300 كيلوغرام من مخدر الشيرا قرب أكلو بتزنيت. زنقة20| تزنيت تمكنت المصالح الأمنية المختصة، صباح اليوم السبت 13 شتنبر الجاري، من إحباط عملية تهريب كبرى للمخدرات على مستوى منطقة أكلو قرب بولفضايل بإقليم تزنيت، بناءً على معلومات دقيقة وفرتها المديرية العامة لمراقبة التراب الوطني (DST). وأسفرت العملية التي نفذت بدورية مشتركة ضمت جهاز القوات المساعدة والدرك الملكي والقوات المسلحة الملكية وبتنسيق مع السلطات الخبر إحباط عملية تهريب طن و300 كيلوغرام من مخدر الشيرا قرب أكلو بتزنيت  .', 'size': 2}], 'main_title': 'إحباط تهريب طن و300 كيلوغرام من المخدرات بتزنيت'}, {'community_id': '1', 'articles': [{'id': '87', 'title': 'بطولة العالم لألعاب القوى..سفيان البقالي وصلاح الدين بنيزيد يتأهلان إلى نهائي 3000 متر موانع', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/sport/others/412675.html', 'summary': 'بطولة العالم لألعاب القوى..سفيان البقالي وصلاح الدين بنيزيد يتأهلان إلى نهائي 3000 متر موانع. تأهل البطل الأولمبي والعالمي المغربي سفيان البقالي ومواطنه صلاح الدين بنيزيد، اليوم السبت، لنهائي سباق 3000 متر موانع، المدرج ضمن منافسات الدورة الـ 20 لبطولة', 'size': 2}, {'id': '224', 'title': 'بطولة العالم: البقالي وبنيزيد يتأهلان لنصف النهائي', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%a8%d8%b7%d9%88%d9%84%d8%a9-%d8%a7%d9%84%d8%b9%d8%a7%d9%84%d9%85-%d8%a7%d9%84%d8%a8%d9%82%d8%a7%d9%84%d9%8a-%d9%88%d8%a8%d9%86%d9%8a%d8%b2%d9%8a%d8%af-%d9%8a%d8%aa%d8%a3%d9%87%d9%84%d8%a7%d9%86/', 'summary': 'بطولة العالم: البقالي وبنيزيد يتأهلان لنصف النهائي. المساء اليوم: تأهل البطل الأولمبي والعالمي المغربي سفيان البقالي ومواطنه صلاح الدين بنيزيد، اليوم السبت، لنهائي سباق 3000 متر موانع، المدرج ضمن منافسات الدورة الـ 20 لبطولة العالم لألعاب القوى التي تحضتنها طوكيو إلى غاية', 'size': 2}], 'main_title': 'بطولة العالم لألعاب القوى..سفيان البقالي وصلاح الدين بنيزيد يتأهلان إلى نهائي 3000 متر موانع'}, {'community_id': '5', 'articles': [{'id': '119', 'title': 'مجلس حقوق الإنسان.. منظمات غير حكومية تحذر من استمرار العبودية في مخيمات تندوف', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%85%d8%ac%d9%84%d8%b3-%d8%ad%d9%82%d9%88%d9%82-%d8%a7%d9%84%d8%a5%d9%86%d8%b3%d8%a7%d9%86-%d9%85%d9%86%d8%b8%d9%85%d8%a7%d8%aa-%d8%ba%d9%8a%d8%b1-%d8%ad%d9%83%d9%88%d9%85%d9%8a%d8%a9-%d8%aa%d8%ad/', 'summary': 'مجلس حقوق الإنسان.. منظمات غير حكومية تحذر من استمرار العبودية في مخيمات تندوف. أثارت منظمات غير حكومية، أمس الجمعة (12 شتنبر)، خلال الدورة الـ60 لمجلس حقوق الإنسان بجنيف، انتباه المجتمع الدولي إلى استمرار ممارسات العبودية في مخيمات تندوف. ونددت الخبيرة القانونية لوسيا فيريرا بيريا، خلال الحوار التفاعلي مع المقرر الخاص المعني بأشكال الرق المعاصرة، بواقع العبودية الوراثية وبالتمييز العنصري المستمر بهذه المخيمات التي تديرها جماعة “البوليساريو” المسلحة. وفي', 'size': 3}, {'id': '139', 'title': 'منظمات غير حكومية تحذر من استمرار العبودية في مخيمات تندوف', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/323264/', 'summary': 'منظمات غير حكومية تحذر من استمرار العبودية في مخيمات تندوف. أثارت منظمات غير حكومية، أمس الجمعة خلال الدورة الـ60 لمجلس حقوق الإنسان بجنيف، انتباه المجتمع الدولي إلى استمرار ممارسات العبودية في مخيمات تندوف. ونددت الخبيرة القانونية لوسيا فيريرا بيريا، خلال الحوار التفاعلي مع المقرر الخاص المعني بأشكال الرق المعاصرة، بواقع العبودية الوراثية وبالتمييز العنصري المستمر بهذه المخيمات التي تديرها جماعة “البوليساريو” المسلحة. وفي كلمة باسم', 'size': 3}, {'id': '209', 'title': 'جنيف.. منظمات غير حكومية تحذر من استمرار العبودية في مخيمات تندوف', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%ac%d9%86%d9%8a%d9%81-%d9%85%d9%86%d8%b8%d9%85%d8%a7%d8%aa-%d8%ba%d9%8a%d8%b1-%d8%ad%d9%83%d9%88%d9%85%d9%8a%d8%a9-%d8%aa%d8%ad%d8%b0%d8%b1-%d9%85%d9%86-%d8%a7%d8%b3%d8%aa%d9%85%d8%b1%d8%a7%d8%b1/', 'summary': 'جنيف.. منظمات غير حكومية تحذر من استمرار العبودية في مخيمات تندوف. أثارت منظمات غير حكومية، أمس الجمعة خلال الدورة الـ60 لمجلس حقوق الإنسان بجنيف، انتباه المجتمع الدولي إلى استمرار ممارسات العبودية في مخيمات تندوف.  جنيف.. منظمات غير حكومية تحذر من استمرار العبودية في مخيمات تندوف     .', 'size': 2}, {'id': '347', 'title': 'جنيف: منظمات حقوقية تدق ناقوس الخطر حول استمرار العبودية في مخيمات تندوف', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%ac%d9%86%d9%8a%d9%81-%d9%85%d9%86%d8%b8%d9%85%d8%a7%d8%aa-%d8%ad%d9%82%d9%88%d9%82%d9%8a%d8%a9-%d8%aa%d8%af%d9%82-%d9%86%d8%a7%d9%82%d9%88%d8%b3-%d8%a7%d9%84%d8%ae%d8%b7%d8%b1-%d8%ad%d9%88%d9%84/', 'summary': 'جنيف: منظمات حقوقية تدق ناقوس الخطر حول استمرار العبودية في مخيمات تندوف. أثارت منظمات غير حكومية، أول أمس الجمعة خلال الدورة الـ60 لمجلس حقوق الإنسان بجنيف، انتباه المجتمع الدولي إلى استمرار ممارسات العبودية في مخيمات تندوف. ونددت الخبيرة القانونية لوسيا فيريرا بيريا، خلال الحوار التفاعلي مع المقرر الخاص المعني بأشكال الرق المعاصرة، بواقع العبودية الوراثية وبالتمييز العنصري المستمر بهذه المخيمات التي تديرها جماعة “البوليساريو” المسلحة. …  جنيف: منظمات حقوقية تدق ناقوس الخطر حول استمرار العبودية في مخيمات تندوف     .', 'size': 4}], 'main_title': 'جنيف: منظمات حقوقية تدق ناقوس الخطر حول استمرار العبودية في مخيمات تندوف'}, {'community_id': '2', 'articles': [{'id': '123', 'title': 'توزيع “كتب مدرسة الريادة”.. رابطة الكتبيين تحذر من التلاعب بهامش الربح', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%aa%d9%88%d8%b2%d9%8a%d8%b9-%d9%83%d8%aa%d8%a8-%d9%85%d8%af%d8%b1%d8%b3%d8%a9-%d8%a7%d9%84%d8%b1%d9%8a%d8%a7%d8%af%d8%a9-%d8%b1%d8%a7%d8%a8%d8%b7%d8%a9-%d8%a7%d9%84%d9%83%d8%aa%d8%a8%d9%8a/', 'summary': 'توزيع “كتب مدرسة الريادة”.. رابطة الكتبيين تحذر من التلاعب بهامش الربح. عبرت رابطة الكتبيين بالمغرب عن استنكارها لما جرى تداوله من طرف إحدى شركات التوزيع المكلفة ببعض كتب مدرسة الريادة بخصوص الهامش المخصص للربح لفائدة الموزعين والكتبيين، والمحدد بشكل صريح في دفتر التحملات. وقالت الرابطة، في بلاغ لها، إن هذه الممارسات تمس جوهر مقتضيات دفتر التحملات وتلحق أضرارا مباشرة بالمهنيين وبسير عملية توزيع كتب مدرسة الريادة', 'size': 2}, {'id': '135', 'title': 'رابطة الكتبيين تحذر من خروقات في توزيع كتب مدارس الريادة', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/323261/', 'summary': 'رابطة الكتبيين تحذر من خروقات في توزيع كتب مدارس الريادة. استنكرت رابطة الكتبيين بالمغرب ما جرى تداوله من طرف إحدى شركات التوزيع المكلفة ببعض كتب مدرسة الريادة بخصوص الهامش المخصص للربح لفائدة الموزعين والكتبيين، والمحدد بشكل صريح في دفتر التحملات. وأكدت الرابطة في بلاغها، أن هذه الممارسات تمس جوهر مقتضيات دفتر التحملات وتلحق أضرارا مباشرة بالمهنيين وبسير عملية توزيع كتب مدرسة الريادة على الصعيد الوطني.', 'size': 3}, {'id': '215', 'title': 'رابطة الكتبيين بالمغرب: تجاوزات وخروقات في توزيع كتب مدارس الريادة تلحق أضرارا مباشرة بالمهنيين', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/227000/', 'summary': 'رابطة الكتبيين بالمغرب: تجاوزات وخروقات في توزيع كتب مدارس الريادة تلحق أضرارا مباشرة بالمهنيين. استنكرت رابطة الكتبيين بالمغرب بشدة ما تداولته إحدى شركات التوزيع المكلفة ببعض كتب مدرسة الريادة بخصوص الهامش المخصص للربح لفائدة الموزعين والكتبيين، والمحدد بشكل صريح في دفتر التحملات. واعتبرت الرابطة في بلاغ استنكاري، تتوفر جريدة “كواليس اليوم” على نسخة منه، صادر اليوم السبت، أن هذه الممارسات تمس جوهر مقتضيات دفتر التحملات وتلحق أضرارا مباشرة بالمهنيين', 'size': 2}], 'main_title': 'رابطة الكتبيين تحذر من خروقات في توزيع كتب مدارس الريادة'}, {'community_id': '4', 'articles': [{'id': '143', 'title': 'فيديو السلاح الأبيض يثير الجدل.. أمن فاس يوقف قاصرا ويطارد متورطا آخر', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/323258/', 'summary': 'فيديو السلاح الأبيض يثير الجدل.. أمن فاس يوقف قاصرا ويطارد متورطا آخر. تفاعلت ولاية أمن فاس، بجدية كبيرة، مع شريط فيديو منشور على صفحات مواقع التواصل الاجتماعي يوم أمس الجمعة 12 شتنبر الجاري، يظهر حيازة شخصين للسلاح الأبيض في ظروف تشكل خطرا على الأشخاص والممتلكات. وقد أوضحت الأبحاث والتحريات المنجزة على ضوء هذا الشريط، أن الأمر يتعلق بقضية زجرية عالجتها مصالح الشرطة بولاية أمن فاس بتاريخ 31', 'size': 3}, {'id': '286', 'title': 'أمن فاس يعتقل شخصا ظهر في فيديو يهـ ـدد الأشخاص و الممتلكات بالسـ ـلاح الأبيض', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/206176', 'summary': 'أمن فاس يعتقل شخصا ظهر في فيديو يهـ ـدد الأشخاص و الممتلكات بالسـ ـلاح الأبيض.  أعلنت ولاية أمن فاس، أنها تفاعلت بجدية كبيرة، مع شريط فيديو منشور على صفحات مواقع التواصل الاجتماعي أمس الجمعة 12 شتنبر الجاري، يظهر حيازة شخصين للسلاح الأبيض في ظروف تشكل خطرا على الأشخاص والممتلكات. وحسب ما توصلت به “الأحداث” من معطيات، فقد أوضحت الأبحاث والتحريات المنجزة على ضوء هذا الشريط، أن الأمر يتعلق بقضية', 'size': 3}, {'id': '336', 'title': 'الأمن يلقي القبض على مسلحين روعوا ساكنة المدينة القديمة بفاس', 'source': 'rue20.com', 'link': 'https://rue20.com/936138.html', 'summary': 'الأمن يلقي القبض على مسلحين روعوا ساكنة المدينة القديمة بفاس.  / متابعة تفاعلت ولاية أمن فاس، بجدية كبيرة، مع شريط فيديو منشور على صفحات مواقع التواصل الاجتماعي يوم الجمعة 12 شتنبر الجاري، يظهر حيازة شخصين للسلاح الأبيض في ظروف تشكل خطرا على الأشخاص والممتلكات. وقد أوضحت الأبحاث والتحريات المنجزة على ضوء هذا الشريط، أن الأمر يتعلق بقضية زجرية عالجتها مصالح الشرطة بولاية أمن الخبر الأمن يلقي القبض على مسلحين روعوا ساكنة المدينة القديمة بفاس  .', 'size': 3}], 'main_title': 'فيديو السلاح الأبيض يثير الجدل.. أمن فاس يوقف قاصرا ويطارد متورطا آخر'}, {'community_id': '3', 'articles': [{'id': '170', 'title': 'ارتفاع عدد حالات الإصابة بالكوليرا عالميا', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a7%d8%b1%d8%aa%d9%81%d8%a7%d8%b9-%d8%b9%d8%af%d8%af-%d8%ad%d8%a7%d9%84%d8%a7%d8%aa-%d8%a7%d9%84%d8%a5%d8%b5%d8%a7%d8%a8%d8%a9-%d8%a8%d8%a7%d9%84%d9%83%d9%88%d9%84%d9%8a%d8%b1%d8%a7-%d8%b9%d8%a7/', 'summary': 'ارتفاع عدد حالات الإصابة بالكوليرا عالميا. ارتفع عدد حالات الإصابة بالكوليرا المبلغ عنها حول العالم في عام 2024، وفق ما كشفه تقرير لمنظمة الصحة العالمية. وأظهر التقرير زيادة حالات الكوليرا المبلغ عنها بنسبة 5 في المائة، بينما ارتفعت حالات الوفاة بنسبة 50 في المائة مقارنة بعام 2023، حيث توفي أكثر من 6 آلاف شخص بسبب هذا المرض القابل للوقاية والعلاج. وأشار  ارتفاع عدد حالات الإصابة بالكوليرا عالميا     .', 'size': 2}, {'id': '236', 'title': 'منظمة الصحة العالمية: ارتفاع وفيات الكوليرا بنسبة 50% عام 2024', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%85%d9%86%d8%b8%d9%85%d8%a9-%d8%a7%d9%84%d8%b5%d8%ad%d8%a9-%d8%a7%d9%84%d8%b9%d8%a7%d9%84%d9%85%d9%8a%d8%a9-%d8%a7%d8%b1%d8%aa%d9%81%d8%a7%d8%b9-%d9%88%d9%81%d9%8a%d8%a7%d8%aa-%d8%a7%d9%84%d9%83/', 'summary': 'منظمة الصحة العالمية: ارتفاع وفيات الكوليرا بنسبة 50% عام 2024. كشف تقرير لمنظمة الصحة العالمية، عن ارتفاع عدد حالات الإصابة بالكوليرا المُبلغ عنها حول العالم في عام 2024. وأظهر تقرير المنظمة، ارتفاع حالات الكوليرا المُبلّغ عنها بنسبة 5 في المائة، وارتفاع حالات الوفاة بنسبة 50 في المائة في عام 2024 مقارنةً بعام 2023، حيث تُوفي أكثر من 6 آلاف شخص بسبب المرض الذي …  منظمة الصحة العالمية: ارتفاع وفيات الكوليرا بنسبة 50% عام 2024     .', 'size': 2}], 'main_title': 'ارتفاع عدد حالات الإصابة بالكوليرا عالميا'}, {'community_id': '6', 'articles': [{'id': '288', 'title': 'وفـ ـاة أستاذ في حـ ـادثة سير مـ ـروعة بين مولاي عيسى بن إدريس وأوزود', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/206163', 'summary': 'وفـ ـاة أستاذ في حـ ـادثة سير مـ ـروعة بين مولاي عيسى بن إدريس وأوزود. أزيلال/الأحداث في حادثة سير مأساوية وقعت ليلة أمس، لقي أستاذ مادة الاجتماعيات بمولاي عيسى بن إدريس مصرعه إثر انزلاق سيارته بأحد المنعرجات الخطيرة على الطريق الرابطة بين مولاي عيسى وأوزود. الراحل، الذي يدعى (ي. أ)، حديث العهد بالحصول على رخصة السياقة، فقد السيطرة على مركبته في منعرج حاد، ما أدى إلى انزلاقها بشكل مأساوي أودى', 'size': 2}, {'id': '330', 'title': 'مصرع أستاذ في حادثة سير مروعة بأزيلال', 'source': 'rue20.com', 'link': 'https://rue20.com/936153.html', 'summary': 'مصرع أستاذ في حادثة سير مروعة بأزيلال.  / متابعة لقي أستاذ لمادة الاجتماعيات بثانوية القاضي عياض بمولاي عيسى بن إدريس، مصرعه ليلة أمس السبت، إثر حادثة سير مأساوية وقعت بأحد المنعرجات الخطيرة على الطريق الرابطة بين مولاي عيسى وأوزود، بإقليم أزيلال. وبحسب مصادر محلية، فإن الضحية، حديث العهد بالحصول على رخصة السياقة، فقد السيطرة على مركبته أثناء مروره بمنعرج حاد، الخبر مصرع أستاذ في حادثة سير مروعة بأزيلال  .', 'size': 2}], 'main_title': 'وفـ ـاة أستاذ في حـ ـادثة سير مـ ـروعة بين مولاي عيسى بن إدريس وأوزود'}, {'community_id': '7', 'articles': [{'id': '328', 'title': 'طقس حار مع كتل ضبابية متوقع اليوم الأحد', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%b7%d9%82%d8%b3-%d8%ad%d8%a7%d8%b1-%d9%85%d8%b9-%d9%83%d8%aa%d9%84-%d8%b6%d8%a8%d8%a7%d8%a8%d9%8a%d8%a9-%d9%85%d8%aa%d9%88%d9%82%d8%b9-%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%a3%d8%ad-3/', 'summary': 'طقس حار مع كتل ضبابية متوقع اليوم الأحد. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الأحد، أن تتميز الحالة الجوية عامة بطقس حار نسبيا بكل من سهول تادلة، والرحامنة، وسوس، والجنوب الشرقي، وداخل الأقليم الصحراوية للمملكة. كما يرتقب نمو كتل ضبابية محلية بالسواحل الشمالية والوسطى وشمال غرب الأقاليم الصحراوية خلال الصباح والليل، فضلا عن نزول قطرات مطرية مع بروز رعد بمرتفعات الأطلس الكبير،  طقس حار مع كتل ضبابية متوقع اليوم الأحد     .', 'size': 2}, {'id': '350', 'title': 'توقعات أحوال الطقس اليوم الأحد', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%aa%d9%88%d9%82%d8%b9%d8%a7%d8%aa-%d8%a3%d8%ad%d9%88%d8%a7%d9%84-%d8%a7%d9%84%d8%b7%d9%82%d8%b3-%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%a3%d8%ad%d8%af-48/', 'summary': 'توقعات أحوال الطقس اليوم الأحد. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليومه الأحد، أن تتميز الحالة الجوية عامة بطقس حار نسبيا بكل من سهول تادلة، والرحامنة، وسوس، والجنوب الشرقي، وداخل الأقليم الصحراوية للمملكة. كما يرتقب نمو كتل ضبابية محلية بالسواحل الشمالية والوسطى وشمال غرب الأقاليم الصحراوية خلال الصباح والليل، فضلا عن نزول قطرات مطرية مع بروز رعد وذلك …  توقعات أحوال الطقس اليوم الأحد     .', 'size': 2}], 'main_title': 'طقس حار مع كتل ضبابية متوقع اليوم الأحد'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    