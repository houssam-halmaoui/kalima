<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 16/07/2025 - 18h31</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '99', 'title': 'القضاء الكندي يدين هشام جيراندو بتهمة التشهير', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/409365.html', 'summary': 'القضاء الكندي يدين هشام جيراندو بتهمة التشهير. أصدرت المحكمة العليا في كيبيك، يوم الاثنين 14 يوليوز الجاري، حكمًا جزائيًا ضد هشام جيراندو، وهو يوتيوبر من أصل مغربي يقيم بمونتريال بكندا، أدانته من', 'size': 2}, {'id': '218', 'title': 'المحكمة العليا بكندا تُدين هشام جيراندو', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%a7%d9%84%d9%85%d8%ad%d9%83%d9%85%d8%a9-%d8%a7%d9%84%d8%b9%d9%84%d9%8a%d8%a7-%d8%a8%d9%83%d9%86%d8%af%d8%a7-%d8%aa%d9%8f%d8%af%d9%8a%d9%86-%d9%87%d8%b4%d8%a7%d9%85-%d8%ac%d9%8a%d8%b1%d8%a7%d9%86/', 'summary': 'المحكمة العليا بكندا تُدين هشام جيراندو.  – متابعات أصدرت المحكمة العليا في كيبيك، كندا، يوم الاثنين 14 يوليوز، حكمًا نهائيًا في حق اليوتيوبر المغربي المقيم بمونتريال هشام جيراندو، بعد إدانته بتهم التشهير ونشر معلومات...  المحكمة العليا بكندا تُدين هشام جيراندو     .', 'size': 2}], 'main_title': 'القضاء الكندي يدين هشام جيراندو بتهمة التشهير'}, {'community_id': '5', 'articles': [{'id': '105', 'title': 'من قلب الرباط .. حزب جاكوب زوما  يدعم المقترح المغربي للحكم الذاتي ويعتبر أنه يضمن للمغرب سيادته على الصحراء', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/politic/409373.html', 'summary': 'من قلب الرباط .. حزب جاكوب زوما يدعم المقترح المغربي للحكم الذاتي ويعتبر أنه يضمن للمغرب سيادته على الصحراء. قال جاكوب زوما، الرئيس السابق لجنوب إفريقيا وزعيم حزب "أومكونتو وي سيزوي" (MK)، إن حزبه يعتبر أن مقترح الحكم الذاتي المغربي "سيتيح حكامة محلية ملموسة', 'size': 2}, {'id': '227', 'title': 'حزب “أومكونتو وي سيزوي” الجنوب إفريقي يدعم المقترح المغربي للحكم الذاتي', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/224742/', 'summary': 'حزب “أومكونتو وي سيزوي” الجنوب إفريقي يدعم المقترح المغربي للحكم الذاتي. كواليس اليوم قال جاكوب زوما، الرئيس السابق لجنوب إفريقيا وزعيم حزب “أومكونتو وي سيزوي” (MK)، إن حزبه يعتبر أن مقترح الحكم الذاتي المغربي “سيتيح حكامة محلية ملموسة من قبل ساكنة منطقة الصحراء، مع ضمان سيادة المغرب على الصحراء”. وقد عبر زوما عن هذا الموقف في تصريح للصحافة عقب مباحثاته مع وزير الشؤون الخارجية والتعاون', 'size': 2}], 'main_title': 'من قلب الرباط .. حزب جاكوب زوما  يدعم المقترح المغربي للحكم الذاتي ويعتبر أنه يضمن للمغرب سيادته على الصحراء'}, {'community_id': '2', 'articles': [{'id': '115', 'title': 'انطلاق أشغال الدورة الـ20 للمؤتمر الوزاري الإفريقي حول البيئة بمشاركة المغرب', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/divers/409383.html', 'summary': 'انطلاق أشغال الدورة الـ20 للمؤتمر الوزاري الإفريقي حول البيئة بمشاركة المغرب. انطلقت، اليوم الأربعاء بمقر برنامج الأمم المتحدة للبيئة بنيروبي، أشغال الدورة العادية العشرين للمؤتمر الوزاري الإفريقي حول البيئة، بمشاركة المملكة المغربية. ويمثل المملكة في هذه الدورة،', 'size': 2}, {'id': '195', 'title': 'نيروبي.. انطلاق الدورة الـ20 للمؤتمر الوزاري الإفريقي حول البيئة بمشاركة المغرب', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/469686.html', 'summary': 'نيروبي.. انطلاق الدورة الـ20 للمؤتمر الوزاري الإفريقي حول البيئة بمشاركة المغرب. انطلقت، اليوم الأربعاء بمقر برنامج الأمم المتحدة للبيئة بنيروبي، أشغال الدورة العادية العشرين للمؤتمر الوزاري الإفريقي حول البيئة، بمشاركة المملكة المغربية.', 'size': 2}], 'main_title': 'انطلاق أشغال الدورة الـ20 للمؤتمر الوزاري الإفريقي حول البيئة بمشاركة المغرب'}, {'community_id': '7', 'articles': [{'id': '228', 'title': 'طقس الأربعاء.. حار مع زخات رعدية مرتقبة في بعض المناطق', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/224739/', 'summary': 'طقس الأربعاء.. حار مع زخات رعدية مرتقبة في بعض المناطق. كواليس اليوم تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الأربعاء، أن يبقى الطقس حارا بكل من السهول الداخلية الشمالية والوسطى وهضاب الفوسفاط ووالماس والجنوب الشرقي للبلاد وبداخل الأقاليم الجنوبية. كما يرتقب نزول زخات رعدية وسقوط برد مصحوبا بهبات رياح محلية داخل الأقاليم الجنوبية، فضلا عن تمركز سحب ركامية مرفوقة بقطرات مطرية متفرقة ورعد محلي', 'size': 2}, {'id': '247', 'title': 'توقعات أحوال الطقس اليوم الأربعاء', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%aa%d9%88%d9%82%d8%b9%d8%a7%d8%aa-%d8%a3%d8%ad%d9%88%d8%a7%d9%84-%d8%a7%d9%84%d8%b7%d9%82%d8%b3-%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%a3%d8%b1%d8%a8%d8%b9%d8%a7%d8%a1-28/', 'summary': 'توقعات أحوال الطقس اليوم الأربعاء. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليومه الأربعاء، أن يبقى الطقس حارا بكل من السهول الداخلية الشمالية والوسطى وهضاب الفوسفاط ووالماس والجنوب الشرقي للبلاد وبداخل الأقاليم الجنوبية. كما يرتقب نزول زخات رعدية وسقوط برد مصحوبا بهبات رياح محلية داخل الأقاليم الجنوبية، فضلا عن تمركز سحب ركامية مرفوقة بقطرات مطرية متفرقة ورعد محلي فوق …  توقعات أحوال الطقس اليوم الأربعاء     .', 'size': 2}], 'main_title': 'طقس الأربعاء.. حار مع زخات رعدية مرتقبة في بعض المناطق'}, {'community_id': '1', 'articles': [{'id': '330', 'title': 'النيابة العامة: سبب وفاة الشخص المعتصم فوق سطح خزان للمياه ناتج عن تمزق النخاع الشوكي على مستوى العنق', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/203548', 'summary': 'النيابة العامة: سبب وفاة الشخص المعتصم فوق سطح خزان للمياه ناتج عن تمزق النخاع الشوكي على مستوى العنق.  أعلن الوكيل العام للملك لدى محكمة الاستئناف ببني ملال، في بلاغ رسمي، عن نتائج التحقيقات الأولية والتشريح الطبي المتعلق بوفاة شخص كان قد اعتصم فوق سطح خزان للمياه بجماعة أولاد يوسف التابعة لاقليم بني ملال، مشيرا إلى أن الوفاة نتجت عن شنق ذاتي، وفق ما خلصت إليه لجنة طبية ثلاثية أجرت التشريح. وبحسب', 'size': 4}, {'id': '351', 'title': 'النيابة العامة تكشف الحقيقة الكاملة لوفاة معتصم “شاطو” أولاد يوسف', 'source': 'assabah.ma', 'link': 'https://assabah.ma/859866.html', 'summary': 'النيابة العامة تكشف الحقيقة الكاملة لوفاة معتصم “شاطو” أولاد يوسف. كشف الوكيل العام للملك لدى محكمة الاستئناف ببني ملال، اليوم الأربعاء، تفاصيل واقعة اعتصام شخص فوق سطح خزان مياه بجماعة أولاد يوسف، وهي الحادثة التي انتهت بوفاته بعد سلسلة من السلوكيات العنيفة والخطيرة تجاه عناصر الوقاية المدنية والدرك الملكي. ووفق بلاغ رسمي صادر عن النيابة العامة، توصلتأكمل القراءة » المقالة النيابة العامة تكشف الحقيقة الكاملة لوفاة معتصم “شاطو” أولاد يوسف  .', 'size': 4}, {'id': '372', 'title': 'النيابة العامة تكشف تفاصيل وفاة “مول الشاطو” واعتداءه على عناصر الإنقاذ', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1085914.html', 'summary': 'النيابة العامة تكشف تفاصيل وفاة “مول الشاطو” واعتداءه على عناصر الإنقاذ. أعلن الوكيل العام للملك لدى محكمة الاستئناف ببني ملال، في بلاغ رسمي، تفاصيل واقعة مأساوية شهدتها الجماعة الترابية أولاد يوسف، بعدما أقدم شخص على الاعتصام فوق سطح خزان مياه واحتجاز عنصر من الوقاية المدنية، قبل أن تنتهي الواقعة بوفاة المعتصم بعد محاولة إنقاذ فاشلة. وأوضح البلاغ أن المعني بالأمر قام بالاعتداء على عنصر من الوقاية ظهرت المقالة النيابة العامة تكشف تفاصيل وفاة “مول الشاطو” واعتداءه على عناصر الإنقاذ  .', 'size': 5}, {'id': '388', 'title': 'حادث خزان الماء ببني ملال.. النيابة العامة تكشف أسباب وفاة المعتصم', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%ad%d8%a7%d8%af%d8%ab-%d8%ae%d8%b2%d8%a7%d9%86-%d8%a7%d9%84%d9%85%d8%a7%d8%a1-%d8%a8%d8%a8%d9%86%d9%8a-%d9%85%d9%84%d8%a7%d9%84-%d8%a7%d9%84%d9%86%d9%8a%d8%a7%d8%a8%d8%a9-%d8%a7%d9%84%d8%b9/', 'summary': 'حادث خزان الماء ببني ملال.. النيابة العامة تكشف أسباب وفاة المعتصم. أكد الوكيل العام للملك لدى محكمة الاستئناف ببني ملال أن وفاة الشخص، الذي رمى بنفسه من أعلى سطح خزان للمياه الكائن بالجماعة الترابية أولاد يوسف، نتجت عن تمزق النخاع الشوكي على مستوى العنق، وكذا تمزق الشريان السباتي، وتمزق للعضلات المقابلة له مع كسر لعظم الحلق نتيجة عملية الشنق بالحبل الذي لفه المعني بالأمر حول رقبته.  حادث خزان الماء ببني ملال.. النيابة العامة تكشف أسباب وفاة المعتصم     .', 'size': 5}, {'id': '442', 'title': 'النيابة العامة: المعتصم فوق خزان للمياه شنق نفسه وليس هناك أي شكاية حول وفاة والده', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d9%86%d9%8a%d8%a7%d8%a8%d8%a9-%d8%a7%d9%84%d8%b9%d8%a7%d9%85%d8%a9-%d8%a7%d9%84%d9%85%d8%b9%d8%aa%d8%b5%d9%85-%d9%81%d9%88%d9%82-%d8%ae%d8%b2%d8%a7%d9%86-%d9%84%d9%84%d9%85%d9%8a%d8%a7/', 'summary': 'النيابة العامة: المعتصم فوق خزان للمياه شنق نفسه وليس هناك أي شكاية حول وفاة والده. نفت النيابة العامة ببني ملال مزاعم إقدام الشخص الذي اعتصم خزان للمياه بالجماعة الترابية أولاد يوسف ببني ملال، والذي توفي بعد مضاعفات عقب محاولة للانتحار، قيد حياته، بوضع شكاية عن شكوك حول ملابسات وظروف وفاة والده، والتي تزعم شائعات أنها السبب وراء احتجاجه. وأكد بلاغ للوكيل العام للملك لدى محكمة الاستئناف ببني ملال …  النيابة العامة: المعتصم فوق خزان للمياه شنق نفسه وليس هناك أي شكاية حول وفاة والده     .', 'size': 5}], 'main_title': 'النيابة العامة تكشف تفاصيل وفاة “مول الشاطو” واعتداءه على عناصر الإنقاذ'}, {'community_id': '6', 'articles': [{'id': '347', 'title': '“كان السيدات”.. الشباك ضمن فريق دور المجموعات', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%83%d8%a7%d9%86-%d8%a7%d9%84%d8%b3%d9%8a%d8%af%d8%a7%d8%aa-%d8%a7%d9%84%d8%b4%d8%a8%d8%a7%d9%83-%d8%b6%d9%85%d9%86-%d9%81%d8%b1%d9%8a%d9%82-%d8%af%d9%88%d8%b1-%d8%a7%d9%84%d9%85%d8%ac%d9%85/', 'summary': '“كان السيدات”.. الشباك ضمن فريق دور المجموعات. كشف الاتحاد الإفريقي لكرة القدم (كاف)، اليوم الأربعاء (16 يوليوز)، عن اختيار اللاعبة المغربية غزلان الشباك ضمن تشكيلة الفريق الذي يضم أحسن اللاعبات في دور المجموعات برسم كأس أمم إفريقيا للسيدات (المغرب 2024). وأوضح (كاف)، على موقعه الرسمي، أن مجموعة الدراسة التقنية التابعة له اختارت فريقا يتكون من 11 لاعبة لتشكيل منتخب من أفضل لاعبات', 'size': 2}, {'id': '389', 'title': 'كأس أمم إفريقيا للسيدات.. المغربية غزلان الشباك ضمن فريق دور المجموعات', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%83%d8%a3%d8%b3-%d8%a3%d9%85%d9%85-%d8%a5%d9%81%d8%b1%d9%8a%d9%82%d9%8a%d8%a7-%d9%84%d9%84%d8%b3%d9%8a%d8%af%d8%a7%d8%aa-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8%d9%8a%d8%a9-%d8%ba%d8%b2%d9%84%d8%a7/', 'summary': 'كأس أمم إفريقيا للسيدات.. المغربية غزلان الشباك ضمن فريق دور المجموعات. كشف الاتحاد الإفريقي لكرة القدم (كاف)، اليوم الأربعاء، عن اختيار اللاعبة المغربية غزلان الشباك ضمن تشكيلة الفريق الذي يضم أحسن اللاعبات في دور المجموعات برسم كأس أمم إفريقيا للسيدات (المغرب 2024). وأوضح (كاف)، على موقعه الرسمي، أن مجموعة الدراسة التقنية التابعة له اختارت فريقا يتكون من 11 لاعبة لتشكيل منتخب من أفضل لاعبات دور المجموعات  كأس أمم إفريقيا للسيدات.. المغربية غزلان الشباك ضمن فريق دور المجموعات     .', 'size': 2}], 'main_title': '“كان السيدات”.. الشباك ضمن فريق دور المجموعات'}, {'community_id': '3', 'articles': [{'id': '353', 'title': 'تبييض الأموال والمخدرات تسقطان فرنسيا بالبيضاء', 'source': 'assabah.ma', 'link': 'https://assabah.ma/859736.html', 'summary': 'تبييض الأموال والمخدرات تسقطان فرنسيا بالبيضاء. أوقفت عناصر الشرطة بولاية أمن البيضاء، أمس الثلاثاء، فرنسيا يبلغ من العمر 42 سنة، مبحوث عنه على الصعيد الوطني من قبل الشرطة القضائية بطنجة ويشكل موضوع أمر دولي بإلقاء القبض صادر عن السلطات القضائية الفرنسية. وذكر مصدر أمني أن إيقاف هذا الفرنسي تم بالبيضاء، حيث كشفت عمليةأكمل القراءة » المقالة تبييض الأموال والمخدرات تسقطان فرنسيا بالبيضاء  .', 'size': 2}, {'id': '445', 'title': 'أمن البيضاء يوقف مواطنا فرنسيا مطلوب لدى السلطات القضائية الفرنسية', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a3%d9%85%d9%86-%d8%a7%d9%84%d8%a8%d9%8a%d8%b6%d8%a7%d8%a1-%d9%8a%d9%88%d9%82%d9%81-%d9%85%d9%88%d8%a7%d8%b7%d9%86%d8%a7-%d9%81%d8%b1%d9%86%d8%b3%d9%8a%d8%a7-%d9%85%d8%b7%d9%84%d9%88%d8%a8-%d9%84/', 'summary': 'أمن البيضاء يوقف مواطنا فرنسيا مطلوب لدى السلطات القضائية الفرنسية. تمكنت عناصر الشرطة بولاية أمن الدار البيضاء، يوم أمس الثلاثاء، من توقيف مواطن فرنسي يبلغ من العمر 42 سنة، مبحوث عنه على الصعيد الوطني من قبل الشرطة القضائية بطنجة ويشكل موضوع أمر دولي بإلقاء القبض صادر عن السلطات القضائية الفرنسية. وكشفت مصادر أمنية، أنه قد تم توقيف هذا المواطن الفرنسي بمدينة الدار البيضاء، …  أمن البيضاء يوقف مواطنا فرنسيا مطلوب لدى السلطات القضائية الفرنسية     .', 'size': 2}], 'main_title': 'تبييض الأموال والمخدرات تسقطان فرنسيا بالبيضاء'}, {'community_id': '4', 'articles': [{'id': '357', 'title': 'عضو بالكونغرس الأمريكي: بقيادة الملك المغرب يمثل نموذجا للاستقرار والإصلاحات', 'source': 'assabah.ma', 'link': 'https://assabah.ma/859692.html', 'summary': 'عضو بالكونغرس الأمريكي: بقيادة الملك المغرب يمثل نموذجا للاستقرار والإصلاحات. أكد عضو الكونغرس الأمريكي، جو ويلسون، أن المغرب، بقيادة صاحب الجلالة الملك محمد السادس، فرض نفسه كنموذج في مجال الاستقرار، والإصلاح، والانخراط البناء على الصعيدين الإقليمي والدولي. وقال ويلسون أحد النواب المؤثرين في مجلس النواب الأمريكي، في حديث لوكالة المغرب العربي للأنباء: “تحت قيادة صاحب الجلالة، أعطتأكمل القراءة » المقالة عضو بالكونغرس الأمريكي: بقيادة الملك المغرب يمثل نموذجا للاستقرار والإصلاحات  .', 'size': 2}, {'id': '413', 'title': 'عضو بالكونغرس الأمريكي.. المغرب يمثل نموذجا للاستقرار والإصلاحات بقيادة الملك', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/469719.html', 'summary': 'عضو بالكونغرس الأمريكي.. المغرب يمثل نموذجا للاستقرار والإصلاحات بقيادة الملك. أكد عضو الكونغرس الأمريكي، جو ويلسون، أن المغرب، بقيادة الملك محمد السادس، فرض نفسه كنموذج في مجال الاستقرار، والإصلاح، والانخراط البناء على الصعيدين الإقليمي والدولي.', 'size': 2}], 'main_title': 'عضو بالكونغرس الأمريكي: بقيادة الملك المغرب يمثل نموذجا للاستقرار والإصلاحات'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    