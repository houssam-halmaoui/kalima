<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 11/09/2025 - 12h25</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '7', 'articles': [{'id': '30', 'title': 'أخنوش: مشاريع الماء والفلاحة ضمن أولوياتنا', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-656125.html', 'summary': 'أخنوش: مشاريع الماء والفلاحة ضمن أولوياتنا. أكد رئيس الحكومة، عزيز أخنوش ، أن فريقه الحكومي يشتغل بجدية وببرنامج مكثف، واصفا إياه بـ"حكومة العمل"، خاصة مع دخول السنة الأخيرة من ولايتها. وأوضح أخنوش ، خلال مروره في برنامج حواري خاص بثته القناتان الأولى والثانية مساء الأربعاء، أن الدخول الحكومي الجديد يحمل أولويات واضحة، أبرزها استكمال تنزيل الأوراش الاجتماعية الكبرى المرتبطة ببناء الدولة الاجتماعية، وعلى رأسها الصحة والتعليم والحماية الاجتماعية. كما شدد على أن مشاريع الماء والفلاحة والاستثمارات تبقى ضمن المحاور الأساسية لعمل الحكومة في المرحلة المقبلة. وفي سياق آخر، أبرز رئيس الحكومة أن الدخول المدرسي لهذا الموسم تميز بالمرونة، مثمنا الجهود الكبيرة التي تبذلها الأطر التعليمية لإنجاح العملية. وأشار أخنوش إلى أن عملية "مليون محفظة" مكنت من توجيه دعم مباشر لفائدة نحو 3 ملايين و200 ألف أسرة، قصد تمكينها من اقتناء المستلزمات المدرسية لأبنائها، في خطوة تروم تعزيز العدالة الاجتماعية وتخفيف الأعباء عن الأسر المغربية.', 'size': 4}, {'id': '141', 'title': 'أخنوش: تكليف الداخلية بالإشراف على الانتخابات يضمن الحياد والشفافية', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/323041/', 'summary': 'أخنوش: تكليف الداخلية بالإشراف على الانتخابات يضمن الحياد والشفافية. أعرب رئيس الحكومة المغربية، عزيز أخنوش، مساء اليوم الأربعاء، عن ارتياحه للتكليف الملكي الذي أسند إلى وزارة الداخلية مهمة الإعداد للاستحقاقات الانتخابية المقبلة، معتبراً أن هذه الخطوة تعكس حرص المؤسسة الملكية على ضمان نزاهة العملية الانتخابية وتجنيبها أي شبهة تضارب للمصالح. وأوضح أخنوش، في حوار بث على القناتين العموميتين الأولى والثانية، أن هذا الاختيار جاء', 'size': 5}, {'id': '172', 'title': 'أخنوش يرحّب بإشراف الداخلية على انتخابات 2026 مقللا من أهمية الاجتماعات مع الأحزاب', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a3%d8%ae%d9%86%d9%88%d8%b4-%d9%8a%d8%b1%d8%ad%d9%91%d8%a8-%d8%a8%d8%a5%d8%b4%d8%b1%d8%a7%d9%81-%d8%a7%d9%84%d8%af%d8%a7%d8%ae%d9%84%d9%8a%d8%a9-%d8%b9%d9%84%d9%89-%d8%a7%d9%86%d8%aa%d8%ae%d8%a7/', 'summary': 'أخنوش يرحّب بإشراف الداخلية على انتخابات 2026 مقللا من أهمية الاجتماعات مع الأحزاب. أعرب رئيس الحكومة، عزيز أخنوش، عن ارتياحه لإسناد الإشراف على الانتخابات التشريعية المقبلة لسنة 2026 إلى وزارة الداخلية، معتبرا أن هذا التوجه يضمن حياد العملية الانتخابية ويُبعده عن أي اتهامات باستغلال موقعه السياسي. وقال أخنوش في لقاء صحفي مسجل مع قنوات التلفزيون العمومي: «أنا فرحان لأنني أعفيت من الإشراف السياسي على الانتخابات، ويجب أن تظل  أخنوش يرحّب بإشراف الداخلية على انتخابات 2026 مقللا من أهمية الاجتماعات مع الأحزاب     .', 'size': 4}, {'id': '346', 'title': 'أخنوش: نطمح لتصدر انتخابات 2026 ونشتغل للمغاربة وليس فقط للمونديال', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1098784.html', 'summary': 'أخنوش: نطمح لتصدر انتخابات 2026 ونشتغل للمغاربة وليس فقط للمونديال. عبر رئيس الحكومة عزيز أخنوش، عن طموحه ورغبته في تصدر الانتخابات التشريعية المقررة في شتنبر من سنة 2026، مستدركا بأن حكومته ستعرض حصيلتها أولا أمام المغاربة قبل موعد الانتخابات، التي ستفرز الحكومة المقبلة. وقال أخنوش، في لقاء خاص مع القناتين الأولى والثانية مساء أمس الأربعاء 10 شتنبر 2025، ردا على سؤال حول طموح حزبه لتصدر ظهرت المقالة أخنوش: نطمح لتصدر انتخابات 2026 ونشتغل للمغاربة وليس فقط للمونديال  .', 'size': 5}, {'id': '387', 'title': 'هل نجح أخنوش في إقناع المغاربة بحصيلة 4 سنوات من حكومته؟', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/226891/', 'summary': 'هل نجح أخنوش في إقناع المغاربة بحصيلة 4 سنوات من حكومته؟. قضى رئيس الحكومة المغربية عزيز أخنوش ساعة ونصف كاملة في خرجة إعلامية على القناتين الأولى والثانية، من دون أن يتمكن من إقناع المغاربة بجدوى ما يعتبرها إصلاحات أنجزتها حكومته خلال أربع سنوات. الخطاب الطويل، الذي جاء متأخراً وفي ظرفية سياسية حساسة، لم يقدم للمغاربة أي معطى ملموس يمكن أن يبدد حالة الاستياء المتصاعدة من', 'size': 3}], 'main_title': 'أخنوش: تكليف الداخلية بالإشراف على الانتخابات يضمن الحياد والشفافية'}, {'community_id': '4', 'articles': [{'id': '68', 'title': 'رئيس الحكومة يترأس اجتماع اللجنة البين وزارية المكلفة ببرنامج إعادة البناء والتأهيل العام للمناطق المتضررة من زلزال الحوز', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/206008', 'summary': 'رئيس الحكومة يترأس اجتماع اللجنة البين وزارية المكلفة ببرنامج إعادة البناء والتأهيل العام للمناطق المتضررة من زلزال الحوز.  ترأس رئيس الحكومة السيد عزيز أخنوش، يوم الأربعاء 10 شتنبر 2025 بالرباط، اجتماع اللجنة البين وزارية المكلفة ببرنامج إعادة البناء والتأهيل العام للمناطق المتضررة من زلزال الحوز، تم خلاله الوقوف على التقدم المسجل في تنزيل هذا البرنامج، تنفيذا للتعليمات الملكية السامية. في مستهل الاجتماع، عبر السيد رئيس الحكومة، عن ارتياحه للنتائج المحققة في تنزيل', 'size': 3}, {'id': '111', 'title': 'رئيس الحكومة يترأس اجتماع اللجنة البين وزارية المكلفة ببرنامج إعادة البناء والتأهيل للمناطق المتضررة من زلزال الحوز', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/national/412518.html', 'summary': 'رئيس الحكومة يترأس اجتماع اللجنة البين وزارية المكلفة ببرنامج إعادة البناء والتأهيل للمناطق المتضررة من زلزال الحوز. ترأس رئيس الحكومة عزيز أخنوش، يوم الأربعاء 10 شتنبر 2025 بالرباط، اجتماع اللجنة البين وزارية المكلفة ببرنامج إعادة البناء والتأهيل العام للمناطق المتضررة من زلزال', 'size': 3}, {'id': '146', 'title': '6.9 مليار درهم دعما للأسر.. الحكومة تستعرض حصيلة إعادة البناء والتأهيل بعد زلزال الحوز', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/323030/', 'summary': '6.9 مليار درهم دعما للأسر.. الحكومة تستعرض حصيلة إعادة البناء والتأهيل بعد زلزال الحوز. ترأس رئيس الحكومة، عزيز أخنوش اليوم الأربعاء، بالرباط، اجتماع اللجنة بين الوزارية المكلفة ببرنامج إعادة البناء والتأهيل العام للمناطق المتضررة من زلزال الحوز، الذي تم خلاله الوقوف على التقدم المسجل في تنزيل هذا البرنامج، تنفيذا للتعليمات الملكية السامية. وذكر بلاغ لرئاسة الحكومة أن أخنوش شدد على أن التوجيهات الملكية السامية، تعد بوصلة عمل مختلف القطاعات', 'size': 3}], 'main_title': 'رئيس الحكومة يترأس اجتماع اللجنة البين وزارية المكلفة ببرنامج إعادة البناء والتأهيل العام للمناطق المتضررة من زلزال الحوز'}, {'community_id': '0', 'articles': [{'id': '97', 'title': 'شواهد طبية وهمية تكشف فضيحة طبيب ومساعدته', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/412500.html', 'summary': 'شواهد طبية وهمية تكشف فضيحة طبيب ومساعدته. تمكنت عناصر المصلحة الولائية للشرطة بمدينة مراكش، مساء يوم الثلاثاء 9 شتنبر الجاري، من توقيف أربعة أشخاص تتراوح أعمارهم بين 29 و59 سنة، وهم طبيب', 'size': 3}, {'id': '148', 'title': 'مراكش.. توقيف طبيب ومساعدته ووسطاء في قضية شواهد طبية وهمية', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/323018/', 'summary': 'مراكش.. توقيف طبيب ومساعدته ووسطاء في قضية شواهد طبية وهمية. تمكنت عناصر المصلحة الولائية للشرطة بمدينة مراكش، مساء أمس الثلاثاء 9 شتنبر الجاري، من توقيف أربعة أشخاص تتراوح أعمارهم بين 29 و59 سنة، وهم طبيب عام بالقطاع الخاص ومساعدته واثنان من الوسطاء، وذلك للاشتباه في تورطهم في تقديم شواهد طبية وهمية مقابل مبالغ مالية. وحسب المعلومات الأولية للبحث، فقد توصلت مصالح الأمن بمعطيات حول تقديم', 'size': 3}, {'id': '226', 'title': 'القبض على طبيب عام ومساعدته ووسيطين لتورطهم في المتاجرة بالشواهد الطبية', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/226862/', 'summary': 'القبض على طبيب عام ومساعدته ووسيطين لتورطهم في المتاجرة بالشواهد الطبية. تمكنت عناصر المصلحة الولائية للشرطة بمدينة مراكش، مساء يوم الثلاثاء 9 شتنبر الجاري، من توقيف أربعة أشخاص تتراوح أعمارهم بين 29 و59 سنة، وهم طبيب عام بالقطاع الخاص ومساعدته واثنان من الوسطاء، وذلك للاشتباه في تورطهم في تقديم شواهد طبية وهمية مقابل مبالغ مالية. وحسب المعلومات الأولية للبحث، فقد توصلت مصالح الأمن بمعطيات حول تقديم', 'size': 3}], 'main_title': 'شواهد طبية وهمية تكشف فضيحة طبيب ومساعدته'}, {'community_id': '1', 'articles': [{'id': '102', 'title': 'جدل واسع بعد طرد جماعي ل16 تلميذاً من مدرسة الأخوين', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/education/412509.html', 'summary': 'جدل واسع بعد طرد جماعي ل16 تلميذاً من مدرسة الأخوين. أثارت إدارة مدرسة الأخوين بإفران جدلاً واسعاً خلال الموسم الدراسي 2025/2026 بعد أن أصدرت إشعارات بحرمان 16 تلميذا من الدراسة، نتيجة اعتراض أولياء أمورهم على', 'size': 2}, {'id': '165', 'title': 'طرد جماعي لـ 16 تلميذا من مدرسة الأخوين بإفران', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1098700.html', 'summary': 'طرد جماعي لـ 16 تلميذا من مدرسة الأخوين بإفران. ظهرت المقالة طرد جماعي لـ 16 تلميذا من مدرسة الأخوين بإفران  .', 'size': 2}], 'main_title': 'جدل واسع بعد طرد جماعي ل16 تلميذاً من مدرسة الأخوين'}, {'community_id': '5', 'articles': [{'id': '128', 'title': 'أخنوش مدافعا عن “قانونية” صفقة إنجاز محطة التحلية بكازا: المناقصة كانت شفافة والناس راه كتستثمر فبلادها فين الإشكال؟', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a3%d8%ae%d9%86%d9%88%d8%b4-%d9%85%d8%af%d8%a7%d9%81%d8%b9%d8%a7-%d8%b9%d9%86-%d9%82%d8%a7%d9%86%d9%88%d9%86%d9%8a%d8%a9-%d8%b5%d9%81%d9%82%d8%a9-%d8%a5%d9%86%d8%ac%d8%a7%d8%b2-%d9%85%d8%ad/', 'summary': 'أخنوش مدافعا عن “قانونية” صفقة إنجاز محطة التحلية بكازا: المناقصة كانت شفافة والناس راه كتستثمر فبلادها فين الإشكال؟. في أول رد له على الجدل الواسع الذي رافق اختيار إحدى الشركات المملوكة له، لإنجاز محطة تحلية مياه الدار البيضاء المستقبلية، دافع رئيس الحكومة، عزيز أخنوش، عن “قانونية” هذه الصفقة. وقال أخنوش، في حوار خاص، بت مساء اليوم الأربعاء (10 شتنبر) على قناتين الأولى والثانية “دوزيم”، “تدار فيها طلب عروض شاركوا فيه شركات مغربية وعالمية،', 'size': 2}, {'id': '139', 'title': 'أخنوش يدافع عن قانونية صفقة تحلية مياه الدار البيضاء', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/323052/', 'summary': 'أخنوش يدافع عن قانونية صفقة تحلية مياه الدار البيضاء. في خضم الجدل الواسع الذي أثارته صفقة إنجاز محطة تحلية مياه البحر بمدينة الدار البيضاء، اختار رئيس الحكومة عزيز أخنوش الظهور الإعلامي مساء الأربعاء عبر القناتين العموميتين “الأولى” و”دوزيم”، حيث قدّم روايته الكاملة بشأن المشروع الذي اعتبره محطة مفصلية في مسار تدبير ملف الماء بالمغرب، مؤكداً أن العملية تمت في إطار قانوني وشفاف، ولا تحمل', 'size': 2}], 'main_title': 'أخنوش مدافعا عن “قانونية” صفقة إنجاز محطة التحلية بكازا: المناقصة كانت شفافة والناس راه كتستثمر فبلادها فين الإشكال؟'}, {'community_id': '2', 'articles': [{'id': '162', 'title': 'زلزال الحوز.. صرف قرابة 7 ملايير درهم للمتضررين واستكمال بناء وتأهيل 51 ألف مسكن', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1098727.html', 'summary': 'زلزال الحوز.. صرف قرابة 7 ملايير درهم للمتضررين واستكمال بناء وتأهيل 51 ألف مسكن. كشف المدير العام لوكالة تنمية الأطلس الكبير، اليوم الأربعاء بالرباط، أن 51.154 أسرة، من ضحايا زلزال الحوز، استكملت بناء وتأهيل منازلها، فيما بلغت القيمة الإجمالية للدعم المالي المقدم للأسر المتضررة، ما مجموعه 6,9 مليار درهم. وسجل المدير العام للوكالة، خلال اجتماع للجنة البين وزارية المكلفة ببرنامج إعادة البناء والتأهيل العام للمناطق المتضررة من زلزال الحوز، ظهرت المقالة زلزال الحوز.. صرف قرابة 7 ملايير درهم للمتضررين واستكمال بناء وتأهيل 51 ألف مسكن  .', 'size': 2}, {'id': '186', 'title': 'تقرير رسمي : إعادة بناء وترميم أزيد من 51 ألف مسكن لمتضرري زلزال الحوز', 'source': 'rue20.com', 'link': 'https://rue20.com/935256.html', 'summary': 'تقرير رسمي : إعادة بناء وترميم أزيد من 51 ألف مسكن لمتضرري زلزال الحوز. . الرباط أكد المدير العام لوكالة تنمية الأطلس الكبير سعيد الليث، اليوم الأربعاء بالرباط، أن عدد المساكن التي تم بناؤها أو إعادة بنائها أو ترميمها، إثر زلزال الحوز لـ8 شتنبر 2023، بلغ 51 ألفا و154منزلا. وأبرز السيد الليث في تصريح للصحافة، عقب اجتماع اللجنة بين الوزارية المكلفة ببرنامج إعادة البناء والتأهيل العام للمناطق المتضررة الخبر تقرير رسمي : إعادة بناء وترميم أزيد من 51 ألف مسكن لمتضرري زلزال الحوز  .', 'size': 2}], 'main_title': 'زلزال الحوز.. صرف قرابة 7 ملايير درهم للمتضررين واستكمال بناء وتأهيل 51 ألف مسكن'}, {'community_id': '6', 'articles': [{'id': '170', 'title': 'الشرطة تطلق النار على جانح خطير ضواحي سلا', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a7%d9%84%d8%b4%d8%b1%d8%b7%d8%a9-%d8%aa%d8%b7%d9%84%d9%82-%d8%a7%d9%84%d9%86%d8%a7%d8%b1-%d8%b9%d9%84%d9%89-%d8%ac%d8%a7%d9%86%d8%ad-%d8%ae%d8%b7%d9%8a%d8%b1-%d8%b6%d9%88%d8%a7%d8%ad%d9%8a-%d8%b3/', 'summary': 'الشرطة تطلق النار على جانح خطير ضواحي سلا. اضطر عناصر فرقة الشرطة القضائية بمنطقة أمن العيايدة بمدينة سلا لاستعمال أسلحتهم الوظيفية، مساء اليوم الأربعاء، وذلك خلال تدخل أمني لإيقاف شخص يبلغ من العمر 40 سنة، من ذوي السوابق القضائية العديدة، والذي كان في حالة غير طبيعية واندفاع قوي وعرض عناصر الشرطة لاعتداء جدي وخطير باستعمال السلاح الأبيض. وتشير المعطيات الخاصة بالبحث إلى تدخل  الشرطة تطلق النار على جانح خطير ضواحي سلا     .', 'size': 4}, {'id': '180', 'title': 'مصرع شمكار برصاص الأمن بعدما روع المواطنين وأصاب شرطي دورية أمنية بسكين', 'source': 'rue20.com', 'link': 'https://rue20.com/935312.html', 'summary': 'مصرع شمكار برصاص الأمن بعدما روع المواطنين وأصاب شرطي دورية أمنية بسكين. . الرباط اضطر عناصر فرقة الشرطة القضائية بمنطقة أمن العيايدة بمدينة سلا لاستعمال أسلحتهم الوظيفية، مساء اليوم الأربعاء 10 شتنبر الجاري، وذلك خلال تدخل أمني لإيقاف شخص يبلغ من العمر 40 سنة، من ذوي السوابق القضائية العديدة، والذي كان في حالة غير طبيعية واندفاع قوي وعرض عناصر الشرطة لاعتداء جدي وخطير باستعمال السلاح الأبيض. الخبر مصرع شمكار برصاص الأمن بعدما روع المواطنين وأصاب شرطي دورية أمنية بسكين  .', 'size': 4}, {'id': '220', 'title': 'بعد اعتدائه على شرطي بساطور.. مصرع مجرم خطير برصاص الشرطة في مدينة سلا', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/226880/', 'summary': 'بعد اعتدائه على شرطي بساطور.. مصرع مجرم خطير برصاص الشرطة في مدينة سلا. اضطر عناصر فرقة الشرطة القضائية بمنطقة أمن العيايدة بمدينة سلا لاستعمال أسلحتهم الوظيفية، مساء اليوم الأربعاء 10 شتنبر الجاري، وذلك خلال تدخل أمني لإيقاف شخص يبلغ من العمر 40 سنة، من ذوي السوابق القضائية العديدة، والذي كان في حالة غير طبيعية واندفاع قوي وعرض عناصر الشرطة لاعتداء جدي وخطير باستعمال السلاح الأبيض. وتشير المعطيات الخاصة', 'size': 4}, {'id': '327', 'title': 'عرض عناصر الشرطة لاعتداء جدي وخطير باستعمال السلاح الأبيض.. القرطاس لتوقيف شخص في سلا', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%b9%d8%b1%d8%b6-%d8%b9%d9%86%d8%a7%d8%b5%d8%b1-%d8%a7%d9%84%d8%b4%d8%b1%d8%b7%d8%a9-%d9%84%d8%a7%d8%b9%d8%aa%d8%af%d8%a7%d8%a1-%d8%ac%d8%af%d9%8a-%d9%88%d8%ae%d8%b7%d9%8a%d8%b1-%d8%a8%d8%a7%d8%b3/', 'summary': 'عرض عناصر الشرطة لاعتداء جدي وخطير باستعمال السلاح الأبيض.. القرطاس لتوقيف شخص في سلا. اضطر عناصر فرقة الشرطة القضائية بمنطقة أمن العيايدة بمدينة سلا لاستعمال أسلحتهم الوظيفية، مساء أمس الأربعاء (10 شتنبر)، وذلك خلال تدخل أمني لإيقاف شخص يبلغ من العمر 40 سنة، من ذوي السوابق القضائية العديدة، والذي كان في حالة غير طبيعية واندفاع قوي وعرض عناصر الشرطة لاعتداء جدي وخطير باستعمال السلاح الأبيض. وتشير المعطيات الخاصة بالبحث', 'size': 4}], 'main_title': 'الشرطة تطلق النار على جانح خطير ضواحي سلا'}, {'community_id': '3', 'articles': [{'id': '224', 'title': 'ذكرى استشهاد علال بن عبد الله دفاعا عن العرش العلوي المجيد', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/226867/', 'summary': 'ذكرى استشهاد علال بن عبد الله دفاعا عن العرش العلوي المجيد. يخلد الشعب المغربي، غدا الخميس، الذكرى الـ 72 لاستشهاد علال بن عبد الله، الذي وهب روحه وفاء لمقدسات الوطن وثوابته، مبرهنا عن عمق الحس الوطني والوعي النضالي، ليصبح رمزا للشجاعة والتشبث بالعرش العلوي المجيد وبالتوابث الوطنية. ففي 11 شتنبر من سنة 1953، خرج الشهيد علال بن عبد الله، مسلحا بإيمانه ليهاجم صنيعة الاستعمار ابن عرفة', 'size': 2}, {'id': '247', 'title': 'علال بن عبد الله.. أيقونة الشهادة والوفاء في ملحمة التحرير المغربي', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%b9%d9%84%d8%a7%d9%84-%d8%a8%d9%86-%d8%b9%d8%a8%d8%af-%d8%a7%d9%84%d9%84%d9%87-%d8%a3%d9%8a%d9%82%d9%88%d9%86%d8%a9-%d8%a7%d9%84%d8%b4%d9%87%d8%a7%d8%af%d8%a9-%d9%88%d8%a7%d9%84%d9%88%d9%81%d8%a7/', 'summary': 'علال بن عبد الله.. أيقونة الشهادة والوفاء في ملحمة التحرير المغربي. يحيي الشعب المغربي، غدا الخميس 11 شتنبر 2025، الذكرى الثانية والسبعين لاستشهاد البطل الوطني علال بن عبد الله، الذي قدم حياته ثمنا لوفائه للوطن وولائه للعرش العلوي المجيد، هذا الرجل الذي تحوّل إلى رمز للشجاعة والتضحية، خلّد اسمه في سجل المقاومة الوطنية بوقفة بطولية هزت أركان الاستعمار الفرنسي وأكدت تمسك المغاربة بملكهم الشرعي …  علال بن عبد الله.. أيقونة الشهادة والوفاء في ملحمة التحرير المغربي     .', 'size': 2}], 'main_title': 'ذكرى استشهاد علال بن عبد الله دفاعا عن العرش العلوي المجيد'}, {'community_id': '8', 'articles': [{'id': '342', 'title': 'طقس الخميس…أجواء حارة في عدد من المناطق', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/323057/', 'summary': 'طقس الخميس…أجواء حارة في عدد من المناطق. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الخميس، أن يظل الطقس حارا نسبيا بكل من الجنوب الشرقي وأقصى جنوب المملكة. وخلال الليل والصباح، سيلاحظ تشكل سحب منخفضة بالقرب من سواحل المحيط الأطلسي حيث ستكون مرفوقة بكتل ضبابية أو قطرات مطرية جد خفيفة محليا. كما يرتقب تسجيل هبات رياح قوية نوعا ما بالسواحل الوسطى والجنوبية. وستتراوح', 'size': 2}, {'id': '358', 'title': 'توقعات أحوال الطقس.. سحب منخفضة بالقرب من سواحل المحيط الأطلسي', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%aa%d9%88%d9%82%d8%b9%d8%a7%d8%aa-%d8%a3%d8%ad%d9%88%d8%a7%d9%84-%d8%a7%d9%84%d8%b7%d9%82%d8%b3-%d8%b3%d8%ad%d8%a8-%d9%85%d9%86%d8%ae%d9%81%d8%b6%d8%a9-%d8%a8%d8%a7%d9%84%d9%82%d8%b1%d8%a8-%d9%85/', 'summary': 'توقعات أحوال الطقس.. سحب منخفضة بالقرب من سواحل المحيط الأطلسي. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الخميس، أن يظل الطقس حارا نسبيا بكل من الجنوب الشرقي وأقصى جنوب المملكة. وخلال الليل والصباح، سيلاحظ تشكل سحب منخفضة بالقرب من سواحل المحيط الأطلسي حيث ستكون مرفوقة بكتل ضبابية أو قطرات مطرية جد خفيفة محليا. كما يرتقب تسجيل هبات رياح قوية نوعا ما بالسواحل الوسطى والجنوبية. وستتراوح  توقعات أحوال الطقس.. سحب منخفضة بالقرب من سواحل المحيط الأطلسي     .', 'size': 3}, {'id': '398', 'title': 'توقعات “الأرصاد الجوية” لطقس اليوم الخميس', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%aa%d9%88%d9%82%d8%b9%d8%a7%d8%aa-%d8%a7%d9%84%d8%a3%d8%b1%d8%b5%d8%a7%d8%af-%d8%a7%d9%84%d8%ac%d9%88%d9%8a%d8%a9-%d9%84%d8%b7%d9%82%d8%b3-%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d8%a7-13/', 'summary': 'توقعات “الأرصاد الجوية” لطقس اليوم الخميس. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الخميس 10 شتنبر 2025، أن يظل الطقس حارا نسبيا بكل من الجنوب الشرقي وأقصى جنوب المملكة. وخلال الليل والصباح، سيلاحظ تشكل سحب منخفضة بالقرب من سواحل المحيط الأطلسي حيث ستكون مرفوقة بكتل ضبابية أو قطرات مطرية جد خفيفة محليا. كما يرتقب تسجيل هبات رياح قوية نوعا …  توقعات “الأرصاد الجوية” لطقس اليوم الخميس     .', 'size': 2}], 'main_title': 'توقعات أحوال الطقس.. سحب منخفضة بالقرب من سواحل المحيط الأطلسي'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    