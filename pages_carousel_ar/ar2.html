<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 02/07/2025 - 06h24</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '68', 'title': 'عبد اللطيف حموشي يستقبل رئيس جهاز الاستخبارات الوطني لدولة الإمارات العربية المتحدة', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/202766', 'summary': 'عبد اللطيف حموشي يستقبل رئيس جهاز الاستخبارات الوطني لدولة الإمارات العربية المتحدة.  استقبل المدير العام للأمن الوطني ولمراقبة التراب الوطني السيد عبد اللطيف حموشي، اليوم الثلاثاء بالرباط، السيد علي عبيد الظاهري رئيس جهاز الاستخبارات الوطني لدولة الإمارات العربية المتحدة الشقيقة، الذي كان مرفوقا بوفد أمني رفيع المستوى، وذلك في إطار زيارة عمل ترمي إلى تطوير آليات التعاون والمساعدة المتبادلة، وتوسيع مجالات ومستويات التنسيق والشراكات الأمنية. وأوضح', 'size': 5}, {'id': '112', 'title': 'حموشي يستقبل رئيس جهاز الاستخبارات الوطني لدولة الإمارات العربية المتحدة', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/national/408537.html', 'summary': 'حموشي يستقبل رئيس جهاز الاستخبارات الوطني لدولة الإمارات العربية المتحدة. استقبل المدير العام للأمن الوطني ولمراقبة التراب الوطني عبد اللطيف حموشي، اليوم الثلاثاء بالرباط، علي عبيد الظاهري رئيس جهاز الاستخبارات الوطني لدولة الإمارات العربية المتحدة', 'size': 4}, {'id': '130', 'title': 'حموشي يستقبل رئيس جهاز الاستخبارات الإماراتي', 'source': 'assabah.ma', 'link': 'https://assabah.ma/856687.html', 'summary': 'حموشي يستقبل رئيس جهاز الاستخبارات الإماراتي. استقبل المدير عبد اللطيف حموشي، العام للأمن الوطني ولمراقبة التراب الوطني، اليوم الثلاثاء بالرباط، علي عبيد الظاهري، رئيس جهاز الاستخبارات الوطني لدولة الإمارات العربية المتحدة الشقيقة، الذي كان مرفوقا بوفد أمني رفيع المستوى، وذلك في إطار زيارة عمل ترمي إلى تطوير آليات التعاون والمساعدة المتبادلة، وتوسيع مجالاتأكمل القراءة » المقالة حموشي يستقبل رئيس جهاز الاستخبارات الإماراتي  .', 'size': 5}, {'id': '224', 'title': 'عاجل.. السيد عبد اللطيف حموشي يستقبل رئيس جهاز الاستخبارات الوطني لدولة الإمارات العربية المتحدة', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/223826/', 'summary': 'عاجل.. السيد عبد اللطيف حموشي يستقبل رئيس جهاز الاستخبارات الوطني لدولة الإمارات العربية المتحدة. استقبل المدير العام للأمن الوطني ولمراقبة التراب الوطني السيد عبد اللطيف حموشي، اليوم الثلاثاء بالرباط، السيد علي عبيد الظاهري رئيس جهاز الاستخبارات الوطني لدولة الإمارات العربية المتحدة الشقيقة، الذي كان مرفوقا بوفد أمني رفيع المستوى، وذلك في إطار زيارة عمل ترمي إلى تطوير آليات التعاون والمساعدة المتبادلة، وتوسيع مجالات ومستويات التنسيق والشراكات الأمنية. وأوضح بلاغ', 'size': 5}, {'id': '234', 'title': 'عبد اللطيف حموشي يستقبل رئيس جهاز الاستخبارات الوطني لدولة الإمارات العربية المتحدة (صور)', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%b9%d8%a8%d8%af-%d8%a7%d9%84%d9%84%d8%b7%d9%8a%d9%81-%d8%ad%d9%85%d9%88%d8%b4%d9%8a-%d9%8a%d8%b3%d8%aa%d9%82%d8%a8%d9%84-%d8%b1%d8%a6%d9%8a%d8%b3-%d8%ac%d9%87%d8%a7%d8%b2-%d8%a7%d9%84%d8%a7%d8%b3/', 'summary': 'عبد اللطيف حموشي يستقبل رئيس جهاز الاستخبارات الوطني لدولة الإمارات العربية المتحدة (صور). استقبل المدير العام للأمن الوطني ولمراقبة التراب الوطني عبد اللطيف حموشي، اليوم الثلاثاء بالرباط، علي عبيد الظاهري رئيس جهاز الاستخبارات الوطني لدولة الإمارات العربية المتحدة الشقيقة، الذي كان مرفوقا بوفد أمني رفيع المستوى، وذلك في إطار زيارة عمل ترمي إلى تطوير آليات التعاون والمساعدة المتبادلة، وتوسيع مجالات ومستويات التنسيق والشراكات الأمنية. وأوضح بلاغ …  عبد اللطيف حموشي يستقبل رئيس جهاز الاستخبارات الوطني لدولة الإمارات العربية المتحدة (صور)     .', 'size': 4}], 'main_title': 'عبد اللطيف حموشي يستقبل رئيس جهاز الاستخبارات الوطني لدولة الإمارات العربية المتحدة'}, {'community_id': '1', 'articles': [{'id': '74', 'title': 'أخنوش: المغرب، بقيادة جلالة الملك، يواصل تعزيز إصلاحاته الهيكلية في المجالات ذات الأولوية', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/national/408496.html', 'summary': 'أخنوش: المغرب، بقيادة جلالة الملك، يواصل تعزيز إصلاحاته الهيكلية في المجالات ذات الأولوية. أكد رئيس الحكومة عزيز أخنوش، أمام المؤتمر الدولي الرابع حول تمويل التنمية، الذي انطلقت أشغاله اليوم الاثنين باشبيلية، أن المغرب، بقيادة صاحب الجلالة الملك محمد', 'size': 2}, {'id': '227', 'title': 'أخنوش من إشبيلية: المغرب يواصل الإصلاحات ذات الأولوية', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%a3%d8%ae%d9%86%d9%88%d8%b4-%d9%85%d9%86-%d8%a5%d8%b4%d8%a8%d9%8a%d9%84%d9%8a%d8%a9-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d9%8a%d9%88%d8%a7%d8%b5%d9%84-%d8%a7%d9%84%d8%a5%d8%b5%d9%84%d8%a7%d8%ad/', 'summary': 'أخنوش من إشبيلية: المغرب يواصل الإصلاحات ذات الأولوية. المساء اليوم: قال رئيس الحكومة عزيز أخنوش، أمام المؤتمر الدولي الرابع حول تمويل التنمية، الذي انطلقت أشغاله أمس الاثنين باشبيلية، إن المغرب، بقيادة الملك محمد السادس، يواصل تعزيز إصلاحاته الهيكلية في المجالات ذات الأولوية. وأوضح', 'size': 2}], 'main_title': 'أخنوش: المغرب، بقيادة جلالة الملك، يواصل تعزيز إصلاحاته الهيكلية في المجالات ذات الأولوية'}, {'community_id': '2', 'articles': [{'id': '77', 'title': 'أسعار الكازوال والبنزين تعود للارتفاع من جديد بالمغرب', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/economy/408501.html', 'summary': 'أسعار الكازوال والبنزين تعود للارتفاع من جديد بالمغرب. بالفعل، وبعد محطات متعددة شهدت فيها أسعار الكازوال على الخصوص في الآونة الأخيرة انخفاضات وارتفاعات ظلّت محدودة في مجملها، والتي لم تتجاوز انخفاضًا بحوالي 15', 'size': 2}, {'id': '240', 'title': 'درجة\u202d \u202cالحرارة\u202d \u202cغير\u202d \u202cالمسبوقة\u202d \u202cتربك\u202d \u202cيوميات\u202d \u202cساكنة\u202d \u202c17\u202d \u202cمنطقة\u202d \u202cبالمغرب', 'source': 'www.alalam.ma', 'link': 'https://www.alalam.ma/درجة\u202d-\u202cالحرارة\u202d-\u202cغير\u202d-\u202cالمسبوقة\u202d-\u202cتربك\u202d-\u202cيوميات\u202d-\u202cساكنة\u202d_a28499.html', 'summary': 'درجة\u202d \u202cالحرارة\u202d \u202cغير\u202d \u202cالمسبوقة\u202d \u202cتربك\u202d \u202cيوميات\u202d \u202cساكنة\u202d \u202c17\u202d \u202cمنطقة\u202d \u202cبالمغرب. مهنيو\u202d \u202cالأرصاد\u202d \u202cينبهون\u202d \u202cوخبراء\u202d \u202cيعددون\u202d \u202cتداعياتها\u202d \u202cعلى\u202d \u202cالصحة\u202d \u202cالعامة\u202d \u202cوالمنتوجات\u202d \u202cالزراعية\u202d \u202cوحقينة\u202d \u202cالسدود\u202d \u202c', 'size': 2}], 'main_title': 'أسعار الكازوال والبنزين تعود للارتفاع من جديد بالمغرب'}, {'community_id': '3', 'articles': [{'id': '100', 'title': 'الداخلة.. مهاجرة "إفريقية" تتسبب في اعتقال أحد أفراد القوات المساعدة بتهم ثقيلة', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/408525.html', 'summary': 'الداخلة.. مهاجرة "إفريقية" تتسبب في اعتقال أحد أفراد القوات المساعدة بتهم ثقيلة. أفادت السلطات المحلية بولاية جهة الداخلة – وادي الذهب أن مصالح الدرك الملكي بمدينة الداخلة فتحت بحثا قضائيا تحت إشراف النيابة العامة المختصة، أمس الاثنين،', 'size': 2}, {'id': '226', 'title': 'الداخلة.. توقيف “مخزني” يشتبه تورطه في التحرش بمواطنة إفريقية', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/223820/', 'summary': 'الداخلة.. توقيف “مخزني” يشتبه تورطه في التحرش بمواطنة إفريقية. كواليس اليوم أفادت السلطات المحلية بولاية جهة الداخلة – وادي الذهب بأن مصالح الدرك الملكي بمدينة الداخلة فتحت بحثا قضائيا تحت إشراف النيابة العامة المختصة، أمس الإثنين، وذلك لتحديد ظروف وملابسات تورط أحد أفراد القوات المساعدة في قضية تتعلق بالتحرش والابتزاز المادي. وأوضحت السلطات ذاتها أن المعطيات الأولية للبحث تشير إلى تقدم مهاجرة منحدرة', 'size': 2}], 'main_title': 'الداخلة.. مهاجرة "إفريقية" تتسبب في اعتقال أحد أفراد القوات المساعدة بتهم ثقيلة'}, {'community_id': '4', 'articles': [{'id': '120', 'title': 'بسبب تصريحه عن الأراضي المغربية.. الجزائر تُدين بوعلام صنصال بالسجن 5 سنوات', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/world/408546.html', 'summary': 'بسبب تصريحه عن الأراضي المغربية.. الجزائر تُدين بوعلام صنصال بالسجن 5 سنوات. في خطوة جديدة تُعمّق التوتر بين حرية التعبير والسلطة القضائية في الجزائر، أيدت محكمة الاستئناف الجزائرية، الثلاثاء، الحكم الصادر في حق الكاتب الفرنسي الجزائري بوعلام', 'size': 2}, {'id': '429', 'title': 'محكمة جزائرية تدين الكاتب بوعلام صنصال بخمس سنوات سجنا', 'source': 'almassaa.com', 'link': 'https://almassaa.com/110946-2/', 'summary': 'محكمة جزائرية تدين الكاتب بوعلام صنصال بخمس سنوات سجنا. المساء اليوم: ثبتت محكمة استئناف في العاصمة الجزائرية اليوم الثلاثاء (الأول من يوليو 2025) عقوبة بالسجن خمس (5) سنوات بحق الكاتب الفرنسي الجزائري بوعلام صنصال لاتهامه بـ”المساس بوحدة الوطن”. وتحدثت رئيسة المحكمة بالفرنسية إلى صنصال،', 'size': 2}], 'main_title': 'بسبب تصريحه عن الأراضي المغربية.. الجزائر تُدين بوعلام صنصال بالسجن 5 سنوات'}, {'community_id': '8', 'articles': [{'id': '126', 'title': 'بتنسيق مع الديستي.. إحباط محاولة تهريب 3 أطنان و30 كلغ من الحشيش وتوقيف 3 متورطين (صور)', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a8%d8%aa%d9%86%d8%b3%d9%8a%d9%82-%d9%85%d8%b9-%d8%a7%d9%84%d8%af%d9%8a%d8%b3%d8%aa%d9%8a-%d8%a5%d8%ad%d8%a8%d8%a7%d8%b7-%d9%85%d8%ad%d8%a7%d9%88%d9%84%d8%a9-%d8%aa%d9%87%d8%b1%d9%8a%d8%a8-3/', 'summary': 'بتنسيق مع الديستي.. إحباط محاولة تهريب 3 أطنان و30 كلغ من الحشيش وتوقيف 3 متورطين (صور). تمكنت عناصر الشرطة بالمنطقة اﻹقليمية للأمن بمدينة الصويرة بتنسيق مع مصالح المديرية العامة لمراقبة التراب الوطني (الديستي)، في الساعات اﻷولى من فجر اليوم الثلاثاء (1 يوليوز)، من إحباط محاولة تهريب ثلاثة أطنان و30 كيلوغراما من مخدر الشيرا، وتوقيف ثلاثة أشخاص يشتبه في ارتباطهم بشبكة إجرامية تنشط في التهريب الدولي للمخدرات والمؤثرات العقلية. وأوضح بلاغ للمديرية', 'size': 3}, {'id': '183', 'title': 'إحباط تهريب ثلاثة أطنان من الحشيش بالصويرة', 'source': 'rue20.com', 'link': 'https://rue20.com/917360.html', 'summary': 'إحباط تهريب ثلاثة أطنان من الحشيش بالصويرة.  | الصويرة أحبطت عناصر الشرطة التابعة للمنطقة الإقليمية للأمن بمدينة الصويرة، بتنسيق وثيق مع مصالح المديرية العامة لمراقبة التراب الوطني، في الساعات الأولى من صباح اليوم الثلاثاء، محاولة تهريب كبرى لمخدر الشيرا، أسفرت عن حجز ثلاثة أطنان و30 كيلوغراماً من المخدرات، وتوقيف ثلاثة أشخاص يُشتبه في ارتباطهم بشبكة إجرامية تنشط في مجال التهريب الخبر إحباط تهريب ثلاثة أطنان من الحشيش بالصويرة  .', 'size': 3}, {'id': '194', 'title': 'إحباط تهريب أزيد من 3 أطنان من مخدر الشيرا بالصويرة', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/468174.html', 'summary': 'إحباط تهريب أزيد من 3 أطنان من مخدر الشيرا بالصويرة. تمكنت عناصر الشرطة بالمنطقة الإقليمية للأمن بمدينة الصويرة بتنسيق مع مصالح المديرية العامة لمراقبة التراب الوطني، في الساعات الأولى من فجر اليوم الثلاثاء، من إحباط محاولة تهريب ثلاثة أطنان و30 كيلوغراما من مخدر الشيرا، وتوقيف ثلاثة أشخاص يشتبه في ارتباطهم بشبكة إجرامية تنشط في التهريب الدولي للمخدرات والمؤثرات العقلية.', 'size': 3}, {'id': '221', 'title': 'الصويرة.. الأمن يحبط محاولة تهريب أزيد من 3 أطنان من مخدر الشيرا', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/223840/', 'summary': 'الصويرة.. الأمن يحبط محاولة تهريب أزيد من 3 أطنان من مخدر الشيرا. كمال عسو أحبطت عناصر الشرطة بالمنطقة اﻹقليمية للأمن بمدينة الصويرة بتنسيق مع مصالح المديرية العامة لمراقبة التراب الوطني، في الساعات اﻷولى من فجر اليوم الثلاثاء، محاولة تهريب ثلاثة أطنان و30 كيلوغراما من مخدر الشيرا، وتوقيف ثلاثة أشخاص يشتبه في ارتباطهم بشبكة إجرامية تنشط في التهريب الدولي للمخدرات والمؤثرات العقلية. وأوضح بلاغ للمديرية العامة للأمن', 'size': 2}, {'id': '232', 'title': 'إحباط محاولة تهريب كمية مهمة من مخدر الشيرا بالصويرة', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a5%d8%ad%d8%a8%d8%a7%d8%b7-%d9%85%d8%ad%d8%a7%d9%88%d9%84%d8%a9-%d8%aa%d9%87%d8%b1%d9%8a%d8%a8-%d9%83%d9%85%d9%8a%d8%a9-%d9%85%d9%87%d9%85%d8%a9-%d9%85%d9%86-%d9%85%d8%ae%d8%af%d8%b1-%d8%a7%d9%84/', 'summary': 'إحباط محاولة تهريب كمية مهمة من مخدر الشيرا بالصويرة. تمكنت عناصر الشرطة بالمنطقة الإقليمية للأمن بمدينة الصويرة بتنسيق مع مصالح المديرية العامة لمراقبة التراب الوطني، في الساعات الأولى من فجر اليوم الثلاثاء، من إحباط محاولة تهريب ثلاثة أطنان و30 كيلوغراما من مخدر الشيرا، وتوقيف ثلاثة أشخاص يشتبه ارتباطهم بشبكة إجرامية تنشط في التهريب الدولي للمخدرات والمؤثرات العقلية. وأوضح بلاغ للمديرية العامة للأمن …  إحباط محاولة تهريب كمية مهمة من مخدر الشيرا بالصويرة     .', 'size': 4}], 'main_title': 'إحباط محاولة تهريب كمية مهمة من مخدر الشيرا بالصويرة'}, {'community_id': '6', 'articles': [{'id': '156', 'title': 'المنصوري: البناء في العالم القروي أولوية حكومية وآلاف الأسر استفادت من “دعم السكن”', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1082268.html', 'summary': 'المنصوري: البناء في العالم القروي أولوية حكومية وآلاف الأسر استفادت من “دعم السكن”. أكدت وزيرة إعداد التراب الوطني والتعمير والإسكان وسياسة المدينة فاطمة الزهراء المنصوري على أن إشكالية البناء في العالم القروي تشكل من أولويات الوزارة، معترفة بوجود تحديات كبيرة في هذا المجال. جاء ذلك في جواب تلاه بالنيابة عنها، كاتب الدولة المكلف بالتعمير، أديب بن ابراهيم خلال جلسة الأسئلة الشفوية بمجلس المستشارين، الثلاثاء فاتح يوليوز 2025. وأكدت ظهرت المقالة المنصوري: البناء في العالم القروي أولوية حكومية وآلاف الأسر استفادت من “دعم السكن”  .', 'size': 2}, {'id': '181', 'title': 'المنصوري: الوكالات الجهوية ستسد اختلالات ونواقص التخطيط العمراني وخصوصيات العالم القروي', 'source': 'rue20.com', 'link': 'https://rue20.com/917357.html', 'summary': 'المنصوري: الوكالات الجهوية ستسد اختلالات ونواقص التخطيط العمراني وخصوصيات العالم القروي.  ا الرباط أكدت وزيرة إعداد التراب الوطني والتعمير والإسكان وسياسة المدينة، فاطمة الزهراء المنصوري، أن معالجة إشكالية البناء في العالم القروي تعد من أولويات الوزارة، في ظل التحديات البنيوية والمجالية التي يعرفها هذا القطاع. وجاء تصريح الوزيرة في جواب تلاه بالنيابة عنها كاتب الدولة المكلف بالتعمير، أديب بن ابراهيم، خلال جلسة الأسئلة الشفوية الخبر المنصوري: الوكالات الجهوية ستسد اختلالات ونواقص التخطيط العمراني وخصوصيات العالم القروي  .', 'size': 2}], 'main_title': 'المنصوري: البناء في العالم القروي أولوية حكومية وآلاف الأسر استفادت من “دعم السكن”'}, {'community_id': '7', 'articles': [{'id': '170', 'title': 'عجز الميزانية يتفاقم.. وصل إلى 26.8 مليار درهم نهاية ماي', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%b9%d8%ac%d8%b2-%d8%a7%d9%84%d9%85%d9%8a%d8%b2%d8%a7%d9%86%d9%8a%d8%a9-%d9%8a%d8%aa%d9%81%d8%a7%d9%82%d9%85-%d8%a8%d9%88%d8%b5%d9%88%d9%84%d9%87-%d8%a5%d9%84%d9%89-26-8-%d9%85%d9%84%d9%8a%d8%a7/', 'summary': 'عجز الميزانية يتفاقم.. وصل إلى 26.8 مليار درهم نهاية ماي. أعلنت وزارة الاقتصاد والمالية أن وضعية التحملات وموارد الخزينة كشفت عن عجز في الميزانية بقيمة 26,8 مليار درهم عند متم ماي 2025، مقابل 17,7 مليار درهم خلال الفترة ذاتها قبل سنة. وذكرت الوزارة، في وثيقة حول وضعية التحملات وموارد الخزينة، أن هذا التطور يعكس ارتفاعا في النفقات العامة (زائد 31,9 مليار درهم)، أهم من المداخيل  عجز الميزانية يتفاقم.. وصل إلى 26.8 مليار درهم نهاية ماي     .', 'size': 2}, {'id': '357', 'title': 'نفقات الدولة ترتفع بأزيد من 30 مليار درهم.. ووتيرة العجز المالي تتسارع', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/317132/', 'summary': 'نفقات الدولة ترتفع بأزيد من 30 مليار درهم.. ووتيرة العجز المالي تتسارع. أفادت وزارة الاقتصاد والمالية أن عجز الميزانية بلغ 26,8 مليار درهم مع نهاية شهر ماي 2025، مقابل 17,7 مليار درهم خلال نفس الفترة من سنة 2024، وفقًا لآخر المؤشرات المتعلقة بوضعية التحملات وموارد الخزينة. وأوضحت الوزارة، في الوثيقة الصادرة بهذا الخصوص، أن هذا التفاقم في العجز يُعزى إلى ارتفاع النفقات العمومية بما مجموعه 31,9 مليار', 'size': 2}], 'main_title': 'عجز الميزانية يتفاقم.. وصل إلى 26.8 مليار درهم نهاية ماي'}, {'community_id': '9', 'articles': [{'id': '188', 'title': 'مباحثات مغربية سعودية لتوطيد العلاقات الاقتصادية الثنائية وبحث آفاق جديدة للاستثمار', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/468185.html', 'summary': 'مباحثات مغربية سعودية لتوطيد العلاقات الاقتصادية الثنائية وبحث آفاق جديدة للاستثمار. متابعة استقبل وزير الصناعة والتجارة، رياض مزور، الثلاثاء بالرباط، وفدا اقتصاديا سعوديا هاما يقوده رئيس اتحاد غرف التجارة السعودية، حسن بن معجب الحويزي، في زيارة استكشافية تروم توطيد العلاقات الاقتصادية الثنائية وبحث آفاق جديدة للاستثمار بالمغرب. ويهدف هذا اللقاء، الذي يندرج في إطار تعزيز وتقوية العلاقات الثنائية بين المغرب والسعودية، إلى بحث السبل الكفيلة بتيسير …', 'size': 2}, {'id': '335', 'title': 'وفد اقتصادي سعودي يحل بالرباط.. المغرب والسعودية عازمان على توطيد التعاون الاقتصادي', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%88%d9%81%d8%af-%d8%a7%d9%82%d8%aa%d8%b5%d8%a7%d8%af%d9%8a-%d8%b3%d8%b9%d9%88%d8%af%d9%8a-%d9%8a%d8%ad%d9%84-%d8%a8%d8%a7%d9%84%d8%b1%d8%a8%d8%a7%d8%b7-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d9%88/', 'summary': 'وفد اقتصادي سعودي يحل بالرباط.. المغرب والسعودية عازمان على توطيد التعاون الاقتصادي. استقبل وزير الصناعة والتجارة، رياض مزور، اليوم الثلاثاء (1 يوليوز) بالرباط، وفدا اقتصاديا سعوديا هاما يقوده رئيس اتحاد غرف التجارة السعودية، حسن بن معجب الحويزي، في زيارة استكشافية تروم توطيد العلاقات الاقتصادية الثنائية وبحث آفاق جديدة للاستثمار بالمغرب. ويهدف هذا اللقاء، الذي يندرج في إطار تعزيز وتقوية العلاقات الثنائية بين المغرب والسعودية، إلى بحث السبل', 'size': 2}], 'main_title': 'مباحثات مغربية سعودية لتوطيد العلاقات الاقتصادية الثنائية وبحث آفاق جديدة للاستثمار'}, {'community_id': '10', 'articles': [{'id': '195', 'title': 'بونو خرافي ومتألق.. الإعلام الدولي يشيد بأداء حارس الأسود أمام “مانشستر سيتي”', 'source': 'machahid24.com', 'link': 'https://machahid24.com/sport/468151.html', 'summary': 'بونو خرافي ومتألق.. الإعلام الدولي يشيد بأداء حارس الأسود أمام “مانشستر سيتي”. تفاعلت الصحافة الدولية مع الأداء الأسطوري للحارس المغربي ياسين بونو، في المباراة التي جمعت فريقه الهلال السعودي بفريق مانشستر سيتي الإنجليزي، ضمن منافسات كأس العالم للأندية.', 'size': 2}, {'id': '354', 'title': 'العالم يصفق للأخطبوط بونو.. تصديات خيالية تُعيد أمجاد مونديال قطر', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/317128/', 'summary': 'العالم يصفق للأخطبوط بونو.. تصديات خيالية تُعيد أمجاد مونديال قطر. خطف الحارس المغربي ياسين بونو الأضواء خلال مواجهة الهلال السعودي أمام مانشستر سيتي الإنجليزي، ضمن منافسات كأس العالم للأندية، بعدما قدّم أداءً لافتًا أسهم بشكل مباشر في تأهل فريقه إلى الدور ربع النهائي، عقب فوز مثير بأربعة أهداف مقابل ثلاثة. ورغم استقبال الهلال لهدف مبكر في الدقائق الأولى من اللقاء، نجح بونو في الحفاظ على', 'size': 2}], 'main_title': 'بونو خرافي ومتألق.. الإعلام الدولي يشيد بأداء حارس الأسود أمام “مانشستر سيتي”'}, {'community_id': '11', 'articles': [{'id': '308', 'title': 'عاجل.. الحكم على محمد بودريقة بـ5 سنوات سجنا نافذا وغرامة قدرها 564 ألف درهم', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-636027.html', 'summary': 'عاجل.. الحكم على محمد بودريقة بـ5 سنوات سجنا نافذا وغرامة قدرها 564 ألف درهم. هبة بريس - الدار البيضاء أصدرت المحكمة الزجرية الابتدائية بعين السبع بالدار البيضاء، اليوم الثلاثاء فاتح يوليوز 2025، حكمًا يقضي بإدانة محمد بودريقة ، الرئيس الأسبق لنادي الرجاء الرياضي والبرلماني السابق عن حزب التجمع الوطني للأحرار، بالسجن خمس سنوات حبسا نافذا، وغرامة مالية قدرها 564 ألف درهم. وجاء هذا الحكم بعد متابعة بودريقة في حالة اعتقال، بناءً على قرار صادر عن قاضي التحقيق بالمحكمة ذاتها، وذلك على خلفية اتهامه بعدة تهم ثقيلة، أبرزها إصدار شيكات بدون مؤونة، والنصب، والتزوير في محرر عرفي واستعماله، إضافة إلى التوصل بغير وجه حق إلى شهادة تصدرها الإدارة العامة واستعمالها.', 'size': 4}, {'id': '319', 'title': 'خمس سنوات سجنا نافذا في حق \u200eمحمد بودريقة وغرامة تفوق 650 ألف درهم', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/202787', 'summary': 'خمس سنوات سجنا نافذا في حق \u200eمحمد بودريقة وغرامة تفوق 650 ألف درهم.  أصدرت المحكمة الزجرية الابتدائية بعين السبع بمدينة الدار البيضاء، مساء الثلاثاء فاتح يوليوز 2025، حكمها في حق محمد بودريقة، الرئيس السابق لنادي الرجاء البيضاوي لكرة القدم، والنائب البرلماني السابق عن حزب التجمع الوطني للأحرار. وقضت المحكمة، بإدانة محمد بودريقة، بخمس سنوات حبسا نافذا، مع أداء غرامة، ومنعه من إصدار الشيكات لمدة سنة. وتوبع محمد', 'size': 5}, {'id': '338', 'title': 'رسميا.. إدانة بودريقة بـ5 سنوات سجنا نافذا', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%b1%d8%b3%d9%85%d9%8a%d8%a7-%d8%a5%d8%af%d8%a7%d9%86%d8%a9-%d8%a8%d9%88%d8%af%d8%b1%d9%8a%d9%82%d8%a9-%d8%a8%d9%805-%d8%b3%d9%86%d9%88%d8%a7%d8%aa-%d8%b3%d8%ac%d9%86%d8%a7-%d9%86%d8%a7%d9%81/', 'summary': 'رسميا.. إدانة بودريقة بـ5 سنوات سجنا نافذا. أدانت المحكمة الزجرية الابتدائية بعين السبع بالدار البيضاء، اليوم الثلاثاء (1 يوليوز)، محمد بودريقة، الرئيس السابق لنادي الرجاء، بـ5 سنوات سجنا نافذا. كما قضت المحكمة بإدانة بودريقة بغرامة مالية قدرها 660 ألف درهم، والمنع من إصدار الشيكات لمدة سنة، وذلك بـ”تهمة إصدار شيكات بدون رصيد والنصب والتزوير في محرر رسمي واستعماله والتوصل بغير حق لشهادة', 'size': 4}, {'id': '394', 'title': 'خمس سنوات سجنا نافذا لبودريقة في قضايا التزوير والنصب', 'source': 'rue20.com', 'link': 'https://rue20.com/917394.html', 'summary': 'خمس سنوات سجنا نافذا لبودريقة في قضايا التزوير والنصب.  الرباط أصدرت المحكمة الزجرية بعين السبع، مساء الثلاثاء 1 يوليوز، حكمًا بالسجن النافذ في حق محمد بودريقة، الرئيس السابق لنادي الرجاء الرياضي والبرلماني السابق. وقضت المحكمة بإدانة بودريقة بخمس سنوات حبسًا نافذًا، بالإضافة إلى غرامة مالية، بعد متابعته في عدد من القضايا المرتبطة بجنح إصدار شيكات بدون رصيد، والنصب، والتزوير في محرر رسمي واستعماله، الخبر خمس سنوات سجنا نافذا لبودريقة في قضايا التزوير والنصب  .', 'size': 3}, {'id': '439', 'title': 'الحكم على محمد بودريقة بـ5 سنوات سجنا نافذة', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d8%ad%d9%83%d9%85-%d8%b9%d9%84%d9%89-%d9%85%d8%ad%d9%85%d8%af-%d8%a8%d9%88%d8%af%d8%b1%d9%8a%d9%82%d8%a9-%d8%a8%d9%805-%d8%b3%d9%86%d9%88%d8%a7%d8%aa-%d8%b3%d8%ac%d9%86%d8%a7-%d9%86%d8%a7/', 'summary': 'الحكم على محمد بودريقة بـ5 سنوات سجنا نافذة. أصدرت المحكمة الزجرية الابتدائية بعين السبع، اليوم الثلاثاء 1 يوليوز 2025، حكما، يقضي بإدانة محمد بودريقة، الرئيس الأسبق لنادي الرجاء الرياضي والبرلماني السابق عن حزب التجمع الوطني للأحرار، بالسجن لمدة خمس سنوات حبسا نافذا. وكان قاضي التحقيق بالمحكمة الابتدائية عين السبع بالدار البيضاء قرر متابعة محمد بودريقة في حالة اعتقال، حيث سطّر تهما …  الحكم على محمد بودريقة بـ5 سنوات سجنا نافذة     .', 'size': 3}], 'main_title': 'خمس سنوات سجنا نافذا في حق \u200eمحمد بودريقة وغرامة تفوق 650 ألف درهم'}, {'community_id': '12', 'articles': [{'id': '337', 'title': 'موازين 2025.. الدورة الـ20 استقطبت أكثر من 3,75 مليون من عشاق الموسيقى', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%85%d9%88%d8%a7%d8%b2%d9%8a%d9%86-2025-%d8%a7%d9%84%d8%af%d9%88%d8%b1%d8%a9-%d8%a7%d9%84%d9%8020-%d8%a7%d8%b3%d8%aa%d9%82%d8%b7%d8%a8%d8%aa-%d8%a3%d9%83%d8%ab%d8%b1-%d9%85%d9%86-375-%d9%85%d9%84/', 'summary': 'موازين 2025.. الدورة الـ20 استقطبت أكثر من 3,75 مليون من عشاق الموسيقى. أعلنت جمعية مغرب الثقافات أن النسخة الـ20 من مهرجان موازين-إيقاعات العالم استقطبت أزيد من 3,75 مليون من عشاق الموسيقى الذين حضروا للاحتفاء بالفن في تعدديته، والاحتكاك بأكثر من 100 فنان من مختلف أنحاء العالم. وتحت الرعاية السامية لصاحب الجلالة الملك محمد السادس، اختتمت، مساء السبت (28 يونيو)، فعاليات هذه الدورة، في أجواء استثنائية امتزج فيها', 'size': 3}, {'id': '399', 'title': 'موازين 2025 يستقطب أزيد من 3,75 مليون من عشاق الموسيقى', 'source': 'machahid24.com', 'link': 'https://machahid24.com/panorama/468195.html', 'summary': 'موازين 2025 يستقطب أزيد من 3,75 مليون من عشاق الموسيقى. متابعة أعلنت جمعية مغرب الثقافات أن النسخة الـ20 من مهرجان موازين-إيقاعات العالم استقطبت أزيد من 3,75 مليون من عشاق الموسيقى الذين حضروا للاحتفاء بالفن في تعدديته، والاحتكاك بأكثر من 100 فنان من مختلف أنحاء العالم. وتحت الرعاية السامية للملك محمد السادس، اختُتمت مساء السبت فعاليات هذه الدورة، في أجواء استثنائية امتزج فيها الزخم الجماهيري بالتألق …', 'size': 2}, {'id': '436', 'title': 'مهرجان موازين يستقطب أكثر من 3,75 مليون متفرج ويحتفي بأزيد من 100 فنان عالمي', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%85%d9%87%d8%b1%d8%ac%d8%a7%d9%86-%d9%85%d9%88%d8%a7%d8%b2%d9%8a%d9%86-%d9%8a%d8%b3%d8%aa%d9%82%d8%b7%d8%a8-%d8%a3%d9%83%d8%ab%d8%b1-%d9%85%d9%86-375-%d9%85%d9%84%d9%8a%d9%88%d9%86-%d9%85%d8%aa/', 'summary': 'مهرجان موازين يستقطب أكثر من 3,75 مليون متفرج ويحتفي بأزيد من 100 فنان عالمي. أعلنت جمعية مغرب الثقافات أن النسخة الـ20 من مهرجان موازين-إيقاعات العالم استقطبت أزيد من 3,75 مليون من عشاق الموسيقى الذين حضروا للاحتفاء بالفن في تعدديته، والاحتكاك بأكثر من 100 فنان من مختلف أنحاء العالم. وتحت الرعاية السامية للملك محمد السادس، اختُتمت مساء السبت فعاليات هذه الدورة، في أجواء استثنائية امتزج فيها الزخم الجماهيري …  مهرجان موازين يستقطب أكثر من 3,75 مليون متفرج ويحتفي بأزيد من 100 فنان عالمي     .', 'size': 2}], 'main_title': 'موازين 2025.. الدورة الـ20 استقطبت أكثر من 3,75 مليون من عشاق الموسيقى'}, {'community_id': '5', 'articles': [{'id': '339', 'title': 'من ضمنهم 3 آلاف في العالم القروي.. 54 ألف مستفيد من برنامج دعم السكن', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%85%d9%86-%d8%b6%d9%85%d9%86%d9%87%d9%85-3-%d8%a2%d9%84%d8%a7%d9%81-%d9%81%d9%8a-%d8%a7%d9%84%d8%b9%d8%a7%d9%84%d9%85-%d8%a7%d9%84%d9%82%d8%b1%d9%88%d9%8a-54-%d8%a3%d9%84%d9%81-%d9%85%d8%b3%d8%aa/', 'summary': 'من ضمنهم 3 آلاف في العالم القروي.. 54 ألف مستفيد من برنامج دعم السكن. أفاد كاتب الدولة المكلف بالإسكان، أديب بن إبراهيم، اليوم الثلاثاء (1 يوليوز)، بأن عدد المستفيدين من برنامج الدعم المباشر للسكن بلغ 54 ألف مستفيد، من بينهم 3 آلاف في العالم القروي. وأوضح السيد بن إبراهيم، في معرض رده على سؤال شفوي بمجلس المستشارين حول “مدى استفادة المناطق القروية والجبلية من برامج دعم السكن”، أن عدد', 'size': 4}, {'id': '351', 'title': '54 ألف مستفيد من برنامج دعم السكن ضمنهم 3 آلاف في العالم القروي', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/317152/', 'summary': '54 ألف مستفيد من برنامج دعم السكن ضمنهم 3 آلاف في العالم القروي. أفاد كاتب الدولة المكلف بالإسكان، أديب بن إبراهيم، اليوم الثلاثاء، بأن عدد المستفيدين من برنامج الدعم المباشر للسكن بلغ 54 ألف مستفيد، من بينهم 3 آلاف في العالم القروي. وأوضح بن إبراهيم، في معرض رده على سؤال شفوي بمجلس المستشارين حول “مدى استفادة المناطق القروية والجبلية من برامج دعم السكن”، أن عدد الطلبات التي تم', 'size': 4}, {'id': '387', 'title': '54 ألف مستفيد حتى الآن من برنامج الدعم المباشر للسكن', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/54-%d8%a3%d9%84%d9%81-%d9%85%d8%b3%d8%aa%d9%81%d9%8a%d8%af-%d8%ad%d8%aa%d9%89-%d8%a7%d9%84%d8%a2%d9%86-%d9%85%d9%86-%d8%a8%d8%b1%d9%86%d8%a7%d9%85%d8%ac-%d8%a7%d9%84%d8%af%d8%b9%d9%85-%d8%a7%d9%84/', 'summary': '54 ألف مستفيد حتى الآن من برنامج الدعم المباشر للسكن. قال كاتب الدولة المكلف بالإسكان، أديب بن إبراهيم، الثلاثاء، إن عدد المستفيدين من برنامج الدعم المباشر للسكن بلغ 54 ألف مستفيد، من بينهم 3 آلاف في العالم القروي. وأوضح بن إبراهيم، في معرض رده على سؤال شفوي بمجلس المستشارين حول "مدى استفادة المناطق القروية والجبلية من برامج دعم السكن"، أن عدد الطلبات التي تم استقبالها  54 ألف مستفيد حتى الآن من برنامج الدعم المباشر للسكن     .', 'size': 4}, {'id': '426', 'title': 'بن إبراهيم: 54 ألف مستفيدا من برنامج دعم السكن ضمنهم 3 آلاف في العالم القروي', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/223863/', 'summary': 'بن إبراهيم: 54 ألف مستفيدا من برنامج دعم السكن ضمنهم 3 آلاف في العالم القروي. كواليس اليوم أفاد كاتب الدولة المكلف بالإسكان، أديب بن إبراهيم، اليوم الثلاثاء، بأن عدد المستفيدين من برنامج الدعم المباشر للسكن بلغ 54 ألف مستفيد، من بينهم 3 آلاف في العالم القروي. وأوضح بن إبراهيم، في معرض رده على سؤال شفوي بمجلس المستشارين حول “مدى استفادة المناطق القروية والجبلية من برامج دعم السكن”، أن عدد', 'size': 4}], 'main_title': 'من ضمنهم 3 آلاف في العالم القروي.. 54 ألف مستفيد من برنامج دعم السكن'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    