<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 21/07/2025 - 18h32</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '3', 'articles': [{'id': '0', 'title': 'مقدونيا الشمالية تدعم الحكم الذاتي', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d9%85%d9%82%d8%af%d9%88%d9%86%d9%8a%d8%a7-%d8%a7%d9%84%d8%b4%d9%85%d8%a7%d9%84%d9%8a%d8%a9-%d8%aa%d8%af%d8%b9%d9%85-%d8%a7%d9%84%d8%ad%d9%83%d9%85-%d8%a7%d9%84%d8%b0%d8%a7%d8%aa%d9%8a-1596609.html', 'summary': 'مقدونيا الشمالية تدعم الحكم الذاتي. أكدت جمهورية مقدونيا الشمالية أنها “تعتبر مخطط الحكم الذاتي الذي تقدم به المغرب في 2007، الأساس الوحيد لتسوية هذا النزاع”. هذا الموقف تم التعبير عنه في الإعلان المشترك الموقع من قبل وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج، ناصر بوريطة، ووزير الشؤون الخارجية والتجارة الخارجية لجمهورية مقدونيا الشمالية، تيمتشو موتسونسكي، وذلك قي أعقاب لقائهما  مقدونيا الشمالية تدعم الحكم الذاتي     - هسبريس جريدة إلكترونية مغربية .', 'size': 4}, {'id': '160', 'title': 'جمهورية مقدونيا الشمالية: مخطط الحكم الذاتي الأساس الوحيد لتسوية نزاع الصحراء', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1086996.html', 'summary': 'جمهورية مقدونيا الشمالية: مخطط الحكم الذاتي الأساس الوحيد لتسوية نزاع الصحراء. أكدت جمهورية مقدونيا الشمالية أنها “تعتبر مخطط الحكم الذاتي الذي تقدم به المغرب في 2007 ، الأساس الوحيد لتسوية هذا النزاع”. هذا الموقف تم التعبير عنه في الإعلان المشترك، الموقع من قبل وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج ناصر بوريطة ووزير الشؤون الخارجية والتجارة الخارجية لجمهورية مقدونيا الشمالية تيمتشو موتسونسكي، وذلك قي أعقاب ظهرت المقالة جمهورية مقدونيا الشمالية: مخطط الحكم الذاتي الأساس الوحيد لتسوية نزاع الصحراء  .', 'size': 4}, {'id': '360', 'title': 'مقدونيا الشمالية تعتبر مخطط الحكم الذاتي الأساس الوحيد لتسوية النزاع حول الصحراء', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/318891/', 'summary': 'مقدونيا الشمالية تعتبر مخطط الحكم الذاتي الأساس الوحيد لتسوية النزاع حول الصحراء. أكدت جمهورية مقدونيا الشمالية أنها “تعتبر مخطط الحكم الذاتي الذي تقدم به المغرب في 2007 ، الأساس الوحيد لتسوية هذا النزاع”. هذا الموقف تم التعبير عنه في الإعلان المشترك، الموقع من قبل وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج ناصر بوريطة ووزير الشؤون الخارجية والتجارة الخارجية لجمهورية مقدونيا الشمالية تيمتشو موتسونسكي، وذلك قي أعقاب', 'size': 4}, {'id': '441', 'title': 'جمهورية مقدونيا الشمالية: الحكم الذاتي هو الأساس الوحيد لتسوية نزاع الصحراء', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/224982/', 'summary': 'جمهورية مقدونيا الشمالية: الحكم الذاتي هو الأساس الوحيد لتسوية نزاع الصحراء. أكدت جمهورية مقدونيا الشمالية أنها “تعتبر مخطط الحكم الذاتي الذي تقدم به المغرب في 2007 ، الأساس الوحيد لتسوية هذا النزاع”. هذا الموقف تم التعبير عنه في الإعلان المشترك، الموقع من قبل وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج ناصر بوريطة ووزير الشؤون الخارجية والتجارة الخارجية لجمهورية مقدونيا الشمالية تيمتشو موتسونسكي، وذلك قي أعقاب', 'size': 4}], 'main_title': 'مقدونيا الشمالية تدعم الحكم الذاتي'}, {'community_id': '13', 'articles': [{'id': '6', 'title': 'حجز كوكايين خام بطنجة المتوسط', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d8%a3%d9%85%d9%86-%d8%b7%d9%86%d8%ac%d8%a9-%d8%a7%d9%84%d9%85%d8%aa%d9%88%d8%b3%d8%b7-%d9%8a%d8%ad%d8%ac%d8%b2-%d9%83%d9%88%d9%83%d8%a7%d9%8a%d9%8a%d9%86-%d8%ae%d8%a7%d9%85-1596581.html', 'summary': 'حجز كوكايين خام بطنجة المتوسط. تمكنت عناصر الشرطة بمنطقة أمن ميناء طنجة المتوسط، يوم الأحد 20 يوليوز الجاري، من إجهاض عملية للتهريب الدولي لشحنة بلغ مجموع وزنها 25 كيلوغراما من مخدر الكوكايين الخام، جرى حجزها على متن حاوية للنقل الدولي للبضائع. وكانت عملية المراقبة الأمنية التي أخضعت لها هذه الحاوية القادمة من أحد موانئ أمريكا الجنوبية والمتوجهة إلى ميناء هولندي،  حجز كوكايين خام بطنجة المتوسط     - هسبريس جريدة إلكترونية مغربية .', 'size': 5}, {'id': '127', 'title': 'ميناء طنجة المتوسط.. إحباط عملية للتهريب الدولي للمخدرات وحجز 25 كلغ من الكوكايين', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%85%d9%8a%d9%86%d8%a7%d8%a1-%d8%b7%d9%86%d8%ac%d8%a9-%d8%a7%d9%84%d9%85%d8%aa%d9%88%d8%b3%d8%b7-%d8%a5%d8%ad%d8%a8%d8%a7%d8%b7-%d8%b9%d9%85%d9%84%d9%8a%d8%a9-%d9%84%d9%84%d8%aa%d9%87%d8%b1%d9%8a/', 'summary': 'ميناء طنجة المتوسط.. إحباط عملية للتهريب الدولي للمخدرات وحجز 25 كلغ من الكوكايين. تمكنت عناصر الشرطة بمنطقة أمن ميناء طنجة المتوسط، أمس الأحد (20 يوليوز)، من إجهاض عملية للتهريب الدولي لشحنة بلغ مجموع وزنها 25 كيلوغراما من مخدر الكوكايين الخام، جرى حجزها على متن حاوية للنقل الدولي للبضائع. ومكنت عملية المراقبة الأمنية التي أخضعت لها هذه الحاوية القادمة من أحد موانئ أمريكا الجنوبية والمتوجهة إلى ميناء هولندي، من', 'size': 5}, {'id': '165', 'title': 'شرطة ميناء طنجة تحبط تهريب 25 كيلوغراما من الكوكايين داخل حاوية متجهة لأوروبا', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1086977.html', 'summary': 'شرطة ميناء طنجة تحبط تهريب 25 كيلوغراما من الكوكايين داخل حاوية متجهة لأوروبا. تمكنت عناصر الشرطة بمنطقة أمن ميناء طنجة المتوسط، يوم الأحد 20 يوليوز الجاري، من إجهاض عملية للتهريب الدولي لشحنة بلغ مجموع وزنها 25 كيلوغراما من مخدر الكوكايين الخام، جرى حجزها على متن حاوية للنقل الدولي للبضائع. وكانت عملية المراقبة الأمنية التي أخضعت لها هذه الحاوية القادمة من أحد موانئ أمريكا الجنوبية والمتوجهة إلى ميناء هولندي، ظهرت المقالة شرطة ميناء طنجة تحبط تهريب 25 كيلوغراما من الكوكايين داخل حاوية متجهة لأوروبا  .', 'size': 5}, {'id': '186', 'title': 'شرطة ميناء طنجة المتوسط تجهض محاولة لتهريب 25 كيلوغراما من الكوكايين', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%b4%d8%b1%d8%b7%d8%a9-%d9%85%d9%8a%d9%86%d8%a7%d8%a1-%d8%b7%d9%86%d8%ac%d8%a9-%d8%a7%d9%84%d9%85%d8%aa%d9%88%d8%b3%d8%b7-%d8%aa%d8%ac%d9%87%d8%b6-%d9%85%d8%ad%d8%a7%d9%88%d9%84%d8%a9-%d9%84%d8%aa/', 'summary': 'شرطة ميناء طنجة المتوسط تجهض محاولة لتهريب 25 كيلوغراما من الكوكايين. تمكنت عناصر الشرطة بمنطقة أمن ميناء طنجة المتوسط، يوم الأحد 20 يوليوز الجاري، من إجهاض عملية للتهريب الدولي لشحنة بلغ مجموع وزنها 25 كيلوغراما من مخدر الكوكايين الخام، جرى حجزها على متن حاوية للنقل الدولي للبضائع. وأوضح مصدر أمني أن عملية المراقبة الأمنية التي أخضعت لها هذه الحاوية القادمة من أحد موانئ أمريكا الجنوبية والمتوجهة  شرطة ميناء طنجة المتوسط تجهض محاولة لتهريب 25 كيلوغراما من الكوكايين     .', 'size': 5}, {'id': '230', 'title': 'ميناء طنجة المتوسط: إجهاض عملية للتهريب الدولي لشحنة وزنها 25 كيلوغراما من الكوكايين الخام', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/224974/', 'summary': 'ميناء طنجة المتوسط: إجهاض عملية للتهريب الدولي لشحنة وزنها 25 كيلوغراما من الكوكايين الخام. تمكنت عناصر الشرطة بمنطقة أمن ميناء طنجة المتوسط، يوم الأحد 20 يوليوز الجاري، من إجهاض عملية للتهريب الدولي لشحنة بلغ مجموع وزنها 25 كيلوغراما من مخدر الكوكايين الخام، جرى حجزها على متن حاوية للنقل الدولي للبضائع. وكانت عملية المراقبة الأمنية التي أخضعت لها هذه الحاوية القادمة من أحد موانئ أمريكا الجنوبية والمتوجهة إلى ميناء هولندي،', 'size': 5}], 'main_title': 'حجز كوكايين خام بطنجة المتوسط'}, {'community_id': '7', 'articles': [{'id': '100', 'title': 'معهد واشنطن: الجزائر أمام مفترق طرق في ملف الصحراء المغربية', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/politic/409655.html', 'summary': 'معهد واشنطن: الجزائر أمام مفترق طرق في ملف الصحراء المغربية. أكد معهد واشنطن لسياسات الشرق الأدنى، في تقرير، أن الجزائر تقف اليوم أمام خيارين حاسمين في ما يتعلق بنزاع الصحراء المغربية: إما الانخراط بشكل جاد', 'size': 2}, {'id': '152', 'title': 'الصحراء المغربية تحاصر الجزائر.. ومعهد واشنطن يدق ناقوس الخطر', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-581252.html', 'summary': 'الصحراء المغربية تحاصر الجزائر.. ومعهد واشنطن يدق ناقوس الخطر. أكد معهد واشنطن لسياسات الشرق الأدنى، في تقرير جديد، أن الجزائر أصبحت أمام مفترق طرق حاسم بخصوص نزاع الصحراء المغربية، فإما أن تنخرط بشكل جدي ومسؤول في مسار التسوية السياسية، أو تواجه مزيدا من العزلة الدولية المتصاعدة. وأشار التقرير إلى أن المملكة المغربية نجحت في توسيع دائرة الدعم الدولي لمبادرة الحكم الذاتي، خصوصا', 'size': 2}], 'main_title': 'معهد واشنطن: الجزائر أمام مفترق طرق في ملف الصحراء المغربية'}, {'community_id': '8', 'articles': [{'id': '102', 'title': 'صحفي مغربي يكشف أمورا مريبة تعرضت لها سفينة "حنظلة" المتجهة نحو غزة', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/world/409657.html', 'summary': 'صحفي مغربي يكشف أمورا مريبة تعرضت لها سفينة "حنظلة" المتجهة نحو غزة. كشف الصحفي المغربي محمد البقالي، العامل بشبكة الجزيرة، عن تفاصيل مثيرة تتعلق بمحاولة تخريب طالت سفينة "حنظلة" المتجهة نحو غزة ضمن أسطول الحرية الرامي إلى', 'size': 2}, {'id': '153', 'title': '“حنظلة” تنجو من الكمين.. صحفي مغربي يروي ما لم يعلن عن أسطول الحرية', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-581246.html', 'summary': '“حنظلة” تنجو من الكمين.. صحفي مغربي يروي ما لم يعلن عن أسطول الحرية. كشف الصحفي المغربي محمد البقالي، مراسل شبكة الجزيرة، عن معطيات مثيرة تتعلق بمحاولة تخريب استهدفت سفينة “حنظلة” التي تُشارك في “أسطول الحرية” المتجه إلى قطاع غزة، في مسعى لكسر الحصار الإسرائيلي المضروب على القطاع. وأوضح البقالي، في تدوينة نشرها على صفحته الرسمية بموقع “فيسبوك”، أن طاقم السفينة اكتشف، قبيل انطلاق الرحلة، حبلا', 'size': 2}], 'main_title': 'صحفي مغربي يكشف أمورا مريبة تعرضت لها سفينة "حنظلة" المتجهة نحو غزة'}, {'community_id': '4', 'articles': [{'id': '105', 'title': 'مجزرة المساعدات في غزة.. 93 شهيداً برصاص الاحتلال أثناء انتظار رغيف الخبز', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/world/409660.html', 'summary': 'مجزرة المساعدات في غزة.. 93 شهيداً برصاص الاحتلال أثناء انتظار رغيف الخبز. أعلن الدفاع المدني في غزة استشهاد 93 فلسطينيا على الأقل عندما أطلقت القوات لإسرائيلية النار باتجاه أشخاص ينتظرون الحصول على مساعدات، غالبيتهم في شمال القطاع،', 'size': 2}, {'id': '209', 'title': 'غزة.. غارات مكثفة بالقطاع والمجاعة تفتك بالسكان', 'source': 'machahid24.com', 'link': 'https://machahid24.com/international/470077.html', 'summary': 'غزة.. غارات مكثفة بالقطاع والمجاعة تفتك بالسكان. في اليوم الـ654 من حرب الإبادة على غزة، يستمر إغلاق المعابر ومنع عبور الإمدادات الإنسانية للقطاع، ومع الإغلاق بات الجوع سلاحا لا يقل فتكا عن القصف الإسرائيلي.', 'size': 2}], 'main_title': 'مجزرة المساعدات في غزة.. 93 شهيداً برصاص الاحتلال أثناء انتظار رغيف الخبز'}, {'community_id': '9', 'articles': [{'id': '149', 'title': 'توقعات طقس اليوم الاثنين بالبلاد', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/318855/', 'summary': 'توقعات طقس اليوم الاثنين بالبلاد. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الاثنين، أن يكون الطقس حارا نسبيا بجنوب الأقاليم الجنوبية، بالجنوب الشرقي، وبالمنطقة الشرقية وبسهول تادلة. ويرتقب تشكل سحب منخفضة وكتل ضبابية فوق كل من السهول الشمالية، والسواحل الوسطى، وغرب الأقاليم الجنوبية، كما سيلاحظ تمركز ضباب محلي شمال غرب الأقاليم الجنوبية. وستهم سحب غير مستقرة ومصحوبة برعد النصف الشمالي', 'size': 2}, {'id': '238', 'title': 'طقس اليوم الاثنين: عودة درجات الحرارة إلى اعتدال نسبي', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%a7%d9%84%d8%b7%d9%82%d8%b3-%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%a7%d8%ab%d9%86%d9%8a%d9%86-%d8%b9%d9%88%d8%af%d8%a9-%d8%af%d8%b1%d8%ac%d8%a7%d8%aa-%d8%a7%d9%84%d8%ad%d8%b1%d8%a7%d8%b1/', 'summary': 'طقس اليوم الاثنين: عودة درجات الحرارة إلى اعتدال نسبي. المساء اليوم: تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الاثنين، أن يكون الطقس حارا نسبيا بجنوب الأقاليم الجنوبية، بالجنوب-الشرقي، وبالمنطقة الشرقية وبسهول تادلة. ويُرتقب تشكل سحب منخفضة وكتل ضبابية فوق كل من السهول الشمالية، والسواحل', 'size': 2}], 'main_title': 'توقعات طقس اليوم الاثنين بالبلاد'}, {'community_id': '11', 'articles': [{'id': '166', 'title': 'الخطوط الملكية والبريد بنك يطلقان خدمة رقمية مبتكرة بمطار البيضاء', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1086974.html', 'summary': 'الخطوط الملكية والبريد بنك يطلقان خدمة رقمية مبتكرة بمطار البيضاء. أعلنت الخطوط الملكية المغربية، بشراكة مع مجموعة البريد بنك، اليوم الإثنين، عن إطلاق حل رقمي جديد ومبتكر بمطار محمد الخامس بالدار البيضاء، يهدف إلى إعادة ابتكار تجربة المسافر من خلال مواكبة شخصية تعتمد على أحدث تقنيات الأداء اللاتلامسي. ويرتكز هذا الحل، الأول من نوعه بالمغرب، حسب بلاغ مشترك توصلت به “العمق”، على خدمة «Barid Payment ظهرت المقالة الخطوط الملكية والبريد بنك يطلقان خدمة رقمية مبتكرة بمطار البيضاء  .', 'size': 2}, {'id': '411', 'title': '“لارام” و”البريد بنك” يطلقان خدمة رقمية جديدة لفائدة المسافرين', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/470185.html', 'summary': '“لارام” و”البريد بنك” يطلقان خدمة رقمية جديدة لفائدة المسافرين. أعلنت الخطوط الملكية المغربية “لارام” ومجموعة “البريد بنك”، اليوم الاثنين، عن إطلاق حل رقمي جديد غير مسبوق يستخدم “Barid Payment Mobile” بهدف تقديم خدمة مخصصة لزبائن الشركة في مطار محمد الخامس الدولي بالدار البيضاء. وذكرت “لارام” و”البريد بنك”، في بلاغ مشترك، أن ھذه المبادرة، التي تعد الأولى من نوعھا بالمغرب، تندرج ضمن سعي الشركة الوطنیة …', 'size': 2}], 'main_title': 'الخطوط الملكية والبريد بنك يطلقان خدمة رقمية مبتكرة بمطار البيضاء'}, {'community_id': '0', 'articles': [{'id': '184', 'title': 'أمن أنفا يوقف المشتبه في ارتكابه جريمة الضرب والجرح بالسلاح الأبيض', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a3%d9%85%d9%86-%d8%a3%d9%86%d9%81%d8%a7-%d9%8a%d9%88%d9%82%d9%81-%d8%a7%d9%84%d9%85%d8%b4%d8%aa%d8%a8%d9%87-%d9%81%d9%8a-%d8%a7%d8%b1%d8%aa%d9%83%d8%a7%d8%a8%d9%87-%d8%ac%d8%b1%d9%8a%d9%85%d8%a9/', 'summary': 'أمن أنفا يوقف المشتبه في ارتكابه جريمة الضرب والجرح بالسلاح الأبيض. تمكنت عناصر الشرطة بمنطقة أمن أنفا بمدينة الدار البيضاء، خلال الساعات الأولى من صباح يوم الأحد 20 يوليوز الجاري، من توقيف المشتبه فيه الرئيسي في ارتكاب جريمة الضرب والجرح البليغين باستعمال السلاح الأبيض، والتي شكلت موضوع تسجيل فيديو متداول على شبكات التواصل الاجتماعي. وأوضح مصدر أمني أن مصالح الأمن الوطني بمدينة الدار البيضاء كانت قد  أمن أنفا يوقف المشتبه في ارتكابه جريمة الضرب والجرح بالسلاح الأبيض     .', 'size': 4}, {'id': '243', 'title': 'البيضاء.. الأمن يُطيح بمشتبه به في قضية ضرب وجرح خطيرة بسلاح أبيض', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d8%a8%d9%8a%d8%b6%d8%a7%d8%a1-%d8%a7%d9%84%d8%a3%d9%85%d9%86-%d9%8a%d9%8f%d8%b7%d9%8a%d8%ad-%d8%a8%d9%85%d8%b4%d8%aa%d8%a8%d9%87-%d8%a8%d9%87-%d9%81%d9%8a-%d9%82%d8%b6%d9%8a%d8%a9/', 'summary': 'البيضاء.. الأمن يُطيح بمشتبه به في قضية ضرب وجرح خطيرة بسلاح أبيض. تمكنت عناصر الشرطة بمنطقة أمن أنفا بمدينة الدار البيضاء، أمس الأحد، من توقيف المشتبه فيه الرئيسي في ارتكاب جريمة الضرب والجرح البليغين باستعمال السلاح الأبيض، والتي شكلت موضوع تسجيل فيديو متداول على شبكات التواصل الاجتماعي. وكشفت مصادر أمنية، أن مصالح الأمن الوطني بمدينة الدار البيضاء، كانت قد تفاعلت، بسرعة وجدية، مع هذا التسجيل …  البيضاء.. الأمن يُطيح بمشتبه به في قضية ضرب وجرح خطيرة بسلاح أبيض     .', 'size': 3}, {'id': '315', 'title': 'البيضاء.. إيقاف متورط في واقعة اعتداء بسلاح أبيض بمنطقة آنفا', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-642461.html', 'summary': 'البيضاء.. إيقاف متورط في واقعة اعتداء بسلاح أبيض بمنطقة آنفا. هبة بريس تمكنت عناصر الشرطة بمنطقة أمن أنفا بمدينة الدار البيضاء، خلال الساعات الأولى من صباح يوم الأحد 20 يوليوز الجاري، من توقيف المشتبه فيه الرئيسي في ارتكاب جريمة الضرب والجرح البليغين باستعمال السلاح الأبيض، والتي شكلت موضوع تسجيل فيديو متداول على شبكات التواصل الاجتماعي. وكانت مصالح الأمن الوطني بمدينة الدار البيضاء قد تفاعلت، بسرعة وجدية، مع هذا التسجيل المصور، حيث أظهرت الأبحاث الأولية أن الأمر يتعلق بقضية جرى تسجيلها صباح نفس اليوم بوسط منطقة أنفا، وتتعلق بتعرض الضحية لاعتداء جسدي باستعمال السلاح الأبيض، لأسباب وخلفيات تعكف الأبحاث على تحديدها، قبل أن تسفر التدخلات الأمنية عن تحديد هوية المشتبه فيه وتوقيفه بعد وقت وجيز من ارتكاب هذه الأفعال الإجرامية. وقد تم الاحتفاظ بالمشتبه فيه تحت تدبير الحراسة النظرية رهن إشارة البحث الذي تشرف عليه النيابة العامة المختصة، وذلك للكشف عن جميع ظروف وملابسات هذه القضية، وكذا تحديد الأفعال الإجرامية المنسوبة إليه.', 'size': 2}, {'id': '427', 'title': 'الدار البيضاء.. توقيف مشتبه به في جريمة اعتداء بواسطة سلاح أبيض', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%a7%d9%84%d8%af%d8%a7%d8%b1-%d8%a7%d9%84%d8%a8%d9%8a%d8%b6%d8%a7%d8%a1-%d8%aa%d9%88%d9%82%d9%8a%d9%81-%d9%85%d8%b4%d8%aa%d8%a8%d9%87-%d8%a8%d9%87-%d9%81%d9%8a-%d8%ac%d8%b1%d9%8a%d9%85%d8%a9/', 'summary': 'الدار البيضاء.. توقيف مشتبه به في جريمة اعتداء بواسطة سلاح أبيض. -متابعات أوقفت عناصر الشرطة بمنطقة أمن أنفا بمدينة الدار البيضاء، خلال الساعات الأولى من صباح الأحد 20 يوليوز، المشتبه فيه الرئيسي في ارتكاب جريمة الضرب والجرح البليغين باستعمال السلاح...  الدار البيضاء.. توقيف مشتبه به في جريمة اعتداء بواسطة سلاح أبيض     .', 'size': 3}], 'main_title': 'أمن أنفا يوقف المشتبه في ارتكابه جريمة الضرب والجرح بالسلاح الأبيض'}, {'community_id': '10', 'articles': [{'id': '200', 'title': 'الصحراء المغربية.. مقدونيا الشمالية تعتبر مخطط الحكم الذاتي الأساس الوحيد لتسوية النزاع', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/470135.html', 'summary': 'الصحراء المغربية.. مقدونيا الشمالية تعتبر مخطط الحكم الذاتي الأساس الوحيد لتسوية النزاع. أكدت جمهورية مقدونيا الشمالية أنها “تعتبر مخطط الحكم الذاتي الذي تقدم به المغرب في 2007 ، الأساس الوحيد لتسوية هذا النزاع”. هذا الموقف تم التعبير عنه في الإعلان المشترك', 'size': 2}, {'id': '331', 'title': 'المغرب يكسب حليفًا جديدًا في قضية الصحراء من قلب أوروبا الشرقية', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/politic/409683.html', 'summary': 'المغرب يكسب حليفًا جديدًا في قضية الصحراء من قلب أوروبا الشرقية. أكدت جمهورية مقدونيا الشمالية أنها "تعتبر مخطط الحكم الذاتي الذي تقدم به المغرب في 2007 ، الأساس الوحيد لتسوية هذا النزاع". هذا الموقف تم التعبير عنه', 'size': 2}], 'main_title': 'الصحراء المغربية.. مقدونيا الشمالية تعتبر مخطط الحكم الذاتي الأساس الوحيد لتسوية النزاع'}, {'community_id': '1', 'articles': [{'id': '313', 'title': 'طاطا.. إحباط محاولة تهريب دولي للمخدرات وحجز ما يقارب 600 كلغ من الشيرا', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-642466.html', 'summary': 'طاطا.. إحباط محاولة تهريب دولي للمخدرات وحجز ما يقارب 600 كلغ من الشيرا. هبة بريس تمكنت عناصر الشرطة بالمنطقة الإقليمية للأمن بمدينة طاطا، خلال الساعات الأولى من صباح اليوم الاثنين 21 يوليوز الجاري، من إحباط محاولة للتهريب الدولي للمخدرات وحجز 598 كيلوغراما و 500 غراما من مخدر الشيرا. وقد تم تنفيذ هذه العملية الأمنية بتنسيق مع عناصر الدرك الملكي بالمنطقة القروية "فم الحصن"، التي تبعد بحوالي 120 كيلومترا عن مدينة طاطا، وأسفرت عن حجز 20 رزمة من مخدر الشيرا بلغ مجموع وزنها 598 كيلوغراما و500 غراما، والتي تم اكتشافها مخبأة في منطقة صخرية في انتظار عملية تهريبها. وقد فتحت مصالح الشرطة القضائية بمدينة طاطا بحثا قضائيا تحت إشراف النيابة العامة المختصة، وذلك للكشف عن جميع ظروف وملابسات وخلفيات هذه القضية، وكذا توقيف جميع المتورطين في الشبكة الإجرامية الضالعة في هذه العملية. وتندرج هذه العملية الأمنية في سياق المجهودات المكثفة والمتواصلة التي تبذلها مصالح المديرية العامة للأمن الوطني، لمكافحة التهريب الدولي للمخدرات والمؤثرات العقلية.', 'size': 2}, {'id': '357', 'title': 'إحباط محاولة تهريب دولي للمخدرات بطاطا', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/318899/', 'summary': 'إحباط محاولة تهريب دولي للمخدرات بطاطا. تمكنت عناصر الشرطة بالمنطقة الإقليمية للأمن بمدينة طاطا، خلال الساعات الأولى من صباح اليوم الاثنين 21 يوليوز الجاري، من إحباط محاولة للتهريب الدولي للمخدرات وحجز 598 كيلوغراما و 500 غراما من مخدر الشيرا. وقد تم تنفيذ هذه العملية الأمنية بتنسيق مع عناصر الدرك الملكي بالمنطقة القروية “فم الحصن”، التي تبعد بحوالي 120 كيلومترا عن', 'size': 3}, {'id': '437', 'title': 'طاطا.. إحباط محاولة للتهريب الدولي للمخدرات وحجز 598 كيلوغراما و 500 غراما من الشيرا', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/224993/', 'summary': 'طاطا.. إحباط محاولة للتهريب الدولي للمخدرات وحجز 598 كيلوغراما و 500 غراما من الشيرا. تمكنت عناصر الشرطة بالمنطقة الإقليمية للأمن بمدينة طاطا، خلال الساعات الأولى من صباح اليوم الاثنين 21 يوليوز الجاري، من إحباط محاولة للتهريب الدولي للمخدرات وحجز 598 كيلوغراما و 500 غراما من مخدر الشيرا. وقد تم تنفيذ هذه العملية الأمنية بتنسيق مع عناصر الدرك الملكي بالمنطقة القروية “فم الحصن”، التي تبعد بحوالي 120 كيلومترا عن مدينة', 'size': 2}], 'main_title': 'إحباط محاولة تهريب دولي للمخدرات بطاطا'}, {'community_id': '6', 'articles': [{'id': '334', 'title': 'الأمن يضع يده على "صيد ثمين" بطاطا', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/409687.html', 'summary': 'الأمن يضع يده على "صيد ثمين" بطاطا. تمكنت عناصر الشرطة بالمنطقة الإقليمية للأمن بمدينة طاطا، خلال الساعات الأولى من صباح اليوم الاثنين 21 يوليوز الجاري، من إحباط محاولة للتهريب الدولي للمخدرات وحجز', 'size': 2}, {'id': '459', 'title': 'إحباط محاولة للتهريب الدولي للمخدرات بمدينة طاطا', 'source': 'www.alalam.ma', 'link': 'https://www.alalam.ma/إحباط-محاولة-للتهريب-الدولي-للمخدرات-بمدينة-طاطا_a28803.html', 'summary': 'إحباط محاولة للتهريب الدولي للمخدرات بمدينة طاطا. *العلم الإلكترونية* تمكنت عناصر الشرطة بالمنطقة الإقليمية للأمن بمدينة طاطا، خلال الساعات الأول...', 'size': 2}], 'main_title': 'الأمن يضع يده على "صيد ثمين" بطاطا'}, {'community_id': '5', 'articles': [{'id': '350', 'title': 'جلالة الملك يهنئ عاهلي بلجيكا بمناسبة العيد الوطني لبلدهما', 'source': 'assabah.ma', 'link': 'https://assabah.ma/860769.html', 'summary': 'جلالة الملك يهنئ عاهلي بلجيكا بمناسبة العيد الوطني لبلدهما. بعث صاحب الجلالة الملك محمد السادس برقية تهنئة إلى عاهلي مملكة بلجيكا، صاحب الجلالة الملك فيليب وصاحبة الجلالة الملكة ماتيلد، وذلك بمناسبة احتفال بلادهما بعيدها الوطني. وقال جلالة الملك، في هذه البرقية “يطيب لي، ومملكة بلجيكا تحتفل بعيدها الوطني، أن أبعث إليكم بأحر تهانئي، مقرونة بمتمنياتي الصادقةأكمل القراءة » المقالة جلالة الملك يهنئ عاهلي بلجيكا بمناسبة العيد الوطني لبلدهما  .', 'size': 2}, {'id': '450', 'title': 'الملك محمد السادس يهنئ عاهلي بلجيكا بمناسبة العيد الوطني لبلدهما', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7%d8%af%d8%b3-%d9%8a%d9%87%d9%86%d8%a6-%d8%b9%d8%a7%d9%87%d9%84%d9%8a-%d8%a8%d9%84%d8%ac%d9%8a%d9%83%d8%a7-%d8%a8%d9%85-3/', 'summary': 'الملك محمد السادس يهنئ عاهلي بلجيكا بمناسبة العيد الوطني لبلدهما. بعث الملك محمد السادس، برقية تهنئة إلى عاهلي مملكة بلجيكا، الملك فيليب والملكة ماتيلد، وذلك بمناسبة احتفال بلادهما بعيدها الوطني. وقال الملك محمد السادس، في هذه البرقية “يطيب لي، ومملكة بلجيكا تحتفل بعيدها الوطني، أن أبعث إليكم بأحر تهانئي، مقرونة بمتمنياتي الصادقة لكم ولكافة أفراد أسرتكم بدوام الصحة والهناء، وللشعب البلجيكي باطراد الرقي …  الملك محمد السادس يهنئ عاهلي بلجيكا بمناسبة العيد الوطني لبلدهما     .', 'size': 2}], 'main_title': 'جلالة الملك يهنئ عاهلي بلجيكا بمناسبة العيد الوطني لبلدهما'}, {'community_id': '12', 'articles': [{'id': '354', 'title': 'البنك الإفريقي للتنمية يمول برامج فلاحية في المغرب', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/318907/', 'summary': 'البنك الإفريقي للتنمية يمول برامج فلاحية في المغرب. وافق مجلس إدارة مجموعة البنك الإفريقي للتنمية على تمويل قدره 100 مليون أورو للمغرب من أجل تنفيذ برامج دعم الفلاحة التضامنية الشاملة للنساء والشباب. وأوضح البنك، في بيان، أن هذا المشروع يهدف إلى خلق فرص مستدامة للنساء والشباب، وتعزيز الأمن الغدائي، وتحسين إعداد الزراعة المغربية الصغيرة لمواجهة تحديات تغير المناخ. كما سيمكن هذا المشروع، بحسب', 'size': 3}, {'id': '364', 'title': '“البنك الأفريقي” يقرض المغرب 116 مليون دولار لدعم الفلاحة التضامنية', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-581328.html', 'summary': '“البنك الأفريقي” يقرض المغرب 116 مليون دولار لدعم الفلاحة التضامنية. وافق مجلس إدارة مجموعة البنك الإفريقي للتنمية على تخصيص تمويل بقيمة 100 مليون أورو للمغرب لدعم تنفيذ برامج الفلاحة التضامنية الشاملة التي تستهدف النساء والشباب. وأوضح البنك في بيان أن هذا التمويل يهدف إلى خلق فرص مستدامة للنساء والشباب وتعزيز الأمن الغذائي وتحسين قدرة الزراعة الصغيرة في المغرب على مواجهة تحديات', 'size': 2}, {'id': '431', 'title': 'تمويل جديد بقيمة 100 مليون أورو لدعم برامج الفلاحة التضامنية الشاملة', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%aa%d9%85%d9%88%d9%8a%d9%84-%d8%ac%d8%af%d9%8a%d8%af-%d8%a8%d9%82%d9%8a%d9%85%d8%a9-100-%d9%85%d9%84%d9%8a%d9%88%d9%86-%d8%a3%d9%88%d8%b1%d9%88-%d9%84%d8%af%d8%b9%d9%85-%d8%a8%d8%b1%d8%a7%d9%85/', 'summary': 'تمويل جديد بقيمة 100 مليون أورو لدعم برامج الفلاحة التضامنية الشاملة. وافق مجلس إدارة مجموعة البنك الإفريقي للتنمية على تمويل قدره 100 مليون أورو للمغرب من أجل تنفيذ برامج دعم الفلاحة التضامنية الشاملة للنساء والشباب.  تمويل جديد بقيمة 100 مليون أورو لدعم برامج الفلاحة التضامنية الشاملة     .', 'size': 2}], 'main_title': 'البنك الإفريقي للتنمية يمول برامج فلاحية في المغرب'}, {'community_id': '14', 'articles': [{'id': '393', 'title': 'الحكومة تتحرك ضد استغلال الأطفال والمسنين في المحتوى الرقمي', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a7%d9%84%d8%ad%d9%83%d9%88%d9%85%d8%a9-%d8%aa%d8%aa%d8%ad%d8%b1%d9%83-%d8%b6%d8%af-%d8%a7%d8%b3%d8%aa%d8%ba%d9%84%d8%a7%d9%84-%d8%a7%d9%84%d8%a3%d8%b7%d9%81%d8%a7%d9%84-%d9%88%d8%a7%d9%84%d9%85/', 'summary': 'الحكومة تتحرك ضد استغلال الأطفال والمسنين في المحتوى الرقمي. كشف محمد المهدي بنسعيد، وزير الثقافة والشباب والاتصال، أن الحكومة بصدد إعداد مشروع قانون جديد يؤطر الممارسات الرقمية بصفة عامة، ويتصدى لاستغلال الأطفال والمسنين في المحتوى الرقمي. وقال الوزير، في جوابه عن سؤال شفهي تقدم به الفريق الاشتراكي ـ المعارضة الاتحادية خلال جلسة الأسئلة الشفوية بمجلس النواب اليوم الاثنين، "إن هذا الموضوع يهم جميع المؤسسات  الحكومة تتحرك ضد استغلال الأطفال والمسنين في المحتوى الرقمي     .', 'size': 2}, {'id': '405', 'title': 'الحكومة تكشف عن مشروع قانون لضبط “فوضى التواصل الإجتماعي”', 'source': 'rue20.com', 'link': 'https://rue20.com/922316.html', 'summary': 'الحكومة تكشف عن مشروع قانون لضبط “فوضى التواصل الإجتماعي”.  | الرباط أعلن محمد المهدي بنسعيد، وزير الشباب والثقافة والتواصل، عن إعداد الحكومة لمشروع قانون يهدف إلى تنظيم وضبط المحتوى الرقمي على الإنترنت. جاء ذلك في ردّه على سؤال يتعلق باستغلال الأطفال والمسنين في صناعة المحتوى الرقمي، وهو ما بات يشكل ظاهرة مثيرة للقلق في المجتمع. وأكد الوزير بنسعيد أن وزارته تقوم بحملات الخبر الحكومة تكشف عن مشروع قانون لضبط “فوضى التواصل الإجتماعي”  .', 'size': 2}], 'main_title': 'الحكومة تتحرك ضد استغلال الأطفال والمسنين في المحتوى الرقمي'}, {'community_id': '2', 'articles': [{'id': '407', 'title': 'السفير الأمريكي الأسبق: البيت الأبيض يراهن على المغرب والسر في “رؤية الملك”', 'source': 'rue20.com', 'link': 'https://rue20.com/922270.html', 'summary': 'السفير الأمريكي الأسبق: البيت الأبيض يراهن على المغرب والسر في “رؤية الملك”.  | الرباط قال سفير الولايات المتحدة الأسبق بالمغرب، دوايت بوش، إن العلاقات الاستراتيجية القائمة بين المغرب والولايات المتحدة تتميز بمتانتها ويتعين أن تتعزز في المجالات ذات القيمة المضافة العالية. وفي حديث خص به وكالة المغرب العربي للأنباء، بمناسبة الذكرى الـ26 لاعتلاء صاحب الجلالة الملك محمد السادس عرش أسلافه المنعمين، أكد دوايت بوش أن الخبر السفير الأمريكي الأسبق: البيت الأبيض يراهن على المغرب والسر في “رؤية الملك”  .', 'size': 2}, {'id': '440', 'title': 'السفير الأسبق لواشنطن بالرباط: المغرب والولايات المتحدة.. علاقات استراتيجية تتطلع للمستقبل', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/224984/', 'summary': 'السفير الأسبق لواشنطن بالرباط: المغرب والولايات المتحدة.. علاقات استراتيجية تتطلع للمستقبل. واشنطن – قال سفير الولايات المتحدة الأسبق بالمغرب، دوايت بوش، إن العلاقات الاستراتيجية القائمة بين المغرب والولايات المتحدة تتميز بمتانتها ويتعين أن تتعزز في المجالات ذات القيمة المضافة العالية. وفي حديث خص به وكالة المغرب العربي للأنباء، بمناسبة الذكرى الـ26 لاعتلاء صاحب الجلالة الملك محمد السادس عرش أسلافه المنعمين، أكد السيد دوايت بوش أن هذه', 'size': 2}], 'main_title': 'السفير الأمريكي الأسبق: البيت الأبيض يراهن على المغرب والسر في “رؤية الملك”'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    