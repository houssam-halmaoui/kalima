<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 17/09/2025 - 06h16</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '40', 'title': 'نشرة إنذارية: زخات رعدية قوية مصحوبة بهبات رياح بهذه المناطق', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-657697.html', 'summary': 'نشرة إنذارية: زخات رعدية قوية مصحوبة بهبات رياح بهذه المناطق. هبة بريس أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب، تسجيل زخات رعدية محليا قوية مصحوبة بهبات رياح، اليوم الثلاثاء بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة “برتقالي”، أنه من المرتقب تسجيل زخات رعدية محليا قوية (من 20 إلى 30 ملم) مصحوبة بهبات رياح، بعمالات وأقاليم ورزازات، تنغير، زاكورة، وأوسرد، اليوم الثلاثاء من الساعة الثانية بعد الزوال إلى الحادية عشرة ليلا.', 'size': 3}, {'id': '176', 'title': 'نشرة إنذارية: زخات رعدية قوية مصحوبة برياح بعدة مناطق بالمملكة', 'source': 'soltana.ma', 'link': 'https://soltana.ma/1357839.html', 'summary': 'نشرة إنذارية: زخات رعدية قوية مصحوبة برياح بعدة مناطق بالمملكة. أفادت المديرية العامة للأرصاد الجوية بأن زخات رعدية محليا قوية مصحوبة بهبات رياح ستهم عددا من عمالات وأقاليم المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة برتقالي، أن هذه التساقطات المطرية التي ستتراوح ما بين 20 و30 ملم، ستهم عمالات وأقاليم ورززات، تنغير، زاكورة، وأوسرد. وذلك خلال الفترة الممتدة من الساعة 14:00 إلى الساعة', 'size': 3}, {'id': '244', 'title': 'نشرة انذارية: زخات رعدية ورياح قوية في عدد من أقاليم المملكة', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%86%d8%b4%d8%b1%d8%a9-%d8%a7%d9%86%d8%b0%d8%a7%d8%b1%d9%8a%d8%a9-%d8%b2%d8%ae%d8%a7%d8%aa-%d8%b1%d8%b9%d8%af%d9%8a%d8%a9-%d9%88%d8%b1%d9%8a%d8%a7%d8%ad-%d9%82%d9%88%d9%8a%d8%a9-%d9%81%d9%8a-%d8%b9/', 'summary': 'نشرة انذارية: زخات رعدية ورياح قوية في عدد من أقاليم المملكة. أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب، تسجيل زخات رعدية محليا قوية مصحوبة بهبات رياح، اليوم الثلاثاء بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة “برتقالي”، أنه من المرتقب تسجيل زخات رعدية محليا قوية (من 20 إلى 30 ملم) مصحوبة بهبات رياح، بعمالات وأقاليم ورزازات، تنغير، زاكورة، وأوسرد، اليوم …  نشرة انذارية: زخات رعدية ورياح قوية في عدد من أقاليم المملكة     .', 'size': 3}], 'main_title': 'نشرة إنذارية: زخات رعدية قوية مصحوبة بهبات رياح بهذه المناطق'}, {'community_id': '1', 'articles': [{'id': '96', 'title': '300 درهم غرامة… ضوابط جديدة لنقل “التروتنيت” داخل القطارات والمحطات', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/economy/412835.html', 'summary': '300 درهم غرامة… ضوابط جديدة لنقل “التروتنيت” داخل القطارات والمحطات. أعلن المكتب الوطني للسكك الحديدية عن اعتماد ضوابط جديدة لتنظيم نقل واستعمال “التروتينيت” داخل المحطات وعلى متن القطارات، مع فرض غرامات مالية على المخالفين، وذلك', 'size': 2}, {'id': '389', 'title': 'الأمن يحرر أزيد من 43 ألف مخالفة سير ويحصّل ما يقارب 8 ملايين درهم خلال أسبوع', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a7%d9%84%d8%a3%d9%85%d9%86-%d9%8a%d8%ad%d8%b1%d8%b1-%d8%a3%d8%b2%d9%8a%d8%af-%d9%85%d9%86-43-%d8%a3%d9%84%d9%81-%d9%85%d8%ae%d8%a7%d9%84%d9%81%d8%a9-%d9%88%d9%8a%d8%ad%d8%b5%d9%91%d9%84-%d9%85/', 'summary': 'الأمن يحرر أزيد من 43 ألف مخالفة سير ويحصّل ما يقارب 8 ملايين درهم خلال أسبوع. أعلنت المديرية العامة للأمن الوطني أن مصالحها سجلت، خلال الأسبوع الممتد من 8 إلى 14 شتنبر الجاري، ما مجموعه 43 ألفا و186 مخالفة مرورية، فيما بلغ عدد المحاضر المحالة على النيابة العامة 6114 محضرا. كما تم استخلاص 37 ألفا و72 غرامة صلحية، تجاوزت قيمتها الإجمالية 7 ملايين و895 ألفا و900 درهم. البيان أشار أيضا  الأمن يحرر أزيد من 43 ألف مخالفة سير ويحصّل ما يقارب 8 ملايين درهم خلال أسبوع     .', 'size': 2}], 'main_title': '300 درهم غرامة… ضوابط جديدة لنقل “التروتنيت” داخل القطارات والمحطات'}, {'community_id': '2', 'articles': [{'id': '97', 'title': 'عاجل.. وزير الصحة يعفي المديرة الجهوية والمندوب الإقليمي ومدير مستشفى أكادير ويحيل ملفات الوفيات على النيابة العامة', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/412836.html', 'summary': 'عاجل.. وزير الصحة يعفي المديرة الجهوية والمندوب الإقليمي ومدير مستشفى أكادير ويحيل ملفات الوفيات على النيابة العامة. شهدت مدينة أكادير تطوراً غير مسبوق في ملف المستشفى الجهوي الحسن الثاني، بعدما أصدر وزير الصحة والحماية الاجتماعية، أمين التهراوي، قرارات حاسمة شملت إعفاء المديرة', 'size': 2}, {'id': '239', 'title': 'أكادير.. احتجاجات “مستشفى الموت” تفضح شعار الدولة الاجتماعية وتُعري تهاون المسؤولين', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a3%d9%83%d8%a7%d8%af%d9%8a%d8%b1-%d8%a7%d8%ad%d8%aa%d8%ac%d8%a7%d8%ac%d8%a7%d8%aa-%d9%85%d8%b3%d8%aa%d8%b4%d9%81%d9%89-%d8%a7%d9%84%d9%85%d9%88%d8%aa-%d8%aa%d9%81%d8%b6%d8%ad-%d8%b4%d8%b9/', 'summary': 'أكادير.. احتجاجات “مستشفى الموت” تفضح شعار الدولة الاجتماعية وتُعري تهاون المسؤولين. شهدت مدينة أكادير، أول أمس الأحد، احتجاجات غاضبة أمام المستشفى الجهوي الحسن الثاني، الذي لم يعد الناس يصفونه إلا بـ”مستشفى الموت”، بعد أن تحوّل إلى رمز للتسيّب، وسوء التدبير، وانعدام الخدمات الصحية الأساسية. هذه الاحتجاجات الصاخبة دفعت وزير الصحة، أمين التهراوي، إلى القيام بزيارة للمستشفى صباح اليوم الثلاثاء 16 شتنبر 2025، في خطوة …  أكادير.. احتجاجات “مستشفى الموت” تفضح شعار الدولة الاجتماعية وتُعري تهاون المسؤولين     .', 'size': 2}], 'main_title': 'عاجل.. وزير الصحة يعفي المديرة الجهوية والمندوب الإقليمي ومدير مستشفى أكادير ويحيل ملفات الوفيات على النيابة العامة'}, {'community_id': '3', 'articles': [{'id': '112', 'title': 'دورية هامة من رئيس النيابة العامة إلى وكلاء الملك بالمحاكم', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/national/412853.html', 'summary': 'دورية هامة من رئيس النيابة العامة إلى وكلاء الملك بالمحاكم. دعا الوكيل العام للملك لدى محكمة النقض، رئيس النيابة العامة، هشام البلاوي، اليوم الثلاثاء، إلى التقيد بالضوابط القانونية التي تؤطر معالجة برقيات البحث إصدارا وإلغاء. وجاء', 'size': 2}, {'id': '168', 'title': 'رئيس النيابة العامة يشدد على إصدار مذكرات البحث في أضيق الحدود مع مراجعة مستمرة للمبررات', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%b1%d8%a6%d9%8a%d8%b3-%d8%a7%d9%84%d9%86%d9%8a%d8%a7%d8%a8%d8%a9-%d8%a7%d9%84%d8%b9%d8%a7%d9%85%d8%a9-%d9%8a%d8%b4%d8%af%d8%af-%d8%b9%d9%84%d9%89-%d8%a5%d8%b5%d8%af%d8%a7%d8%b1-%d9%85%d8%b0%d9%83/', 'summary': 'رئيس النيابة العامة يشدد على إصدار مذكرات البحث في أضيق الحدود مع مراجعة مستمرة للمبررات. دعت رئاسة النيابة العامة جميع الوكلاء العامين ووكلاء الملك إلى تشديد الرقابة على إصدار برقيات البحث وإلغائها، باعتبارها إجراءات تمسّ مباشرة بحرية الأفراد وتتطلب احتراما صارما للضوابط القانونية. وفي دورية أصدرها هشام البلاوي، الوكيل العام للملك لدى محكمة النقض ورئيس النيابة العامة، شددت المؤسسة على أن برقية البحث تكتسي طابعاً استثنائياً، لأنها تُعمّم وطنياً ويظل  رئيس النيابة العامة يشدد على إصدار مذكرات البحث في أضيق الحدود مع مراجعة مستمرة للمبررات     .', 'size': 3}, {'id': '399', 'title': 'دورية جديدة من رئيس النيابة العامة لمراجعة “برقيات البحث”', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/475696.html', 'summary': 'دورية جديدة من رئيس النيابة العامة لمراجعة “برقيات البحث”. دعا الوكيل العام للملك لدى محكمة النقض، رئيس النيابة العامة، هشام البلاوي، اليوم الثلاثاء، إلى التقيد بالضوابط القانونية التي تؤطر معالجة برقيات البحث إصدارا وإلغاء. مؤكداً أن برقية البحث تعتبر آلية قانونية يتم اللجوء إليها من أجل ضبط الأشخاص المطلوبين من طرف العدالة المتواجدين في حالة فرار للاشتباه في ارتكابهم لأفعال جرمية، أو تنفيذا للأوامر بإلقاء القبض الصادرة في حقهم في إطار التحقيق الإعدادي أو المسطرة الغيابية، أو لإيقاف الأشخاص المطلوب تنفيذ الإكراه البدني في مواجهتهم، أو المحكومين بعقوبات سالبة للحرية بمقتضى مقررات قضائية حائزة لقوة الأمر المقضي به.', 'size': 2}], 'main_title': 'رئيس النيابة العامة يشدد على إصدار مذكرات البحث في أضيق الحدود مع مراجعة مستمرة للمبررات'}, {'community_id': '4', 'articles': [{'id': '147', 'title': '40.5 مليار درهم لدعم الأسر.. الحكومة تكشف حصيلة ورش الحماية الاجتماعية', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1100291.html', 'summary': '40.5 مليار درهم لدعم الأسر.. الحكومة تكشف حصيلة ورش الحماية الاجتماعية. كشفت اللجنة الوزارية لقيادة إصلاح منظومة الحماية الاجتماعية عن صرف 40.5 مليار درهم كإعانات مباشرة منذ إطلاق برنامج الدعم الاجتماعي المباشر في دجنبر 2023. جاء ذلك خلال اجتماع ترأسه رئيس الحكومة عزيز أخنوش، يوم الثلاثاء 16 شتنبر 2025 بالرباط، والذي خصص لتقييم حصيلة البرامج المندرجة في إطار ورش الحماية الاجتماعية وتتبع سير مختلف مكوناته. وأفاد ظهرت المقالة 40.5 مليار درهم لدعم الأسر.. الحكومة تكشف حصيلة ورش الحماية الاجتماعية  .', 'size': 2}, {'id': '167', 'title': 'لجنة وزارية: 24,3 مليون مستفيد من التغطية الصحية و40,5 مليار درهم للدعم الاجتماعي المباشر', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%84%d8%ac%d9%86%d8%a9-%d9%88%d8%b2%d8%a7%d8%b1%d9%8a%d8%a9-243-%d9%85%d9%84%d9%8a%d9%88%d9%86-%d9%85%d8%b3%d8%aa%d9%81%d9%8a%d8%af-%d9%85%d9%86-%d8%a7%d9%84%d8%aa%d8%ba%d8%b7%d9%8a%d8%a9-%d8%a7/', 'summary': 'لجنة وزارية: 24,3 مليون مستفيد من التغطية الصحية و40,5 مليار درهم للدعم الاجتماعي المباشر. أعلنت اللجنة الوزارية لقيادة إصلاح منظومة الحماية الاجتماعية، في اجتماع ترأسه رئيس الحكومة عزيز أخنوش الثلاثاء بالرباط، عن ارتفاع عدد المستفيدين من أنظمة التأمين الإجباري الأساسي عن المرض إلى 24,3 مليون شخص، مقابل 8,6 مليون سنة 2021. كما كشفت أن حجم الدعم الاجتماعي المباشر المصروف منذ دجنبر 2023 بلغ 40,5 مليار درهم، استفادت منه حوالي  لجنة وزارية: 24,3 مليون مستفيد من التغطية الصحية و40,5 مليار درهم للدعم الاجتماعي المباشر     .', 'size': 2}], 'main_title': '40.5 مليار درهم لدعم الأسر.. الحكومة تكشف حصيلة ورش الحماية الاجتماعية'}, {'community_id': '5', 'articles': [{'id': '157', 'title': 'حصيلة متواضعة للمغرب في مونديال طوكيو.. فضية البقالي تخفي إخفاقا جماعيا', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1100131.html', 'summary': 'حصيلة متواضعة للمغرب في مونديال طوكيو.. فضية البقالي تخفي إخفاقا جماعيا. شهدت المشاركة المغربية في بطولة العالم لألعاب القوى، المقامة في العاصمة اليابانية طوكيو إلى غاية 21 شتنبر الجاري، نتائج ضعيفة، حيث جمعت الحصيلة بين ميدالية وحيدة وإقصاء جماعي مخيب للآمال في عدد من المسابقات. فضية “مُرضية” لا تكفي اكتفى حامل اللقب، البطل سفيان البقالي، بالميدالية الفضية في سباق 3000 متر موانع، بعد أن حل في المركز ظهرت المقالة حصيلة متواضعة للمغرب في مونديال طوكيو.. فضية البقالي تخفي إخفاقا جماعيا  .', 'size': 2}, {'id': '221', 'title': 'سفيان البقالي يوضح ما حصل بعد اكتفائه بالميدالية الفضية في مونديال طوكيو', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/227115/', 'summary': 'سفيان البقالي يوضح ما حصل بعد اكتفائه بالميدالية الفضية في مونديال طوكيو. وكالات / فشل العداء المغربي سفيان البقالي في الاحتفاظ بلقبه بطلا لسباق 3000 متر موانع للمرة الثالثة تواليا، مكتفيا، الإثنين 15 شتنبر 2025، بالميدالية الفضية في النسخة العشرين من بطولة العالم لألعاب القوى المقامة في طوكيو. فيما كان البقالي، البطل العالمي والأولمبي، يتجه لاجتياز خط النهاية، فاجأه النيوزيلندي جوردي بيميش لينتزع منه المركز الأول بتوقيت', 'size': 2}, {'id': '233', 'title': 'البقالي يكتفي بالميدالية الذهبية في بطولة العالم لألعاب القوى', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%a7%d9%84%d8%a8%d9%82%d8%a7%d9%84%d9%8a-%d9%8a%d9%83%d8%aa%d9%81%d9%8a-%d8%a8%d8%a7%d9%84%d9%85%d9%8a%d8%af%d8%a7%d9%84%d9%8a%d8%a9-%d8%a7%d9%84%d8%b0%d9%87%d8%a8%d9%8a%d8%a9-%d9%81%d9%8a-%d8%a8/', 'summary': 'البقالي يكتفي بالميدالية الذهبية في بطولة العالم لألعاب القوى. المساء اليوم: أحرز العداء المغربي سفيان البقالي، مساء أمس الاثنين، الميدالية الفضية في سباق 3000 متر موانع ، في بطولة العالم لألعاب القوى، التي تحتضنها العاصمة اليابانية طوكيو ،إلى غاية 21 شتنبر الجاري، مكتفيا بالمركز', 'size': 3}], 'main_title': 'البقالي يكتفي بالميدالية الذهبية في بطولة العالم لألعاب القوى'}, {'community_id': '6', 'articles': [{'id': '161', 'title': 'المغرب يقترب من امتلاك أول غواصة حربية والمنافسة تشتعل بين 3 قوى عسكرية', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1100118.html', 'summary': 'المغرب يقترب من امتلاك أول غواصة حربية والمنافسة تشتعل بين 3 قوى عسكرية. كشفت مجلة “Army Recogniti” المتخصصة في الشؤون العسكرية، أن المغرب دخل في مفاوضات متقدمة مع ثلاث قوى عسكرية عالمية هي فرنسا وألمانيا وروسيا، بهدف اقتناء أول غواصة حربية في تاريخ قواته المسلحة الملكية. وتُمثل هذه الخطوة، في حال إتمامها، تحولا نوعيا في العقيدة الدفاعية للمملكة وقفزة استراتيجية لتعزيز سيادتها البحرية على واجهتيها الأطلسية والمتوسطية. ويأتي ظهرت المقالة المغرب يقترب من امتلاك أول غواصة حربية والمنافسة تشتعل بين 3 قوى عسكرية  .', 'size': 2}, {'id': '391', 'title': 'سباق دولي لتزويد المغرب بأول غواصة عسكرية.. فرنسا وألمانيا وروسيا في قلب المفاوضات', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%b3%d8%a8%d8%a7%d9%82-%d8%af%d9%88%d9%84%d9%8a-%d9%84%d8%aa%d8%b2%d9%88%d9%8a%d8%af-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d8%a8%d8%a3%d9%88%d9%84-%d8%ba%d9%88%d8%a7%d8%b5%d8%a9-%d8%b9%d8%b3%d9%83/', 'summary': 'سباق دولي لتزويد المغرب بأول غواصة عسكرية.. فرنسا وألمانيا وروسيا في قلب المفاوضات. تتسارع المفاوضات بين المغرب وثلاث قوى بحرية كبرى—فرنسا وألمانيا وروسيا—لتمكين القوات البحرية الملكية من اقتناء أول غواصة حربية في تاريخها، في خطوة وُصفت بالتحول النوعي في قدرات المملكة الدفاعية واستراتيجيتها البحرية. وكشفت مجلة «Army Recogniti» المتخصصة أن الرباط بلغت مراحل متقدمة من التفاوض، ما يعكس رغبتها في تعزيز حضورها العسكري في البحرين الأبيض المتوسط والأطلسي،  سباق دولي لتزويد المغرب بأول غواصة عسكرية.. فرنسا وألمانيا وروسيا في قلب المفاوضات     .', 'size': 2}], 'main_title': 'المغرب يقترب من امتلاك أول غواصة حربية والمنافسة تشتعل بين 3 قوى عسكرية'}, {'community_id': '7', 'articles': [{'id': '196', 'title': 'المغرب-رواندا.. التوقيع على مذكرة تفاهم لتعزيز التعاون في مجال تدبير المؤسسات السجنية', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/475670.html', 'summary': 'المغرب-رواندا.. التوقيع على مذكرة تفاهم لتعزيز التعاون في مجال تدبير المؤسسات السجنية. جرى اليوم الثلاثاء بالرباط، التوقيع على مذكرة تفاهم بين المندوبية العامة لإدارة السجون وإعادة الإدماج والمفوضية العامة للمؤسسات السجنية بجمهورية رواندا، تهم على الخصوص تعزيز التعاون الثنائي في مجال تدبير المؤسسات السجنية.', 'size': 2}, {'id': '205', 'title': 'مذكرة تفاهم بين المغرب ورواندا لتعزيز التعاون في مجال تدبير المؤسسات السجنية', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d9%85%d8%b0%d9%83%d8%b1%d8%a9-%d8%aa%d9%81%d8%a7%d9%87%d9%85-%d8%a8%d9%8a%d9%86-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d9%88%d8%b1%d9%88%d8%a7%d9%86%d8%af%d8%a7-%d9%84%d8%aa%d8%b9%d8%b2%d9%8a%d8%b2/', 'summary': 'مذكرة تفاهم بين المغرب ورواندا لتعزيز التعاون في مجال تدبير المؤسسات السجنية. جرى، اليوم الثلاثاء بالرباط، التوقيع على مذكرة تفاهم بين المندوبية العامة لإدارة السجون وإعادة الإدماج والمفوضية العامة للمؤسسات السجنية بجمهورية رواندا،  مذكرة تفاهم بين المغرب ورواندا لتعزيز التعاون في مجال تدبير المؤسسات السجنية     .', 'size': 2}], 'main_title': 'المغرب-رواندا.. التوقيع على مذكرة تفاهم لتعزيز التعاون في مجال تدبير المؤسسات السجنية'}, {'community_id': '8', 'articles': [{'id': '202', 'title': 'المغرب يحقق تقدما لافتا في مؤشر الابتكار العالمي 2025 بصعود 9 مراتب', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d9%8a%d8%ad%d9%82%d9%82-%d8%aa%d9%82%d8%af%d9%85%d8%a7-%d9%84%d8%a7%d9%81%d8%aa%d8%a7-%d9%81%d9%8a-%d9%85%d8%a4%d8%b4%d8%b1-%d8%a7%d9%84%d8%a7%d8%a8%d8%aa%d9%83/', 'summary': 'المغرب يحقق تقدما لافتا في مؤشر الابتكار العالمي 2025 بصعود 9 مراتب. حقق المغرب تقدما ملحوظا في نسخة عام 2025 من مؤشر الابتكار العالمي (Global Innovati Index – GII)، حيث احتل المرتبة 57 عالميا، وهو أفضل تصنيف له  المغرب يحقق تقدما لافتا في مؤشر الابتكار العالمي 2025 بصعود 9 مراتب     .', 'size': 2}, {'id': '243', 'title': 'المغرب يحقق أفضل ترتيب له على الإطلاق في مؤشر الابتكار العالمي 2025 بصعود 9 مراتب', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d9%8a%d8%ad%d9%82%d9%82-%d8%a3%d9%81%d8%b6%d9%84-%d8%aa%d8%b1%d8%aa%d9%8a%d8%a8-%d9%84%d9%87-%d8%b9%d9%84%d9%89-%d8%a7%d9%84%d8%a5%d8%b7%d9%84%d8%a7%d9%82-%d9%81/', 'summary': 'المغرب يحقق أفضل ترتيب له على الإطلاق في مؤشر الابتكار العالمي 2025 بصعود 9 مراتب. حقق المغرب قفزة نوعية في نسخة 2025 من مؤشر الابتكار العالمي (Global Innovati Index – GII)، حيث احتل المرتبة 57 عالميا، مسجلا أفضل تصنيف له على الإطلاق ودخوله لأول مرة ضمن قائمة الـ60 الأوائل، إذ يأتي هذا التقدم بمقدار 9 مراتب مقارنة بعام 2024، مؤكدا استمرار المسار التصاعدي للمملكة التي انتقلت من المرتبة …  المغرب يحقق أفضل ترتيب له على الإطلاق في مؤشر الابتكار العالمي 2025 بصعود 9 مراتب     .', 'size': 2}], 'main_title': 'المغرب يحقق تقدما لافتا في مؤشر الابتكار العالمي 2025 بصعود 9 مراتب'}, {'community_id': '9', 'articles': [{'id': '224', 'title': 'التامك يستقبل المفوض العام للمؤسسات السجنية بجمهورية رواندا', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/227106/', 'summary': 'التامك يستقبل المفوض العام للمؤسسات السجنية بجمهورية رواندا. استقبل محمد صالح التامك، المندوب العام لإدارة السجون وإعادة الإدماج، صباح يومه الثلاثاء 16 شتنبر 2025 بمقر المندوبية العامة بالرباط، السيد Evarite MURENZI، المفوض العام للمؤسسات السجنية بجمهورية رواندا، مرفوقا بسفيرة جمهورية رواندا المعتمدة بالرباط. وقد كان اللقاء مناسبة لتبادل وجهات النظر بخصوص التعاون القائم بين البلدين في مجال إدارة السجون، والذي توج بتوقيع اتفاقية', 'size': 2}, {'id': '242', 'title': 'المغرب ورواندا يعززان التعاون في مجال تدبير المؤسسات السجنية', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d9%88%d8%b1%d9%88%d8%a7%d9%86%d8%af%d8%a7-%d9%8a%d8%b9%d8%b2%d8%b2%d8%a7%d9%86-%d8%a7%d9%84%d8%aa%d8%b9%d8%a7%d9%88%d9%86-%d9%81%d9%8a-%d9%85%d8%ac%d8%a7%d9%84/', 'summary': 'المغرب ورواندا يعززان التعاون في مجال تدبير المؤسسات السجنية. أفادت المندوبية العامة لإدارة السجون وإعادة الإدماج، في بلاغ لها، أن المندوب العام محمد صالح التامك استقبل صباح الثلاثاء 16 شتنبر 2025 بمقر المندوبية بالرباط، Evarite MURENZI، المفوض العام للمؤسسات السجنية بجمهورية رواندا، مرفوقا بسفيرة بلاده المعتمدة بالمغرب. وأوضح البلاغ أن هذا اللقاء شكل فرصة لتبادل وجهات النظر حول سبل تعزيز التعاون بين …  المغرب ورواندا يعززان التعاون في مجال تدبير المؤسسات السجنية     .', 'size': 2}], 'main_title': 'التامك يستقبل المفوض العام للمؤسسات السجنية بجمهورية رواندا'}, {'community_id': '10', 'articles': [{'id': '235', 'title': 'رئيس الحكومة يترأس اجتماع اللجنة الوزارية لقيادة إصلاح منظومة الحماية الاجتماعية', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%b1%d8%a6%d9%8a%d8%b3-%d8%a7%d9%84%d8%ad%d9%83%d9%88%d9%85%d8%a9-%d9%8a%d8%aa%d8%b1%d8%a3%d8%b3-%d8%a7%d8%ac%d8%aa%d9%85%d8%a7%d8%b9-%d8%a7%d9%84%d9%84%d8%ac%d9%86%d8%a9-%d8%a7%d9%84%d9%88%d8%b2/', 'summary': 'رئيس الحكومة يترأس اجتماع اللجنة الوزارية لقيادة إصلاح منظومة الحماية الاجتماعية. ترأس رئيس الحكومة عزيز أخنوش، يوم الثلاثاء 16 شتنبر 2025 بالرباط، اجتماع اللجنة الوزارية لقيادة إصلاح منظومة الحماية الاجتماعية، خصص لتقييم حصيلة تنزيل هذا الورش الوطني الاستراتيجي، ومتابعة تقدم التسجيل في السجل الوطني للسكان والسجل الاجتماعي الموحد، وكذا نظام “أمو-تضامن” وبرنامج الدعم الاجتماعي المباشر. ووفقا لبلاغ الحكومة توصل موقع “” بنسخة منه، كشف …  رئيس الحكومة يترأس اجتماع اللجنة الوزارية لقيادة إصلاح منظومة الحماية الاجتماعية     .', 'size': 2}, {'id': '394', 'title': 'الأرقام الرسمية تشير إلى إستفادة 24 مليون مغربي من التغطية الصحية و4 ملايين أسرة من الدعم الإجتماعي المباشر', 'source': 'rue20.com', 'link': 'https://rue20.com/936948.html', 'summary': 'الأرقام الرسمية تشير إلى إستفادة 24 مليون مغربي من التغطية الصحية و4 ملايين أسرة من الدعم الإجتماعي المباشر.  الرباط ترأس رئيس الحكومة عزيز أخنوش، يوم الثلاثاء 16 شتنبر 2025 بالرباط، اجتماع اللجنة الوزارية لقيادة إصلاح منظومة الحماية الاجتماعية، تم خلاله الوقوف على حصيلة مختلف البرامج المندرجة في إطار ورش الحماية الاجتماعية، تجسيدا للإرادة الملكية السامية، وتتبع سير التسجيل في السجل الوطني للسكان والسجل الاجتماعي الموحد، وكذا التسجيل في نظام “أمو-تضامن”، وتتبع استفادة الخبر الأرقام الرسمية تشير إلى إستفادة 24 مليون مغربي من التغطية الصحية و4 ملايين أسرة من الدعم الإجتماعي المباشر  .', 'size': 2}, {'id': '398', 'title': 'إجتماع رفيع للوقوف على حصيلة برامج ورش الحماية الاجتماعية', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/475702.html', 'summary': 'إجتماع رفيع للوقوف على حصيلة برامج ورش الحماية الاجتماعية. ترأس رئيس الحكومة عزيز أخنوش، يوم الثلاثاء 16 شتنبر 2025 بالرباط، اجتماع اللجنة الوزارية لقيادة إصلاح منظومة الحماية الاجتماعية، تم خلاله الوقوف على حصيلة مختلف البرامج المندرجة في إطار ورش الحماية الاجتماعية، تجسيدا للإرادة الملكية السامية، وتتبع سير التسجيل في السجل الوطني للسكان والسجل الاجتماعي الموحد، وكذا التسجيل في نظام "أمو-تضامن"، وتتبع استفادة الأسر المعنية من برنامج الدعم الاجتماعي المباشر. وفق ما أورده موقع رئاسة الحكومة.', 'size': 3}], 'main_title': 'إجتماع رفيع للوقوف على حصيلة برامج ورش الحماية الاجتماعية'}, {'community_id': '11', 'articles': [{'id': '316', 'title': '3 سنوات سجناً للناشطة سعيدة العلمي وغرامة 20 ألف درهم', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-657825.html', 'summary': '3 سنوات سجناً للناشطة سعيدة العلمي وغرامة 20 ألف درهم. هبة بريس - الدار البيضاء أصدرت المحكمة الزجرية بعين السبع بمدينة الدار البيضاء ، مساء اليوم الثلاثاء 16 شتنبر 2025، حكمها في حق الناشطة السياسية سعيدة العلمي ، بعد جلسة مطولة خُصصت للمداولة والنطق بالحكم. ووفق ما أكدته مصادر موثوقة حضرت أطوار الجلسة، فقد قضت المحكمة بالحكم على الناشطة المذكورة بالسجن النافذ لـ 3 سنوات، إلى جانب غرامة مالية قدرها 20 ألف درهم. ويأتي هذا الحكم بعد توقيف سعيدة العلمي يوم 1 يوليوز 2025 بمدينة الدار البيضاء، في سياق متابعة قضائية جديدة أقل من عامٍ على استفادتها من عفو ملكي صدر في 29 يوليوز 2024. وقد توبعت العلمي بتهم تتعلق بإهانة منظمة ونشر إدعاءات كاذية وإهانة القضاء.', 'size': 2}, {'id': '329', 'title': 'الدار البيضاء.. إدانة الناشطة الحقوقية سعيدة العلمي بثلاث سنوات سجناً نافذاً وغرامة مالية', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/412867.html', 'summary': 'الدار البيضاء.. إدانة الناشطة الحقوقية سعيدة العلمي بثلاث سنوات سجناً نافذاً وغرامة مالية. قضت المحكمة الزجرية بعين السبع بمدينة الدار البيضاء، مساء اليوم الثلاثاء 16 شتنبر 2025، بالسجن النافذ لمدة ثلاث سنوات في حق الناشطة الحقوقية سعيدة العلمي،', 'size': 3}, {'id': '385', 'title': 'حكم جديد بالسجن ثلاث سنوات في حق المدونة سعيدة العلمي', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%ad%d9%83%d9%85-%d8%ac%d8%af%d9%8a%d8%af-%d8%a8%d8%a7%d9%84%d8%b3%d8%ac%d9%86-%d8%ab%d9%84%d8%a7%d8%ab-%d8%b3%d9%86%d9%88%d8%a7%d8%aa-%d9%81%d9%8a-%d8%ad%d9%82-%d8%a7%d9%84%d9%85%d8%af%d9%88%d9%86/', 'summary': 'حكم جديد بالسجن ثلاث سنوات في حق المدونة سعيدة العلمي. أصدرت المحكمة الزجرية بعين السبع في الدار البيضاء، الثلاثاء، حكما يقضي بسجن الناشطة والمدونة سعيدة العلمي ثلاث سنوات نافذة، مع غرامة مالية قدرها عشرون ألف درهم. ويأتي هذا الحكم بعد متابعتها بتهم تتعلق بإهانة القضاء وهيئات منظمة، إضافة إلى نشر ادعاءات اعتبرتها المحكمة كاذبة وتمس بالمؤسسات. المدونة كانت قد أوقفت مطلع يوليوز الماضي بمدينة الدار  حكم جديد بالسجن ثلاث سنوات في حق المدونة سعيدة العلمي     .', 'size': 3}, {'id': '403', 'title': 'السجن مرة أخرى.. 3 سنوات حبسا نافذا للناشطة سعيدة العلمي', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%a7%d9%84%d8%b3%d8%ac%d9%86-%d9%85%d8%b1%d8%a9-%d8%a3%d8%ae%d8%b1%d9%89-3-%d8%b3%d9%86%d9%88%d8%a7%d8%aa-%d8%ad%d8%a8%d8%b3%d8%a7-%d9%86%d8%a7%d9%81%d8%b0%d8%a7-%d9%84%d9%84%d9%86%d8%a7%d8%b4/', 'summary': 'السجن مرة أخرى.. 3 سنوات حبسا نافذا للناشطة سعيدة العلمي. قضت المحكمة الابتدائية بعين السبع بالدار البيضاء، اليوم الثلاثاء 16 شتنبر 2025، بإدانة الناشطة الحقوقية والمدونة سعيدة العلمي بالحبس النافذ لمدة ثلاث سنوات  السجن مرة أخرى.. 3 سنوات حبسا نافذا للناشطة سعيدة العلمي     .', 'size': 2}], 'main_title': 'الدار البيضاء.. إدانة الناشطة الحقوقية سعيدة العلمي بثلاث سنوات سجناً نافذاً وغرامة مالية'}, {'community_id': '13', 'articles': [{'id': '339', 'title': 'مراكش.. توقيف شخصين نظما سباق دراجات نارية استعراضي غير قانوني', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%85%d8%b1%d8%a7%d9%83%d8%b4-%d8%aa%d9%88%d9%82%d9%8a%d9%81-%d8%b4%d8%ae%d8%b5%d9%8a%d9%86-%d9%86%d8%b8%d9%85%d8%a7-%d8%b3%d8%a8%d8%a7%d9%82-%d8%af%d8%b1%d8%a7%d8%ac%d8%a7%d8%aa-%d9%86%d8%a7%d8%b1/', 'summary': 'مراكش.. توقيف شخصين نظما سباق دراجات نارية استعراضي غير قانوني. تمكنت عناصر الشرطة بولاية أمن مراكش، زوال اليوم الثلاثاء (16 شتنبر)، من توقيف شخصين يشتبه في تورطهما في تنظيم سباقات غير قانونية للدراجات النارية والسياقة بطريقة استعراضية وخطيرة بالشارع العام وتعريض مستعملي الطريق للخطر. وكان المشتبه فيهما قد أقدما، رفقة أشخاص آخرين، على تنظيم سباقات غير قانونية للدراجات النارية بالشارع العام، فضلا عن سياقة دراجات', 'size': 2}, {'id': '358', 'title': 'أمن مراكش يوقف شخصين بعد انتشار مقاطع سباقات خطيرة للدراجات النارية', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/323568/', 'summary': 'أمن مراكش يوقف شخصين بعد انتشار مقاطع سباقات خطيرة للدراجات النارية. تمكنت عناصر الشرطة بولاية أمن مراكش، زوال اليوم الثلاثاء 16 شتنبر الجاري، من توقيف شخصين يشتبه في تورطهما في تنظيم سباقات غير قانونية للدراجات النارية والسياقة بطريقة استعراضية وخطيرة بالشارع العام وتعريض مستعملي الطريق للخطر. وكان المشتبه فيهما قد أقدما، رفقة أشخاص آخرين، على تنظيم سباقات غير قانونية للدراجات النارية بالشارع العام، فضلا عن سياقة', 'size': 2}], 'main_title': 'مراكش.. توقيف شخصين نظما سباق دراجات نارية استعراضي غير قانوني'}, {'community_id': '12', 'articles': [{'id': '368', 'title': 'مديرية أمن نظم المعلومات تحذر من ثغرات أمنية في منتجات آبل وتدعو للتحديث الفوري', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1100357.html', 'summary': 'مديرية أمن نظم المعلومات تحذر من ثغرات أمنية في منتجات آبل وتدعو للتحديث الفوري. أصدرت المديرية العامة لأمن نظم المعلومات التابعة لإدارة الدفاع الوطني، اليوم الثلاثاء، نشرة أمنية كشفت فيها عن وجود ثغرات أمنية حرجة في مجموعة واسعة من منتجات شركة آبل، مؤكدة أن الشركة أطلقت تحديثات طارئة لمعالجتها. وأوضحت المديرية في نشرتها التي صنفت مستوى الخطر والتأثير بالـ “حرج”، أن استغلال هذه الثغرات قد يسمح للمهاجمين بتنفيذ تعليمات ظهرت المقالة مديرية أمن نظم المعلومات تحذر من ثغرات أمنية في منتجات آبل وتدعو للتحديث الفوري  .', 'size': 2}, {'id': '431', 'title': 'المديرية العامة لأمن نظم المعلومات تُحذر من هجمات إلكترونية تطال أجهزة الـ”آبل”', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d9%85%d8%af%d9%8a%d8%b1%d9%8a%d8%a9-%d8%a7%d9%84%d8%b9%d8%a7%d9%85%d8%a9-%d9%84%d8%a3%d9%85%d9%86-%d9%86%d8%b8%d9%85-%d8%a7%d9%84%d9%85%d8%b9%d9%84%d9%88%d9%85%d8%a7%d8%aa-%d8%aa%d9%8f/', 'summary': 'المديرية العامة لأمن نظم المعلومات تُحذر من هجمات إلكترونية تطال أجهزة الـ”آبل”. حذّرت المديرية العامة لأمن نظم المعلومات التابعة لإدارة الدفاع الوطني، اليوم الثلاثاء 16 شتنبر 2025، من وجود ثغرات أمنية في عدد من أجهزة شركة “آبل”، قد تستغل من طرف مهاجمين لاختراق الأجهزة وسرقة المعطيات. وفي هذا السياق، أوضحت المديرية في نشرتها الأمنية المؤرخة بتاريخ 16 شتنبر 2025، أن هذه الثغرات الأمنية حرجة وقد …  المديرية العامة لأمن نظم المعلومات تُحذر من هجمات إلكترونية تطال أجهزة الـ”آبل”     .', 'size': 2}], 'main_title': 'مديرية أمن نظم المعلومات تحذر من ثغرات أمنية في منتجات آبل وتدعو للتحديث الفوري'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    