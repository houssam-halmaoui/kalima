<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 31/07/2025 - 18h32</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '76', 'title': 'جلالة الملك محمد السادس يترأس بالمضيق حفل استقبال بمناسبة عيد العرش المجيد', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/national/410195.html', 'summary': 'جلالة الملك محمد السادس يترأس بالمضيق حفل استقبال بمناسبة عيد العرش المجيد. ترأس صاحب الجلالة الملك محمد السادس، نصره الله، مرفوقا بصاحب السمو الملكي ولي العهد الأمير مولاي الحسن، وصاحب السمو الملكي الأمير مولاي رشيد، بعد زوال', 'size': 2}, {'id': '258', 'title': 'الملك محمد السادس يترأس بالمضيق حفل استقبال بمناسبة عيد العرش المجيد', 'source': 'www.alalam.ma', 'link': 'https://www.alalam.ma/الملك-محمد-السادس-يترأس-بالمضيق-حفل-استقبال-بمناسبة-عيد-العرش_a28941.html', 'summary': 'الملك محمد السادس يترأس بالمضيق حفل استقبال بمناسبة عيد العرش المجيد. *العلم الإلكترونية* ترأس جلالة الملك محمد السادس، نصره الله، مرفوقا بصاحب السمو الملكي ولي العهد الأمير مولاي الحسن...', 'size': 2}], 'main_title': 'جلالة الملك محمد السادس يترأس بالمضيق حفل استقبال بمناسبة عيد العرش المجيد'}, {'community_id': '11', 'articles': [{'id': '104', 'title': 'الملك محمد السادس يأمر بإرسال مساعدة إنسانية وطبية عاجلة لفائدة ساكنة قطاع غزة', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/national/410225.html', 'summary': 'الملك محمد السادس يأمر بإرسال مساعدة إنسانية وطبية عاجلة لفائدة ساكنة قطاع غزة. أفاد بلاغ لوزارة الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج، اليوم الأربعاء، بأن صاحب الجلالة الملك محمد السادس، نصره الله، رئيس لجنة القدس، أعطى تعليماته', 'size': 4}, {'id': '200', 'title': 'الملك يعطي تعليماته لإرسال مساعدة إنسانية وطبية عاجلة لفائدة الشعب الفلسطيني', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/471118.html', 'summary': 'الملك يعطي تعليماته لإرسال مساعدة إنسانية وطبية عاجلة لفائدة الشعب الفلسطيني. أفاد بلاغ لوزارة الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج، اليوم الأربعاء، بأن الملك محمد السادس، رئيس لجنة القدس، أعطى تعليماته السامية من أجل إرسال مساعدة إنسانية وطبية عاجلة لفائدة الشعب الفلسطيني الشقيق، وخاصة ساكنة قطاع غزة. وتتكون هذه المساعدة، التي يبلغ حجمها الإجمالي نحو 180 طنا، من مواد غذائية أساسية، ومن الحليب ومواد موجهة …', 'size': 4}, {'id': '211', 'title': 'الملك يعطي تعليماته من أجل إرسال مساعدة إنسانية وطبية عاجلة لفائدة غزة', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%8a%d8%b9%d8%b7%d9%8a-%d8%aa%d8%b9%d9%84%d9%8a%d9%85%d8%a7%d8%aa%d9%87-%d9%85%d9%86-%d8%a3%d8%ac%d9%84-%d8%a5%d8%b1%d8%b3%d8%a7%d9%84-%d9%85%d8%b3%d8%a7%d8%b9%d8%af/', 'summary': 'الملك يعطي تعليماته من أجل إرسال مساعدة إنسانية وطبية عاجلة لفائدة غزة. في بلاغ لوزارة الشؤون الخارجية أعطى الملك محمد السادس، رئيس لجنة القدس، تعليماته السامية من أجل إرسال مساعدة إنسانية وطبية عاجلة لفائدة الشعب  الملك يعطي تعليماته من أجل إرسال مساعدة إنسانية وطبية عاجلة لفائدة غزة     .', 'size': 4}, {'id': '221', 'title': 'جلالة الملك يأمر بإرسال مساعدة إنسانية وطبية عاجلة لفائدة الشعب الفلسطيني الشقيق', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/225413/', 'summary': 'جلالة الملك يأمر بإرسال مساعدة إنسانية وطبية عاجلة لفائدة الشعب الفلسطيني الشقيق. الرباط – أفاد بلاغ لوزارة الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج، اليوم الأربعاء، بأن صاحب الجلالة الملك محمد السادس، نصره الله، رئيس لجنة القدس، أعطى تعليماته السامية من أجل إرسال مساعدة إنسانية وطبية عاجلة لفائدة الشعب الفلسطيني الشقيق، وخاصة ساكنة قطاع غزة. وتتكون هذه المساعدة، التي يبلغ حجمها الإجمالي نحو 180 طنا، من مواد', 'size': 2}, {'id': '251', 'title': 'الملك محمد السادس يأمر بإرسال مساعدات إنسانية عاجلة لسكان غزة والشعب الفلسطيني', 'source': 'www.alalam.ma', 'link': 'https://www.alalam.ma/الملك-محمد-السادس-يأمر-بإرسال-مساعدات-إنسانية-عاجلة-لسكان-غزة_a28949.html', 'summary': 'الملك محمد السادس يأمر بإرسال مساعدات إنسانية عاجلة لسكان غزة والشعب الفلسطيني. *العلم الإلكترونية* أعطى جلالة الملك محمد السادس، رئيس لجنة القدس، تعليماته السامية من أجل إرسال مساعدة إنسانية وطبي...', 'size': 3}], 'main_title': 'الملك محمد السادس يأمر بإرسال مساعدة إنسانية وطبية عاجلة لفائدة ساكنة قطاع غزة'}, {'community_id': '2', 'articles': [{'id': '107', 'title': 'السفير الأمريكي الجديد بالمغرب: الملك محمد السادس "قائد يحظى بالاحترام وصديق للولايات المتحدة"', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/politic/410228.html', 'summary': 'السفير الأمريكي الجديد بالمغرب: الملك محمد السادس "قائد يحظى بالاحترام وصديق للولايات المتحدة". قال السفير الأمريكي الجديد الذي تم تعيينه بالمغرب، ديوك بوكان الثالث، إن صاحب الجلالة الملك محمد السادس "قائد يحظى بالاحترام وصديق للولايات المتحدة". وفي مداخلة خلال', 'size': 2}, {'id': '423', 'title': 'السفير الأمريكي بالمغرب: الملك محمد السادس قائد يحظى بالاحترام وصديق للولايات المتحدة', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/225430/', 'summary': 'السفير الأمريكي بالمغرب: الملك محمد السادس قائد يحظى بالاحترام وصديق للولايات المتحدة. قال السفير الأمريكي الجديد الذي تم تعيينه بالمغرب، ديوك بوكان الثالث، إن صاحب الجلالة الملك محمد السادس “قائد يحظى بالاحترام وصديق للولايات المتحدة”. وفي مداخلة خلال جلسة تأكيد تعيينه، أمام لجنة الشؤون الخارجية بمجلس الشيوخ الأمريكي، التي انعقدت أمس الثلاثاء بواشنطن، أبرز السفير الجديد أن المملكة المغربية تشكل “ركيزة للاستقرار” بفضل تموقعها الجغرافي، الذي يجعلها', 'size': 2}], 'main_title': 'السفير الأمريكي الجديد بالمغرب: الملك محمد السادس "قائد يحظى بالاحترام وصديق للولايات المتحدة"'}, {'community_id': '5', 'articles': [{'id': '118', 'title': 'وجدة.. اعتقال أفراد عصابة لجؤوا إلى حيلة ذكية للسطو على الحسابات البنكية للضحايا', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/410240.html', 'summary': 'وجدة.. اعتقال أفراد عصابة لجؤوا إلى حيلة ذكية للسطو على الحسابات البنكية للضحايا. تمكنت عناصر الشرطة بولاية أمن وجدة بتنسيق مع مصالح المديرية العامة لمراقبة التراب الوطني، مساء أمس الأربعاء 30 يوليوز الجاري، من توقيف ثلاثة أشخاص من', 'size': 3}, {'id': '156', 'title': 'تفكيك شبكة للنصب وانتحال الصفة بوجدة يقود لتوقيف 3 أشخاص بينهم قاصر', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1089618.html', 'summary': 'تفكيك شبكة للنصب وانتحال الصفة بوجدة يقود لتوقيف 3 أشخاص بينهم قاصر. تمكنت عناصر الشرطة بولاية أمن وجدة بتنسيق مع مصالح المديرية العامة لمراقبة التراب الوطني، مساء أمس الأربعاء 30 يوليوز الجاري، من توقيف ثلاثة أشخاص من بينهم قاصر يبلغ من العمر 17 سنة، وذلك للاشتباه في تورطهم في قضية تتعلق بالنصب والاحتيال وانتحال صفة ينظمها القانون. وحسب المعطيات الأولية للبحث، فقد كان المشتبه فيهم يتصلون هاتفيا ظهرت المقالة تفكيك شبكة للنصب وانتحال الصفة بوجدة يقود لتوقيف 3 أشخاص بينهم قاصر  .', 'size': 4}, {'id': '172', 'title': 'بشبهة النصب والاحتيال وانتحال صفة.. أمن وجدة يوقف ثلاثة أشخاص', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a8%d8%b4%d8%a8%d9%87%d8%a9-%d8%a7%d9%84%d9%86%d8%b5%d8%a8-%d9%88%d8%a7%d9%84%d8%a7%d8%ad%d8%aa%d9%8a%d8%a7%d9%84-%d9%88%d8%a7%d9%86%d8%aa%d8%ad%d8%a7%d9%84-%d8%b5%d9%81%d8%a9-%d8%a3%d9%85%d9%86/', 'summary': 'بشبهة النصب والاحتيال وانتحال صفة.. أمن وجدة يوقف ثلاثة أشخاص. تمكنت عناصر الشرطة بولاية أمن وجدة بتنسيق مع مصالح المديرية العامة لمراقبة التراب الوطني، مساء أمس الأربعاء 30 يوليوز الجاري، من توقيف ثلاثة أشخاص من بينهم قاصر يبلغ من العمر 17 سنة، وذلك للاشتباه في تورطهم في قضية تتعلق بالنصب والاحتيال وانتحال صفة ينظمها القانون. وأوضح مصدر أمني أنه وحسب المعطيات الأولية للبحث، فقد كان  بشبهة النصب والاحتيال وانتحال صفة.. أمن وجدة يوقف ثلاثة أشخاص     .', 'size': 5}, {'id': '184', 'title': 'اعتقال أفراد شبكة انتحلوا صفة مسؤولين ونصبوا على مواطنين بوجدة', 'source': 'rue20.com', 'link': 'https://rue20.com/925450.html', 'summary': 'اعتقال أفراد شبكة انتحلوا صفة مسؤولين ونصبوا على مواطنين بوجدة.  ا الرباط تمكنت عناصر الشرطة بولاية أمن وجدة بتنسيق مع مصالح المديرية العامة لمراقبة التراب الوطني، مساء أمس الأربعاء 30 يوليوز الجاري، من توقيف ثلاثة أشخاص من بينهم قاصر يبلغ من العمر 17 سنة، وذلك للاشتباه في تورطهم في قضية تتعلق بالنصب والاحتيال وانتحال صفة ينظمها القانون. وحسب المعطيات الأولية للبحث، فقد كان الخبر اعتقال أفراد شبكة انتحلوا صفة مسؤولين ونصبوا على مواطنين بوجدة  .', 'size': 4}, {'id': '191', 'title': 'ضمنهم قاصر.. توقيف متهمين بالنصب والاحتيال وانتحال صفة', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/471196.html', 'summary': 'ضمنهم قاصر.. توقيف متهمين بالنصب والاحتيال وانتحال صفة. تمكنت عناصر الشرطة بولاية أمن وجدة بتنسيق مع مصالح المديرية العامة لمراقبة التراب الوطني، مساء أمس الأربعاء 30 يوليوز الجاري، من توقيف ثلاثة أشخاص من بينهم قاصر يبلغ من العمر 17 سنة، وذلك للاشتباه في تورطهم في قضية تتعلق بالنصب والاحتيال وانتحال صفة ينظمها القانون.', 'size': 5}], 'main_title': 'بشبهة النصب والاحتيال وانتحال صفة.. أمن وجدة يوقف ثلاثة أشخاص'}, {'community_id': '10', 'articles': [{'id': '131', 'title': 'وزير الثقافة المصري: جلالة الملك أرسى دعائم تنمية شاملة وعزز مكانة المملكة على الساحتين الإقليمية والدولية', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%88%d8%b2%d9%8a%d8%b1-%d8%a7%d9%84%d8%ab%d9%82%d8%a7%d9%81%d8%a9-%d8%a7%d9%84%d9%85%d8%b5%d8%b1%d9%8a-%d8%ac%d9%84%d8%a7%d9%84%d8%a9-%d8%a7%d9%84%d9%85%d9%84%d9%83-%d8%a3%d8%b1%d8%b3%d9%89-%d8%af/', 'summary': 'وزير الثقافة المصري: جلالة الملك أرسى دعائم تنمية شاملة وعزز مكانة المملكة على الساحتين الإقليمية والدولية. أكد وزير الثقافة المصري أحمد فؤاد هنو، مساء أمس الأربعاء (30 يوليوز) بالقاهرة، أن صاحب الجلالة الملك محمد السادس تمكن من إرساء وترسيخ دعائم تنمية شاملة وتعزيز مكانة المملكة المغربية على الساحتين الإقليمية والدولية. وأشاد الوزير المصري، خلال حفل استقباله أقامه سفير المغرب بمصر، محمد آيت وعلي، بمناسبة الاحتفال بالذكرى السادسة والعشرين لعيد العرش المجيد،', 'size': 3}, {'id': '422', 'title': 'وزير الثقافة المصري: جلالة الملك أرسى دعائم تنمية شاملة وعزز مكانة المملكة إقليميا ودوليا', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/225433/', 'summary': 'وزير الثقافة المصري: جلالة الملك أرسى دعائم تنمية شاملة وعزز مكانة المملكة إقليميا ودوليا. أكد وزير الثقافة المصري أحمد فؤاد هنو، مساء أمس الأربعاء بالقاهرة، أن صاحب الجلالة الملك محمد السادس تمكن من إرساء وترسيخ دعائم تنمية شاملة وتعزيز مكانة المملكة المغربية على الساحتين الإقليمية والدولية. وأشاد الوزير المصري، خلال حفل استقباله أقامه سفير المغرب بمصر، محمد آيت وعلي، بمناسبة الاحتفال بالذكرى السادسة والعشرين لعيد العرش المجيد، بما حققته', 'size': 3}, {'id': '433', 'title': 'وزير الثقافة المصري: الملك محمد السادس أرسى دعائم تنمية شاملة وعزز مكانة المملكة إقليميا ودوليا', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%88%d8%b2%d9%8a%d8%b1-%d8%a7%d9%84%d8%ab%d9%82%d8%a7%d9%81%d8%a9-%d8%a7%d9%84%d9%85%d8%b5%d8%b1%d9%8a-%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7%d8%af%d8%b3/', 'summary': 'وزير الثقافة المصري: الملك محمد السادس أرسى دعائم تنمية شاملة وعزز مكانة المملكة إقليميا ودوليا. قال وزير الثقافة المصري أحمد فؤاد هنو، مساء أمس الأربعاء بالقاهرة، إن الملك محمد السادس تمكن من إرساء وترسيخ دعائم تنمية شاملة وتعزيز مكانة المملكة المغربية على الساحتين الإقليمية والدولية. ونوه الوزير المصري، خلال حفل استقباله أقامه سفير المغرب بمصر، محمد آيت وعلي، بمناسبة الاحتفال بالذكرى السادسة والعشرين لعيد العرش المجيد، بما حققته …  وزير الثقافة المصري: الملك محمد السادس أرسى دعائم تنمية شاملة وعزز مكانة المملكة إقليميا ودوليا     .', 'size': 3}], 'main_title': 'وزير الثقافة المصري: جلالة الملك أرسى دعائم تنمية شاملة وعزز مكانة المملكة على الساحتين الإقليمية والدولية'}, {'community_id': '4', 'articles': [{'id': '171', 'title': 'توقيف ثلاثينية وحجز أزيد من 2430 قرصا طبيا مخدرا بسلا', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%aa%d9%88%d9%82%d9%8a%d9%81-%d8%ab%d9%84%d8%a7%d8%ab%d9%8a%d9%86%d9%8a%d8%a9-%d9%88%d8%ad%d8%ac%d8%b2-%d8%a3%d8%b2%d9%8a%d8%af-%d9%85%d9%86-2430-%d9%82%d8%b1%d8%b5-%d8%b7%d8%a8%d9%8a-%d9%85%d8%ae/', 'summary': 'توقيف ثلاثينية وحجز أزيد من 2430 قرصا طبيا مخدرا بسلا. تمكنت عناصر الشرطة بالأمن الإقليمي بمدينة سلا، بناءً على معلومات دقيقة وفرتها مصالح المديرية العامة لمراقبة التراب الوطني، مساء أمس الأربعاء 30 يوليوز الجاري، من توقيف سيدة تبلغ من العمر 33 سنة، للاشتباه في تورطها في قضية تتعلق بحيازة وترويج المخدرات والمؤثرات العقلية. وأوضح مصدر أمني أنه جرى توقيف المشتبه فيها بأحد أحياء مدينة سلا،  توقيف ثلاثينية وحجز أزيد من 2430 قرصا طبيا مخدرا بسلا     .', 'size': 2}, {'id': '240', 'title': 'توقيف سيدة بشبهة حيازة وترويج المخدرات والمؤثرات العقلية بسلا', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%aa%d9%88%d9%82%d9%8a%d9%81-%d8%b3%d9%8a%d8%af%d8%a9-%d8%a8%d8%b4%d8%a8%d9%87%d8%a9-%d8%ad%d9%8a%d8%a7%d8%b2%d8%a9-%d9%88%d8%aa%d8%b1%d9%88%d9%8a%d8%ac-%d8%a7%d9%84%d9%85%d8%ae%d8%af%d8%b1%d8%a7/', 'summary': 'توقيف سيدة بشبهة حيازة وترويج المخدرات والمؤثرات العقلية بسلا. تمكنت عناصر الشرطة بالأمن الإقليمي بمدينة سلا، بناءً على معلومات دقيقة وفرتها مصالح المديرية العامة لمراقبة التراب الوطني، مساء أمس الأربعاء، من توقيف سيدة تبلغ من العمر 33 سنة، وذلك للاشتباه في تورطها في قضية تتعلق بحيازة وترويج المخدرات والمؤثرات العقلية. وأكدت مصادر أمنية، أنه قد جرى توقيف المشتبه فيها بأحد أحياء مدينة …  توقيف سيدة بشبهة حيازة وترويج المخدرات والمؤثرات العقلية بسلا     .', 'size': 2}], 'main_title': 'توقيف ثلاثينية وحجز أزيد من 2430 قرصا طبيا مخدرا بسلا'}, {'community_id': '8', 'articles': [{'id': '176', 'title': 'كندا تعتزم الاعتراف بدولة فلسطين خلال الجمعية العامة للأمم المتحدة', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%83%d9%86%d8%af%d8%a7-%d8%aa%d8%b9%d8%aa%d8%b2%d9%85-%d8%a7%d9%84%d8%a7%d8%b9%d8%aa%d8%b1%d8%a7%d9%81-%d8%a8%d8%af%d9%88%d9%84%d8%a9-%d9%81%d9%84%d8%b3%d8%b7%d9%8a%d9%86-%d8%ae%d9%84%d8%a7%d9%84/', 'summary': 'كندا تعتزم الاعتراف بدولة فلسطين خلال الجمعية العامة للأمم المتحدة. أعلن رئيس الوزراء الكندي، مارك كارني، أن بلاده "تعتزم" الاعتراف بدولة فلسطين خلال اجتماعات الجمعية العامة للأمم المتحدة في نيويورك في شتنبر المقبل. وقال كارني خلال مؤتمر صحافي في أوتاوا إن "كندا تعتزم الاعتراف بدولة فلسطين خلال الدورة الثمانين للجمعية العامة للأمم المتحدة في شتنبر 2025". وأوضح أن هذا التحول في موقف أوتاوا مدفوع بقناعة  كندا تعتزم الاعتراف بدولة فلسطين خلال الجمعية العامة للأمم المتحدة     .', 'size': 2}, {'id': '239', 'title': 'كندا تعتزم الاعتراف رسميا بدولة فلسطين خلال الجمعية العامة للأمم المتحدة شتنبر المقبل', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%83%d9%86%d8%af%d8%a7-%d8%aa%d8%b9%d8%aa%d8%b2%d9%85-%d8%a7%d9%84%d8%a7%d8%b9%d8%aa%d8%b1%d8%a7%d9%81-%d8%b1%d8%b3%d9%85%d9%8a%d8%a7-%d8%a8%d8%af%d9%88%d9%84%d8%a9-%d9%81%d9%84%d8%b3%d8%b7%d9%8a/', 'summary': 'كندا تعتزم الاعتراف رسميا بدولة فلسطين خلال الجمعية العامة للأمم المتحدة شتنبر المقبل. أعلن رئيس الوزراء الكندي، مارك كارني، أن بلاده تعتزم الاعتراف رسميا بدولة فلسطين خلال الدورة الـ80 للجمعية العامة للأمم المتحدة المقررة في شتنبر 2025، مشددا على أن هذا القرار يأتي في سياق “ضرورة عاجلة لحماية ما تبقى من فرص حل الدولتين”. وأكد كارني في تصريح منشور على موقع الحكومة الكندية، أن “كندا لطالما …  كندا تعتزم الاعتراف رسميا بدولة فلسطين خلال الجمعية العامة للأمم المتحدة شتنبر المقبل     .', 'size': 2}], 'main_title': 'كندا تعتزم الاعتراف بدولة فلسطين خلال الجمعية العامة للأمم المتحدة'}, {'community_id': '1', 'articles': [{'id': '225', 'title': 'الملك محمد السادس يشحن نوابض المغرب… بالمستقبل', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/225400/', 'summary': 'الملك محمد السادس يشحن نوابض المغرب… بالمستقبل. طالع السعود الأطلسي هو ذا القائد التاريخي… الملك محمد السادس… الملك المبدع لاستراتيجية إصلاحية شاملة وبعيدة المدى للمغرب… يجعل من خطاب العرش، خطاب التواصل مع شعبه في شأن مسار تلك الاستراتيجية، من جهة ما تحقّق منها ومن جهة ما ينبغي، ولا بد، أن يتحقق… بنبرة هادئة، وبصوت صارم، وبنَفَس متفائل ألقى الملك محمد السادس، بمناسبة', 'size': 2}, {'id': '307', 'title': 'خطاب المصارحة', 'source': 'www.alakhbar.press.ma', 'link': 'https://www.alakhbar.press.ma/%d8%ae%d8%b7%d8%a7%d8%a8-%d8%a7%d9%84%d9%85%d8%b5%d8%a7%d8%b1%d8%ad%d8%a9-270275.html', 'summary': 'خطاب المصارحة. أكد الملك محمد السادس في خطاب العرش الذي تطرق إلى الإنجازات المحققة والمصارحة بما يحتاجه المغرب لتسريع الوتيرة التنموية، أن ما تحقق من بناء مغرب متقدم، موحد ومتضامن، لم يكن وليد الصدفة، وإنما هو نتيجة رؤية استراتيجية بعيدة المدى، تدعمها مؤشرات الأمن والاستقرار السياسي والمؤسساتي، وصواب الاختيارات التنموية الكبرى بالمملكة الشريفة. ورغم توالي سنوات الجفاف …  خطاب المصارحة     .', 'size': 2}], 'main_title': 'الملك محمد السادس يشحن نوابض المغرب… بالمستقبل'}, {'community_id': '3', 'articles': [{'id': '230', 'title': 'عائدات السياحة بلغت 54 مليار درهم حتى نهاية يونيو 2025', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%b9%d8%a7%d8%a6%d8%af%d8%a7%d8%aa-%d8%a7%d9%84%d8%b3%d9%8a%d8%a7%d8%ad%d8%a9-%d8%a8%d9%84%d8%ba%d8%aa-54-%d9%85%d9%84%d9%8a%d8%a7%d8%b1-%d8%af%d8%b1%d9%87%d9%85-%d8%ad%d8%aa%d9%89-%d9%86%d9%87/', 'summary': 'عائدات السياحة بلغت 54 مليار درهم حتى نهاية يونيو 2025. المساء اليوم: بلغت عائدات السياحة 54مليار درهم بحلول نهاية يونيو 2025، مسجلةً زيادة قدرها 9.6% مقارنة بسنة 2024، أي ما يعادل 4.7 مليار درهم إضافية. ووفق وزارة السياحة فإن “هذا الأداء المتميز، المدعوم بنمو +19%', 'size': 2}, {'id': '367', 'title': 'تنفيذ قانون المالية.. تسجيل عجز في الميزانية بـ24,8 مليار درهم', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%aa%d9%86%d9%81%d9%8a%d8%b0-%d9%82%d8%a7%d9%86%d9%88%d9%86-%d8%a7%d9%84%d9%85%d8%a7%d9%84%d9%8a%d8%a9-%d8%aa%d8%b3%d8%ac%d9%8a%d9%84-%d8%b9%d8%ac%d8%b2-%d9%81%d9%8a-%d8%a7%d9%84%d9%85%d9%8a/', 'summary': 'تنفيذ قانون المالية.. تسجيل عجز في الميزانية بـ24,8 مليار درهم. أظهر تنفيذ قانون المالية عند متم يونيو 2025 عجزا في الميزانية قدره 24,8 مليار درهم، وفقا للخزينة العامة للمملكة. وأكدت الخزينة، في تقريرها الفصلي الأخير حول تنفيذ قانون المالية برسم الفصل الثاني من سنة 2025، أن هذا العجز يعزى إلى الموارد العادية (باستثناء الإيرادات من القروض) البالغة 319,8 مليار درهم، والنفقات (باستثناء استهلاك الديون) التي  تنفيذ قانون المالية.. تسجيل عجز في الميزانية بـ24,8 مليار درهم     .', 'size': 2}], 'main_title': 'عائدات السياحة بلغت 54 مليار درهم حتى نهاية يونيو 2025'}, {'community_id': '6', 'articles': [{'id': '276', 'title': 'الجيش يجدد الولاء والإخلاص للملك', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d8%a7%d9%84%d8%ac%d9%8a%d8%b4-%d9%8a%d8%ac%d8%af%d8%af-%d8%a7%d9%84%d9%88%d9%84%d8%a7%d8%a1-%d9%88%d8%a7%d9%84%d8%a5%d8%ae%d9%84%d8%a7%d8%b5-%d9%84%d9%84%d9%85%d9%84%d9%83-1602204.html', 'summary': 'الجيش يجدد الولاء والإخلاص للملك. رفعت أسرة القوات المسلحة الملكية برقية تهنئة وولاء وإخلاص إلى الملك محمد السادس، القائد الأعلى رئيس أركان الحرب العامة للقوات المسلحة الملكية، بمناسبة الذكرى السادسة والعشرين لتربعه على العرش. نص البرقية: ” الحمد لله، والصلاة والسلام على رسول الله وآله وصحبه مولاي صاحب الجلالة الملك، القائد الأعلى ورئيس أركان الحرب العامة للقوات المسلحة الملكية في  الجيش يجدد الولاء والإخلاص للملك     - هسبريس جريدة إلكترونية مغربية .', 'size': 4}, {'id': '312', 'title': 'برقية تهنئة وولاء وإخلاص إلى جلالة الملك من أسرة القوات المسلحة الملكية بمناسبة عيد العرش المجيد', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/204462', 'summary': 'برقية تهنئة وولاء وإخلاص إلى جلالة الملك من أسرة القوات المسلحة الملكية بمناسبة عيد العرش المجيد.  رفعت أسرة القوات المسلحة الملكية برقية تهنئة وولاء وإخلاص إلى صاحب الجلالة الملك محمد السادس،القائد الأعلى ورئيس أركان الحرب العامة للقوات المسلحة الملكية، بمناسبة الذكرى السادسة والعشرين لتربع جلالته عرش أسلافه المنعمين. وفي ما يلي نص البرقية : ”الحمد لله، والصلاة والسلام على رسول الله وآله وصحبه مولاي صاحب الجلالة الملك، القائد الأعلى', 'size': 4}, {'id': '338', 'title': 'بمناسبة عيد العرش.. أسرة القوات المسلحة ترفع برقية تهنئة وولاء وإخلاص إلى جلالة الملك', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a8%d9%85%d9%86%d8%a7%d8%b3%d8%a8%d8%a9-%d8%b9%d9%8a%d8%af-%d8%a7%d9%84%d8%b9%d8%b1%d8%b4-%d8%a3%d8%b3%d8%b1%d8%a9-%d8%a7%d9%84%d9%82%d9%88%d8%a7%d8%aa-%d8%a7%d9%84%d9%85%d8%b3%d9%84%d8%ad%d8%a9/', 'summary': 'بمناسبة عيد العرش.. أسرة القوات المسلحة ترفع برقية تهنئة وولاء وإخلاص إلى جلالة الملك. رفعت أسرة القوات المسلحة الملكية برقية تهنئة وولاء وإخلاص إلى صاحب الجلالة الملك محمد السادس، القائد الأعلى ورئيس أركان الحرب العامة للقوات المسلحة الملكية، بمناسبة الذكرى السادسة والعشرين لتربع جلالته عرش أسلافه المنعمين. وفي ما يلي نص البرقية : ” الحمد لله، والصلاة والسلام على رسول الله وآله وصحبه مولاي صاحب الجلالة الملك، القائد الأعلى', 'size': 4}, {'id': '429', 'title': 'برقية تهنئة وولاء وإخلاص إلى الملك محمد السادس من أسرة القوات المسلحة الملكية بمناسبة عيد العرش المجيد', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a8%d8%b1%d9%82%d9%8a%d8%a9-%d8%aa%d9%87%d9%86%d8%a6%d8%a9-%d9%88%d9%88%d9%84%d8%a7%d8%a1-%d9%88%d8%a5%d8%ae%d9%84%d8%a7%d8%b5-%d8%a5%d9%84%d9%89-%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%85%d8%ad%d9%85/', 'summary': 'برقية تهنئة وولاء وإخلاص إلى الملك محمد السادس من أسرة القوات المسلحة الملكية بمناسبة عيد العرش المجيد. رفعت أسرة القوات المسلحة الملكية برقية تهنئة وولاء وإخلاص إلى الملك محمد السادس، القائد الأعلى ورئيس أركان الحرب العامة للقوات المسلحة الملكية، بمناسبة الذكرى السادسة والعشرين لتربع جلالته عرش أسلافه المنعمين. وفي ما يلي نص البرقية: ” الحمد لله، والصلاة والسلام على رسول الله وآله وصحبه مولاي صاحب الجلالة الملك، القائد الأعلى ورئيس …  برقية تهنئة وولاء وإخلاص إلى الملك محمد السادس من أسرة القوات المسلحة الملكية بمناسبة عيد العرش المجيد     .', 'size': 4}], 'main_title': 'الجيش يجدد الولاء والإخلاص للملك'}, {'community_id': '9', 'articles': [{'id': '313', 'title': 'جلالة الملك يترأس بتطوان حفل أداء القسم للضباط المتخرجين من المدارس العليا العسكرية وشبه العسكرية', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/204454', 'summary': 'جلالة الملك يترأس بتطوان حفل أداء القسم للضباط المتخرجين من المدارس العليا العسكرية وشبه العسكرية.  ترأس صاحب الجلالة الملك محمد السادس، القائد الأعلى و رئيس أركان الحرب العامة للقوات المسلحة الملكية، نصره الله، مرفوقا بصاحب السمو الملكي ولي العهد الأمير مولاي الحسن و صاحب السمو الملكي الأمير مولاي رشيد،بعد ظهر اليوم الخميس ،بساحة المشور بالقصر الملكي بتطوان، حفل مراسم أداء القسم من طرف الضباط المتخرجين من مختلف المدارس', 'size': 3}, {'id': '389', 'title': 'عيد العرش… الملك يترأس بتطوان حفل أداء القسم للضباط المتخرجين من المدارس العليا العسكرية وشبه العسكرية', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/471237.html', 'summary': 'عيد العرش… الملك يترأس بتطوان حفل أداء القسم للضباط المتخرجين من المدارس العليا العسكرية وشبه العسكرية. ترأس الملك محمد السادس، القائد الأعلى ورئيس أركان الحرب العامة للقوات المسلحة الملكية، مرفوقا بولي العهد الأمير مولاي الحسن والأمير مولاي رشيد، بعد ظهر اليوم الخميس، بساحة المشور بالقصر الملكي بتطوان، حفل مراسم أداء القسم من طرف الضباط المتخرجين من مختلف المدارس والمعاهد العسكرية وشبه العسكرية وكذا ضباط الصف الذين تمت ترقيتهم إلى رتبة ضابط، …', 'size': 4}, {'id': '420', 'title': 'عيد العرش .. جلالة الملك يترأس حفل أداء القسم للضباط المتخرجين من المدارس العليا العسكرية وشبه العسكرية', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/225439/', 'summary': 'عيد العرش .. جلالة الملك يترأس حفل أداء القسم للضباط المتخرجين من المدارس العليا العسكرية وشبه العسكرية. تطوان – ترأس صاحب الجلالة الملك محمد السادس، القائد الأعلى ورئيس أركان الحرب العامة للقوات المسلحة الملكية، نصره الله، مرفوقا بصاحب السمو الملكي ولي العهد الأمير مولاي الحسن وصاحب السمو الملكي الأمير مولاي رشيد، بعد ظهر اليوم الخميس، بساحة المشور بالقصر الملكي بتطوان، حفل مراسم أداء القسم من طرف الضباط المتخرجين من مختلف المدارس والمعاهد', 'size': 4}, {'id': '428', 'title': 'عيد العرش.. أمير المؤمنين الملك محمد السادس يترأس حفل الولاء بالقصر الملكي بتطوان', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%b9%d9%8a%d8%af-%d8%a7%d9%84%d8%b9%d8%b1%d8%b4-%d8%a3%d9%85%d9%8a%d8%b1-%d8%a7%d9%84%d9%85%d8%a4%d9%85%d9%86%d9%8a%d9%86-%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3-2/', 'summary': 'عيد العرش.. أمير المؤمنين الملك محمد السادس يترأس حفل الولاء بالقصر الملكي بتطوان. ترأس أمير المؤمنين الملك محمد السادس، مرفوقا بصاحب السمو الملكي ولي العهد الأمير مولاي الحسن، وصاحب السمو الملكي الأمير مولاي رشيد، وصاحب السمو الأمير مولاي أحمد، بعد زوال اليوم الخميس 31 يوليوز 2025، بساحة المشور بالقصر الملكي بتطوان، حفل الولاء، وذلك تخليدا للذكرى السادسة والعشرين لتربع جلالة الملك على عرش أسلافه المنعمين. وفي …  عيد العرش.. أمير المؤمنين الملك محمد السادس يترأس حفل الولاء بالقصر الملكي بتطوان     .', 'size': 3}], 'main_title': 'عيد العرش… الملك يترأس بتطوان حفل أداء القسم للضباط المتخرجين من المدارس العليا العسكرية وشبه العسكرية'}, {'community_id': '7', 'articles': [{'id': '373', 'title': 'وسط مخاوف بشأن الإمدادات.. أسعار النفط تواصل ارتفاعها لليوم الرابع', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%88%d8%b3%d8%b7-%d9%85%d8%ae%d8%a7%d9%88%d9%81-%d8%a8%d8%b4%d8%a3%d9%86-%d8%a7%d9%84%d8%a5%d9%85%d8%af%d8%a7%d8%af%d8%a7%d8%aa-%d8%a3%d8%b3%d8%b9%d8%a7%d8%b1-%d8%a7%d9%84%d9%86%d9%81%d8%b7-%d8%aa/', 'summary': 'وسط مخاوف بشأن الإمدادات.. أسعار النفط تواصل ارتفاعها لليوم الرابع. ارتفعت أسعار النفط، اليوم الخميس، لليوم الرابع على التوالي، وسط مخاوف من تأثر الإمدادات. وصعدت العقود الآجلة لخام برنت تسليم شتنبر، والتي من المقرر أن ينتهي أجلها اليوم، بنسبة 4ر0 في المائة إلى 51ر73 دولارا للبرميل. كما ارتفع خام غرب تكساس الوسيط الأمريكي تسليم شتنبر إلى 37ر70 دولارا للبرميل (زائد 5ر0 في المائة)، فيما ارتفع  وسط مخاوف بشأن الإمدادات.. أسعار النفط تواصل ارتفاعها لليوم الرابع     .', 'size': 2}, {'id': '435', 'title': 'أسعار النفط تواصل الصعود لليوم الرابع وسط مخاوف من تراجع الإمدادات', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a3%d8%b3%d8%b9%d8%a7%d8%b1-%d8%a7%d9%84%d9%86%d9%81%d8%b7-%d8%aa%d9%88%d8%a7%d8%b5%d9%84-%d8%a7%d9%84%d8%b5%d8%b9%d9%88%d8%af-%d9%84%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%b1%d8%a7%d8%a8%d8%b9/', 'summary': 'أسعار النفط تواصل الصعود لليوم الرابع وسط مخاوف من تراجع الإمدادات. تواصل أسعار النفط تسجيل مكاسب لليوم الرابع على التوالي، مدفوعة بمخاوف متزايدة بشأن استقرار الإمدادات العالمية، في ظل توترات جيوسياسية وظروف مناخية تؤثر على الإنتاج. وسجلت العقود الآجلة لخام برنت تسليم شتنبر، والتي ينتهي أجلها اليوم الخميس، ارتفاعا بنسبة 0.4% لتصل إلى 73.51 دولارا للبرميل. كما صعد خام غرب تكساس الوسيط الأميركي تسليم …  أسعار النفط تواصل الصعود لليوم الرابع وسط مخاوف من تراجع الإمدادات     .', 'size': 2}], 'main_title': 'وسط مخاوف بشأن الإمدادات.. أسعار النفط تواصل ارتفاعها لليوم الرابع'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    