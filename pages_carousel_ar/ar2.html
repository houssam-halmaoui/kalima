<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 04/10/2025 - 12h21</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '4', 'articles': [{'id': '21', 'title': 'الأمن الوطني يمنح ترقية استثنائية لشرطيين تكريماً لتضحياتهما', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-662985.html', 'summary': 'الأمن الوطني يمنح ترقية استثنائية لشرطيين تكريماً لتضحياتهما. أصدر المدير العام للأمن الوطني ولمراقبة التراب الوطني، عبد اللطيف حموشي، قراراً يقضي بمنح ترقية استثنائية لاثنين من موظفي الشرطة، أحدهما برتبة حارس أمن سابق بالمديرية العامة للأمن العمومي، والثاني مفتش شرطة ممتاز يعمل بولاية أمن فاس، وذلك تقديراً لتضحياتهما الجسيمة واعترافاً بحسهما المهني الرفيع. وأوضح بلاغ للمديرية أن الموظف الأول فارق الحياة إثر حادثة', 'size': 5}, {'id': '136', 'title': 'ترقية استثنائية لشرطيين أحدهما فارق الحياة أثناء أداء الواجب', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/325204/', 'summary': 'ترقية استثنائية لشرطيين أحدهما فارق الحياة أثناء أداء الواجب. أصدر المدير العام للأمن الوطني و لمراقبة التراب الوطني عبد اللطيف حموشي قرارا بمنح ترقية استثنائية لاثنين من موظفي الشرطة، أحدهما برتبة حارس أمن كان يعمل بمديرية الأمن العمومي والثاني مفتش شرطة ممتاز يعمل بولاية أمن فاس، وذلك تقديرا لتضحياتهم الجسيمة وامتنانا لحسهم المهني العالي. وكان الموظفان المستفيدان من هذه الترقية الاستثنائية قد تعرضا لحوادث', 'size': 5}, {'id': '188', 'title': 'حموشي يرقي استثنائيا موظفي شرطة أحدهما توفي أثناء أداء مهامهما', 'source': 'rue20.com', 'link': 'https://rue20.com/942009.html', 'summary': 'حموشي يرقي استثنائيا موظفي شرطة أحدهما توفي أثناء أداء مهامهما.  الرباط أصدر المدير العام للأمن الوطني ولمراقبة التراب الوطني عبد اللطيف حموشي قرارا بمنح ترقية استثنائية لاثنين من موظفي الشرطة، أحدهما برتبة حارس أمن كان يعمل بمديرية الأمن العمومي والثاني مفتش شرطة ممتاز يعمل بولاية أمن فاس، وذلك تقديرا لتضحياتهم الجسيمة وامتنانا لحسهم المهني العالي. وكان الموظفان المستفيدان من هذه الترقية الاستثنائية قد تعرضا الخبر حموشي يرقي استثنائيا موظفي شرطة أحدهما توفي أثناء أداء مهامهما  .', 'size': 5}, {'id': '226', 'title': 'عاجل.. السيد حموشي يمنح ترقية استثنائي لموظفي شرطة تقديرا لتضحياتهم الجسيمة', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/227990/', 'summary': 'عاجل.. السيد حموشي يمنح ترقية استثنائي لموظفي شرطة تقديرا لتضحياتهم الجسيمة. أصدر المدير العام للأمن الوطني ولمراقبة التراب الوطني عبد اللطيف حموشي قرارا بمنح ترقية استثنائية لاثنين من موظفي الشرطة، أحدهما برتبة حارس أمن كان يعمل بمديرية الأمن العمومي والثاني مفتش شرطة ممتاز يعمل بولاية أمن فاس، وذلك تقديرا لتضحياتهم الجسيمة وامتنانا لحسهم المهني العالي. وكان الموظفان المستفيدان من هذه الترقية الاستثنائية قد تعرضا لحوادث خطيرة', 'size': 5}, {'id': '247', 'title': 'التفاتة إنسانية.. حموشي يقرر ترقية استثنائية لشرطيين أصيبا أثناء مزاولة مهامهما', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d8%aa%d9%81%d8%a7%d8%aa%d8%a9-%d8%a5%d9%86%d8%b3%d8%a7%d9%86%d9%8a%d8%a9-%d8%ad%d9%85%d9%88%d8%b4%d9%8a-%d9%8a%d9%82%d8%b1%d8%b1-%d8%aa%d8%b1%d9%82%d9%8a%d8%a9-%d8%a7%d8%b3%d8%aa%d8%ab/', 'summary': 'التفاتة إنسانية.. حموشي يقرر ترقية استثنائية لشرطيين أصيبا أثناء مزاولة مهامهما. أصدر المدير العام للأمن الوطني ولمراقبة التراب الوطني عبد اللطيف حموشي قرارا بمنح ترقية استثنائية لاثنين من موظفي الشرطة، أحدهما برتبة حارس أمن كان يعمل بمديرية الأمن العمومي والثاني مفتش شرطة ممتاز يعمل بولاية أمن فاس، وذلك تقديرا لتضحياتهم الجسيمة وامتنانا لحسهم المهني العالي. وحسب مصدر أمني، كان الموظفان المستفيدان من هذه الترقية …  التفاتة إنسانية.. حموشي يقرر ترقية استثنائية لشرطيين أصيبا أثناء مزاولة مهامهما     .', 'size': 5}], 'main_title': 'الأمن الوطني يمنح ترقية استثنائية لشرطيين تكريماً لتضحياتهما'}, {'community_id': '3', 'articles': [{'id': '33', 'title': 'حماس توافق على خطة ترامب للإفراج عن الرهائن', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-662953.html', 'summary': 'حماس توافق على خطة ترامب للإفراج عن الرهائن. هبة بريس أعلنت حركة حماس، مساء اليوم الجمعة، موافقتها على مقترح الرئيس الأميركي دونالد ترامب، القاضي بالإفراج عن جميع الرهائن الإسرائيليين الأحياء وتسليم جثامين القتلى، في إطار خطة شاملة لمستقبل قطاع غزة. وأكدت الحركة في بيان رسمي “استعدادها الفوري للدخول في مفاوضات عبر الوسطاء لبحث تفاصيل المبادرة”، مشيدة بالجهود العربية والإسلامية والدولية، وبالجهود المبذولة من', 'size': 3}, {'id': '117', 'title': 'بناء على مقترح ترامب.. “حماس” توافق على الإفراج عن كل الرهائن الإسرائيليين', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a8%d9%86%d8%a7%d8%a1-%d8%b9%d9%84%d9%89-%d9%85%d9%82%d8%aa%d8%b1%d8%ad-%d8%aa%d8%b1%d8%a7%d9%85%d8%a8-%d8%ad%d9%85%d8%a7%d8%b3-%d8%aa%d9%88%d8%a7%d9%81%d9%82-%d8%b9%d9%84%d9%89-%d8%a7%d9%84/', 'summary': 'بناء على مقترح ترامب.. “حماس” توافق على الإفراج عن كل الرهائن الإسرائيليين. أعلنت حركة “حماس”، مساء اليوم الجمعة (3 أكتوبر)، موافقتها على الإفراج عن كل الرهائن الإسرائيليين الأحياء وتسليم جثث الأموات، بناء على مقترح الرئيس الأميركي دونالد ترامب. وأكدت حماس، في بيان لها، استعدادها “للانخراط على الفور في مفاوضات عبر الوسطاء لبحث تفاصيل خطة ترامب”. وأضاف البيان أن الحركة “تقدّر الجهود العربية والإسلامية والدولية وكذا جهود الرئيس', 'size': 3}, {'id': '146', 'title': 'حماس توافق على خطة ترامب بشأن غزة', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-592282.html', 'summary': 'حماس توافق على خطة ترامب بشأن غزة. أعلنت حركة “حماس”، مساء الجمعة، موافقتها على الإفراج عن كل الرهائن الإسرائيليين الأحياء وتسليم جثث الأموات بناء على مقترح الرئيس الأميركي دونالد ترامب. وأكدت حماس في بيان “استعدادها للانخراط على الفور في مفاوضات عبر الوسطاء لبحث تفاصيل خطة ترامب”، مبرزة أنها “تقدّر الجهود العربية والإسلامية والدولية وكذا جهود الرئيس ترامب”. وتابع البيان', 'size': 4}, {'id': '241', 'title': 'حماس توافق على خطة ترامب لإنهاء الحرب في قطاع غزة', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%ad%d9%85%d8%a7%d8%b3-%d8%aa%d9%88%d8%a7%d9%81%d9%82-%d8%b9%d9%84%d9%89-%d8%ae%d8%b7%d8%a9-%d8%aa%d8%b1%d8%a7%d9%85%d8%a8-%d9%84%d8%a5%d9%86%d9%87%d8%a7%d8%a1-%d8%a7%d9%84%d8%ad%d8%b1%d8%a8-%d9%81/', 'summary': 'حماس توافق على خطة ترامب لإنهاء الحرب في قطاع غزة. كشفت حركة “حماس”، مساء الجمعة 03 أكتوبر 2025، موافقتها على مقترح الرئيس الأميركي دونالد ترامب، الذي يتضمن الإفراج عن جميع الرهائن الإسرائيليين الأحياء وتسليم جثث القتلى، في إطار خطة شاملة لإنهاء الحرب في قطاع غزة. وفي هذا الصدد، شددت الحركة في بيان رسمي استعدادها “للشروع الفوري في مفاوضات عبر الوسطاء لبحث تفاصيل الخطة”، …  حماس توافق على خطة ترامب لإنهاء الحرب في قطاع غزة     .', 'size': 2}], 'main_title': 'حماس توافق على خطة ترامب بشأن غزة'}, {'community_id': '0', 'articles': [{'id': '57', 'title': 'إيداع المتورطين في أحداث التخـ ـريب وإضـ ـرام النـ ـار والسـ ـرقة بسلا السجن… والأبحاث متواصلة لتوقيف باقي المشاركين', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/206966', 'summary': 'إيداع المتورطين في أحداث التخـ ـريب وإضـ ـرام النـ ـار والسـ ـرقة بسلا السجن… والأبحاث متواصلة لتوقيف باقي المشاركين.  الرباط – قررت النيابة العامة لدى محكمة الاستئناف بالرباط، إحالة مجموعة من الأشخاص المتورطين في أحداث تخريب وإضرام النار والسرقة التي شهدتها مدينة سلا، على قاضي التحقيق. وبناءً على ملتمس النيابة العامة، تقرر إيداع المتهمين السجن في انتظار استكمال مجريات التحقيق التفصيلي، في حين لا تزال الأبحاث جارية لتوقيف باقي المتورطين في هذه الأفعال.', 'size': 5}, {'id': '138', 'title': 'سلا.. إيداع المتورطين في أحداث التخريب وإضرام النار والسرقة السجن', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/325202/', 'summary': 'سلا.. إيداع المتورطين في أحداث التخريب وإضرام النار والسرقة السجن. قررت النيابة العامة لدى محكمة الاستئناف بالرباط، إحالة مجموعة من الأشخاص المتورطين في أحداث تخريب وإضرام النار والسرقة التي شهدتها مدينة سلا، على قاضي التحقيق. وبناءً على ملتمس النيابة العامة، تقرر إيداع المتهمين السجن في انتظار استكمال مجريات التحقيق التفصيلي، في حين لا تزال الأبحاث جارية لتوقيف باقي المتورطين في هذه الأفعال.', 'size': 5}, {'id': '178', 'title': 'النيابة العامة تحيل على السجن مخربين خلال احتجاجات عنيفة في سلا', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a7%d9%84%d9%86%d9%8a%d8%a7%d8%a8%d8%a9-%d8%a7%d9%84%d8%b9%d8%a7%d9%85%d8%a9-%d8%aa%d8%ad%d9%8a%d9%84-%d8%b9%d9%84%d9%89-%d8%a7%d9%84%d8%b3%d8%ac%d9%86-%d9%85%d8%ae%d8%b1%d8%a8%d9%8a%d9%86-%d9%81/', 'summary': 'النيابة العامة تحيل على السجن مخربين خلال احتجاجات عنيفة في سلا. قررت النيابة العامة لدى محكمة الاستئناف بالرباط، إحالة مجموعة من الأشخاص المتورطين في أحداث تخريب وإضرام النار والسرقة التي شهدتها مدينة سلا، على قاضي التحقيق. وبحسب مصدر بهذه الينابة،وبناءً على ملتمس النيابة العامة، تقرر إيداع المتهمين السجن في انتظار استكمال مجريات التحقيق التفصيلي، في حين لا تزال الأبحاث جارية لتوقيف باقي المتورطين في هذه الأفعال.  النيابة العامة تحيل على السجن مخربين خلال احتجاجات عنيفة في سلا     .', 'size': 4}, {'id': '194', 'title': 'إحالة المتورطين في أحداث التخريب والعنف بسلا على قاضي التحقيق وإيداعهم السجن', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/477503.html', 'summary': 'إحالة المتورطين في أحداث التخريب والعنف بسلا على قاضي التحقيق وإيداعهم السجن. قررت النيابة العامة لدى محكمة الاستئناف بالرباط، إحالة مجموعة من الأشخاص المتورطين في أحداث تخريب وإضرام النار والسرقة التي شهدتها مدينة سلا، مؤخرا، على قاضي التحقيق. وبناءً على ملتمس النيابة العامة، تقرر إيداع المتهمين السجن في انتظار استكمال مجريات التحقيق التفصيلي، في حين تواصل مصالح الأمن أبحاثها لتوقيف باقي المشاركين في هذه الأفعال. يذكر أن …', 'size': 4}, {'id': '293', 'title': 'إيداع المتورطين في أحداث التخريب وإضرام النار والسرقة بسلا السجن… والأبحاث متواصلة لتوقيف باقي المشاركين', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/413893.html', 'summary': 'إيداع المتورطين في أحداث التخريب وإضرام النار والسرقة بسلا السجن… والأبحاث متواصلة لتوقيف باقي المشاركين. قررت النيابة العامة لدى محكمة الاستئناف بالرباط، إحالة مجموعة من الأشخاص المتورطين في أحداث تخريب وإضرام النار والسرقة التي شهدتها مدينة سلا، على قاضي التحقيق. وبناءً', 'size': 5}], 'main_title': 'إيداع المتورطين في أحداث التخـ ـريب وإضـ ـرام النـ ـار والسـ ـرقة بسلا السجن… والأبحاث متواصلة لتوقيف باقي المشاركين'}, {'community_id': '2', 'articles': [{'id': '139', 'title': 'طقس السبت.. أمطار متفرقة ورياح قوية بهذه المناطق المغربية', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-592297.html', 'summary': 'طقس السبت.. أمطار متفرقة ورياح قوية بهذه المناطق المغربية. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليوم غد السبت، أن تتميز الحالة الجوية العامة بطقس حار نسبيا بكل من الجنوب-الشرقي للبلاد وبأقصى جنوب الأقاليم الصحراوية. كما يرتقب تشكل كتل ضبابية أو نزول أمطار خفيفة بكل من سواحل البحر الأبيض المتوسط والسهول الشمالية الوسطى للمحيط الأطلسي، وكذا بالشمال الغربي للأقاليم الصحراوية. وسيلاحظ', 'size': 4}, {'id': '290', 'title': 'طقس السبت.. أجواء حارة بعدد من مناطق المملكة', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-663044.html', 'summary': 'طقس السبت.. أجواء حارة بعدد من مناطق المملكة. هبة بريس تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليوم السبت، أن تتميز الحالة الجوية العامة بطقس حار نسبيا بكل من الجنوب-الشرقي للبلاد وبأقصى جنوب الأقاليم الصحراوية. كما يرتقب تشكل كتل ضبابية أونزول أمطار خفيفة بكل من سواحل البحر الأبيض المتوسط والسهول الشمالية الوسطى للمحيط الأطلسي، وكذا بالشمال الغربي للأقاليم الصحراوية. وسيلاحظ أيضا تسجيل هبات رياح', 'size': 4}, {'id': '359', 'title': 'أحوال الطقس: عودة درجة الحرارة إلى الارتفاع مع هطول أمطار', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a3%d8%ad%d9%88%d8%a7%d9%84-%d8%a7%d9%84%d8%b7%d9%82%d8%b3-%d8%b9%d9%88%d8%af%d8%a9-%d8%af%d8%b1%d8%ac%d8%a9-%d8%a7%d9%84%d8%ad%d8%b1%d8%a7%d8%b1%d8%a9-%d8%a5%d9%84%d9%89-%d8%a7%d9%84%d8%a7%d8%b1/', 'summary': 'أحوال الطقس: عودة درجة الحرارة إلى الارتفاع مع هطول أمطار. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لهذا اليوم، أن تتميز الحالة الجوية العامة بطقس حار نسبيا بكل من الجنوب-الشرقي للبلاد وبأقصى جنوب الأقاليم الصحراوية. كما يرتقب تشكل كتل ضبابية أونزول أمطار خفيفة بكل من سواحل البحر الأبيض المتوسط والسهول الشمالية الوسطى للمحيط الأطلسي، وكذا بالشمال الغربي للأقاليم الصحراوية. وسيلاحظ أيضا تسجيل هبات رياح قوية  أحوال الطقس: عودة درجة الحرارة إلى الارتفاع مع هطول أمطار     .', 'size': 4}, {'id': '388', 'title': 'توقعات الأرصاد الجوية لطقس اليوم السبت', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%aa%d9%88%d9%82%d8%b9%d8%a7%d8%aa-%d8%a7%d9%84%d8%a3%d8%b1%d8%b5%d8%a7%d8%af-%d8%a7%d9%84%d8%ac%d9%88%d9%8a%d8%a9-%d9%84%d8%b7%d9%82%d8%b3-%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%b3%d8%a8-2/', 'summary': 'توقعات الأرصاد الجوية لطقس اليوم السبت. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم السبت، أن تتميز الحالة الجوية العامة بطقس حار نسبيا بكل من الجنوب-الشرقي للبلاد وبأقصى جنوب الأقاليم الصحراوية. كما يرتقب تشكل كتل ضبابية أونزول أمطار خفيفة بكل من سواحل البحر الأبيض المتوسط والسهول الشمالية الوسطى للمحيط الأطلسي، وكذا بالشمال الغربي للأقاليم الصحراوية. وسيلاحظ أيضا تسجيل هبات رياح …  توقعات الأرصاد الجوية لطقس اليوم السبت     .', 'size': 4}], 'main_title': 'طقس السبت.. أمطار متفرقة ورياح قوية بهذه المناطق المغربية'}, {'community_id': '5', 'articles': [{'id': '180', 'title': 'إنخفاض سعر الدرهم مقابل اليورو', 'source': 'rue20.com', 'link': 'https://rue20.com/942059.html', 'summary': 'إنخفاض سعر الدرهم مقابل اليورو. . الرباط أفاد بنك المغرب بأن سعر صرف الدرهم انخفض بنسبة 0,4 في المائة مقابل الأورو وبـ 0,5 في المائة مقابل الدولار الأمريكي، وذلك خلال الفترة الممتدة من 25 شتنبر إلى فاتح أكتوبر 2025. وأوضح بنك المغرب، في نشرته الأسبوعية للمؤشرات الاقتصادية، أنه لم يتم خلال هذه الفترة إجراء أي عملية مناقصة في سوق الخبر إنخفاض سعر الدرهم مقابل اليورو  .', 'size': 3}, {'id': '282', 'title': 'بنك المغرب: انخفاض سعر صرف الدرهم مقابل الأورو', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-663067.html', 'summary': 'بنك المغرب: انخفاض سعر صرف الدرهم مقابل الأورو. هبة بريس أفاد بنك المغرب بأن سعر صرف الدرهم انخفض بنسبة 0,4 في المائة مقابل الأورو وبـ 0,5 في المائة مقابل الدولار الأمريكي، وذلك خلال الفترة الممتدة من 25 شتنبر إلى فاتح أكتوبر 2025. وأوضح بنك المغرب، في نشرته الأسبوعية للمؤشرات الاقتصادية، أنه لم يتم خلال هذه الفترة إجراء أي عملية مناقصة في سوق الصرف.', 'size': 3}, {'id': '342', 'title': 'بنك المغرب يرصد ضغوطا على الدرهم وتقلبات في البورصة وسط تحولات السوق المالية', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1105258.html', 'summary': 'بنك المغرب يرصد ضغوطا على الدرهم وتقلبات في البورصة وسط تحولات السوق المالية. أكد بنك المغرب بأن سعر صرف الدرهم انخفض بنسبة 0,4 في المائة مقابل الأورو وبـ 0,5 في المائة مقابل الدولار الأمريكي، وذلك خلال الفترة الممتدة من 25 شتنبر إلى فاتح أكتوبر 2025. وأوضح بنك المغرب، في نشرته الأسبوعية للمؤشرات الاقتصادية، أنه لم يتم خلال هذه الفترة إجراء أي عملية مناقصة في سوق الصرف. وأبرز المصدر ظهرت المقالة بنك المغرب يرصد ضغوطا على الدرهم وتقلبات في البورصة وسط تحولات السوق المالية  .', 'size': 3}], 'main_title': 'إنخفاض سعر الدرهم مقابل اليورو'}, {'community_id': '1', 'articles': [{'id': '357', 'title': 'سعيد رشيق مندوب جهوي لمؤسسة وسيط المملكة بجهة الدار البيضاء', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%b3%d8%b9%d9%8a%d8%af-%d8%b1%d8%b4%d9%8a%d9%82-%d9%85%d9%86%d8%af%d9%88%d8%a8-%d8%ac%d9%87%d9%88%d9%8a-%d9%84%d9%85%d8%a4%d8%b3%d8%b3%d8%a9-%d9%88%d8%b3%d9%8a%d8%b7-%d8%a7%d9%84%d9%85%d9%85%d9%84/', 'summary': 'سعيد رشيق مندوب جهوي لمؤسسة وسيط المملكة بجهة الدار البيضاء. جرى، اليوم الجمعة بالدار البيضاء، تنصيب سعيد رشيق مندوبا جهويا لمؤسسة وسيط المملكة بجهة الدار البيضاء سطات الذي يندرج في إطار التفعيل الكامل للقانون المحدث لهذه المؤسسة، وتحديدا تفعيل جميع صلاحيات المندوبيات الجهوية و تعزيز قدراتها وتطوير وتحديث أساليب اشتغالها. وبهذه المناسبة، أكد وسيط المملكة حسن طارق، في تصريح له، أن تنصيب المندوب الجهوي للمؤسسة يشكل  سعيد رشيق مندوب جهوي لمؤسسة وسيط المملكة بجهة الدار البيضاء     .', 'size': 2}, {'id': '382', 'title': 'تنصيب المندوب الجهوي لمؤسسة وسيط المملكة بجهة الدار البيضاء-سطات', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%aa%d9%86%d8%b5%d9%8a%d8%a8-%d8%a7%d9%84%d9%85%d9%86%d8%af%d9%88%d8%a8-%d8%a7%d9%84%d8%ac%d9%87%d9%88%d9%8a-%d9%84%d9%85%d8%a4%d8%b3%d8%b3%d8%a9-%d9%88%d8%b3%d9%8a%d8%b7-%d8%a7%d9%84%d9%85%d9%85/', 'summary': 'تنصيب المندوب الجهوي لمؤسسة وسيط المملكة بجهة الدار البيضاء-سطات. المساء اليوم – الدار البيضاء جرى بالدار البيضاء، تنصيب سعيد رشيق مندوبا جهويا لمؤسسة وسيط المملكة بجهة الدار البيضاء سطات. وقال وسيط المملكة حسن طارق، إن تنصيب المندوب الجهوي للمؤسسة يشكل فرصة للتأكيد على الأدوار', 'size': 2}], 'main_title': 'سعيد رشيق مندوب جهوي لمؤسسة وسيط المملكة بجهة الدار البيضاء'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    