<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 12/07/2025 - 18h27</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '3', 'articles': [{'id': '126', 'title': 'اعتداء شنيع ونهاية مأساوية.. القصة الكاملة لاعتصام “درامي” في ولاد يوسف ضواحي بني ملال', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a7%d8%b9%d8%aa%d8%af%d8%a7%d8%a1-%d8%b4%d9%86%d9%8a%d8%b9-%d9%88%d9%86%d9%87%d8%a7%d9%8a%d8%a9-%d9%85%d8%a3%d8%b3%d8%a7%d9%88%d9%8a%d8%a9-%d8%a7%d9%84%d9%82%d8%b5%d8%a9-%d8%a7%d9%84%d9%83%d8%a7/', 'summary': 'اعتداء شنيع ونهاية مأساوية.. القصة الكاملة لاعتصام “درامي” في ولاد يوسف ضواحي بني ملال. عاشت جماعة أولاد يوسف التابعة لإقليم بني ملال، يوم أمس الجمعة (11 يوليوز)، على وقع صدمة كبيرة، بعد تطورات مأساوية شهدها اعتصام ثلاثيني فوق خزان مائي يعرف محليا بـ”شاطو الماء”، والذي دام أزيد من أسبوعين، احتجاجا على ما وصفه بـ”الظروف الغامضة” التي رافقت وفاة والده. ورغم المحاولات المتكررة التي قامت بها السلطات المحلية والجهات الرسمية', 'size': 3}, {'id': '290', 'title': 'بني ملال: إنهاء الشكل الاحتجاجي الذي انخرط فيه شخص اعتصم فوق خزان مياه بجماعة أولاد يوسف', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/203355', 'summary': 'بني ملال: إنهاء الشكل الاحتجاجي الذي انخرط فيه شخص اعتصم فوق خزان مياه بجماعة أولاد يوسف.  أفادت السلطات المحلية بإقليم بني ملال أنه تم، مساء أمس الجمعة، إنهاء الشكل الاحتجاجي الذي انخرط فيه شخص يبلغ من العمر حوالي 45 سنة،من خلال الاعتصام فوق خزان مياه مرتفع بالجماعة الترابية أولاد يوسف، وذلك بتسجيل قيام المعني بالأمر بالإلقاء بنفسه من أعلى الخزان واضعا حبلا على عنقه، لينقل إثر ذلك للمستشفى الجهوي', 'size': 5}, {'id': '358', 'title': '"كرونولوجيا" الحادث المأساوي فوق خزان ماء ببني ملال', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%83%d8%b1%d9%88%d9%86%d9%88%d9%84%d9%88%d8%ac%d9%8a%d8%a7-%d8%a7%d9%84%d8%ad%d8%a7%d8%af%d8%ab-%d8%a7%d9%84%d9%85%d8%a3%d8%b3%d8%a7%d9%88%d9%8a-%d9%81%d9%88%d9%82-%d8%ae%d8%b2%d8%a7%d9%86/', 'summary': '"كرونولوجيا" الحادث المأساوي فوق خزان ماء ببني ملال. أفادت السلطات المحلية بإقليم بني ملال أنه تم مساء أمس الجمعة 11 يوليوز 2025، إنهاء الشكل الاحتجاجي الذي خاضه شخص يبلغ من العمر حوالي 45 سنة، من خلال الاعتصام فوق خزان مياه مرتفع بالجماعة الترابية أولاد يوسف، وذلك بعد قيام المعني بالأمر بالإلقاء بنفسه من أعلى الخزان واضعا حبلا على عنقه، لينقل إثر ذلك إلى  "كرونولوجيا" الحادث المأساوي فوق خزان ماء ببني ملال     .', 'size': 4}, {'id': '361', 'title': 'سلطات بني ملال تكشف تفاصيل واقعة الشاطو وتعلن عن بقاء المعتصم على قيد الحياة', 'source': 'rue20.com', 'link': 'https://rue20.com/919665.html', 'summary': 'سلطات بني ملال تكشف تفاصيل واقعة الشاطو وتعلن عن بقاء المعتصم على قيد الحياة. . مراكش أفادت السلطات المحلية بإقليم بني ملال أنه تم مساء أمس الجمعة 11 يوليوز 2025، إنهاء الشكل الاحتجاجي الذي انخرط فيه شخص يبلغ من العمر حوالي 45 سنة، من خلال الاعتصام فوق خزان مياه مرتفع بالجماعة الترابية أولاد يوسف، وذلك بتسجيل قيام المعني بالأمر بالإلقاء بنفسه من أعلى الخزان واضعا حبلا على عنقه، الخبر سلطات بني ملال تكشف تفاصيل واقعة الشاطو وتعلن عن بقاء المعتصم على قيد الحياة  .', 'size': 4}, {'id': '380', 'title': 'عاجل.. السلطات تكشف تفاصيل ليلة الرعب مع “بوعبيد” بني ملال', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/224569/', 'summary': 'عاجل.. السلطات تكشف تفاصيل ليلة الرعب مع “بوعبيد” بني ملال. أفادت السلطات المحلية بإقليم بني ملال أنه تم مساء أمس الجمعة 11 يوليوز 2025، إنهاء الشكل الاحتجاجي الذي انخرط فيه شخص يبلغ من العمر حوالي 45 سنة، من خلال الاعتصام فوق خزان مياه مرتفع بالجماعة الترابية أولاد يوسف، وذلك بتسجيل قيام المعني بالأمر بالإلقاء بنفسه من أعلى الخزان واضعا حبلا على عنقه، لينقل إثر ذلك', 'size': 5}], 'main_title': 'بني ملال: إنهاء الشكل الاحتجاجي الذي انخرط فيه شخص اعتصم فوق خزان مياه بجماعة أولاد يوسف'}, {'community_id': '4', 'articles': [{'id': '146', 'title': 'ماكرون يستقبل الطالبي العلمي ورؤساء البرلمانات الفرنكوفونية بقصر الإليزيه', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1084912.html', 'summary': 'ماكرون يستقبل الطالبي العلمي ورؤساء البرلمانات الفرنكوفونية بقصر الإليزيه. استقبل الرئيس الفرنسي إيمانويل ماكرون، مساء يوم الجمعة 11 يوليوز 2025 بقصر الإليزيه، رئيس مجلس النواب، راشيد الطالبي العلمي، إلى جانب رؤساء البرلمانات المشاركين في أشغال الدورة 50 للجمعية البرلمانية للفرنكوفونية، التي تحتضنه العاصمة الفرنسية باريس في الفترة من 9 إلى 13 من الشهر الجاري. ويترأس الطالبي العلمي الوفد البرلماني المغربي المشارك في أشغال الجمعية ظهرت المقالة ماكرون يستقبل الطالبي العلمي ورؤساء البرلمانات الفرنكوفونية بقصر الإليزيه  .', 'size': 3}, {'id': '172', 'title': 'ماكرون يستقبل رئيس مجلس النواب الطالبي العلمي', 'source': 'rue20.com', 'link': 'https://rue20.com/919618.html', 'summary': 'ماكرون يستقبل رئيس مجلس النواب الطالبي العلمي.  الرباط استقبل الرئيس الفرنسي إيمانويل ماكرون، مساء يوم الجمعة 11 يوليوز 2025 بقصر الإليزيه، رئيس مجلس النواب، راشيد الطالبي العلمي، إلى جانب رؤساء البرلمانات المشاركين في أشغال الدورة 50 للجمعية البرلمانية للفرنكوفونية، التي تحتضنه العاصمة الفرنسية باريس في الفترة من 9 إلى 13 من الشهر الجاري. ويترأس السيد الطالبي العلمي الوفد البرلماني المغربي المشارك الخبر ماكرون يستقبل رئيس مجلس النواب الطالبي العلمي  .', 'size': 3}, {'id': '389', 'title': 'ماكرون يستقبل الطالبي العلمي ورؤساء البرلمانات المشاركين في الجمعية البرلمانية للفرنكوفونية', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%85%d8%a7%d9%83%d8%b1%d9%88%d9%86-%d9%8a%d8%b3%d8%aa%d9%82%d8%a8%d9%84-%d8%a7%d9%84%d8%b7%d8%a7%d9%84%d8%a8%d9%8a-%d8%a7%d9%84%d8%b9%d9%84%d9%85%d9%8a-%d9%88%d8%b1%d8%a4%d8%b3%d8%a7%d8%a1-%d8%a7/', 'summary': 'ماكرون يستقبل الطالبي العلمي ورؤساء البرلمانات المشاركين في الجمعية البرلمانية للفرنكوفونية. استضاف الرئيس الفرنسي إيمانويل ماكرون، مساء أمس الجمعة 11 يوليوز 2025 بقصر الإليزيه، رئيس مجلس النواب، راشيد الطالبي العلمي، إلى جانب رؤساء البرلمانات المشاركين في أشغال الدورة 50 للجمعية البرلمانية للفرنكوفونية، التي تحتضنها العاصمة الفرنسية باريس في الفترة من 9 إلى 13 من الشهر الجاري. وفي هذا الصدد، يترأس الطالبي العلمي الوفد البرلماني …  ماكرون يستقبل الطالبي العلمي ورؤساء البرلمانات المشاركين في الجمعية البرلمانية للفرنكوفونية     .', 'size': 3}], 'main_title': 'ماكرون يستقبل الطالبي العلمي ورؤساء البرلمانات الفرنكوفونية بقصر الإليزيه'}, {'community_id': '5', 'articles': [{'id': '168', 'title': 'الرباط تحتضن اجتماعات حاسمة لمشروع أنبوب الغاز الإفريقي', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a7%d9%84%d8%b1%d8%a8%d8%a7%d8%b7-%d8%aa%d8%ad%d8%aa%d8%b6%d9%86-%d8%a7%d8%ac%d8%aa%d9%85%d8%a7%d8%b9%d8%a7%d8%aa-%d8%ad%d8%a7%d8%b3%d9%85%d8%a9-%d9%84%d9%85%d8%b4%d8%b1%d9%88%d8%b9-%d8%a3%d9%86/', 'summary': 'الرباط تحتضن اجتماعات حاسمة لمشروع أنبوب الغاز الإفريقي. انعقدت يومي 10 و11 يوليوز الجاري بالرباط، اجتماعات رفيعة المستوى للجنة التقنية ولجنة التسيير الخاصة بمشروع أنبوب الغاز الإفريقي الأطلسي، بحضور المدراء العامين (وفرقهم التقنية والإدارية) للشركات الوطنية للبترول بالدول التي يعبرها الأنبوب، إلى جانب مفوض البنية التحتية والطاقة والرقمنة ومدير الطاقة والمعادن بالمجموعة الاقتصادية لدول غرب إفريقيا (سيدياو). وأوضح بلاغ للمكتب الوطني للهيدروكاربورات والمعادن،  الرباط تحتضن اجتماعات حاسمة لمشروع أنبوب الغاز الإفريقي     .', 'size': 2}, {'id': '191', 'title': 'اجتماعات بالرباط للجنة التقنية ولجنة تسيير مشروع أنبوب الغاز الإفريقي الأطلسي', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/224566/', 'summary': 'اجتماعات بالرباط للجنة التقنية ولجنة تسيير مشروع أنبوب الغاز الإفريقي الأطلسي. و م ع انعقدت يومي 10 و11 يوليوز الجاري بالرباط، اجتماعات رفيعة المستوى للجنة التقنية ولجنة التسيير الخاصة بمشروع أنبوب الغاز الإفريقي الأطلسي، بحضور المدراء العامين (وفرقهم التقنية والإدارية) للشركات الوطنية للبترول بالدول التي يعبرها الأنبوب، إلى جانب مفوض البنية التحتية والطاقة والرقمنة ومدير الطاقة والمعادن بالمجموعة الاقتصادية لدول غرب إفريقيا (سيدياو). وأوضح بلاغ', 'size': 2}], 'main_title': 'الرباط تحتضن اجتماعات حاسمة لمشروع أنبوب الغاز الإفريقي'}, {'community_id': '2', 'articles': [{'id': '170', 'title': 'حالة الطقس:  حار مع سحب على الساحل الأطلسي', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%ad%d8%a7%d9%84%d8%a9-%d8%a7%d9%84%d8%b7%d9%82%d8%b3-%d8%ad%d8%a7%d8%b1-%d9%85%d8%b9-%d8%b3%d8%ad%d8%a8-%d8%b9%d9%84%d9%89-%d8%a7%d9%84%d8%b3%d8%a7%d8%ad%d9%84-%d8%a7%d9%84%d8%a3%d8%b7%d9%84/', 'summary': 'حالة الطقس: حار مع سحب على الساحل الأطلسي. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليوم السبت، أن يبقى الطقس حارا نسبيا بداخل الأقاليم الجنوبية والجنوب الشرقي للبلاد. ويحتمل نزول قطرات مطرية بمنطقة طنجة، واللوكوس والشمال الغربي، مع تشكل سحب منخفضة في بداية الصباح والليل قرب السواحل المحيطية مع كتل من الضباب. كما يتوقع أن تكون السماء أحيانا غائمة بالجنوب الشرقي، مع احتمال تسجيل  حالة الطقس: حار مع سحب على الساحل الأطلسي     .', 'size': 3}, {'id': '192', 'title': 'طقس السبت.. حار نسبيا في عدة مناطق بالمملكة', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/224563/', 'summary': 'طقس السبت.. حار نسبيا في عدة مناطق بالمملكة. كواليس اليوم تتوقع المديرية العامة للأرصاد الجوية أن يبقى الطقس، اليوم السبت، حارا نسبيا بداخل الأقاليم الجنوبية والجنوب الشرقي للبلاد. ويحتمل نزول قطرات مطرية بمنطقة طنجة واللوكوس والشمال الغربي، مع تشكل سحب منخفضة في بداية الصباح والليل قرب السواحل المحيطية مع كتل من الضباب. كما يرتقب أن تكون السماء أحيانا غائمة بالجنوب الشرقي، مع', 'size': 2}, {'id': '213', 'title': 'توقعات أحوال الطقس اليوم السبت', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%aa%d9%88%d9%82%d8%b9%d8%a7%d8%aa-%d8%a3%d8%ad%d9%88%d8%a7%d9%84-%d8%a7%d9%84%d8%b7%d9%82%d8%b3-%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%b3%d8%a8%d8%aa-26/', 'summary': 'توقعات أحوال الطقس اليوم السبت. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليومه السبت، أن يبقى الطقس حارا نسبيا بداخل الأقاليم الجنوبية والجنوب الشرقي للبلاد. ويحتمل نزول قطرات مطرية بمنطقة طنجة، واللوكوس والشمال الغربي، مع تشكل سحب منخفضة في بداية الصباح والليل قرب السواحل المحيطية مع كتل من الضباب. كما يتوقع أن تكون السماء أحيانا غائمة بالجنوب الشرقي، مع …  توقعات أحوال الطقس اليوم السبت     .', 'size': 2}], 'main_title': 'حالة الطقس:  حار مع سحب على الساحل الأطلسي'}, {'community_id': '1', 'articles': [{'id': '306', 'title': 'موجة عنف ضد المهاجرين المغاربة في مورسيا بعد واقعة الاعتداء على مسن', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/409188.html', 'summary': 'موجة عنف ضد المهاجرين المغاربة في مورسيا بعد واقعة الاعتداء على مسن. في تطور لافت بمدينة توري باشيكو في إقليم مورسيا الإسباني، شهدت المدينة أمس الجمعة توترًا غير مسبوق بعد حادث اعتداء على مسن مغربي. الحادث الذي وقع', 'size': 2}, {'id': '354', 'title': 'موجة عنف تستهدف مغاربة مورسيا الإسبانية بعد حادث اعتداء على مسن', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%85%d9%88%d8%ac%d8%a9-%d8%b9%d9%86%d9%81-%d8%aa%d8%b3%d8%aa%d9%87%d8%af%d9%81-%d9%85%d8%ba%d8%a7%d8%b1%d8%a8%d8%a9-%d9%85%d9%88%d8%b1%d8%b3%d9%8a%d8%a7-%d8%a7%d9%84%d8%a5%d8%b3%d8%a8%d8%a7%d9%86/', 'summary': 'موجة عنف تستهدف مغاربة مورسيا الإسبانية بعد حادث اعتداء على مسن. شهدت مدينة توري باشيكو (إقليم مورسيا، إسبانيا) أمس الجمعة حالة توتر كبيرة بعد دعوة إلى تظاهرة تضامن مع مواطن مسّن تعرّض لاعتداء عنيف. وردّت التظاهرة بتحوّلها إلى اشتباكات وإطلاق شعارات عنصرية استهدفت مهاجرين من أصول مغربية. وطالب المتظاهرون بـ"حرّاس مدنيين إضافيين"، في أعقاب اعتداء صباح الأربعاء على رجل مسن يبلغ من العمر نحو 68 سنة،  موجة عنف تستهدف مغاربة مورسيا الإسبانية بعد حادث اعتداء على مسن     .', 'size': 2}], 'main_title': 'موجة عنف ضد المهاجرين المغاربة في مورسيا بعد واقعة الاعتداء على مسن'}, {'community_id': '0', 'articles': [{'id': '311', 'title': 'احتلوا مراتب مشرفة.. فرسان خيالة الأمن الوطني يتألقون في البطولة الوطنية للقفز على الحواجز (صور)', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a7%d8%ad%d8%aa%d9%84%d9%88%d8%a7-%d9%85%d8%b1%d8%a7%d8%aa%d8%a8-%d9%85%d8%b4%d8%b1%d9%81%d8%a9-%d9%81%d8%b1%d8%b3%d8%a7%d9%86-%d8%ae%d9%8a%d8%a7%d9%84%d8%a9-%d8%a7%d9%84%d8%a3%d9%85%d9%86-%d8%a7/', 'summary': 'احتلوا مراتب مشرفة.. فرسان خيالة الأمن الوطني يتألقون في البطولة الوطنية للقفز على الحواجز (صور). شارك فرسان خيالة الأمن الوطني، خلال الفترة الممتدة من 5 إلى 13 يوليوز الجاري، في البطولة الوطنية للقفز على الحواجز وترويض الفرس والبطولة الوطنية العسكرية للقفز على الحواجز برسم سنة 2025، والتي نظمتها الجامعة الملكية المغربية للفروسية على هامش أسبوع الفرس بدار السلام بالرباط. وأحرز فرسان خيالة الأمن الوطني على مجموعة من المراتب المتقدمة في', 'size': 2}, {'id': '313', 'title': 'بالصور.. فرسان الأمن الوطني يتألقون في أسبوع الفرس بالرباط', 'source': 'assabah.ma', 'link': 'https://assabah.ma/858916.html', 'summary': 'بالصور.. فرسان الأمن الوطني يتألقون في أسبوع الفرس بالرباط. شارك فرسان خيالة الأمن الوطني، خلال الفترة الممتدة من 5 إلى 13 يوليوز الجاري، في البطولة الوطنية للقفز على الحواجز وترويض الفرس والبطولة الوطنية العسكرية للقفز على الحواجز برسم سنة 2025، والتي نظمتها الجامعة الملكية المغربية للفروسية على هامش أسبوع الفرس بدار السلام بالرباط. وأحرز فرسان خيالةأكمل القراءة » المقالة بالصور.. فرسان الأمن الوطني يتألقون في أسبوع الفرس بالرباط  .', 'size': 2}], 'main_title': 'احتلوا مراتب مشرفة.. فرسان خيالة الأمن الوطني يتألقون في البطولة الوطنية للقفز على الحواجز (صور)'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    