<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 16/10/2025 - 18h27</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '9', 'articles': [{'id': '22', 'title': 'تارودانت.. اندلاع حريق مهول بسوق “جنان الجامع” وتسجيل خسائر مادية جسيمة', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-666504.html', 'summary': 'تارودانت.. اندلاع حريق مهول بسوق “جنان الجامع” وتسجيل خسائر مادية جسيمة. هبة بريس – تارودانت اندلع حريق ضخم في الساعات الأولى من صباح اليوم الخميس بسوق “جنان الجامع” بمدينة تارودانت، أحد أكبر وأقدم الأسواق الشعبية بالمنطقة، مما خلف خسائر مادية جسيمة وأثار حالة من الحزن والذهول في صفوف التجار والسكان المحليين. وحسب مصادر محلية، فقد بدأت ألسنة اللهب في الانتشار بسرعة هائلة نتيجة احتواء السوق على', 'size': 2}, {'id': '193', 'title': 'حريق مهول يأتي على السوق البلدي بتارودانت مخلفاً خسائر جسيمة', 'source': 'rue20.com', 'link': 'https://rue20.com/945555.html', 'summary': 'حريق مهول يأتي على السوق البلدي بتارودانت مخلفاً خسائر جسيمة.  ا متابعة عاشت مدينة تارودانت صباح اليوم على وقع فاجعة حقيقية، بعدما اندلع حريق ضخم في سوق “جنان الجامع”، أحد أهم الأسواق التجارية الحيوية بالمدينة. وأسفر الحريق عن تدمير عدد كبير من المحلات التجارية، مما أثار حالة من الذعر والخوف بين التجار وأصحاب البضائع وكذلك السكان المجاورين للسوق. وحسب المعطيات المتوفرة، فقد انتشر الخبر حريق مهول يأتي على السوق البلدي بتارودانت مخلفاً خسائر جسيمة  .', 'size': 4}, {'id': '256', 'title': 'اندلاع حريق مهول بسوق “جنان الجامع” بتارودانت (صور)', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%86%d8%af%d9%84%d8%a7%d8%b9-%d8%ad%d8%b1%d9%8a%d9%82-%d9%85%d9%87%d9%88%d9%84-%d8%a8%d8%b3%d9%88%d9%82-%d8%ac%d9%86%d8%a7%d9%86-%d8%a7%d9%84%d8%ac%d8%a7%d9%85%d8%b9-%d8%a8%d8%aa%d8%a7/', 'summary': 'اندلاع حريق مهول بسوق “جنان الجامع” بتارودانت (صور). عاش تجار وسكان مدينة تارودانت، صباح اليوم الخميس 16 أكتوبر الجاري، لحظات من الرعب والهلع بعد اندلاع حريق مهول في سوق “جنان الجامع” أشهر الأسواق التجارية بالمدينة. ووفق مصادر محلية، فقد إلتهمت النيران عددا كبيرا من المحلات التجارية، وخلفت خسائر مادية كبيرة لم يتم تحديد حجمها بعد، فيما لم يتم تسجيل أي خسائر …  اندلاع حريق مهول بسوق “جنان الجامع” بتارودانت (صور)     .', 'size': 2}, {'id': '444', 'title': 'تارودانت: حريق يأتي على اغلب محلات السوق البلدي', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/228555/', 'summary': 'تارودانت: حريق يأتي على اغلب محلات السوق البلدي. السعيد بنلباه شب صباح اليوم الخميس 16 اكتوبر 2025 حريق مهول بالسوق البلدي بتارودانت المسمى ” جنان الجامع ” وفي وقت وجيز اتى على اغلب المحلات التجارية المتخصصة في بيع الملابس والمواد الغذائية المختلفة وبعض المحلات الحرفية ، مخلفا خسائر مادية كبيرة . وحسب بعض المعلومات المتداولة فإن الحريق قد تكون اندلعت اولى شراراته من', 'size': 2}], 'main_title': 'حريق مهول يأتي على السوق البلدي بتارودانت مخلفاً خسائر جسيمة'}, {'community_id': '1', 'articles': [{'id': '102', 'title': 'محكمة الاستئناف بالدار البيضاء تؤجل قضية محمد بودريقة', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/414562.html', 'summary': 'محكمة الاستئناف بالدار البيضاء تؤجل قضية محمد بودريقة. قررت محكمة الاستئناف في الدار البيضاء تأجيل النظر في قضية محمد بودريقة، الرئيس السابق لنادي الرجاء الرياضي، إلى يوم الأربعاء 22 أكتوبر 2025. جاء ذلك بعد', 'size': 2}, {'id': '227', 'title': 'آخر مستجدات محاكمة بودريقة في قضية “الشيك”', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d9%85%d8%ad%d8%a7%d9%83%d9%85%d8%a9-%d9%85%d8%ad%d9%85%d8%af-%d8%a8%d9%88%d8%af%d8%b1%d9%8a%d9%82%d8%a9/', 'summary': 'آخر مستجدات محاكمة بودريقة في قضية “الشيك”.  – متابعات قررت محكمة الاستئناف بالدار البيضاء، اليوم الأربعاء، تأجيل النظر في قضية محمد بودريقة، الرئيس السابق لنادي الرجاء الرياضي، إلى الأربعاء 22 أكتوبر الجاري، وذلك بعد أن...  آخر مستجدات محاكمة بودريقة في قضية “الشيك”     .', 'size': 2}], 'main_title': 'محكمة الاستئناف بالدار البيضاء تؤجل قضية محمد بودريقة'}, {'community_id': '6', 'articles': [{'id': '111', 'title': 'وسيط المملكة يشيد بتوجيه أخنوش القطاعات الوزارية إلى التعاون مع مؤسسة الوسيط', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/politic/414572.html', 'summary': 'وسيط المملكة يشيد بتوجيه أخنوش القطاعات الوزارية إلى التعاون مع مؤسسة الوسيط. أشاد وسيط المملكة، حسن طارق، بالمنشور الذي وجهه رئيس الحكومة، عزيز أخنوش، إلى الوزراء من أجل تعزيز التنسيق والتعاون مع مؤسسة وسيط المملكة، مبرزا أنه', 'size': 2}, {'id': '174', 'title': 'وسيط المملكة يشيد بتوجيهات أخنوش إلى وزرائه لتعزيز التعاون مع الإدارات', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1108523.html', 'summary': 'وسيط المملكة يشيد بتوجيهات أخنوش إلى وزرائه لتعزيز التعاون مع الإدارات. أشاد وسيط المملكة، حسن طارق، اليوم الأربعاء، ظهرت المقالة وسيط المملكة يشيد بتوجيهات أخنوش إلى وزرائه لتعزيز التعاون مع الإدارات  .', 'size': 2}], 'main_title': 'وسيط المملكة يشيد بتوجيه أخنوش القطاعات الوزارية إلى التعاون مع مؤسسة الوسيط'}, {'community_id': '13', 'articles': [{'id': '122', 'title': 'المغرب والأرجنتين في النهائي..موعد مباراة الحلم في كأس العالم للشباب', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/sport/lionatlas/414586.html', 'summary': 'المغرب والأرجنتين في النهائي..موعد مباراة الحلم في كأس العالم للشباب. ضرب المنتخب المغربي لأقل من 20 سنة موعدا مع نظيره الارجنتيني في نهائي كأس العالم لهذه الفئة، المقامة حاليا في الشيلي، عقب تأهلهما في نصف', 'size': 2}, {'id': '428', 'title': 'إعلام عربي: نهائي المغرب والأرجنتين مباراة تاريخية وننتظر اللقب من الشيلي', 'source': 'machahid24.com', 'link': 'https://machahid24.com/sport/478836.html', 'summary': 'إعلام عربي: نهائي المغرب والأرجنتين مباراة تاريخية وننتظر اللقب من الشيلي. أشاد الإعلام الرياضي العربي، بإنجاز المنتخب الوطني المغربي لأقل من 20 سنة لكرة القدم، المتمثل في بلوغ نهائي كأس العالم للشباب.', 'size': 2}], 'main_title': 'المغرب والأرجنتين في النهائي..موعد مباراة الحلم في كأس العالم للشباب'}, {'community_id': '4', 'articles': [{'id': '128', 'title': 'هلال أمام الأمم المتحدة: بعد 50 عاما على استرجاعها، الصحراء المغربية أضحت واحة سلام وقطبا للاندماج الإفريقي والتنمية المشتركة', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/national/414593.html', 'summary': 'هلال أمام الأمم المتحدة: بعد 50 عاما على استرجاعها، الصحراء المغربية أضحت واحة سلام وقطبا للاندماج الإفريقي والتنمية المشتركة. أكد السفير الممثل الدائم للمغرب لدى الأمم المتحدة، عمر هلال، الأربعاء بنيويورك، أنه في غمرة استعدادات المغرب لتخليد الذكرى الخمسين للمسيرة الخضراء المظفرة، التي مكنت', 'size': 2}, {'id': '138', 'title': 'هلال أمام الأمم المتحدة: بعد 50 عاما على استرجاعها الصحراء المغربية أضحت واحة سلام', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%87%d9%84%d8%a7%d9%84-%d8%a3%d9%85%d8%a7%d9%85-%d8%a7%d9%84%d8%a3%d9%85%d9%85-%d8%a7%d9%84%d9%85%d8%aa%d8%ad%d8%af%d8%a9-%d8%a8%d8%b9%d8%af-50-%d8%b9%d8%a7%d9%85%d8%a7-%d8%b9%d9%84%d9%89-%d8%a7/', 'summary': 'هلال أمام الأمم المتحدة: بعد 50 عاما على استرجاعها الصحراء المغربية أضحت واحة سلام. أكد السفير الممثل الدائم للمغرب لدى الأمم المتحدة، عمر هلال، الأربعاء بنيويورك، أنه في غمرة استعدادات المغرب لتخليد الذكرى الخمسين للمسيرة الخضراء المظفرة، التي مكنت من استكمال الوحدة الترابية للمملكة، أضحت الصحراء المغربية واحة للسلام والاندماج الإفريقي والتنمية المشتركة. وفي مداخلة أمام اللجنة الرابعة للجمعية العامة للأمم المتحدة، أبرز هلال أن الصحراء المغربية تجسد اليوم', 'size': 2}], 'main_title': 'هلال أمام الأمم المتحدة: بعد 50 عاما على استرجاعها، الصحراء المغربية أضحت واحة سلام وقطبا للاندماج الإفريقي والتنمية المشتركة'}, {'community_id': '7', 'articles': [{'id': '182', 'title': 'نشرة إنذارية.. زخات رعدية قوية مصحوبة بهبات رياح مرتقبة اليوم الخميس', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%86%d8%b4%d8%b1%d8%a9-%d8%a5%d9%86%d8%b0%d8%a7%d8%b1%d9%8a%d8%a9-%d8%b2%d8%ae%d8%a7%d8%aa-%d8%b1%d8%b9%d8%af%d9%8a%d8%a9-%d9%82%d9%88%d9%8a%d8%a9-%d9%85%d8%b5%d8%ad%d9%88%d8%a8%d8%a9-%d8%a8%d9%87-4/', 'summary': 'نشرة إنذارية.. زخات رعدية قوية مصحوبة بهبات رياح مرتقبة اليوم الخميس. أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل زخات رعدية محليا قوية (ما بين 15 و 30 ملم) مصحوبة بهبات رياح، اليوم الخميس، بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة "برتقالي"، أن هذه الزخات الرعدية ستهم عمالات وأقاليم فكيك وبولمان والحسيمة وشفشاون وتاوريرت والخميسات والحاجب، وذلك من الساعة الواحدة بعد  نشرة إنذارية.. زخات رعدية قوية مصحوبة بهبات رياح مرتقبة اليوم الخميس     .', 'size': 3}, {'id': '239', 'title': 'زخات رعدية محليا قوية مصحوبة بهبات رياح مرتقبة غدا الخميس بعدد من مناطق المملكة', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/228525/', 'summary': 'زخات رعدية محليا قوية مصحوبة بهبات رياح مرتقبة غدا الخميس بعدد من مناطق المملكة. أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل زخات رعدية محليا قوية (ما بين 15 و25 ملم) مصحوبة بهبات رياح، غدا الخميس، بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة “برتقالي”، أن هذه الزخات الرعدية ستهم إقليمي فكيك وبولمان، وذلك من الساعة الواحدة بعد الزوال إلى الحادية عشرة ليلا.', 'size': 3}, {'id': '250', 'title': 'زخات رعدية محليا قوية مصحوبة بهبات رياح مرتقبة اليوم الخميس بعدد من مناطق المملكة', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%b2%d8%ae%d8%a7%d8%aa-%d8%b1%d8%b9%d8%af%d9%8a%d8%a9-%d9%85%d8%ad%d9%84%d9%8a%d8%a7-%d9%82%d9%88%d9%8a%d8%a9-%d9%85%d8%b5%d8%ad%d9%88%d8%a8%d8%a9-%d8%a8%d9%87%d8%a8%d8%a7%d8%aa-%d8%b1%d9%8a%d8%a7-2/', 'summary': 'زخات رعدية محليا قوية مصحوبة بهبات رياح مرتقبة اليوم الخميس بعدد من مناطق المملكة. أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل زخات رعدية محليا قوية (ما بين 15 و 30 ملم) مصحوبة بهبات رياح، اليوم الخميس، بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة “برتقالي”، أن هذه الزخات الرعدية ستهم عمالات وأقاليم فكيك وبولمان والحسيمة وشفشاون وتاوريرت والخميسات والحاجب، وذلك من الساعة …  زخات رعدية محليا قوية مصحوبة بهبات رياح مرتقبة اليوم الخميس بعدد من مناطق المملكة     .', 'size': 3}], 'main_title': 'نشرة إنذارية.. زخات رعدية قوية مصحوبة بهبات رياح مرتقبة اليوم الخميس'}, {'community_id': '12', 'articles': [{'id': '188', 'title': 'عشية زيارة بوريطة.. موسكو تعتبر المغرب "شريكا مهما" لروسيا', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%b9%d8%b4%d9%8a%d8%a9-%d8%b2%d9%8a%d8%a7%d8%b1%d8%a9-%d8%a8%d9%88%d8%b1%d9%8a%d8%b7%d8%a9-%d9%85%d9%88%d8%b3%d9%83%d9%88-%d8%aa%d8%b9%d8%aa%d8%a8%d8%b1-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8/', 'summary': 'عشية زيارة بوريطة.. موسكو تعتبر المغرب "شريكا مهما" لروسيا. أكدت وزارة الشؤون الخارجية الروسية، اليوم الأربعاء، أن روسيا الاتحادية تعتبر المغرب "شريكا مهما" في القارة الإفريقية. وأوضحت الوزارة، في بلاغ صدر عشية زيارة وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج، ناصر بوريطة، أن وزير الخارجية الروسي، سيرغي لافروف، سيجري، اليوم الخميس بموسكو، محادثات مع بوريطة، من المقرر أن يتم خلالها البحث بشكل معمق  عشية زيارة بوريطة.. موسكو تعتبر المغرب "شريكا مهما" لروسيا     .', 'size': 2}, {'id': '417', 'title': 'الرباط وموسكو تعمّقان العلاقات بإحداث لجنة عمل جديدة لتوسيع التعاون', 'source': 'rue20.com', 'link': 'https://rue20.com/945701.html', 'summary': 'الرباط وموسكو تعمّقان العلاقات بإحداث لجنة عمل جديدة لتوسيع التعاون.  ا الرباط وقّع المغرب و روسيا ، الخميس، مذكرة تفاهم لإحداث لجنة عمل بين وزارتي خارجية البلدين، تهدف إلى تعميق الشراكة الاستراتيجية بين البلدين. جاء ذلك خلال مباحثات بين وزير الخارجية ناصر بوريطة ، ونظيره الروسي سيرغي لافروف، في العاصمة موسكو. هذه اللجنة ستتولى مراجعة حصيلة الشراكة بين البلدين، وصياغة مقترحات لتحديد محاور الخبر الرباط وموسكو تعمّقان العلاقات بإحداث لجنة عمل جديدة لتوسيع التعاون  .', 'size': 2}], 'main_title': 'عشية زيارة بوريطة.. موسكو تعتبر المغرب "شريكا مهما" لروسيا'}, {'community_id': '10', 'articles': [{'id': '201', 'title': 'اليوم الخميس.. زخات رعدية محليا قوية مصحوبة بهبات رياح', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/478844.html', 'summary': 'اليوم الخميس.. زخات رعدية محليا قوية مصحوبة بهبات رياح. أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل زخات رعدية محليا قوية (ما بين 15 و 30 ملم) مصحوبة بهبات رياح، اليوم الخميس، بعدد من مناطق المملكة.', 'size': 3}, {'id': '342', 'title': 'نشرة إنذارية: زخات رعدية قوية مصحوبة بهبات رياح مرتقبة اليوم الخميس بعدد من مناطق المملكة', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/national/414601.html', 'summary': 'نشرة إنذارية: زخات رعدية قوية مصحوبة بهبات رياح مرتقبة اليوم الخميس بعدد من مناطق المملكة. أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل زخات رعدية محليا قوية (ما بين 15 و 30 ملم) مصحوبة بهبات رياح، اليوم الخميس، بعدد من', 'size': 3}, {'id': '439', 'title': 'زخات رعدية بعدد من مناطق المملكة (نشرة إنذارية)', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%b2%d8%ae%d8%a7%d8%aa-%d8%b1%d8%b9%d8%af%d9%8a%d8%a9-%d8%a8%d8%b9%d8%af%d8%af-%d9%85%d9%86-%d9%85%d9%86%d8%a7%d8%b7%d9%82-%d8%a7%d9%84%d9%85%d9%85%d9%84%d9%83%d8%a9-%d9%86%d8%b4%d8%b1%d8%a9-%d8%a5/', 'summary': 'زخات رعدية بعدد من مناطق المملكة (نشرة إنذارية).  – متابعة زخات رعدية بعدد من مناطق المملكة (نشرة إنذارية) أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل زخات رعدية محليا قوية (ما بين 15 و 30 ملم)...  زخات رعدية بعدد من مناطق المملكة (نشرة إنذارية)     .', 'size': 3}], 'main_title': 'اليوم الخميس.. زخات رعدية محليا قوية مصحوبة بهبات رياح'}, {'community_id': '3', 'articles': [{'id': '296', 'title': 'بورصة البيضاء ترتفع بنسبة 1,31 بالمائة', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d8%a8%d9%88%d8%b1%d8%b5%d8%a9-%d8%a7%d9%84%d8%a8%d9%8a%d8%b6%d8%a7%d8%a1-%d8%aa%d8%b1%d8%aa%d9%81%d8%b9-%d8%a8%d9%86%d8%b3%d8%a8%d8%a9-131-%d8%a8%d8%a7%d9%84%d9%85%d8%a7%d8%a6%d8%a9-1640972.html', 'summary': 'بورصة البيضاء ترتفع بنسبة 1,31 بالمائة. أنهت بورصة الدار البيضاء تداولاتها، اليوم الخميس، على وقع الارتفاع، حيث سجل مؤشرها الرئيسي “مازي” تقدما بنسبة 1,31 في المائة، ليستقر بذلك عند 18.438,26 نقطة. من جانبه، سجل مؤشر “MASI.20″، الذي يعكس أداء 20 مقاولة مدرجة بالبورصة، ارتفاعا بنسبة 1,69 في المائة إلى 1.493,47 نقطة، فيما سجل MASI.ESG، مؤشر الشركات الحاصلة على أفضل تصنيف ESG،  بورصة البيضاء ترتفع بنسبة 1,31 بالمائة     - هسبريس جريدة إلكترونية مغربية .', 'size': 2}, {'id': '305', 'title': 'بورصة الدار البيضاء تنهي تداولاتها على وقع الارتفاع', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-666641.html', 'summary': 'بورصة الدار البيضاء تنهي تداولاتها على وقع الارتفاع. هبة بريس أنهت بورصة الدار البيضاء تداولاتها، اليوم الخميس، على وقع الارتفاع، حيث سجل مؤشرها الرئيسي “مازي” تقدما بنسبة 1,31 في المائة، ليستقر بذلك عند 18.438,26 نقطة. من جانبه، سجل مؤشر “MASI.20″، الذي يعكس أداء 20 مقاولة مدرجة بالبورصة، ارتفاعا بنسبة 1,69 في المائة إلى 1.493,47 نقطة، فيما سجل MASI.ESG، مؤشر الشركات الحاصلة على أفضل', 'size': 2}], 'main_title': 'بورصة البيضاء ترتفع بنسبة 1,31 بالمائة'}, {'community_id': '11', 'articles': [{'id': '299', 'title': 'عبد النباوي يحدد ركائز العدالة الحديثة', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d8%b9%d8%a8%d8%af-%d8%a7%d9%84%d9%86%d8%a8%d8%a7%d9%88%d9%8a-%d9%8a%d8%ad%d8%af%d8%af-%d8%b1%d9%83%d8%a7%d8%a6%d8%b2-%d8%a7%d9%84%d8%b9%d8%af%d8%a7%d9%84%d8%a9-%d8%a7%d9%84%d8%ad%d8%af%d9%8a%d8%ab-1640929.html', 'summary': 'عبد النباوي يحدد ركائز العدالة الحديثة. أكد الرئيس الأول لمحكمة النقض، الرئيس المنتدب للمجلس الأعلى للسلطة القضائية، محمد عبد النباوي، اليوم الخميس بمراكش، أن الاستقلال والأخلاقيات والتواصل تشكل الركائز الثلاث لأي عدالة حديثة وشرعية وإنسانية. وقال عبد النباوي، خلال الجلسة الافتتاحية لمؤتمر الشبكة الفرانكفونية للمجالس العليا للقضاء، إن “تلاحم هذه الركائز الثلاث هو ما يجعل العدالة مؤسسة محل احترام وتقدير”، وأضاف  عبد النباوي يحدد ركائز العدالة الحديثة     - هسبريس جريدة إلكترونية مغربية .', 'size': 2}, {'id': '407', 'title': 'عبد النباوي: الاستقلال يفقد معناه إن لم يكن مؤطرا بالأخلاقيات', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%b9%d8%a8%d8%af-%d8%a7%d9%84%d9%86%d8%a8%d8%a7%d9%88%d9%8a-%d8%a7%d9%84%d8%a7%d8%b3%d8%aa%d9%82%d9%84%d8%a7%d9%84-%d9%8a%d9%81%d9%82%d8%af-%d9%85%d8%b9%d9%86%d8%a7%d9%87-%d8%a5%d9%86-%d9%84%d9%85/', 'summary': 'عبد النباوي: الاستقلال يفقد معناه إن لم يكن مؤطرا بالأخلاقيات. أكد الرئيس الأول لمحكمة النقض، الرئيس المنتدب للمجلس الأعلى للسلطة القضائية، محمد عبد النباوي، اليوم الخميس بمراكش، أن الاستقلال والأخلاقيات والتواصل تشكل الركائز الثلاث لأساس أي عدالة حديثة وشرعية وإنسانية. وقال عبد النباوي، خلال الجلسة الافتتاحية لمؤتمر الشبكة الفرنكفونية للمجالس العليا للقضاء، إن "تلاحم هذه الركائز الثلاث هو ما يجعل العدالة مؤسسة محل احترام وتقدير".  عبد النباوي: الاستقلال يفقد معناه إن لم يكن مؤطرا بالأخلاقيات     .', 'size': 2}], 'main_title': 'عبد النباوي يحدد ركائز العدالة الحديثة'}, {'community_id': '0', 'articles': [{'id': '301', 'title': 'الكاف: "أشبال المغرب" يكتبون التاريخ', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d8%a7%d9%84%d9%83%d8%a7%d9%81-%d8%a3%d8%b4%d8%a8%d8%a7%d9%84-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d8%aa%d8%b5%d9%86%d8%b9-%d8%a7%d9%84%d8%aa%d8%a7%d8%b1%d9%8a%d8%ae-1640940.html', 'summary': 'الكاف: "أشبال المغرب" يكتبون التاريخ. وصف الاتحاد الإفريقي لكرة القدم (الكاف)، اليوم الخميس، بـ”الانتصار الرمزي والتاريخي” تأهل المنتخب الوطني على حساب نظيره الفرنسي إلى نهائي كأس العالم لأقل من 20 سنة، المقامة حاليا في الشيلي. وكتب “الكاف”، على موقعه الرسمي، أنه “بعد 120 دقيقة من صراع قوي ومفتوح على جميع الاحتمالات ضمن المنتخب المغربي تأهله إلى النهائي بفضل ركلات الترجيح  الكاف: "أشبال المغرب" يكتبون التاريخ     - هسبريس جريدة إلكترونية مغربية .', 'size': 2}, {'id': '418', 'title': 'كاف يبارك التأهل التاريخي للمغرب إلى نهائي مونديال الشباب على حساب فرنسا', 'source': 'rue20.com', 'link': 'https://rue20.com/945733.html', 'summary': 'كاف يبارك التأهل التاريخي للمغرب إلى نهائي مونديال الشباب على حساب فرنسا.  ا الرباط وصف الاتحاد الإفريقي لكرة القدم (الكاف)، اليوم الخميس، بـ”الانتصار الرمزي والتاريخي” تأهل المنتخب الوطني على حساب نظيره الفرنسي إلى نهائي كأس العالم لأقل من 20 سنة، المقامة حاليا في الشيلي. وكتب (الكاف)، على موقعه الرسمي، أنه “بعد 120 دقيقة من صراع قوي ومفتوح على جميع الاحتمالات، ضمن المنتخب المغربي تأهله إلى الخبر كاف يبارك التأهل التاريخي للمغرب إلى نهائي مونديال الشباب على حساب فرنسا  .', 'size': 2}, {'id': '452', 'title': 'الكاف: تأهل المغرب إلى نهائي المونديال انتصار رمزي وتاريخي', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d9%83%d8%a7%d9%81-%d8%aa%d8%a3%d9%87%d9%84-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d8%a5%d9%84%d9%89-%d9%86%d9%87%d8%a7%d8%a6%d9%8a-%d8%a7%d9%84%d9%85%d9%88%d9%86%d8%af%d9%8a%d8%a7%d9%84/', 'summary': 'الكاف: تأهل المغرب إلى نهائي المونديال انتصار رمزي وتاريخي. وصف الاتحاد الإفريقي لكرة القدم (الكاف)، اليوم الخميس 16 أكتوبر 2025، تأهل المنتخب الوطني على حساب نظيره الفرنسي إلى نهائي كأس العالم لأقل من 20 سنة، المقامة حاليا في الشيلي، بـ”الانتصار الرمزي والتاريخي”. وكتب (الكاف)، على موقعه الرسمي، أنه “بعد 120 دقيقة من صراع قوي ومفتوح على جميع الاحتمالات، ضمن المنتخب المغربي تأهله …  الكاف: تأهل المغرب إلى نهائي المونديال انتصار رمزي وتاريخي     .', 'size': 3}], 'main_title': 'الكاف: تأهل المغرب إلى نهائي المونديال انتصار رمزي وتاريخي'}, {'community_id': '8', 'articles': [{'id': '325', 'title': 'موسكو.. بوريطة يتباحث مع نظيره الروسي تطوير العلاقات الثنائية – صور', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-666570.html', 'summary': 'موسكو.. بوريطة يتباحث مع نظيره الروسي تطوير العلاقات الثنائية – صور. هبة بريس أجرى وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج ناصر بوريطة، اليوم الخميس بموسكو، مباحثات مع نظيره الروسي سيرغي لافروف. ويندرج هذا اللقاء في إطار الشراكة الاستراتيجية المعمقة التي وقعها صاحب الجلالة الملك محمد السادس نصره الله، والرئيس فلاديمير بوتين في مارس 2016. وأشاد الوزيران بالزخم القوي الذي أضفاه عليها قائدا البلدين، حيث', 'size': 2}, {'id': '347', 'title': 'في افتتاح لقائه مع لافروف: الملك محمد السادس يولي تقديرًا واحترامًا خاصًا للرئيس بوتين', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/politic/414609.html', 'summary': 'في افتتاح لقائه مع لافروف: الملك محمد السادس يولي تقديرًا واحترامًا خاصًا للرئيس بوتين. في لقاء رفيع المستوى بموسكو، أجرى ناصر بوريطة، وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج، اليوم الخميس، محادثات معمقة مع نظيره الروسي، سيرغي لافروف،', 'size': 4}, {'id': '370', 'title': 'موسكو.. بوريطة يتباحث مع نظيره الروسي سيرغي لافروف', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%85%d9%88%d8%b3%d9%83%d9%88-%d8%a8%d9%88%d8%b1%d9%8a%d8%b7%d8%a9-%d9%8a%d8%aa%d8%a8%d8%a7%d8%ad%d8%ab-%d9%85%d8%b9-%d9%86%d8%b8%d9%8a%d8%b1%d9%87-%d8%a7%d9%84%d8%b1%d9%88%d8%b3%d9%8a-%d8%b3%d9%8a/', 'summary': 'موسكو.. بوريطة يتباحث مع نظيره الروسي سيرغي لافروف. أجرى وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج ناصر بوريطة، اليوم الخميس بموسكو، مباحثات مع نظيره الروسي سيرغي لافروف. ويندرج هذا اللقاء في إطار الشراكة الاستراتيجية المعمقة التي وقعها صاحب الجلالة الملك محمد السادس، والرئيس فلاديمير بوتين في مارس 2016. وأشاد الوزيران بالزخم القوي الذي أضفاه عليها قائدا البلدين، حيث تواصل رؤيتهما تقوية وتوجيه', 'size': 5}, {'id': '398', 'title': 'لجنة عمل جديدة بين المغرب وروسيا لتعميق الشراكة الاستراتيجية', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1108661.html', 'summary': 'لجنة عمل جديدة بين المغرب وروسيا لتعميق الشراكة الاستراتيجية. أجرى وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج ناصر بوريطة، اليوم الخميس بموسكو، مباحثات مع نظيره الروسي سيرغي لافروف. ويندرج هذا اللقاء في إطار الشراكة الاستراتيجية المعمقة التي وقعها الملك محمد السادس والرئيس فلاديمير بوتين في مارس 2016. وأشاد الوزيران بالزخم القوي الذي أضفاه عليها قائدا البلدين، حيث تواصل رؤيتهما تقوية وتوجيه هذه الشراكة ظهرت المقالة لجنة عمل جديدة بين المغرب وروسيا لتعميق الشراكة الاستراتيجية  .', 'size': 4}, {'id': '409', 'title': 'بوريطة يتباحث بموسكو مع نظيره الروسي سيرغي لافروف', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a8%d9%88%d8%b1%d9%8a%d8%b7%d8%a9-%d9%8a%d8%aa%d8%a8%d8%a7%d8%ad%d8%ab-%d8%a8%d9%85%d9%88%d8%b3%d9%83%d9%88-%d9%85%d8%b9-%d9%86%d8%b8%d9%8a%d8%b1%d9%87-%d8%a7%d9%84%d8%b1%d9%88%d8%b3%d9%8a-%d8%b3/', 'summary': 'بوريطة يتباحث بموسكو مع نظيره الروسي سيرغي لافروف. أجرى وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج ناصر بوريطة، اليوم الخميس بموسكو، مباحثات مع نظيره الروسي سيرغي لافروف. ويندرج هذا اللقاء في إطار الشراكة الاستراتيجية المعمقة التي وقعها الملك محمد السادس، والرئيس فلاديمير بوتين في مارس 2016. وأشاد الوزيران بالزخم القوي الذي أضفاه عليها قائدا البلدين، حيث تواصل رؤيتهما تقوية وتوجيه هذه الشراكة  بوريطة يتباحث بموسكو مع نظيره الروسي سيرغي لافروف     .', 'size': 4}], 'main_title': 'موسكو.. بوريطة يتباحث مع نظيره الروسي سيرغي لافروف'}, {'community_id': '5', 'articles': [{'id': '369', 'title': 'المدير العام لشركة سافران: المغرب بقيادة جلالة الملك يمتلك كفاءات ودينامية صناعية حقيقية', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a7%d9%84%d9%85%d8%af%d9%8a%d8%b1-%d8%a7%d9%84%d8%b9%d8%a7%d9%85-%d9%84%d8%b4%d8%b1%d9%83%d8%a9-%d8%b3%d8%a7%d9%81%d8%b1%d8%a7%d9%86-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d8%a8%d9%82%d9%8a%d8%a7/', 'summary': 'المدير العام لشركة سافران: المغرب بقيادة جلالة الملك يمتلك كفاءات ودينامية صناعية حقيقية. أكد المدير العام وعضو مجلس إدارة مجموعة “سافران”، أوليفييه أندرييس، اليوم الخميس (16 أكتوبر)، أن المغرب، تحت قيادة صاحب الجلالة الملك محمد السادس، ي عد خيارا واضحا للاستثمار في قطاع الطيران، لما يوفره من كفاءات، ودينامية صناعية حقيقية، وبنيات تحتية حديثة للغاية. وقال أندرييس، الذي حل ضيفا على برنامج “Good Morning Buine” بقناة BFM Buine', 'size': 2}, {'id': '372', 'title': 'المدير العام لمجموعة سافران على قناة BFM-TV: بقيادة جلالة الملك المغرب يمتلك كفاءات دينامية صناعية حقيقية وبنيات تحتية حديثة', 'source': 'assabah.ma', 'link': 'https://assabah.ma/877289.html', 'summary': 'المدير العام لمجموعة سافران على قناة BFM-TV: بقيادة جلالة الملك المغرب يمتلك كفاءات دينامية صناعية حقيقية وبنيات تحتية حديثة. أكد المدير العام وعضو مجلس إدارة مجموعة “سافران”، أوليفييه أندرييس، اليوم الخميس، أن المغرب، تحت قيادة صاحب الجلالة الملك محمد السادس، يعد خيارا واضحا للاستثمار في قطاع الطيران، لما يوفره من كفاءات، ودينامية صناعية حقيقية، وبنيات تحتية حديثة للغاية. وقال أندرييس، الذي حل ضيفا على برنامج “Goodأكمل القراءة » المقالة المدير العام لمجموعة سافران على قناة BFM-TV: بقيادة جلالة الملك المغرب يمتلك كفاءات دينامية صناعية حقيقية وبنيات تحتية حديثة  .', 'size': 2}], 'main_title': 'المدير العام لشركة سافران: المغرب بقيادة جلالة الملك يمتلك كفاءات ودينامية صناعية حقيقية'}, {'community_id': '2', 'articles': [{'id': '381', 'title': 'الصندوق الوطني للضمان الاجتماعي يعلن بدء تطبيق قرار جديد حول وعاء الاشتراكات', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1108741.html', 'summary': 'الصندوق الوطني للضمان الاجتماعي يعلن بدء تطبيق قرار جديد حول وعاء الاشتراكات. أعلن الصندوق الوطني للضمان الاجتماعي عن دخوله حيز تطبيق القرار رقم 1314.25 المتعلق بوعاء الاشتراكات الاجتماعية ابتداء من فاتح أكتوبر 2025. وأوضح الصندوق في بلاغ صحفي أن هذا القرار الجديد يهدف بشكل أساسي إلى توضيح عناصر الأجر والتعويضات التي لا يتم إدراجها ضمن وعاء الاشتراك مع العمل على تحديد سقوف وشروط إعفائها. وأشار المصدر ذاته ظهرت المقالة الصندوق الوطني للضمان الاجتماعي يعلن بدء تطبيق قرار جديد حول وعاء الاشتراكات  .', 'size': 2}, {'id': '467', 'title': '“CNSS” يشرع في تطبيق القرار الجديد حول وعاء الاشتراكات الاجتماعية', 'source': 'www.alousboue.ma', 'link': 'https://www.alousboue.ma/125243/', 'summary': '“CNSS” يشرع في تطبيق القرار الجديد حول وعاء الاشتراكات الاجتماعية. يعلن الصندوق الوطني للضمان الاجتماعي عن الشروع في تطبيق القرار رقم 1314.25 المتعلق بوعاء الاشتراكات الاجتماعية، انطلاقا من فاتح أكتوبر 2025. ويهدف هذا القرار إلى توضيح عناصر الأجر والتعويضات التي لا تدرج ضمن وعاء الاشتراك، مع تحديد سقوف وشروط إعفائها، كما يسعى إلى إزالة أي غموض يشوب بعض النصوص التنظيمية الحالية، وتوحيد ممارسات …  “CNSS” يشرع في تطبيق القرار الجديد حول وعاء الاشتراكات الاجتماعية     .', 'size': 2}], 'main_title': 'الصندوق الوطني للضمان الاجتماعي يعلن بدء تطبيق قرار جديد حول وعاء الاشتراكات'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    