<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 08/07/2025 - 06h25</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '4', 'articles': [{'id': '155', 'title': 'أخنوش: قطعنا مع “الترقيع” و”الصحاري الطبية” بثورة صحية تلبي طموح المغاربة', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1083693.html', 'summary': 'أخنوش: قطعنا مع “الترقيع” و”الصحاري الطبية” بثورة صحية تلبي طموح المغاربة. أكد رئيس الحكومة، عزيز أخنوش، أن قطاع الصحة في المغرب يشهد “ثورة حقيقية” تضع حدا للحلول الترقيعية وتبشر بمنظومة صحية عصرية ومتكاملة، قادرة على تلبية تطلعات المغاربة وضمان العدالة المجالية. وشدد أخنوش اليوم الاثنين 7 يوليوز 2025، خلال الجلسة الشهرية المخصصة للأسئلة الموجهة لرئيس الحكومة بمجلس النواب، على أن الاهتمام العميق بقطاع الصحة يمثل واجهة ظهرت المقالة أخنوش: قطعنا مع “الترقيع” و”الصحاري الطبية” بثورة صحية تلبي طموح المغاربة  .', 'size': 5}, {'id': '194', 'title': 'ملفات مهمة على طاولة مجلس الحكومة الخميس المقبل', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/468779.html', 'summary': 'ملفات مهمة على طاولة مجلس الحكومة الخميس المقبل. ينعقد، يوم الخميس المقبل، مجلس للحكومة برئاسة عزيز أخنوش، رئيس الحكومة. وذكر بلاغ لرئاسة الحكومة أن المجلس سيتدارس في بدايته ثلاثة مشاريع قوانين، يتعلق الأول منها بتغيير القانون المتعلق بالحالة المدنية، والثاني بحماية الحيوانات الضالة والوقاية من أخطارها، والثالث بإحداث “مؤسسة المغرب 2030”. وأضاف أن المجلس سيواصل أشغاله بدراسة مشروع مرسوم يتعلق بتحديد تأليف اللجنة …', 'size': 4}, {'id': '223', 'title': 'القانون المتعلق بالحالة المدنية على طاولة المجلس الحكومي', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/224250/', 'summary': 'القانون المتعلق بالحالة المدنية على طاولة المجلس الحكومي. كواليس اليوم ينعقد، يوم الخميس المقبل، مجلس للحكومة برئاسة عزيز أخنوش، رئيس الحكومة. وأفادت رئاسة الحكومة، في بلاغ لها، أن المجلس سيتدارس في بدايته ثلاثة مشاريع قوانين، يتعلق الأول منها بتغيير القانون المتعلق بالحالة المدنية، والثاني بحماية الحيوانات الضالة والوقاية من أخطارها، والثالث بإحداث “مؤسسة المغرب 2030”. وأضاف أن المجلس سيواصل أشغاله بدراسة مشروع', 'size': 5}, {'id': '367', 'title': 'المغرب ورهان تعزيز الصحة.. 90 ألف مهني في أفق 2026', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/317666/', 'summary': 'المغرب ورهان تعزيز الصحة.. 90 ألف مهني في أفق 2026. قال رئيس الحكومة، عزيز أخنوش، اليوم الاثنين، بمجلس النواب، إن الحكومة تستهدف الرفع بصفة تدريجية من أعداد مهنيي قطاع الصحة إلى أكثر من 90 ألف في أفق سنة 2026. وأوضح أخنوش في عرض خلال جلسة الأسئلة الشفوية الشهرية حول السياسة العامة التي خصصت لموضوع ” المنظومة الصحية الوطنية بين المنجزات الراهنة والتطلعات المستقبلية “، أن', 'size': 3}, {'id': '454', 'title': 'انعقاد مجلس الحكومة يوم الخميس المقبل.. وهذا جدول أعماله', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%86%d8%b9%d9%82%d8%a7%d8%af-%d9%85%d8%ac%d9%84%d8%b3-%d8%a7%d9%84%d8%ad%d9%83%d9%88%d9%85%d8%a9-%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%ae%d9%85%d9%8a%d8%b3-%d8%a7%d9%84%d9%85%d9%82%d8%a8%d9%84-20/', 'summary': 'انعقاد مجلس الحكومة يوم الخميس المقبل.. وهذا جدول أعماله. ينعقد، يوم الخميس المقبل، مجلس للحكومة برئاسة عزيز أخنوش، رئيس الحكومة. وأفاد بلاغ لرئاسة الحكومة أن المجلس سيتدارس في بدايته ثلاثة مشاريع قوانين، يتعلق الأول منها بتغيير القانون المتعلق بالحالة المدنية، والثاني بحماية الحيوانات الضالة والوقاية من أخطارها، والثالث بإحداث “مؤسسة المغرب 2030”. وأردف أن المجلس سيواصل أشغاله بدراسة مشروع مرسوم يتعلق بتحديد …  انعقاد مجلس الحكومة يوم الخميس المقبل.. وهذا جدول أعماله     .', 'size': 4}], 'main_title': 'أخنوش: قطعنا مع “الترقيع” و”الصحاري الطبية” بثورة صحية تلبي طموح المغاربة'}, {'community_id': '1', 'articles': [{'id': '163', 'title': 'المغرب يعزز حماية تراثه الثقافي بتوقيع اتفاقية مع المنظمة العالمية للملكية الفكرية', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1083695.html', 'summary': 'المغرب يعزز حماية تراثه الثقافي بتوقيع اتفاقية مع المنظمة العالمية للملكية الفكرية. وقع صباح اليوم الإثنين 7 يوليوز 2025 بجنيف، وزير الشباب والثقافة والتواصل محمد المهدي بنسعيد، مذكرة تفاهم مع المدير العام للمنظمة العالمية للملكية الفكرية OMPI، من أجل تعزيز التعاون المشترك في مجال الملكية الفكرية، لاسيما فيما يتعلق بحقوق المؤلف والحقوق المجاورة والحماية القانونية للتراث الثقافي المغربي. وتهم هذه الاتفاقية أيضا، بحسب بلاغ لوزارة الشباب والثقافة ظهرت المقالة المغرب يعزز حماية تراثه الثقافي بتوقيع اتفاقية مع المنظمة العالمية للملكية الفكرية  .', 'size': 3}, {'id': '196', 'title': 'بجنيف.. المغرب يوقع مذكرة تفاهم تضمن الحماية القانونية لتراثه الثقافي', 'source': 'machahid24.com', 'link': 'https://machahid24.com/panorama/468776.html', 'summary': 'بجنيف.. المغرب يوقع مذكرة تفاهم تضمن الحماية القانونية لتراثه الثقافي. وقع صباح اليوم الاثنين بجنيف، محمد المهدي بنسعيد وزير الشباب والثقافة والتواصل، مذكرة تفاهم مع المدير العام للمنظمة العالمية للملكية الفكرية OMPI.', 'size': 2}, {'id': '245', 'title': 'بنسعيد يوقع مذكرة تفاهم مع مدير المنظمة العالمية للملكية الفكرية للحماية القانونية للتراث الثقافي المغربي', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a8%d9%86%d8%b3%d8%b9%d9%8a%d8%af-%d9%8a%d9%88%d9%82%d8%b9-%d9%85%d8%b0%d9%83%d8%b1%d8%a9-%d8%aa%d9%81%d8%a7%d9%87%d9%85-%d9%85%d8%b9-%d9%85%d8%af%d9%8a%d8%b1-%d8%a7%d9%84%d9%85%d9%86%d8%b8%d9%85/', 'summary': 'بنسعيد يوقع مذكرة تفاهم مع مدير المنظمة العالمية للملكية الفكرية للحماية القانونية للتراث الثقافي المغربي. وقع صباح اليوم الإثنين بجنيف، محمد المهدي بنسعيد وزير الشباب والثقافة والتواصل، مذكرة تفاهم مع المدير العام للمنظمة العالمية للملكية الفكرية “OMPI”. وحسب بلاغ وزارة الشباب والثقافة والتواصل، فإن هذه الاتفاقية تروم لتعزيز التعاون المشترك في مجال الملكية الفكرية، لاسيما فيما يتعلق بحقوق المؤلف والحقوق المجاورة والحماية القانونية للتراث الثقافي المغربي. وأوضح المصدر، …  بنسعيد يوقع مذكرة تفاهم مع مدير المنظمة العالمية للملكية الفكرية للحماية القانونية للتراث الثقافي المغربي     .', 'size': 2}], 'main_title': 'المغرب يعزز حماية تراثه الثقافي بتوقيع اتفاقية مع المنظمة العالمية للملكية الفكرية'}, {'community_id': '2', 'articles': [{'id': '166', 'title': 'الأحزاب المغربية بين منطق البقاء ومنطق التغيير: عام الحقيقة الانتخابية', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1083682.html', 'summary': 'الأحزاب المغربية بين منطق البقاء ومنطق التغيير: عام الحقيقة الانتخابية. في المغرب، لا تقاس السياسة بعدد الوعود المعلنة أو الشعارات المرفوعة، بل بما يشعر به المواطن العادي في تفاصيل حياته اليومية. ورغم تعدد الأحزاب وتنوع خطاباتها، يبدو المشهد وكأنه يعيد نفسه بلا تغيير حقيقي. هناك حالة من الدوران في حلقة مفرغة، حيث تتبدل الوجوه وتبقى الأساليب، ويعاد إنتاج نفس الخطاب بعبارات مختلفة. في هذا السياق، ظهرت المقالة الأحزاب المغربية بين منطق البقاء ومنطق التغيير: عام الحقيقة الانتخابية  .', 'size': 2}, {'id': '368', 'title': 'المعارضة تتهم الحكومة بتجاهل الإصلاحات الصحية.. والأغلبية ترد: السيادة خط أحمر', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/317658/', 'summary': 'المعارضة تتهم الحكومة بتجاهل الإصلاحات الصحية.. والأغلبية ترد: السيادة خط أحمر. شهدت جلسة الأسئلة الشفوية بمجلس النواب، التي عقدت زوال الإثنين 7 يوليوز 2025، جدلاً حادًا بين الأغلبية والمعارضة حول المنظومة الصحية في المغرب والإصلاحات المرتبطة بها. في هذه الجلسة، أثيرت العديد من القضايا المتعلقة بالاختلالات البنيوية التي يعاني منها القطاع الصحي، والتي تعد بمثابة تهديد حقيقي لترسيخ مبادئ الكرامة والعدالة الاجتماعية التي يكفلها الدستور. الأغلبية', 'size': 2}], 'main_title': 'الأحزاب المغربية بين منطق البقاء ومنطق التغيير: عام الحقيقة الانتخابية'}, {'community_id': '3', 'articles': [{'id': '190', 'title': 'مطار محمد الخامس: انطلاق أشغال إنجاز المحطة الجوية الجديدة', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/468790.html', 'summary': 'مطار محمد الخامس: انطلاق أشغال إنجاز المحطة الجوية الجديدة. أعلن المكتب الوطني للمطارات عن الإطلاق الرسمي لأشغال التهيئة الأرضية لمشروع المحطة الجوية الجديدة بمطار محمد الخامس الدولي بالدار البيضاء، وهي أولى مراحل الإنجاز الميداني لأحد أكثر مشاريع البنية التحتية طموحا بالمغرب في أفق 2030. وأوضح المكتب، في بلاغ له، أن الاستثمار الإجمالي لهذا المشروع يقدر ب 15 مليار درهم، ما سيمكن المحطة الجديدة من …', 'size': 2}, {'id': '345', 'title': 'استراتيجية “مطارات 2030”.. انطلاق أشغال المحطة الجوية الجديدة في مطار محمد الخامس', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a7%d8%b3%d8%aa%d8%b1%d8%a7%d8%aa%d9%8a%d8%ac%d9%8a%d8%a9-%d9%85%d8%b7%d8%a7%d8%b1%d8%a7%d8%aa-2030-%d8%a7%d9%86%d8%b7%d9%84%d8%a7%d9%82-%d8%a3%d8%b4%d8%ba%d8%a7%d9%84-%d8%a7%d9%84%d9%85/', 'summary': 'استراتيجية “مطارات 2030”.. انطلاق أشغال المحطة الجوية الجديدة في مطار محمد الخامس. أعلن المكتب الوطني للمطارات عن الإطلاق الرسمي لأشغال التهيئة الأرضية لمشروع المحطة الجوية الجديدة بمطار محمد الخامس الدولي بالدار البيضاء، وهي أولى مراحل الإنجاز الميداني لأحد أكثر مشاريع البنية التحتية طموحا بالمغرب في أفق 2030. وأوضح المكتب، في بلاغ له، أن الاستثمار الإجمالي لهذا المشروع يقدر بـ15 مليار درهم، ما سيمكن المحطة الجديدة من استقبال', 'size': 2}], 'main_title': 'مطار محمد الخامس: انطلاق أشغال إنجاز المحطة الجوية الجديدة'}, {'community_id': '6', 'articles': [{'id': '214', 'title': 'مطار محمد الخامس.. انطلاقة نحو العالمية!', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d9%85%d8%b7%d8%a7%d8%b1-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%ae%d8%a7%d9%85%d8%b3-%d8%a7%d9%86%d8%b7%d9%84%d8%a7%d9%82%d8%a9-%d9%86%d8%ad%d9%88-%d8%a7%d9%84%d8%b9%d8%a7%d9%84%d9%85%d9%8a%d8%a9/', 'summary': 'مطار محمد الخامس.. انطلاقة نحو العالمية!.  – متابعة مطار محمد الخامس.. انطلاقة نحو العالمية! أعلن المكتب الوطني للمطارات عن الشروع رسميًا في أشغال بناء المحطة الجوية الجديدة بمطار محمد الخامس بالدار البيضاء، في خطوة...  مطار محمد الخامس.. انطلاقة نحو العالمية!     .', 'size': 2}, {'id': '335', 'title': 'مطار محمد الخامس بالدار البيضاء: انطلاق أشغال إنجاز المحطة الجوية الجديدة', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/economy/408904.html', 'summary': 'مطار محمد الخامس بالدار البيضاء: انطلاق أشغال إنجاز المحطة الجوية الجديدة. أعلن المكتب الوطني للمطارات عن الإطلاق الرسمي لأشغال التهيئة الأرضية لمشروع المحطة الجوية الجديدة بمطار محمد الخامس الدولي بالدار البيضاء، وهي أولى مراحل الإنجاز الميداني', 'size': 2}], 'main_title': 'مطار محمد الخامس.. انطلاقة نحو العالمية!'}, {'community_id': '7', 'articles': [{'id': '221', 'title': '483 حالة لسعة عقرب خلال شهر يونيو الماضي بإقليم أزيلال', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/224259/', 'summary': '483 حالة لسعة عقرب خلال شهر يونيو الماضي بإقليم أزيلال. أحمد التدلاوي أفادت المندوبية الإقليمية لوزارة الصحة والحماية الاجتماعية بأزيلال بأنه جرى تسجيل 483 حالة لسعة عقرب خلال شهر يونيو الماضي بمختلف مناطق الإقليم، دون أن تسجل أي حالة وفاة، بفضل التدخل السريع والفعال للأطر الصحية بالمراكز والمستشفيات المحلية. وأوضحت المندوبية، عبر صفحتها الرسمية على موقع التواصل الاجتماعي “فيسبوك”، أن أكبر عدد من الحالات', 'size': 2}, {'id': '247', 'title': 'وزارة الصحة: 483 لسعة عقرب بأزيلال في يونيو المنصرم', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%88%d8%b2%d8%a7%d8%b1%d8%a9-%d8%a7%d9%84%d8%b5%d8%ad%d8%a9-483-%d9%84%d8%b3%d8%b9%d8%a9-%d8%b9%d9%82%d8%b1%d8%a8-%d8%a8%d8%a3%d8%b2%d9%8a%d9%84%d8%a7%d9%84-%d9%81%d9%8a-%d9%8a%d9%88%d9%86%d9%8a/', 'summary': 'وزارة الصحة: 483 لسعة عقرب بأزيلال في يونيو المنصرم. أكدت المندوبية الإقليمية لوزارة الصحة والحماية الاجتماعية لأزيلال، أن إقليم أزيلال سجل خلال شهر يونيو المنصرم 483 حالة لسعة عقرب. وأوضحت المندوبية، عبر صفحتها الرسمية بموقع التواصل الاجتماعي فيسبوك، أنه لم يتم تسجيل أي حالة وفاة، وذلك بفضل التدخل السريع والفعّال للأطر الصحية بالمراكز والمستشفيات التابعة لمندوبية وزارة الصحة والحماية الاجتماعية بأزيلال. وأشارت …  وزارة الصحة: 483 لسعة عقرب بأزيلال في يونيو المنصرم     .', 'size': 2}], 'main_title': '483 حالة لسعة عقرب خلال شهر يونيو الماضي بإقليم أزيلال'}, {'community_id': '0', 'articles': [{'id': '222', 'title': 'بولعجول يقدم الخطوط العريضة لمشروع البرنامج الاستعجالي للسلامة الطرقية', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/224254/', 'summary': 'بولعجول يقدم الخطوط العريضة لمشروع البرنامج الاستعجالي للسلامة الطرقية. كواليس اليوم استعرض المدير العام للوكالة الوطنية للسلامة الطرقية، السيد ناصر بولعجول، اليوم الإثنين بالرباط، محاور مشروع البرنامج الاستعجالي للسلامة الطرقية للفترة الصيفية برسم 2025. وأكد بولعجول، خلال لقاء صحفي أن هذا البرنامج يرتكز، أساسا، على تعزيز المراقبة الميدانية باستعمال الرادارات المحمولة والثابتة والمستقلة، وضبط المخالفات، ومراقبة مركبات النقل العمومي على مستوى محطات الانطلاق', 'size': 2}, {'id': '434', 'title': 'الخطوط العريضة لمشروع البرنامج الاستعجالي للسلامة الطرقية للفترة الصيفية برسم 2025', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%a7%d9%84%d8%ae%d8%b7%d9%88%d8%b7-%d8%a7%d9%84%d8%b9%d8%b1%d9%8a%d8%b6%d8%a9-%d9%84%d9%85%d8%b4%d8%b1%d9%88%d8%b9-%d8%a7%d9%84%d8%a8%d8%b1%d9%86%d8%a7%d9%85%d8%ac-%d8%a7%d9%84%d8%a7%d8%b3%d8%aa/', 'summary': 'الخطوط العريضة لمشروع البرنامج الاستعجالي للسلامة الطرقية للفترة الصيفية برسم 2025.  – و م ع استعرض المدير العام للوكالة الوطنية للسلامة الطرقية، السيد ناصر بولعجول، اليوم الإثنين بالرباط، محاور مشروع البرنامج الاستعجالي للسلامة الطرقية للفترة الصيفية برسم 2025. وأكد...  الخطوط العريضة لمشروع البرنامج الاستعجالي للسلامة الطرقية للفترة الصيفية برسم 2025     .', 'size': 2}], 'main_title': 'بولعجول يقدم الخطوط العريضة لمشروع البرنامج الاستعجالي للسلامة الطرقية'}, {'community_id': '5', 'articles': [{'id': '414', 'title': 'التوقيع على مذكرة تفاهم من أجل الحماية القانونية للتراث الثقافي المغربي', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/468793.html', 'summary': 'التوقيع على مذكرة تفاهم من أجل الحماية القانونية للتراث الثقافي المغربي. متابعة وقع وزير الشباب والثقافة والتواصل محمد المهدي بنسعيد والمدير العام للمنظمة العالمية للملكية الفكرية دارينغ تانغ، اليوم الاثنين بجنيف، على مذكرة تفاهم. ويتوخى هذا الاتفاق تعزيز التعاون الثنائي في مجال الملكية الفكرية، لاسيما في ما يتعلق بحقوق المؤلف والحقوق المجاورة وكذا الحماية القانونية للتراث الثقافي المغربي. ويشمل هذا الاتفاق كذلك إمكانية الاستفادة من الخبرة …', 'size': 2}, {'id': '444', 'title': 'جنيف.. بنسعيد يوقع على مذكرة تفاهم بين المغرب والمنظمة العالمية للملكية الفكرية', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/224272/', 'summary': 'جنيف.. بنسعيد يوقع على مذكرة تفاهم بين المغرب والمنظمة العالمية للملكية الفكرية. و م ع وقع وزير الشباب والثقافة والتواصل محمد المهدي بنسعيد والمدير العام للمنظمة العالمية للملكية الفكرية دارينغ تانغ، اليوم الاثنين بجنيف، على مذكرة تفاهم. ويتوخى هذا الاتفاق تعزيز التعاون الثنائي في مجال الملكية الفكرية، لاسيما في ما يتعلق بحقوق المؤلف والحقوق المجاورة وكذا الحماية القانونية للتراث الثقافي المغربي. ويشمل هذا الاتفاق كذلك إمكانية', 'size': 2}], 'main_title': 'التوقيع على مذكرة تفاهم من أجل الحماية القانونية للتراث الثقافي المغربي'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    