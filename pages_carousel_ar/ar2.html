<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 28/07/2025 - 12h25</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '66', 'title': 'السيدة الأولى لجمهورية السلفادور السيدة غابرييلا رودريغيز دي بوكيلي تحل بالمغرب في زيارة عمل للمملكة', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/204156', 'summary': 'السيدة الأولى لجمهورية السلفادور السيدة غابرييلا رودريغيز دي بوكيلي تحل بالمغرب في زيارة عمل للمملكة.  حلت السيدة الأولى لجمهورية السلفادور السيدة غابرييلا رودريغيز دي بوكيلي، اليوم الأحد بسلا، في إطار زيارة عمل للمغرب. ولدى نزولها من الطائرة بمطار الرباط-سلا،وجدت السيدة غابرييلا رودريغيز دي بوكيلي في استقبالها صاحبة السمو الملكي الأميرة للا أسماء. وبعد استعراض تشكيلة من القوات المساعدة التي أدت التحية، تقدم للسلام على صاحبة السمو الملكي الأميرة', 'size': 5}, {'id': '113', 'title': 'استقبلتها الأميرة للا أسماء.. “سيدة السلفادور” تزور المغرب!', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a7%d8%b3%d8%aa%d9%82%d8%a8%d9%84%d8%aa%d9%87%d8%a7-%d8%a7%d9%84%d8%a3%d9%85%d9%8a%d8%b1%d8%a9-%d9%84%d9%84%d8%a7-%d8%a3%d8%b3%d9%85%d8%a7%d8%a1-%d8%b3%d9%8a%d8%af%d8%a9-%d8%a7%d9%84%d8%b3/', 'summary': 'استقبلتها الأميرة للا أسماء.. “سيدة السلفادور” تزور المغرب!. حلت السيدة الأولى لجمهورية السلفادور غابرييلا رودريغيز دي بوكيلي، اليوم الأحد بسلا، في إطار زيارة عمل للمغرب. ولدى نزولها من الطائرة بمطار الرباط-سلا، وجدت في استقبالها الأميرة للا أسماء. وقدم لغابرييلا رودريغيز دي بوكيلي الحليب والتمر جريا على التقاليد المغربية الأصيلة. وبعد استراحة قصيرة بالقاعة الشرفية للمطار، توجه موكب الأميرة للا أسماء والسيدة الأولى لجمهورية', 'size': 5}, {'id': '132', 'title': 'للا أسماء تستقبل السيدة الأولى للسلفادور', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/319493/', 'summary': 'للا أسماء تستقبل السيدة الأولى للسلفادور. حلت السيدة الأولى لجمهورية السلفادور السيدة غابرييلا رودريغيز دي بوكيلي، اليوم الأحد بسلا، في إطار زيارة عمل للمغرب. ولدى نزولها من الطائرة بمطار الرباط-سلا، وجدت السيدة غابرييلا رودريغيز دي بوكيلي في استقبالها صاحبة السمو الملكي الأميرة للا أسماء. وبعد استعراض تشكيلة من القوات المساعدة التي أدت التحية، تقدم للسلام على صاحبة السمو الملكي الأميرة للا', 'size': 5}, {'id': '168', 'title': 'زوجة رئيس السالفادور تحل بالعاصمة الرباط', 'source': 'rue20.com', 'link': 'https://rue20.com/924332.html', 'summary': 'زوجة رئيس السالفادور تحل بالعاصمة الرباط. . الرباط حلت السيدة الأولى لجمهورية السلفادور السيدة غابرييلا رودريغيز دي بوكيلي، اليوم الأحد بسلا، في إطار زيارة عمل للمغرب. ولدى نزولها من الطائرة بمطار الرباط-سلا، وجدت السيدة غابرييلا رودريغيز دي بوكيلي في استقبالها صاحبة السمو الملكي الأميرة للا أسماء. وبعد استعراض تشكيلة من القوات المساعدة التي أدت التحية، تقدم للسلام على صاحبة السمو الخبر زوجة رئيس السالفادور تحل بالعاصمة الرباط  .', 'size': 5}, {'id': '219', 'title': 'السيدة الأولى لجمهورية السلفادور غابرييلا رودريغيز دي بوكيلي تحل بالمغرب في زيارة عمل للمملكة', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d8%b3%d9%8a%d8%af%d8%a9-%d8%a7%d9%84%d8%a3%d9%88%d9%84%d9%89-%d9%84%d8%ac%d9%85%d9%87%d9%88%d8%b1%d9%8a%d8%a9-%d8%a7%d9%84%d8%b3%d9%84%d9%81%d8%a7%d8%af%d9%88%d8%b1-%d8%ba%d8%a7%d8%a8/', 'summary': 'السيدة الأولى لجمهورية السلفادور غابرييلا رودريغيز دي بوكيلي تحل بالمغرب في زيارة عمل للمملكة. حلت السيدة الأولى لجمهورية السلفادور غابرييلا رودريغيز دي بوكيلي، اليوم الأحد بسلا، في إطار زيارة عمل للمغرب. وعند نزولها من الطائرة بمطار الرباط-سلا، وجدت غابرييلا رودريغيز دي بوكيلي في استقبالها الأميرة للا أسماء. وعقب استعراض تشكيلة من القوات المساعدة التي أدت التحية، تقدم للسلام على الأميرة للا أسماء والسيدة الأولى لجمهورية السلفادور، والي …  السيدة الأولى لجمهورية السلفادور غابرييلا رودريغيز دي بوكيلي تحل بالمغرب في زيارة عمل للمملكة     .', 'size': 5}], 'main_title': 'السيدة الأولى لجمهورية السلفادور السيدة غابرييلا رودريغيز دي بوكيلي تحل بالمغرب في زيارة عمل للمملكة'}, {'community_id': '3', 'articles': [{'id': '70', 'title': 'طنجة .. إجهاض محاولة تهريب أربعة أطنان و374 كيلوغراما من مخدر الشيرا', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/204124', 'summary': 'طنجة .. إجهاض محاولة تهريب أربعة أطنان و374 كيلوغراما من مخدر الشيرا.  تمكنت عناصر الأمن الوطني والجمارك العاملة بميناء طنجة المتوسط، خلال الساعات الأولى من صباح اليوم الأحد، من إجهاض محاولة تهريب أربعة أطنان و374 كيلوغراما من مخدر الشيرا على متن شاحنة للنقل الدولي للبضائع. وذكر مصدر أمني أن عمليات المراقبة الحدودية المشتركة بين الأمن الوطني والجمارك كانت قد أسفرت عن ضبط هذه المحجوزات الكبيرة من المخدرات', 'size': 3}, {'id': '217', 'title': 'إفشال عملية تهريب قرابة 5 أطنان من الحشيش بالميناء المتوسطي', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%a5%d9%81%d8%b4%d8%a7%d9%84-%d8%b9%d9%85%d9%84%d9%8a%d8%a9-%d8%aa%d9%87%d8%b1%d9%8a%d8%a8-%d9%82%d8%b1%d8%a7%d8%a8%d8%a9-5-%d8%a3%d8%b7%d9%86%d8%a7%d9%86-%d9%85%d9%86-%d8%a7%d9%84%d8%ad%d8%b4%d9%8a/', 'summary': 'إفشال عملية تهريب قرابة 5 أطنان من الحشيش بالميناء المتوسطي. المساء اليوم: أفشلت مصالح الأمن الوطني والجمارك بميناء طنجة المتوسط، صباح اليوم الأحد، محاولة تهريب أربعة أطنان و374 كيلوغراما من مخدر الشيرا على متن شاحنة للنقل الدولي للبضائع. وذكر مصدر أمني أن عمليات المراقبة الحدودية', 'size': 3}, {'id': '231', 'title': 'بتنسيق أمني.. إجهاض محاولة تهريب لأزيد من 4 أطنان من مخدر الشيرا بميناء طنجة المتوسط', 'source': 'www.alalam.ma', 'link': 'https://www.alalam.ma/بتنسيق-أمني-إجهاض-محاولة-تهريب-لأزيد-من-4-أطنان-من-مخدر-الشيرا_a28887.html', 'summary': 'بتنسيق أمني.. إجهاض محاولة تهريب لأزيد من 4 أطنان من مخدر الشيرا بميناء طنجة المتوسط. *العلم الإلكترونية* نجحت عناصر الأمن الوطني والجمارك العاملة بميناء طنجة المتوسط، خلال الساعات الأولى من صباح يومه الأحد 2...', 'size': 3}], 'main_title': 'طنجة .. إجهاض محاولة تهريب أربعة أطنان و374 كيلوغراما من مخدر الشيرا'}, {'community_id': '2', 'articles': [{'id': '110', 'title': 'السلطات الإسرائيلية تفرج عن الصحافي المغربي البقالي', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/410052.html', 'summary': 'السلطات الإسرائيلية تفرج عن الصحافي المغربي البقالي. قامت السلطات الإسرائيلية، اليوم الأحد، بالإفراج عن الصحافي المغربي محمد البقالي، مراسل قناة "الجزيرة"، إضافة إلى أفراد طاقم السفينة "حنظلة" التي كانت في مهمة إنسانية', 'size': 2}, {'id': '188', 'title': 'الإفراج عن الصحافي المغربي محمد البقالي', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%a7%d9%84%d8%a5%d9%81%d8%b1%d8%a7%d8%ac-%d8%b9%d9%86-%d8%a7%d9%84%d8%b5%d8%ad%d8%a7%d9%81%d9%8a-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8%d9%8a-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%a8%d9%82%d8%a7/', 'summary': 'الإفراج عن الصحافي المغربي محمد البقالي. أفرجت سلطات الاحتلال الإسرائيلي، اليوم الأحد، عن الصحافي المغربي محمد البقالي، الذي يشتغل مراسلا لقناة الجزيرة، بعد احتجازه رفقة طاقم "سفينة حنظلة"  الإفراج عن الصحافي المغربي محمد البقالي     .', 'size': 2}], 'main_title': 'السلطات الإسرائيلية تفرج عن الصحافي المغربي البقالي'}, {'community_id': '4', 'articles': [{'id': '115', 'title': 'وصفه بالجوهرة الكروية.  إنفانتينو يُشيد بملعب الأمير مولاي عبد الله', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%88%d8%b5%d9%81%d9%87-%d8%a8%d8%a7%d9%84%d8%ac%d9%88%d9%87%d8%b1%d8%a9-%d8%a7%d9%84%d9%83%d8%b1%d9%88%d9%8a%d8%a9-%d8%a5%d9%86%d9%81%d8%a7%d9%86%d8%aa%d9%8a%d9%86%d9%88-%d9%8a%d9%8f%d8%b4%d9%8a/', 'summary': 'وصفه بالجوهرة الكروية. إنفانتينو يُشيد بملعب الأمير مولاي عبد الله. أعرب جياني إنفانتينو، رئيس الاتحاد الدولي لكرة القدم “فيفا”، عن إعجابه الكبير بالمجمع الرياضي الأمير مولاي عبد الله في العاصمة الرباط، وذلك خلال زيارة تفقدية قام بها اليوم الأحد، رفقة فوزي لقجع، رئيس الجامعة الملكية المغربية لكرة القدم. وتأتي هذه الزيارة في سياق الاستعدادات لاحتضان الملعب لعدد من مباريات نهائيات كأس أمم إفريقيا “المغرب 2025”.', 'size': 2}, {'id': '221', 'title': 'رئيس الفيفا يشيد بملعب الأمير مولاي عبد الله ويصفه بـ”الجوهرة”', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%b1%d8%a6%d9%8a%d8%b3-%d8%a7%d9%84%d9%81%d9%8a%d9%81%d8%a7-%d9%8a%d8%b4%d9%8a%d8%af-%d8%a8%d9%85%d9%84%d8%b9%d8%a8-%d8%a7%d9%84%d8%a3%d9%85%d9%8a%d8%b1-%d9%85%d9%88%d9%84%d8%a7%d9%8a-%d8%b9%d8%a8/', 'summary': 'رئيس الفيفا يشيد بملعب الأمير مولاي عبد الله ويصفه بـ”الجوهرة”. عبّر رئيس الاتحاد الدولي لكرة القدم، جياني إنفانتينو، عن إعجابه الكبير بملعب الأمير مولاي عبد الله في الرباط، خلال زيارة قام بها، يومه الأحد، برفقة رئيس الجامعة الملكية المغربية لكرة القدم، فوزي لقجع. وقال رئيس الفيفا، في منشور له على صفحته الرسمية بموقع التواصل الاجتماعي “إنستغرام”: “إن الملعب يُعدّ من بين أحدث وأكثر …  رئيس الفيفا يشيد بملعب الأمير مولاي عبد الله ويصفه بـ”الجوهرة”     .', 'size': 3}, {'id': '346', 'title': 'إنفانتينو: ملعب الرباط جوهرة حقيقية ومن أجمل الملاعب في العالم', 'source': 'rue20.com', 'link': 'https://rue20.com/924441.html', 'summary': 'إنفانتينو: ملعب الرباط جوهرة حقيقية ومن أجمل الملاعب في العالم.  | الرباط أعرب رئيس الاتحاد الدولي لكرة القدم (الفيفا)، خلال زيارته الأخيرة لملعب الأمير مولاي عبد الله في الرباط ، عن سعادته البالغة بزيارة هذا الصرح الرياضي الرائد، برفقة فوزي لقجع، رئيس الجامعة الملكية المغربية لكرة القدم. وأكد إنفانتينو في منشور على حسابه بإنستاغرام، أن هذا الملعب يعد من بين أكثر الملاعب ابتكارًا الخبر إنفانتينو: ملعب الرباط جوهرة حقيقية ومن أجمل الملاعب في العالم  .', 'size': 2}], 'main_title': 'رئيس الفيفا يشيد بملعب الأمير مولاي عبد الله ويصفه بـ”الجوهرة”'}, {'community_id': '6', 'articles': [{'id': '134', 'title': 'عيد العرش.. خبراء يبرزون النموذج المغربي في الإصلاح والتحديث', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/319481/', 'summary': 'عيد العرش.. خبراء يبرزون النموذج المغربي في الإصلاح والتحديث. احتضنت جامعة القدس أمس السبت لقاء علميا تزامنا مع الاحتفالات بعيد العرش، ضمن برنامج الأنشطة الأكاديمية لكرسي الدراسات المغربية في جامعة القدس في موضوع “عيد العرش بالمملكة المغربية: بين تقاليد الدولة العريقة وطموحات الإصلاح والتحديث”، بمشاركة مسؤولين وجامعيين مغاربة وفلسطينيين. بهذه المناسبة، التي حضرها على الخصوص سفير المغرب لدى دولة فلسطين عبد الرحيم مزيان، والمدير', 'size': 2}, {'id': '177', 'title': 'بحضور فلسطيني وازن.. كرسي الدراسات المغربية في جامعة القدس يحتفي بعيد العرش', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/470789.html', 'summary': 'بحضور فلسطيني وازن.. كرسي الدراسات المغربية في جامعة القدس يحتفي بعيد العرش. احتضنت جامعة القدس لقاء علميا تزامنا مع الاحتفالات بعيد العرش، ضمن برنامج الأنشطة الأكاديمية لكرسي الدراسات المغربية في جامعة القدس في موضوع “عيد العرش بالمملكة المغربية: بين تقاليد الدولة العريقة وطموحات الإصلاح والتحديث”، بمشاركة مسؤولين وجامعيين مغاربة وفلسطينيين. بهذه المناسبة، التي حضرها على الخصوص سفير المغرب لدى دولة فلسطين عبد الرحيم مزيان، والمدير المكلف بتسيير …', 'size': 2}], 'main_title': 'عيد العرش.. خبراء يبرزون النموذج المغربي في الإصلاح والتحديث'}, {'community_id': '1', 'articles': [{'id': '154', 'title': 'سلطات الاحتلال الإسرائيلي تفرج عن الصحافي محمد البقالي وأفراد طاقم السفينة “حنظلة”', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1088673.html', 'summary': 'سلطات الاحتلال الإسرائيلي تفرج عن الصحافي محمد البقالي وأفراد طاقم السفينة “حنظلة”. علمت جريدة “العمق المغربي” من مصادر جيدة الاطلاع أن سلطات الاحتلال الإسرائيلي، أفرجت اليوم الأحد 27 يوليوز الجاري، عن الصحافي والإعلامي المغربي بقناة الجزيرة محمد البقالي إلى جانب أفراد طاقم السفينة حنظلة بعد توقيعهم على وثيقة يلتزمون بموجبها بعدم تكرار المحاولة. وسيتم ترحيل الصحافي البقالي وفق ما أفادت مصادر الجريدة إلى العاصمة الفرنسية باريس يوم ظهرت المقالة سلطات الاحتلال الإسرائيلي تفرج عن الصحافي محمد البقالي وأفراد طاقم السفينة “حنظلة”  .', 'size': 2}, {'id': '157', 'title': 'سينتقل غدا إلى باريس.. الاحتلال يفرج عن الصحافي محمد البقالي', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%b3%d9%8a%d9%86%d8%aa%d9%82%d9%84-%d8%ba%d8%af%d8%a7-%d8%a5%d9%84%d9%89-%d8%a8%d8%a7%d8%b1%d9%8a%d8%b3-%d8%a7%d9%84%d8%a7%d8%ad%d8%aa%d9%84%d8%a7%d9%84-%d9%8a%d9%81%d8%b1%d8%ac-%d8%b9%d9%86/', 'summary': 'سينتقل غدا إلى باريس.. الاحتلال يفرج عن الصحافي محمد البقالي. أفرجت اليوم الأحد 27 يوليوز 2025 سلطات الاحتلال الإسرائيلي عن الصحافي المغربي العامل بقناة الجزيرة محمد البقالي إلى جانب أفراد طاقم السفينة "حنظلة"، وذلك بعد توقيعهم على وثيقة يلتزمون بموجبها بعدم تكرار المحاولة. وسيتم ترحيل الصحافي البقالي إلى العاصمة الفرنسية باريس يوم غد الاثنين 28 يوليوز، بعدما تعذر الحجز في رحلة مباشرة هذا اليوم.  سينتقل غدا إلى باريس.. الاحتلال يفرج عن الصحافي محمد البقالي     .', 'size': 2}], 'main_title': 'سلطات الاحتلال الإسرائيلي تفرج عن الصحافي محمد البقالي وأفراد طاقم السفينة “حنظلة”'}, {'community_id': '7', 'articles': [{'id': '270', 'title': 'طقس الإثنين.. أجواء حارة بمختلف مناطق المملكة', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-644436.html', 'summary': 'طقس الإثنين.. أجواء حارة بمختلف مناطق المملكة. هبة بريس تتوقع المديرية العامة للأرصاد الجوية، اليوم الاثنين، أن يكون الطقس حارا بالسهول غرب الأطلس، والجنوب الشرقي، وبداخل الأقاليم الصحراوية. كما يرتقب تشكل سحب منخفضة كثيفة بالسواحل والسهول الشمالية والوسطى، مصحوبة بكتل ضبابية أو قطرات مطرية جد خفيفة محليا. ومن المنتظر تسجيل هبات رياح قوية نوعا ما بمرتفعات الأطلس وبالمناطق الجنوبية. وستتراوح درجات الحرارة الدنيا ما بين 25 و31 درجة مئوية بالجنوب الشرقي وشرق الأقاليم الصحراوية، وما بين 18 و25 درجة بباقي جهات المملكة، فيما لن يطرأ تغير مهم على درجات الحرارة خلال النهار. وسيكون البحر هادئا إلى قليل الهيجان بالواجهة المتوسطية وبالبوغاز، وقليل الهيجان إلى هائج على طول الساحل الأطلسي.', 'size': 2}, {'id': '345', 'title': 'طقس حار مع كتل ضبابية متوقعة اليوم الاثنين', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%b7%d9%82%d8%b3-%d8%ad%d8%a7%d8%b1-%d9%85%d8%b9-%d9%83%d8%aa%d9%84-%d8%b6%d8%a8%d8%a7%d8%a8%d9%8a%d8%a9-%d9%85%d8%aa%d9%88%d9%82%d8%b9%d8%a9-%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%a7%d8%ab/', 'summary': 'طقس حار مع كتل ضبابية متوقعة اليوم الاثنين. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الاثنين، أن يكون الطقس حارا بالسهول غرب الأطلس، والجنوب الشرقي، وبداخل الأقاليم الصحراوية. كما يرتقب تشكل سحب منخفضة كثيفة بالسواحل والسهول الشمالية والوسطى، مصحوبة بكتل ضبابية أو قطرات مطرية جد خفيفة محليا. ومن المنتظر تسجيل هبات رياح قوية نوعا ما بمرتفعات الأطلس وبالمناطق الجنوبية. وستتراوح درجات الحرارة الدنيا  طقس حار مع كتل ضبابية متوقعة اليوم الاثنين     .', 'size': 4}, {'id': '374', 'title': 'طقس الاثنين: استمرار الحرارة.. وقطرات مطرية محدودة', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%b7%d9%82%d8%b3-%d8%a7%d9%84%d8%a7%d8%ab%d9%86%d9%8a%d9%86-%d8%a7%d8%b3%d8%aa%d9%85%d8%b1%d8%a7%d8%b1-%d8%a7%d9%84%d8%ad%d8%b1%d8%a7%d8%b1%d8%a9-%d9%88%d9%82%d8%b7%d8%b1%d8%a7%d8%aa-%d9%85%d8%b7/', 'summary': 'طقس الاثنين: استمرار الحرارة.. وقطرات مطرية محدودة. المساء اليوم: تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الاثنين، أن يكون الطقس حارا بالسهول غرب الأطلس، والجنوب الشرقي، وبداخل الأقاليم الصحراوية. كما يرتقب تشكل سحب منخفضة كثيفة بالسواحل والسهول الشمالية والوسطى، مصحوبة بكتل ضبابية', 'size': 3}, {'id': '381', 'title': 'توقعات أحوال الطقس لليوم الاثنين', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%aa%d9%88%d9%82%d8%b9%d8%a7%d8%aa-%d8%a3%d8%ad%d9%88%d8%a7%d9%84-%d8%a7%d9%84%d8%b7%d9%82%d8%b3-%d9%84%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%a7%d8%ab%d9%86%d9%8a%d9%86-2/', 'summary': 'توقعات أحوال الطقس لليوم الاثنين. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الاثنين، أن يكون الطقس حارا بالسهول غرب الأطلس، والجنوب الشرقي، وبداخل الأقاليم الصحراوية. كما يرتقب تشكل سحب منخفضة كثيفة بالسواحل والسهول الشمالية والوسطى، مصحوبة بكتل ضبابية أو قطرات مطرية جد خفيفة محليا. ومن المنتظر تسجيل هبات رياح قوية نوعا ما بمرتفعات الأطلس وبالمناطق الجنوبية. وستتراوح درجات …  توقعات أحوال الطقس لليوم الاثنين     .', 'size': 3}], 'main_title': 'طقس حار مع كتل ضبابية متوقعة اليوم الاثنين'}, {'community_id': '5', 'articles': [{'id': '309', 'title': 'بمشاركة المغرب.. انطلاق أشغال تقييم حصيلة قمة الأمم المتحدة حول الأنظمة الغذائية بأديس أبابا', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a8%d9%85%d8%b4%d8%a7%d8%b1%d9%83%d8%a9-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d8%a7%d9%86%d8%b7%d9%84%d8%a7%d9%82-%d8%a3%d8%b4%d8%ba%d8%a7%d9%84-%d8%aa%d9%82%d9%8a%d9%8a%d9%85-%d8%ad%d8%b5%d9%8a/', 'summary': 'بمشاركة المغرب.. انطلاق أشغال تقييم حصيلة قمة الأمم المتحدة حول الأنظمة الغذائية بأديس أبابا. انطلقت، اليوم الاثنين (28 يوليوز) بأديس أبابا، أشغال التقييم الثاني لقمة الأمم المتحدة حول الأنظمة الغذائية، وذلك بمشاركة المغرب. ويمثل المملكة في هذا الحدث وفد يقوده وزير الفلاحة والصيد البحري والتنمية القروية والمياه والغابات، أحمد البواري، ويضم على الخصوص السفير الممثل الدائم للمملكة لدى الاتحاد الإفريقي واللجنة الاقتصادية لإفريقيا، محمد عروشي. وسيمكن هذا الحدث، الذي', 'size': 2}, {'id': '342', 'title': 'بمشاركة المغرب.. انطلاق أشغال التقييم الثاني لحصيلة قمة الأمم المتحدة حول الأنظمة الغذائية', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a8%d9%85%d8%b4%d8%a7%d8%b1%d9%83%d8%a9-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d8%a7%d9%86%d8%b7%d9%84%d8%a7%d9%82-%d8%a3%d8%b4%d8%ba%d8%a7%d9%84-%d8%a7%d9%84%d8%aa%d9%82%d9%8a%d9%8a%d9%85-%d8%a7/', 'summary': 'بمشاركة المغرب.. انطلاق أشغال التقييم الثاني لحصيلة قمة الأمم المتحدة حول الأنظمة الغذائية. انطلقت، اليوم الاثنين بأديس أبابا، أشغال التقييم الثاني لقمة الأمم المتحدة حول الأنظمة الغذائية، وذلك بمشاركة المغرب. ويمثل المملكة في هذا الحدث وفد يقوده وزير الفلاحة والصيد البحري والتنمية القروية والمياه والغابات، أحمد البواري، ويضم على الخصوص السفير الممثل الدائم للمملكة لدى الاتحاد الإفريقي واللجنة الاقتصادية لإفريقيا، محمد عروشي. وسيمكن هذا الحدث، الذي يستند إلى  بمشاركة المغرب.. انطلاق أشغال التقييم الثاني لحصيلة قمة الأمم المتحدة حول الأنظمة الغذائية     .', 'size': 3}, {'id': '356', 'title': 'بمشاركة المغرب.. انظلاق أشغال التقييم الثاني لحصيلة قمة الأمم المتحدة حول الأنظمة الغذائية', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/470835.html', 'summary': 'بمشاركة المغرب.. انظلاق أشغال التقييم الثاني لحصيلة قمة الأمم المتحدة حول الأنظمة الغذائية. نطلقت، اليوم الاثنين بأديس أبابا، أشغال التقييم الثاني لقمة الأمم المتحدة حول الأنظمة الغذائية، وذلك بمشاركة المغرب. ويمثل المملكة في هذا الحدث وفد يقوده وزير الفلاحة والصيد البحري والتنمية القروية والمياه والغابات', 'size': 2}], 'main_title': 'بمشاركة المغرب.. انطلاق أشغال التقييم الثاني لحصيلة قمة الأمم المتحدة حول الأنظمة الغذائية'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    