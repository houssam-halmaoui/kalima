<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 22/08/2025 - 06h22</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '4', 'title': 'السعودية تهنئ الملك بعيد الشباب', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d8%a7%d9%84%d8%b3%d8%b9%d9%88%d8%af%d9%8a%d8%a9-%d8%aa%d9%87%d9%86%d8%a6-%d8%a7%d9%84%d9%85%d9%84%d9%83-%d8%a8%d8%b9%d9%8a%d8%af-%d8%a7%d9%84%d8%b4%d8%a8%d8%a7%d8%a8-1612357.html', 'summary': 'السعودية تهنئ الملك بعيد الشباب. توصل الملك محمد السادس ببرقية تهنئة من خادم الحرمين الشريفين، الملك سلمان بن عبد العزيز آل سعود، عاهل المملكة العربية السعودية، وذلك بمناسبة عيد الشباب. ومما جاء في هذه البرقية: “يطيب لنا بمناسبة ذكرى يوم الشباب المجيد لبلدكم، أن نبعث لجلالتكم أصدق التهاني وأطيب التمنيات بالصحة والسعادة، ولحكومة وشعب المملكة المغربية الشقيق اطراد التقدم والازدهار”.  السعودية تهنئ الملك بعيد الشباب     - هسبريس جريدة إلكترونية مغربية .', 'size': 2}, {'id': '175', 'title': 'العاهل السعودي يهنئ الملك بعيد الشباب', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/473306.html', 'summary': 'العاهل السعودي يهنئ الملك بعيد الشباب. توصل الملك محمد السادس، ببرقية تهنئة من خادم الحرمين الشريفين، الملك سلمان بن عبد العزيز آل سعود، عاهل المملكة العربية السعودية، بمناسبة عيد الشباب.', 'size': 2}], 'main_title': 'السعودية تهنئ الملك بعيد الشباب'}, {'community_id': '1', 'articles': [{'id': '5', 'title': 'مندوبية السجون تردّ على جريدة إسبانية', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d9%85%d9%86%d8%af%d9%88%d8%a8%d9%8a%d8%a9-%d8%a7%d9%84%d8%b3%d8%ac%d9%88%d9%86-%d8%aa%d8%b1%d8%af%d9%91-%d8%b9%d9%84%d9%89-%d8%ac%d8%b1%d9%8a%d8%af%d8%a9-%d8%a5%d8%b3%d8%a8%d8%a7%d9%86%d9%8a%d8%a9-1612355.html', 'summary': 'مندوبية السجون تردّ على جريدة إسبانية. ردّت المندوبية العامة لإدارة السجون وإعادة الإدماج على مقال صدر بالجريدة الإسبانية “La Gaceta”، اليوم الخميس، يدعي أن “أحد الإرهابيين الإسلاميين الموقوفين مؤخرا ببلدة Vallfoga de Balaguer (Lérida) سبق له أن استفاد من العفو بالمغرب”. وأكدت المندوبية العامة لإدارة السجون وإعادة الإدماج، في بيان توضيحي، أن المواطن المغربي المذكور لم يستفد من العفو الملكي السامي  مندوبية السجون تردّ على جريدة إسبانية     - هسبريس جريدة إلكترونية مغربية .', 'size': 2}, {'id': '116', 'title': 'حول “استفادة إرهابي من العفو”.. مندوبية السجون تكذّب ادعاءات صحيفة إسبانية', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%ad%d9%88%d9%84-%d8%a7%d8%b3%d8%aa%d9%81%d8%a7%d8%af%d8%a9-%d8%a5%d8%b1%d9%87%d8%a7%d8%a8%d9%8a-%d9%85%d9%86-%d8%a7%d9%84%d8%b9%d9%81%d9%88-%d9%85%d9%86%d8%af%d9%88%d8%a8%d9%8a%d8%a9-%d8%a7/', 'summary': 'حول “استفادة إرهابي من العفو”.. مندوبية السجون تكذّب ادعاءات صحيفة إسبانية. ردت المندوبية العامة لإدارة السجون وإعادة الإدماج على المقال الصادر بالجريدة الإسبانية “La Gaceta”، اليوم الأربعاء (21 غشت)، والذي يدعي أن “أحد الإرهابيين الإسلاميين الموقوفين مؤخرا ببلدة Vallfoga de Balaguer (Lérida) سبق له أن استفاد من العفو بالمغرب. وخرجت مندوبية السجون ببلاغ توضيح تكشف من خلاله للرأي العام حقيقة ما جاء في مقال الصحيفة الإسبانية،', 'size': 2}], 'main_title': 'مندوبية السجون تردّ على جريدة إسبانية'}, {'community_id': '10', 'articles': [{'id': '66', 'title': 'مؤسسة محمد السادس للعلوم والصحة تنجح في إعادة برمجة خلايا الدم إلى خلايا جذعية مستحثة متعددة القدرات', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/205279', 'summary': 'مؤسسة محمد السادس للعلوم والصحة تنجح في إعادة برمجة خلايا الدم إلى خلايا جذعية مستحثة متعددة القدرات.  أعلنت مؤسسة محمد السادس للعلوم والصحة عن نجاحها، ولأول مرة في المغرب، في إعادة برمجة خلايا الدم المحيطية أحادية النواة (PBMC) إلى خلايا جذعية مستحثة متعددة القدرات (iPS)، وهو ما يمثل تقدما علميا كبيرا وتاريخيا. وأوضحت المؤسسة، في بلاغ لها، أن هذا التقدم الاستراتيجي يمهد الطريق لإحداث منصة وطنية لإعادة البرمجة والتمايز الخلوي لخدمة', 'size': 5}, {'id': '123', 'title': 'مؤسسة محمد السادس للعلوم والصحة تنجح في إعادة برمجة خلايا جذعية مستحثة متعددة القدرات', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/321483/', 'summary': 'مؤسسة محمد السادس للعلوم والصحة تنجح في إعادة برمجة خلايا جذعية مستحثة متعددة القدرات. أعلنت مؤسسة محمد السادس للعلوم والصحة عن نجاحها، ولأول مرة في المغرب، في إعادة برمجة خلايا الدم المحيطية أحادية النواة (PBMC) إلى خلايا جذعية مستحثة متعددة القدرات (iPS)، وهو ما يمثل تقدما علميا كبيرا وتاريخيا. وأوضحت المؤسسة، في بلاغ لها، أن هذا التقدم الاستراتيجي يمهد الطريق لإحداث منصة وطنية لإعادة البرمجة والتمايز الخلوي لخدمة البحث البيوطبي، والطب الشخصي، والعلاجات المبتكرة.', 'size': 5}, {'id': '154', 'title': 'إنجاز طبي غير مسبوق.. مؤسسة محمد السادس تنجح في إعادة برمجة خلايا الدم إلى خلايا جذعية بالمغرب', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a5%d9%86%d8%ac%d8%a7%d8%b2-%d8%b7%d8%a8%d9%8a-%d8%ba%d9%8a%d8%b1-%d9%85%d8%b3%d8%a8%d9%88%d9%82-%d9%85%d8%a4%d8%b3%d8%b3%d8%a9-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7%d8%af%d8%b3/', 'summary': 'إنجاز طبي غير مسبوق.. مؤسسة محمد السادس تنجح في إعادة برمجة خلايا الدم إلى خلايا جذعية بالمغرب. أعلنت مؤسسة محمد السادس للعلوم والصحة عن نجاحها، ولأول مرة في المغرب، في إعادة برمجة خلايا الدم المحيطية أحادية النواة (PBMC) إلى خلايا جذعية مستحثة متعددة القدرات (iPS)، وهو ما يمثل تقدما علميا كبيرا وتاريخيا. وأوضحت المؤسسة، في بلاغ لها، أن هذا التقدم الاستراتيجي يمهد الطريق لإحداث منصة وطنية لإعادة البرمجة والتمايز الخلوي لخدمة البحث  إنجاز طبي غير مسبوق.. مؤسسة محمد السادس تنجح في إعادة برمجة خلايا الدم إلى خلايا جذعية بالمغرب     .', 'size': 4}, {'id': '210', 'title': 'اختراق علمي مغربي بارز.. مؤسسة محمد السادس للعلوم والصحة تنجح في تحويل خلايا الدم إلى جذعية متعددة القدرات', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d8%ae%d8%aa%d8%b1%d8%a7%d9%82-%d8%b9%d9%84%d9%85%d9%8a-%d9%85%d8%ba%d8%b1%d8%a8%d9%8a-%d8%a8%d8%a7%d8%b1%d8%b2-%d9%85%d8%a4%d8%b3%d8%b3%d8%a9-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7/', 'summary': 'اختراق علمي مغربي بارز.. مؤسسة محمد السادس للعلوم والصحة تنجح في تحويل خلايا الدم إلى جذعية متعددة القدرات. كشفت مؤسسة محمد السادس للعلوم والصحة عن نجاحها، ولأول مرة في المغرب، في إعادة برمجة خلايا الدم المحيطية أحادية النواة (PBMC) إلى خلايا جذعية مستحثة متعددة القدرات (iPS)، وهو ما يمثل تقدما علميا كبيرا وتاريخيا. وأبرزت المؤسسة، في بلاغ لها، أن هذا التقدم الاستراتيجي يمهد الطريق لإحداث منصة وطنية لإعادة البرمجة والتمايز الخلوي لخدمة البحث البيوطبي، والطب الشخصي، …  اختراق علمي مغربي بارز.. مؤسسة محمد السادس للعلوم والصحة تنجح في تحويل خلايا الدم إلى جذعية متعددة القدرات     .', 'size': 5}, {'id': '290', 'title': 'خلايا جذعية مغربية.. خطوة جديدة نحو علاج الأمراض وفهم أسرار الخلايا', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%ae%d9%84%d8%a7%d9%8a%d8%a7-%d8%ac%d8%b0%d8%b9%d9%8a%d8%a9-%d9%85%d8%ba%d8%b1%d8%a8%d9%8a%d8%a9-%d8%ae%d8%b7%d9%88%d8%a9-%d8%ac%d8%af%d9%8a%d8%af%d8%a9-%d9%86%d8%ad%d9%88-%d8%b9%d9%84%d8%a7%d8%ac/', 'summary': 'خلايا جذعية مغربية.. خطوة جديدة نحو علاج الأمراض وفهم أسرار الخلايا. نجح مركز محمد السادس للبحث والابتكار، التابع لمؤسسة محمد السادس للعلوم والصحة، لأول مرة في المغرب في إعادة برمجة خلايا الدم إلى خلايا جذعية “مغربية” متعددة القدرات، في خطوة مهمة نحو تطوير الطب الشخصي والعلاجات التجديدية. ويعتبر هذا الإنجاز العلمي المغربي خطوة نوعية لعلاج الأمراض المستعصية، ويضع المغرب على خارطة الابتكار الطبي والتكنولوجيا الحيوية عالميًا،', 'size': 4}], 'main_title': 'مؤسسة محمد السادس للعلوم والصحة تنجح في إعادة برمجة خلايا الدم إلى خلايا جذعية مستحثة متعددة القدرات'}, {'community_id': '9', 'articles': [{'id': '103', 'title': 'قطعة نقدية تحتفي بعيد ميلاد الملك محمد السادس', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/national/411413.html', 'summary': 'قطعة نقدية تحتفي بعيد ميلاد الملك محمد السادس. أصدر بنك المغرب قطعة نقدية تذكارية فضية من فئة 250 درهما، وذلك تخليدا للذكرى الثانية والستين لميلاد صاحب الجلالة الملك محمد السادس. وأوضح بلاغ لبنك المغرب', 'size': 2}, {'id': '149', 'title': 'من فئة 250 درهما.. الزليج يزين القطعة النقدية التذكارية لعيد ميلاد الملك محمد السادس', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1094120.html', 'summary': 'من فئة 250 درهما.. الزليج يزين القطعة النقدية التذكارية لعيد ميلاد الملك محمد السادس. أصدر بنك المغرب قطعة نقدية تذكارية فضية من فئة 250 درهما، ظهرت المقالة من فئة 250 درهما.. الزليج يزين القطعة النقدية التذكارية لعيد ميلاد الملك محمد السادس  .', 'size': 2}], 'main_title': 'قطعة نقدية تحتفي بعيد ميلاد الملك محمد السادس'}, {'community_id': '4', 'articles': [{'id': '105', 'title': 'بورنموث الإنجليزي يضم أمين عدلي لمدة خمسة أعوام', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/sport/proplayers/411415.html', 'summary': 'بورنموث الإنجليزي يضم أمين عدلي لمدة خمسة أعوام. أعلن نادي بورنموث الإنجليزي لكرة القدم، اليوم الخميس، تعاقده مع المهاجم الدولي المغربي أمين عدلي لمدة خمسة أعوام، قادما من باير ليفركوزن الألماني. وذكر النادي، في', 'size': 2}, {'id': '357', 'title': 'بورنموث الإنجليزي يعلن ضم عدلي لخمس سنوات', 'source': 'machahid24.com', 'link': 'https://machahid24.com/sport/473319.html', 'summary': 'بورنموث الإنجليزي يعلن ضم عدلي لخمس سنوات. أعلن نادي بورنموث الإنجليزي لكرة القدم، اليوم الخميس، تعاقده مع المهاجم الدولي المغربي أمين عدلي لمدة خمسة أعوام، قادما من باير ليفركوزن الألماني. وذكر النادي، في بيان، أن عدلي، البالغ من العمر 25 عاما، وقع على عقد سيمتد حتى 2030، لافتا إلى أن اللاعب كان متعاقدا مع ناديه الألماني حتى عام 2028. وقال عدلي، في …', 'size': 2}], 'main_title': 'بورنموث الإنجليزي يضم أمين عدلي لمدة خمسة أعوام'}, {'community_id': '5', 'articles': [{'id': '126', 'title': 'توقيف سبعيني يشتبه في اعتداءه جنسيا على قاصر', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/321476/', 'summary': 'توقيف سبعيني يشتبه في اعتداءه جنسيا على قاصر. تمكنت عناصر الشرطة بولاية أمن تطوان، مساء أمس الأربعاء 20 غشت الجاري، من توقيف شخص يبلغ من العمر 72 سنة، وذلك للاشتباه في تورطه في قضية تتعلق بالتغرير بقاصر وتعريضه لاعتداء جنسي. وكان المشتبه فيه قد أقدم على التغرير بطفل قاصر يبلغ من العمر 10 سنوات، وعرضه لاعتداء جنسي بمدينة تطوان، حيث أسفرت الأبحاث', 'size': 2}, {'id': '213', 'title': 'تطوان.. توقيف سبعيني بشبهة التغرير بقاصر وتعريضه لاعتداء جنسي', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%aa%d8%b7%d9%88%d8%a7%d9%86-%d8%aa%d9%88%d9%82%d9%8a%d9%81-%d8%b3%d8%a8%d8%b9%d9%8a%d9%86%d9%8a-%d8%a8%d8%b4%d8%a8%d9%87%d8%a9-%d8%a7%d9%84%d8%aa%d8%ba%d8%b1%d9%8a%d8%b1-%d8%a8%d9%82%d8%a7%d8%b5/', 'summary': 'تطوان.. توقيف سبعيني بشبهة التغرير بقاصر وتعريضه لاعتداء جنسي. تمكنت عناصر الشرطة بولاية أمن تطوان، مساء أمس الأربعاء 20 غشت الجاري، من توقيف شخص يبلغ من العمر 72 سنة، وذلك للاشتباه في تورطه في قضية تتعلق بالتغرير بقاصر وتعريضه لاعتداء جنسي. وكشفت مصادر أمنية، أن المشتبه فيه كان قد أقدم على التغرير بطفل قاصر يبلغ من العمر 10 سنوات، وعرضه لاعتداء جنسي …  تطوان.. توقيف سبعيني بشبهة التغرير بقاصر وتعريضه لاعتداء جنسي     .', 'size': 3}, {'id': '349', 'title': 'أمن تطوان يعتقل مسنا يبلغ من العمر 72 عاما اعتدى جنسيا على طفل قاصر', 'source': 'rue20.com', 'link': 'https://rue20.com/930361.html', 'summary': 'أمن تطوان يعتقل مسنا يبلغ من العمر 72 عاما اعتدى جنسيا على طفل قاصر.  الرباط تمكنت عناصر الشرطة بولاية أمن تطوان، من توقيف شخص يبلغ من العمر 72 سنة، وذلك للاشتباه في تورطه في قضية تتعلق بالتغرير بقاصر وتعريضه لاعتـداء جنـسي. وكان المشتبه فيه قد أقدم على التغرير بطفل قاصر يبلغ من العمر 10 سنوات، وعرضه لاعتداء جنسي بمدينة تطوان، حيث أسفرت الأبحاث والتحريات المنجزة في هذه القضية الخبر أمن تطوان يعتقل مسنا يبلغ من العمر 72 عاما اعتدى جنسيا على طفل قاصر  .', 'size': 2}], 'main_title': 'تطوان.. توقيف سبعيني بشبهة التغرير بقاصر وتعريضه لاعتداء جنسي'}, {'community_id': '11', 'articles': [{'id': '128', 'title': 'رسميا.. موعد أول مباراة لأسود الأطلس “بمولاي عبد الله”', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/321452/', 'summary': 'رسميا.. موعد أول مباراة لأسود الأطلس “بمولاي عبد الله”. أعلنت الجامعة الملكية المغربية لكرة القدم أن المنتخب الوطني المغربي سيخوض مباراته المقبلة أمام منتخب النيجر، يوم الجمعة 5 شتنبر 2025، ابتداء من الساعة الثامنة مساء، بالمجمع الرياضي الأمير مولاي عبد الله بالرباط. وتدخل هذه المواجهة في إطار التصفيات الأفريقية المؤهلة إلى نهائيات كأس العالم 2026، حيث يسعى “أسود الأطلس” إلى تأكيد صدارتهم للمجموعة الخامسة،', 'size': 3}, {'id': '156', 'title': 'المغرب يستقبل النيجر في تصفيات المونديال بملعب الأمير مولاي عبد الله الجديد', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d9%8a%d8%b3%d8%aa%d9%82%d8%a8%d9%84-%d8%a7%d9%84%d9%86%d9%8a%d8%ac%d8%b1-%d9%81%d9%8a-%d8%aa%d8%b5%d9%81%d9%8a%d8%a7%d8%aa-%d8%a7%d9%84%d9%85%d9%88%d9%86%d8%af/', 'summary': 'المغرب يستقبل النيجر في تصفيات المونديال بملعب الأمير مولاي عبد الله الجديد. خالد لكراري (صحافي متدرب) أعلنت الجامعة الملكية المغربية لكرة القدم أن المنتخب الوطني سيواجه منتخب النيجر يوم الجمعة 5 شتنبر 2025، على أرضية المجمع الرياضي الأمير مولاي عبد الله بالرباط، في إطار التصفيات الإفريقية المؤهلة إلى كأس العالم 2026. وتكتسي المباراة طابعا خاصا، إذ ستشهد الافتتاح الرسمي للملعب بعد إعادة بنائه بمعايير حديثة، على أن  المغرب يستقبل النيجر في تصفيات المونديال بملعب الأمير مولاي عبد الله الجديد     .', 'size': 3}, {'id': '312', 'title': 'بلاغ من الجامعة الملكية لكرة القدم', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-585969.html', 'summary': 'بلاغ من الجامعة الملكية لكرة القدم. أعلنت الجامعة الملكية المغربية لكرة القدم، اليوم الخميس، أن المنتخب الوطني المغربي سيخوض مباراته المقبلة أمام منتخب النيجر، يوم الجمعة 5 شتنبر 2025، بالمجمع الرياضي الأمير مولاي عبد الله بمدينة الرباط، ابتداء من الساعة الثامنة مساء. وأفادت الجامعة في بلاغ بأن هذه المواجهة تدخل في إطار التصفيات الأفريقية المؤهلة إلى نهائيات كأس', 'size': 4}, {'id': '389', 'title': 'مركب الأمير مولاي عبد الله بالرباط يحتضن لقاء المنتخب المغربي أمام النيجر', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%85%d8%b1%d9%83%d8%a8-%d8%a7%d9%84%d8%a3%d9%85%d9%8a%d8%b1-%d9%85%d9%88%d9%84%d8%a7%d9%8a-%d8%b9%d8%a8%d8%af-%d8%a7%d9%84%d9%84%d9%87-%d8%a8%d8%a7%d9%84%d8%b1%d8%a8%d8%a7%d8%b7-%d9%8a%d8%ad%d8%aa/', 'summary': 'مركب الأمير مولاي عبد الله بالرباط يحتضن لقاء المنتخب المغربي أمام النيجر. أعلنت الجامعة الملكية المغربية لكرة القدم، اليوم الخميس، في موقعها الرسمي، أن مباراة المنتخب الوطني المغربي أمام منتخب النيجر، ستجرى يوم الجمعة 5 شتنبر 2025 بالمجمع الرياضي الأمير مولاي عبد الله بمدينة الرباط، ضمن تصفيات إفريقيا المؤهلة لنهائيات كأس العالم 2026. وأضافت الجامعة، عبر موقعها الرسمي، أن اللقاء سينطلق ابتداء من الساعة الثامنة مساء، بالمجمع الرياضي …  مركب الأمير مولاي عبد الله بالرباط يحتضن لقاء المنتخب المغربي أمام النيجر     .', 'size': 2}], 'main_title': 'بلاغ من الجامعة الملكية لكرة القدم'}, {'community_id': '6', 'articles': [{'id': '200', 'title': 'بنك المغرب يصدر قطعة نقدية تذكارية بمناسبة الذكرى 62 لميلاد صاحب الجلالة', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/226219/', 'summary': 'بنك المغرب يصدر قطعة نقدية تذكارية بمناسبة الذكرى 62 لميلاد صاحب الجلالة. أصدر بنك المغرب قطعة نقدية تذكارية فضية من فئة 250 درهما، وذلك تخليدا للذكرى الثانية والستين لميلاد صاحب الجلالة الملك محمد السادس. وأوضح بلاغ لبنك المغرب أن وجه القطعة النقدية يحمل صورة صاحب الجلالة الملك محمد السادس وعبارات “محمد السادس” و”المملكة المغربية- ⵜⴰⴳⵍⴷⵉⵜ ⵏ ⵍⵎⵖⵔⵉⴱ” بالحروف العربية وبحروف تيفيناغ مع الإشارة إلى سنة الإصدار 1447-2025.', 'size': 3}, {'id': '216', 'title': 'بنك المغرب يصدر قطعة نقدية تذكارية بمناسبة الذكرى الـ62 لميلاد الملك محمد السادس', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a8%d9%86%d9%83-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d9%8a%d8%b5%d8%af%d8%b1-%d9%82%d8%b7%d8%b9%d8%a9-%d9%86%d9%82%d8%af%d9%8a%d8%a9-%d8%aa%d8%b0%d9%83%d8%a7%d8%b1%d9%8a%d8%a9-%d8%a8%d9%85%d9%86-5/', 'summary': 'بنك المغرب يصدر قطعة نقدية تذكارية بمناسبة الذكرى الـ62 لميلاد الملك محمد السادس. أصدر بنك المغرب قطعة نقدية تذكارية فضية من فئة 250 درهما، تخليدا للذكرى الثانية والستين لميلاد الملك محمد السادس. ويحمل وجه القطعة النقدية صورة الملك محمد السادس وعبارات «محمد السادس» و «المملكة المغربية» ⵜⴰⴳⵍⴷⵉⵜ ⵏ ⵍⵎⵖⵔⵉⴱ بالحروف العربية وبحروف تيفيناغ مع الإشارة إلى سنة الإصدار 2025 – 1447. ويبرز في وسط ظهر القطعة تمثيل فني …  بنك المغرب يصدر قطعة نقدية تذكارية بمناسبة الذكرى الـ62 لميلاد الملك محمد السادس     .', 'size': 3}, {'id': '289', 'title': 'الذكرى 62 لميلاد جلالة الملك.. بنك المغرب يُصدر قطعة تذكارية فضية', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a7%d9%84%d8%b0%d9%83%d8%b1%d9%89-62-%d9%84%d9%85%d9%8a%d9%84%d8%a7%d8%af-%d8%ac%d9%84%d8%a7%d9%84%d8%a9-%d8%a7%d9%84%d9%85%d9%84%d9%83-%d8%a8%d9%86%d9%83-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8/', 'summary': 'الذكرى 62 لميلاد جلالة الملك.. بنك المغرب يُصدر قطعة تذكارية فضية. أصدر بنك المغرب قطعة نقدية تذكارية فضية من فئة 250 درهما، وذلك تخليدا للذكرى الثانية والستين لميلاد صاحب الجلالة الملك محمد السادس. وأوضح بلاغ لبنك المغرب أن وجه القطعة النقدية يحمل صورة صاحب الجلالة الملك محمد السادس وعبارات “محمد السادس” و”المملكة المغربية- ⵜⴰⴳⵍⴷⵉⵜ ⵏ ⵍⵎⵖⵔⵉⴱ” بالحروف العربية وبحروف تيفيناغ مع الإشارة إلى سنة الإصدار 1447-2025.', 'size': 3}], 'main_title': 'بنك المغرب يصدر قطعة نقدية تذكارية بمناسبة الذكرى 62 لميلاد صاحب الجلالة'}, {'community_id': '3', 'articles': [{'id': '201', 'title': 'تيكاد-9 .. إبراز رؤية ومبادرات جلالة الملك في إفريقيا', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/226217/', 'summary': 'تيكاد-9 .. إبراز رؤية ومبادرات جلالة الملك في إفريقيا. يوكوهاما (اليابان) – تم إبراز الرؤية والمبادرات الاستراتيجية لصاحب الجلالة الملك محمد السادس من أجل تحقيق التنمية والاندماج في إفريقيا، وذلك خلال القمة التاسعة لمؤتمر طوكيو الدولي حول تنمية إفريقيا (تيكاد-9)، التي تنعقد إلى غاية يوم غد الجمعة بمدينة يوكوهاما في اليابان. وفي كلمة خلال ندوة نظمت اليوم الخميس، في إطار أشغال تيكاد، قدم رئيس', 'size': 2}, {'id': '211', 'title': 'تيكاد-9.. إبراز رؤية ومبادرات الملك محمد  السادس في إفريقيا', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%aa%d9%8a%d9%83%d8%a7%d8%af-9-%d8%a5%d8%a8%d8%b1%d8%a7%d8%b2-%d8%b1%d8%a4%d9%8a%d8%a9-%d9%88%d9%85%d8%a8%d8%a7%d8%af%d8%b1%d8%a7%d8%aa-%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%85%d8%ad%d9%85%d8%af/', 'summary': 'تيكاد-9.. إبراز رؤية ومبادرات الملك محمد السادس في إفريقيا. تم إبراز الرؤية والمبادرات الاستراتيجية للملك محمد السادس من أجل تحقيق التنمية والاندماج في إفريقيا، خلال القمة التاسعة لمؤتمر طوكيو الدولي حول تنمية إفريقيا (تيكاد-9)، التي تنعقد إلى غاية يوم غدٍ الجمعة بمدينة يوكوهاما في اليابان. وفي كلمة خلال ندوة نظمت اليوم الخميس، في إطار أشغال تيكاد، قدم رئيس الوفد المغربي، سفير الملك محمد السادس باليابان، …  تيكاد-9.. إبراز رؤية ومبادرات الملك محمد السادس في إفريقيا     .', 'size': 2}], 'main_title': 'تيكاد-9 .. إبراز رؤية ومبادرات جلالة الملك في إفريقيا'}, {'community_id': '13', 'articles': [{'id': '281', 'title': 'توقيف شخص يعاني من اضطرابات عقلية بعد اعتدائه المميت على شرطي بإيموزار', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/411437.html', 'summary': 'توقيف شخص يعاني من اضطرابات عقلية بعد اعتدائه المميت على شرطي بإيموزار. أوقفت عناصر الأمن الوطني بمفوضية الشرطة بمدينة إيموزار، مساء اليوم الخميس 21 غشت الجاري، شخصا يبلغ من العمر 63 سنة، تبدو عليه علامات الخلل العقلي', 'size': 2}, {'id': '384', 'title': 'توقيف شخص بإيموزار لتورطه في مقتل موظف شرطة', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%aa%d9%88%d9%82%d9%8a%d9%81-%d8%b4%d8%ae%d8%b5-%d8%a8%d8%a5%d9%8a%d9%85%d9%88%d8%b2%d8%a7%d8%b1-%d9%84%d8%aa%d9%88%d8%b1%d8%b7%d9%87-%d9%81%d9%8a-%d9%85%d9%82%d8%aa%d9%84-%d9%85%d9%88%d8%b8%d9%81/', 'summary': 'توقيف شخص بإيموزار لتورطه في مقتل موظف شرطة. أوقفت عناصر الأمن الوطني بمفوضية الشرطة بمدينة إيموزار، مساء اليوم الخميس 21 غشت الجاري، شخصا يبلغ من العمر 63 سنة، تبدو عليه علامات الخلل العقلي والاندفاع الشديد، وذلك بعدما تورط في الاعتداء الجسدي على موظف شرطة باستخدام السلاح الأبيض، مما أفضى إلى وفاته. وكشفت مصادر أمنية، أنه حسب المعلومات الأولية للبحث، فقد أقدم …  توقيف شخص بإيموزار لتورطه في مقتل موظف شرطة     .', 'size': 2}], 'main_title': 'توقيف شخص يعاني من اضطرابات عقلية بعد اعتدائه المميت على شرطي بإيموزار'}, {'community_id': '2', 'articles': [{'id': '283', 'title': 'فرنسا تنشر  رسميا إعلان تعليق اتفاقية الإعفاء من التأشيرة مع الجزائر', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/world/411439.html', 'summary': 'فرنسا تنشر رسميا إعلان تعليق اتفاقية الإعفاء من التأشيرة مع الجزائر. نشرت الجريدة الرسمية الفرنسية إشعارًا يُعلن عن تعليق الاتفاق المبرم بين فرنسا والجزائر والمتعلق بإعفاء حاملي الجوازات الدبلوماسية وجوازات الخدمة من تأشيرات الإقامة القصيرة. وأوضحت الجريدة', 'size': 2}, {'id': '387', 'title': 'الجريدة الرسمية الفرنسية تنشر إعلان تعليق باريس لاتفاقية الإعفاء من التأشيرة مع الجزائر', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d8%ac%d8%b1%d9%8a%d8%af%d8%a9-%d8%a7%d9%84%d8%b1%d8%b3%d9%85%d9%8a%d8%a9-%d8%a7%d9%84%d9%81%d8%b1%d9%86%d8%b3%d9%8a%d8%a9-%d8%aa%d9%86%d8%b4%d8%b1-%d8%a5%d8%b9%d9%84%d8%a7%d9%86-%d8%aa/', 'summary': 'الجريدة الرسمية الفرنسية تنشر إعلان تعليق باريس لاتفاقية الإعفاء من التأشيرة مع الجزائر. نشرت الجريدة الرسمية الفرنسية، إشعارا يعلن تعليق الاتفاق المبرم بين فرنسا والجزائر، والمتعلق بإعفاء حاملي الجوازات الدبلوماسية وجوازات الخدمة من تأشيرات الإقامة القصيرة. وأوضحت الجريدة الرسمية، أن الجمهورية الجزائرية الديمقراطية الشعبية، توقفت اعتبارًا من 11 ماي 2025، عن تطبيق الاتفاقية المبرمة بين حكومة الجمهورية الفرنسية وحكومة الجمهورية الجزائرية الديمقراطية الشعبية، بشأن الإعفاء من …  الجريدة الرسمية الفرنسية تنشر إعلان تعليق باريس لاتفاقية الإعفاء من التأشيرة مع الجزائر     .', 'size': 2}], 'main_title': 'فرنسا تنشر  رسميا إعلان تعليق اتفاقية الإعفاء من التأشيرة مع الجزائر'}, {'community_id': '12', 'articles': [{'id': '302', 'title': 'مختل يطعن شرطي مرور ويرديه قتيلا  بايموزار كندر', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/321488/', 'summary': 'مختل يطعن شرطي مرور ويرديه قتيلا بايموزار كندر. أوقفت عناصر الأمن الوطني بمفوضية الشرطة بمدينة إيموزار، مساء اليوم الخميس 21 غشت الجاري، شخصا يبلغ من العمر 63 سنة، تبدو عليه علامات الخلل العقلي والاندفاع الشديد، وذلك بعدما تورط في الاعتداء الجسدي على موظف شرطة باستخدام السلاح الأبيض، مما أفضى إلى وفاته. وحسب المعلومات الأولية للبحث، فقد أقدم المشتبه به الذي كان في وضعية', 'size': 2}, {'id': '379', 'title': 'عاجل.. مختل عقليا يُنهي حياة رجل أمن في إيموزار بسكين وقرار إنساني من السيد حموشي', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/226233/', 'summary': 'عاجل.. مختل عقليا يُنهي حياة رجل أمن في إيموزار بسكين وقرار إنساني من السيد حموشي. أوقفت عناصر الأمن الوطني بمفوضية الشرطة بمدينة إيموزار، مساء اليوم الخميس 21 غشت الجاري، شخصا يبلغ من العمر 63 سنة، تبدو عليه علامات الخلل العقلي والاندفاع الشديد، وذلك بعدما تورط في الاعتداء الجسدي على موظف شرطة باستخدام السلاح الأبيض، مما أفضى إلى وفاته. وحسب المعلومات الأولية للبحث، فقد أقدم المشتبه به الذي كان في وضعية', 'size': 2}], 'main_title': 'مختل يطعن شرطي مرور ويرديه قتيلا  بايموزار كندر'}, {'community_id': '7', 'articles': [{'id': '344', 'title': 'ملك إسبانيا يهنئ جلالة الملك بعيد الشباب', 'source': 'rue20.com', 'link': 'https://rue20.com/930393.html', 'summary': 'ملك إسبانيا يهنئ جلالة الملك بعيد الشباب. . الرباط توصل صاحب الجلالة الملك محمد السادس ببرقية تهنئة من عاهل المملكة الإسبانية، الملك فيليبي السادس، وذلك بمناسبة عيد الشباب. وأعرب العاهل الإسباني، في هذه البرقية، عن أحر التهاني لأخيه جلالة الملك، معبرا باسم الملكة وباسمه، عن أصدق متمنياته بالرفاه ودوام السعادة لجلالة الملك ولجميع أفراد الأسرة الملكية الشريفة. كما جدد العاهل الإسباني، الخبر ملك إسبانيا يهنئ جلالة الملك بعيد الشباب  .', 'size': 2}, {'id': '380', 'title': 'رؤساء وقادة العالم يهنئون جلالة الملك بعيد الشباب', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/226231/', 'summary': 'رؤساء وقادة العالم يهنئون جلالة الملك بعيد الشباب. برقية تهنئة إلى جلالة الملك من العاهل الإسباني بمناسبة عيد الشباب الرباط – توصل صاحب الجلالة الملك محمد السادس ببرقية تهنئة من عاهل المملكة الإسبانية، الملك فيليبي السادس، وذلك بمناسبة عيد الشباب. وأعرب العاهل الإسباني، في هذه البرقية، عن أحر التهاني لأخيه جلالة الملك، معبرا باسم الملكة وباسمه، عن أصدق متمنياته بالرفاه ودوام السعادة لجلالة', 'size': 2}], 'main_title': 'ملك إسبانيا يهنئ جلالة الملك بعيد الشباب'}, {'community_id': '8', 'articles': [{'id': '355', 'title': 'وزارة النقل: إرجاء العمل بالمسطرة الموحدة لتأطير عمليات مراقبة مطابقة الدراجات بمحرك', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/473322.html', 'summary': 'وزارة النقل: إرجاء العمل بالمسطرة الموحدة لتأطير عمليات مراقبة مطابقة الدراجات بمحرك. أعلنت وزارة النقل واللوجيستيك أنها قررت إرجاء العمل بالمسطرة الموحدة لتأطير عمليات مراقبة مطابقة الدراجات بمحرك باستعمال جهاز قياس السرعة (peedomètre). وأنهت الوزارة، في بلاغ لها اليوم الخميس، إلى علم عموم المواطنين أنها قررت إرجاء العمل بمضامين المذكرة الموجهة من طرف الوكالة الوطنية للسلامة الطرقية إلى المديرية العامة للأمن الوطني بتاريخ 6 غشت 2025، والمتعلقة …', 'size': 2}, {'id': '388', 'title': 'وزارة النقل تؤجل العمل بمذكرة مراقبة سرعة الدراجات النارية وتعلن عن إجراءات بديلة لتعزيز السلامة الطرقية', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%88%d8%b2%d8%a7%d8%b1%d8%a9-%d8%a7%d9%84%d9%86%d9%82%d9%84-%d8%aa%d8%a4%d8%ac%d9%84-%d8%a7%d9%84%d8%b9%d9%85%d9%84-%d8%a8%d9%85%d8%b0%d9%83%d8%b1%d8%a9-%d9%85%d8%b1%d8%a7%d9%82%d8%a8%d8%a9-%d8%b3/', 'summary': 'وزارة النقل تؤجل العمل بمذكرة مراقبة سرعة الدراجات النارية وتعلن عن إجراءات بديلة لتعزيز السلامة الطرقية. أعلنت وزارة النقل واللوجيستيك أنها قررت إرجاء العمل بالمسطرة الموحدة لتأطير عمليات مراقبة مطابقة الدراجات بمحرك باستعمال جهاز قياس السرعة (peedomètre). وأنهت الوزارة، في بلاغ لها اليوم الخميس، إلى علم عموم المواطنين أنها قررت إرجاء العمل بمضامين المذكرة الموجهة من طرف الوكالة الوطنية للسلامة الطرقية إلى المديرية العامة للأمن الوطني بتاريخ 6 غشت …  وزارة النقل تؤجل العمل بمذكرة مراقبة سرعة الدراجات النارية وتعلن عن إجراءات بديلة لتعزيز السلامة الطرقية     .', 'size': 2}], 'main_title': 'وزارة النقل: إرجاء العمل بالمسطرة الموحدة لتأطير عمليات مراقبة مطابقة الدراجات بمحرك'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    