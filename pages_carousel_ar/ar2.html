<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 02/07/2025 - 18h28</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '4', 'articles': [{'id': '12', 'title': 'وفاة أحد أفراد “خلية شمهروش” داخل سجن العرائش', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-636215.html', 'summary': 'وفاة أحد أفراد “خلية شمهروش” داخل سجن العرائش. هبة بريس أعلنت إدارة السجن المحلي بالعرائش، يومه الأربعاء, عن وفاة السجين (ي.أ)، المعتقل على خلفية قانون مكافحة الإرهاب ضمن ما عرف بـ”خلية شمهروش”. وذكرت إدارة السجن، أن السجين توفي مساء يوم أمس الثلاثاء فاتح يوليوز، وذلك داخل غرفته الانفرادية بالمؤسسة. وأفادت الادارة, أن السجين المتوفى كان يعاني من اضطرابات نفسية، حيث كان يخضع للمتابعة الطبية ويتلقى الأدوية المناسبة لحالته, مشيرة الى أنه قبل وفاته بساعات، تم عرضه على طبيبة المؤسسة بسبب معاناته من نزلة برد. وأكد البلاغ، أنه تم إبلاغ النيابة العامة المختصة وفقا لما ينص عليه القانون، والتي أوفدت عناصر من الدرك الملكي لمعاينة الجثة بحضور طبيبة المؤسسة، كما تم إبلاغ عائلة المعني بالأمر بالوفاة.', 'size': 2}, {'id': '111', 'title': 'وفاة أحد أفراد "خلية شمهروش" داخل السجن المحلي بالعرائش', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/408579.html', 'summary': 'وفاة أحد أفراد "خلية شمهروش" داخل السجن المحلي بالعرائش. أعلنت إدارة السجن المحلي بالعرائش عن وفاة السجين (ي.أ)، المعتقل على خلفية قانون مكافحة الإرهاب ضمن ما عرف بـ"خلية شمهروش"، مساء أمس الثلاثاء ، وذلك', 'size': 3}, {'id': '151', 'title': 'وفاة أحد معتقلي “خلية شمهروش” داخل زنزانته الانفرادية بسجن العرائش', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1082416.html', 'summary': 'وفاة أحد معتقلي “خلية شمهروش” داخل زنزانته الانفرادية بسجن العرائش. أعلنت إدارة السجن المحلي بالعرائش عن وفاة السجين (ي.أ)، المعتقل على خلفية قانون مكافحة الإرهاب ضمن ما يعرف بـ”خلية شمهروش”، وذلك مساء الثلاثاء فاتح يوليوز 2025، داخل غرفته الانفرادية. وأوضحت إدارة المؤسسة أن المعني بالأمر كان يعاني من اضطرابات نفسية، حيث كان يخضع لمتابعة طبية ويتلقى الأدوية المناسبة لحالته، مضيفة أنه تم عرضه على طبيبة ظهرت المقالة وفاة أحد معتقلي “خلية شمهروش” داخل زنزانته الانفرادية بسجن العرائش  .', 'size': 4}, {'id': '165', 'title': 'وفاة أحد المتوطين في جريمة "خلية شمهروش" داخل زنزانته', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%88%d9%81%d8%a7%d8%a9-%d8%a3%d8%ad%d8%af-%d8%a7%d9%84%d9%85%d8%aa%d9%88%d8%b7%d9%8a%d9%86-%d9%81%d9%8a-%d8%ac%d8%b1%d9%8a%d9%85%d8%a9-%d8%ae%d9%84%d9%8a%d8%a9-%d8%b4%d9%85%d9%87%d8%b1%d9%88%d8%b4/', 'summary': 'وفاة أحد المتوطين في جريمة "خلية شمهروش" داخل زنزانته. أعلنت إدارة السجن المحلي بالعرائش عن وفاة السجين (ي.أ)، المعتقل على خلفية قانون مكافحة الإرهاب ضمن ما عرف بـ"خلية شمهروش"، مساء أمس الثلاثاء ، وذلك داخل غرفته الانفرادية بالمؤسسة. وذكر بلاغ للمؤسسة السجنية أن " السجين المتوفى كان يعاني من اضطرابات نفسية، حيث كان يخضع للمتابعة الطبية ويتلقى الأدوية المناسبة لحالته"، مشيرا إلى أنه تم،  وفاة أحد المتوطين في جريمة "خلية شمهروش" داخل زنزانته     .', 'size': 4}, {'id': '214', 'title': 'وفاة أحد معتقلي “خلية شمهروش” بالسجن المحلي بالعرائش', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%88%d9%81%d8%a7%d8%a9-%d8%a3%d8%ad%d8%af-%d9%85%d8%b9%d8%aa%d9%82%d9%84%d9%8a-%d8%ae%d9%84%d9%8a%d8%a9-%d8%b4%d9%85%d9%87%d8%b1%d9%88%d8%b4-%d8%a8%d8%a7%d9%84%d8%b3%d8%ac%d9%86-%d8%a7%d9%84/', 'summary': 'وفاة أحد معتقلي “خلية شمهروش” بالسجن المحلي بالعرائش. أعلنت إدارة السجن المحلي بالعرائش عن وفاة السجين (ي.أ)، المعتقل على خلفية قانون مكافحة الإرهاب ضمن ما عرف بـ”خلية شمهروش”، مساء يوم أمس الثلاثاء فاتح يوليوز، وذلك داخل غرفته الانفرادية بالمؤسسة. وأوضح بلاغ إدارة المؤسسة السجنية، أن السجين المتوفى كان يعاني من اضطرابات نفسية، حيث كان يخضع للمتابعة الطبية ويتلقى الأدوية المناسبة لحالته، …  وفاة أحد معتقلي “خلية شمهروش” بالسجن المحلي بالعرائش     .', 'size': 4}], 'main_title': 'وفاة أحد معتقلي “خلية شمهروش” داخل زنزانته الانفرادية بسجن العرائش'}, {'community_id': '1', 'articles': [{'id': '67', 'title': 'تفكيك خلية إرهابية موالية لما يسمى بتنظيم “الدولة الإسلامية” تنشط بين تطوان وشفشاون', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/202832', 'summary': 'تفكيك خلية إرهابية موالية لما يسمى بتنظيم “الدولة الإسلامية” تنشط بين تطوان وشفشاون. الاحداث✍️ في إطار العمليات الأمنية الإستباقية الرامية لتحييد مخاطر التهديد الإرهابي وإجهاض المخططات التخريبية التي تحدق بأمن واستقرار المملكة وتهدف للمس الخطير بالنظام العام، تمكن المكتب المركزي للأبحاث القضائية التابع للمديرية العامة لمراقبة التراب الوطني، في الساعات الأولى من صباح اليوم الأربعاء، من تفكيك خلية إرهابية موالية لما يسمى بتنظيم “الدولة الإسلامية”، تتكون من أربعة', 'size': 3}, {'id': '123', 'title': 'تنشط بين تطوان وشفشاون.. تفكيك خلية إرهابية موالية لـ”داعش”', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%aa%d9%86%d8%b4%d8%b7-%d8%a8%d9%8a%d9%86-%d8%aa%d8%b7%d9%88%d8%a7%d9%86-%d9%88%d8%b4%d9%81%d8%b4%d8%a7%d9%88%d9%86-%d8%aa%d9%81%d9%83%d9%8a%d9%83-%d8%ae%d9%84%d9%8a%d8%a9-%d8%a5%d8%b1%d9%87%d8%a7/', 'summary': 'تنشط بين تطوان وشفشاون.. تفكيك خلية إرهابية موالية لـ”داعش”. في إطار العمليات الأمنية الإستباقية الرامية لتحييد مخاطر التهديد الإرهابي وإجهاض المخططات التخريبية التي تحدق بأمن واستقرار المملكة وتهدف للمس الخطير بالنظام العام، تمكن المكتب المركزي للأبحاث القضائية التابع للمديرية العامة لمراقبة التراب الوطني، في الساعات الأولى من صباح اليوم الأربعاء (2 يوليوز)، من تفكيك خلية إرهابية موالية لما يسمى بتنظيم “الدولة الإسلامية”، تتكون من', 'size': 4}, {'id': '200', 'title': 'تفكيك خلية إرهابية موالية لـ“الدولة الإسلامية” بين تطوان وشفشاون', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/223893/', 'summary': 'تفكيك خلية إرهابية موالية لـ“الدولة الإسلامية” بين تطوان وشفشاون. في إطار العمليات الأمنية الإستباقية الرامية لتحييد مخاطر التهديد الإرهابي وإجهاض المخططات التخريبية التي تحدق بأمن واستقرار المملكة وتهدف للمس الخطير بالنظام العام، تمكن المكتب المركزي للأبحاث القضائية التابع للمديرية العامة لمراقبة التراب الوطني، في الساعات الأولى من صباح اليوم الأربعاء، من تفكيك خلية إرهابية موالية لما يسمى بتنظيم “الدولة الإسلامية”، تتكون من أربعة متطرفين', 'size': 3}, {'id': '218', 'title': 'الأمن المغربي يوجه ضربة استباقية قوية لتنظيم داعش ويُفكك خلية إرهابية خطيرة بين تطوان وشفشاون', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d8%a3%d9%85%d9%86-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8%d9%8a-%d9%8a%d9%88%d8%ac%d9%87-%d8%b6%d8%b1%d8%a8%d8%a9-%d8%a7%d8%b3%d8%aa%d8%a8%d8%a7%d9%82%d9%8a%d8%a9-%d9%82%d9%88%d9%8a%d8%a9/', 'summary': 'الأمن المغربي يوجه ضربة استباقية قوية لتنظيم داعش ويُفكك خلية إرهابية خطيرة بين تطوان وشفشاون. في إطار العمليات الأمنية الإستباقية الرامية لتحييد مخاطر التهديد الإرهابي وإجهاض المخططات التخريبية التي تحدق بأمن واستقرار المملكة وتهدف للمس الخطير بالنظام العام، تمكن المكتب المركزي للأبحاث القضائية التابع للمديرية العامة لمراقبة التراب الوطني، في الساعات الأولى من صباح اليوم الأربعاء، من تفكيك خلية إرهابية موالية لما يسمى بتنظيم “الدولة الإسلامية”، تتكون من …  الأمن المغربي يوجه ضربة استباقية قوية لتنظيم داعش ويُفكك خلية إرهابية خطيرة بين تطوان وشفشاون     .', 'size': 2}], 'main_title': 'تنشط بين تطوان وشفشاون.. تفكيك خلية إرهابية موالية لـ”داعش”'}, {'community_id': '3', 'articles': [{'id': '74', 'title': 'حموشي يستقبل رئيس جهاز الاستخبارات الوطني لدولة الإمارات العربية المتحدة', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/national/408537.html', 'summary': 'حموشي يستقبل رئيس جهاز الاستخبارات الوطني لدولة الإمارات العربية المتحدة. استقبل المدير العام للأمن الوطني ولمراقبة التراب الوطني عبد اللطيف حموشي، اليوم الثلاثاء بالرباط، علي عبيد الظاهري رئيس جهاز الاستخبارات الوطني لدولة الإمارات العربية المتحدة', 'size': 2}, {'id': '212', 'title': 'حموشي يستقبل رئيس جهاز الاستخبارات بالإمارات العربية المتحدة', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%ad%d9%85%d9%88%d8%b4%d9%8a-%d9%8a%d8%b3%d8%aa%d9%82%d8%a8%d9%84-%d8%b1%d8%a6%d9%8a%d8%b3-%d8%ac%d9%87%d8%a7%d8%b2-%d8%a7%d9%84%d8%a7%d8%b3%d8%aa%d8%ae%d8%a8%d8%a7%d8%b1%d8%a7%d8%aa-%d8%a8%d8%a7/', 'summary': 'حموشي يستقبل رئيس جهاز الاستخبارات بالإمارات العربية المتحدة. المساء اليوم: استقبل المدير العام للأمن الوطني ولمراقبة التراب الوطني, عبد اللطيف حموشي، اليوم الثلاثاء بالرباط، علي عبيد الظاهري رئيس جهاز الاستخبارات الوطني لدولة الإمارات العربية المتحدة. وأوضح بيان لقطب المديرية العامة للأمن الوطني والمديرية', 'size': 2}], 'main_title': 'حموشي يستقبل رئيس جهاز الاستخبارات الوطني لدولة الإمارات العربية المتحدة'}, {'community_id': '2', 'articles': [{'id': '82', 'title': 'بسبب تصريحه عن الأراضي المغربية.. الجزائر تُدين بوعلام صنصال بالسجن 5 سنوات', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/world/408546.html', 'summary': 'بسبب تصريحه عن الأراضي المغربية.. الجزائر تُدين بوعلام صنصال بالسجن 5 سنوات. في خطوة جديدة تُعمّق التوتر بين حرية التعبير والسلطة القضائية في الجزائر، أيدت محكمة الاستئناف الجزائرية، الثلاثاء، الحكم الصادر في حق الكاتب الفرنسي الجزائري بوعلام', 'size': 2}, {'id': '210', 'title': 'محكمة جزائرية تدين الكاتب بوعلام صنصال بخمس سنوات سجنا', 'source': 'almassaa.com', 'link': 'https://almassaa.com/110946-2/', 'summary': 'محكمة جزائرية تدين الكاتب بوعلام صنصال بخمس سنوات سجنا. المساء اليوم: ثبتت محكمة استئناف في العاصمة الجزائرية اليوم الثلاثاء (الأول من يوليو 2025) عقوبة بالسجن خمس (5) سنوات بحق الكاتب الفرنسي الجزائري بوعلام صنصال لاتهامه بـ”المساس بوحدة الوطن”. وتحدثت رئيسة المحكمة بالفرنسية إلى صنصال،', 'size': 2}], 'main_title': 'بسبب تصريحه عن الأراضي المغربية.. الجزائر تُدين بوعلام صنصال بالسجن 5 سنوات'}, {'community_id': '6', 'articles': [{'id': '124', 'title': 'وفد اقتصادي سعودي يحل بالرباط.. المغرب والسعودية عازمان على توطيد التعاون الاقتصادي', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%88%d9%81%d8%af-%d8%a7%d9%82%d8%aa%d8%b5%d8%a7%d8%af%d9%8a-%d8%b3%d8%b9%d9%88%d8%af%d9%8a-%d9%8a%d8%ad%d9%84-%d8%a8%d8%a7%d9%84%d8%b1%d8%a8%d8%a7%d8%b7-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d9%88/', 'summary': 'وفد اقتصادي سعودي يحل بالرباط.. المغرب والسعودية عازمان على توطيد التعاون الاقتصادي. استقبل وزير الصناعة والتجارة، رياض مزور، اليوم الثلاثاء (1 يوليوز) بالرباط، وفدا اقتصاديا سعوديا هاما يقوده رئيس اتحاد غرف التجارة السعودية، حسن بن معجب الحويزي، في زيارة استكشافية تروم توطيد العلاقات الاقتصادية الثنائية وبحث آفاق جديدة للاستثمار بالمغرب. ويهدف هذا اللقاء، الذي يندرج في إطار تعزيز وتقوية العلاقات الثنائية بين المغرب والسعودية، إلى بحث السبل', 'size': 2}, {'id': '195', 'title': 'المغرب والسعودية عازمان على توطيد التعاون الاقتصادي', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/223914/', 'summary': 'المغرب والسعودية عازمان على توطيد التعاون الاقتصادي. و م ع استقبل وزير الصناعة والتجارة، رياض مزور، أمس الثلاثاء بالرباط، وفدا اقتصاديا سعوديا هاما يقوده رئيس اتحاد غرف التجارة السعودية، حسن بن معجب الحويزي، في زيارة استكشافية تروم توطيد العلاقات الاقتصادية الثنائية وبحث آفاق جديدة للاستثمار بالمغرب. ويهدف هذا اللقاء، الذي يندرج في إطار تعزيز وتقوية العلاقات الثنائية بين المغرب والسعودية، إلى', 'size': 2}], 'main_title': 'وفد اقتصادي سعودي يحل بالرباط.. المغرب والسعودية عازمان على توطيد التعاون الاقتصادي'}, {'community_id': '0', 'articles': [{'id': '144', 'title': 'توقعات طقس اليوم الأربعاء', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/317162/', 'summary': 'توقعات طقس اليوم الأربعاء. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الأربعاء، أن تتميز الحالة الجوية عامة باستمرار الطقس الحار بالمناطق الداخلية غرب الأطلس، والجنوب الشرقي للبلاد وداخل الأقاليم الصحراوية للمملكة. ومن المرتقب أن تتكون كتل ضبابية محلية بالواجهة المتوسطية، والسواحل الشمالية والوسطى، والشمال الغربي للأقاليم الجنوبية، فضلا عن نزول قطرات مطرية، أو زخات رعدية محلية بالأطلس و السفوح', 'size': 5}, {'id': '170', 'title': 'استمرار الطقس الحار اليوم الأربعاء', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a7%d8%b3%d8%aa%d9%85%d8%b1%d8%a7%d8%b1-%d8%a7%d9%84%d8%b7%d9%82%d8%b3-%d8%a7%d9%84%d8%ad%d8%a7%d8%b1-%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%a3%d8%b1%d8%a8%d8%b9%d8%a7%d8%a1-3/', 'summary': 'استمرار الطقس الحار اليوم الأربعاء. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الأربعاء، أن تتميز الحالة الجوية عامة باستمرار الطقس الحار بالمناطق الداخلية غرب الأطلس، والجنوب الشرقي للبلاد وداخل الأقاليم الصحراوية للمملكة. ومن المرتقب أن تتكون كتل ضبابية محلية بالواجهة المتوسطية، والسواحل الشمالية والوسطى، والشمال الغربي للأقاليم الجنوبية، فضلا عن نزول قطرات مطرية، أو زخات رعدية محلية بالأطلس، والسفوح الجنوبية  استمرار الطقس الحار اليوم الأربعاء     .', 'size': 5}, {'id': '199', 'title': 'طقس الأربعاء.. استمرار حرارة الجو مع قطرات مطرية في بعض المناطق', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/223898/', 'summary': 'طقس الأربعاء.. استمرار حرارة الجو مع قطرات مطرية في بعض المناطق. كواليس اليوم تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الأربعاء، أن تتميز الحالة الجوية عامة باستمرار الطقس الحار بالمناطق الداخلية غرب الأطلس، والجنوب الشرقي للبلاد وداخل الأقاليم الصحراوية للمملكة. ومن المرتقب أن تتكون كتل ضبابية محلية بالواجهة المتوسطية، والسواحل الشمالية والوسطى، والشمال الغربي للأقاليم الجنوبية، فضلا عن نزول قطرات مطرية، أو زخات رعدية محلية', 'size': 5}, {'id': '206', 'title': 'طقس الأربعاء: استمرار موجة الحرارة.. ورياح قوية بالشمال والجنوب', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%b7%d9%82%d8%b3-%d8%a7%d9%84%d8%a3%d8%b1%d8%a8%d8%b9%d8%a7%d8%a1-%d8%a7%d8%b3%d8%aa%d9%85%d8%b1%d8%a7%d8%b1-%d9%85%d9%88%d8%ac%d8%a9-%d8%a7%d9%84%d8%ad%d8%b1%d8%a7%d8%b1%d8%a9-%d9%88%d8%b1%d9%8a/', 'summary': 'طقس الأربعاء: استمرار موجة الحرارة.. ورياح قوية بالشمال والجنوب. المساء اليوم: تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الأربعاء، أن تتميز الحالة الجوية عامة باستمرار الطقس الحار بالمناطق الداخلية غرب الأطلس، والجنوب الشرقي للبلاد وداخل الأقاليم الصحراوية للمملكة. ومن المرتقب أن تتكون كتل ضبابية', 'size': 5}, {'id': '221', 'title': 'توقعات أحوال الطقس اليوم الأربعاء', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%aa%d9%88%d9%82%d8%b9%d8%a7%d8%aa-%d8%a3%d8%ad%d9%88%d8%a7%d9%84-%d8%a7%d9%84%d8%b7%d9%82%d8%b3-%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%a3%d8%b1%d8%a8%d8%b9%d8%a7%d8%a1-26/', 'summary': 'توقعات أحوال الطقس اليوم الأربعاء. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليومه الأربعاء، أن تتميز الحالة الجوية عامة باستمرار الطقس الحار بالمناطق الداخلية غرب الأطلس، والجنوب الشرقي للبلاد وداخل الأقاليم الصحراوية للمملكة. ومن المرتقب أن تتكون كتل ضبابية محلية بالواجهة المتوسطية، والسواحل الشمالية والوسطى، والشمال الغربي للأقاليم الجنوبية، فضلا عن نزول قطرات مطرية، أو زخات رعدية محلية بالأطلس، …  توقعات أحوال الطقس اليوم الأربعاء     .', 'size': 5}], 'main_title': 'توقعات طقس اليوم الأربعاء'}, {'community_id': '8', 'articles': [{'id': '250', 'title': 'التوفيق يعلن بدء استخلاص مبلغ الحج', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d8%a7%d9%84%d8%aa%d9%88%d9%81%d9%8a%d9%82-%d9%8a%d8%b9%d9%84%d9%86-%d8%a8%d8%af%d8%a1-%d8%a7%d8%b3%d8%aa%d8%ae%d9%84%d8%a7%d8%b5-%d9%85%d8%a8%d9%84%d8%ba-%d8%a7%d9%84%d8%ad%d8%ac-1585896.html', 'summary': 'التوفيق يعلن بدء استخلاص مبلغ الحج. أعلن وزير الأوقاف والشؤون الإسلامية، أحمد التوفيق، اليوم الأربعاء بالرباط، أنه سيتم استخلاص المبلغ الجزافي عن مصاريف الحج، المحدد في 65 ألف درهم، في الفترة من 21 يوليوز إلى 08 غشت 2025، على أن يتم لاحقا تحديد الكلفة النهائية للحج، إما بالزيادة أو بالنقصان. وقال التوفيق، خلال اجتماع اللجنة الملكية للحج لموسم 1447هـ: “من أجل  التوفيق يعلن بدء استخلاص مبلغ الحج     - هسبريس جريدة إلكترونية مغربية .', 'size': 2}, {'id': '361', 'title': 'وزارة الأوقاف تكشف موعد استخلاص المبلغ الجزافي عن مصاريف حج 1447 هـ', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/468299.html', 'summary': 'وزارة الأوقاف تكشف موعد استخلاص المبلغ الجزافي عن مصاريف حج 1447 هـ. أعلن وزير الأوقاف والشؤون الإسلامية، أحمد التوفيق، اليوم الأربعاء بالرباط، أنه سيتم استخلاص المبلغ الجزافي عن مصاريف الحج والمحدد في 65 ألف درهم، في الفترة من 21 يوليوز إلى 08 غشت 2025، على أن يتم لاحقا تحديد الكلفة النهائية للحج، إما بالزيادة أو بالنقصان.', 'size': 3}, {'id': '379', 'title': 'وزارة الأوقاف تكشف عن موعد استخلاص مصاريف الحج', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d9%88%d8%b2%d8%a7%d8%b1%d8%a9-%d8%a7%d9%84%d8%a3%d9%88%d9%82%d8%a7%d9%81-%d8%aa%d9%83%d8%b4%d9%81-%d8%b9%d9%86-%d9%85%d9%88%d8%b9%d8%af-%d8%a7%d8%b3%d8%aa%d8%ae%d9%84%d8%a7%d8%b5-%d9%85%d8%b5%d8%a7/', 'summary': 'وزارة الأوقاف تكشف عن موعد استخلاص مصاريف الحج. -متابعات أعلن وزير الأوقاف والشؤون الإسلامية، أحمد التوفيق، اليوم الأربعاء بالرباط، أنه سيتم استخلاص المبلغ الجزافي عن مصاريف الحج والمحدد في 65 ألف درهم، في الفترة من 21 يوليوز...  وزارة الأوقاف تكشف عن موعد استخلاص مصاريف الحج     .', 'size': 2}], 'main_title': 'وزارة الأوقاف تكشف موعد استخلاص المبلغ الجزافي عن مصاريف حج 1447 هـ'}, {'community_id': '5', 'articles': [{'id': '298', 'title': 'عصابة الحسابات البنكية تسقط في قبضة أمن جرسيف', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/408598.html', 'summary': 'عصابة الحسابات البنكية تسقط في قبضة أمن جرسيف. تمكنت عناصر الشرطة بالمنطقة الإقليمية للأمن بمدينة جرسيف بتنسيق مع مصالح المديرية العامة لمراقبة التراب الوطني، صباح اليوم الأربعاء 2 يوليوز الجاري، من توقيف سبعة', 'size': 2}, {'id': '385', 'title': 'جرسيف.. توقيف 7 أشخاص يشتبه تورطهم في النصب وانتحال صفات', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/223942/', 'summary': 'جرسيف.. توقيف 7 أشخاص يشتبه تورطهم في النصب وانتحال صفات. كواليس اليوم تمكنت عناصر الشرطة بالمنطقة الإقليمية للأمن بمدينة جرسيف بتنسيق مع مصالح المديرية العامة لمراقبة التراب الوطني، صباح اليوم الأربعاء 2 يوليوز الجاري، من توقيف سبعة أشخاص يشتبه في تورطهم في قضية تتعلق بالنصب والاحتيال وانتحال صفات ينظمها القانون. وحسب المعطيات الأولية للبحث، فقد كان المشتبه فيهم يتصلون هاتفيا بالضحايا، وينتحلون صفات موظفين', 'size': 2}], 'main_title': 'عصابة الحسابات البنكية تسقط في قبضة أمن جرسيف'}, {'community_id': '9', 'articles': [{'id': '327', 'title': 'نشرة إنذارية تحذر من موجة حر وزخات رعدية قوية بهاته المناطق', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1082470.html', 'summary': 'نشرة إنذارية تحذر من موجة حر وزخات رعدية قوية بهاته المناطق. تتوقع المديرية العامة للأرصاد الجوية تسجيل موجة حر مع الشركي من الأربعاء إلى السبت، وكذا زخات رعدية قوية مع تساقط محلي للبرد وهبات رياح غدا الأربعاء، بعدد من مناطق المملكة. وأوضحت المديرية في نشرة إنذارية من مستوى يقظة برتقالي، أنه يرتقب تسجيل درجات حرارة تتراوح ما بين 43 و46 درجة من يوم الأربعاء إلى يوم ظهرت المقالة نشرة إنذارية تحذر من موجة حر وزخات رعدية قوية بهاته المناطق  .', 'size': 2}, {'id': '399', 'title': 'نشرة إنذارية.. موجة حر مع الشركي وزخات قوية مرتقبة بالمملكة', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%86%d8%b4%d8%b1%d8%a9-%d8%a5%d9%86%d8%b0%d8%a7%d8%b1%d9%8a%d8%a9-%d9%85%d9%88%d8%ac%d8%a9-%d8%ad%d8%b1-%d9%85%d8%b9-%d8%a7%d9%84%d8%b4%d8%b1%d9%83%d9%8a-%d9%88%d8%b2%d8%ae%d8%a7%d8%aa-%d9%82/', 'summary': 'نشرة إنذارية.. موجة حر مع الشركي وزخات قوية مرتقبة بالمملكة. تتوقع المديرية العامة للأرصاد الجوية تسجيل موجة حر مع الشركي من الأربعاء إلى السبت، وكذا زخات رعدية قوية مع تساقط محلي للبرد وهبات رياح غدا الأربعاء، بعدد من مناطق المملكة. وأوضحت المديرية في نشرة إنذارية من مستوى يقظة برتقالي، أنه يرتقب تسجيل درجات حرارة تتراوح ما بين 43 و46 درجة من يوم الأربعاء …  نشرة إنذارية.. موجة حر مع الشركي وزخات قوية مرتقبة بالمملكة     .', 'size': 2}], 'main_title': 'نشرة إنذارية تحذر من موجة حر وزخات رعدية قوية بهاته المناطق'}, {'community_id': '7', 'articles': [{'id': '328', 'title': 'بحث وطني: 87 % من المستفيدين راضون عن الدعم المباشر.. والولوج لا يزال معقدا', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1082404.html', 'summary': 'بحث وطني: 87 % من المستفيدين راضون عن الدعم المباشر.. والولوج لا يزال معقدا. كشف بحث ميداني أنجزه المرصد الوطني للتنمية البشرية عن تحقيق نسبة رضا مرتفعة بلغت 87,46% في صفوف المستفيدين من برنامج الدعم الاجتماعي المباشر خلال الفصل الأول من تنفيذه، مع دعوات ملحّة إلى اعتماد آليات مناسبة لتحيين معايير أهلية المستفيدين بشكل فوري، بما يضمن ملاءمة الدعم للتحولات الاجتماعية والاقتصادية التي تمس الأسر المعوزة. البحث، وهو الأول ظهرت المقالة بحث وطني: 87 % من المستفيدين راضون عن الدعم المباشر.. والولوج لا يزال معقدا  .', 'size': 2}, {'id': '353', 'title': 'دراسة: 87% من المغاربة راضون عن الدعم الإجتماعي المباشر', 'source': 'rue20.com', 'link': 'https://rue20.com/917582.html', 'summary': 'دراسة: 87% من المغاربة راضون عن الدعم الإجتماعي المباشر.  ا الرباط في إطار تتبع وتقييم برامج الورش الملكي للدولة الاجتماعية، أجرى المرصد الوطني للتنمية البشرية بحثاً ميدانياً هو الأول من نوعه، لقياس مستوى رضا المستفيدين من برنامج الدعم الاجتماعي المباشر، خلال الفصل الأول من تفعيله. البحث، الذي شمل عينة واسعة من الأسر المستفيدة، اطلع عليه موقع كشف عن مستوى رضا عام مرتفع الخبر دراسة: 87% من المغاربة راضون عن الدعم الإجتماعي المباشر  .', 'size': 3}, {'id': '371', 'title': 'توصيات بتحسين خدمات الدعم الاجتماعي وتحيين معايير الاستفادة', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%aa%d9%88%d8%b5%d9%8a%d8%a7%d8%aa-%d8%a8%d8%aa%d8%ad%d8%b3%d9%8a%d9%86-%d8%ae%d8%af%d9%85%d8%a7%d8%aa-%d8%a7%d9%84%d8%af%d8%b9%d9%85-%d8%a7%d9%84%d8%a7%d8%ac%d8%aa%d9%85%d8%a7%d8%b9%d9%8a-%d9%88/', 'summary': 'توصيات بتحسين خدمات الدعم الاجتماعي وتحيين معايير الاستفادة. -متابعات في إطار تتبع وتقييم برامج الورش الملكي للدولة الاجتماعية، أجرى المرصد الوطني للتنمية البشرية بحثاً ميدانياً هو الأول من نوعه، لقياس مستوى رضا المستفيدين من برنامج الدعم الاجتماعي...  توصيات بتحسين خدمات الدعم الاجتماعي وتحيين معايير الاستفادة     .', 'size': 2}], 'main_title': 'دراسة: 87% من المغاربة راضون عن الدعم الإجتماعي المباشر'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    