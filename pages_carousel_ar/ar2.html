<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 08/08/2025 - 18h27</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '3', 'articles': [{'id': '23', 'title': 'وفاة الفنان المصري سيد صادق', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-647706.html', 'summary': 'وفاة الفنان المصري سيد صادق. هبة بريس - وكالات غيب الموت اليوم الجمعة الفنان المصري سيد صادق عن عمر ناهز 80 عامًا، في وفاة مفاجئة دون معاناة من أي مرض، بحسب ما أعلن نجله السيناريست لؤي سيد صادق عبر حسابه على "فيس بوك". وكتب لؤي نجل الفنان عبر حسابه على فيسبوك: "إنّا لله وإنّا إليهِ رَاجعُون.. توفي إلى رحمة الله الراجل العظيم والدي (سيد صادق)". كما أفاد نجل الفنان أن صلاة الجنازة ستقام اليوم عقب صلاة الجمعة بمسجد الشرطة بالشيخ زايد، والدفن بمقابر الأسرة بطريق الفيوم.', 'size': 2}, {'id': '240', 'title': 'وفاة الفنان المصري سيد صادق عن عمر ناهز 80 عاما', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%88%d9%81%d8%a7%d8%a9-%d8%a7%d9%84%d9%81%d9%86%d8%a7%d9%86-%d8%a7%d9%84%d9%85%d8%b5%d8%b1%d9%8a-%d8%b3%d9%8a%d8%af-%d8%b5%d8%a7%d8%af%d9%82-%d8%b9%d9%86-%d8%b9%d9%85%d8%b1-%d9%86%d8%a7%d9%87%d8%b2/', 'summary': 'وفاة الفنان المصري سيد صادق عن عمر ناهز 80 عاما. رحل صباح اليوم الجمعة الفنان المصري سيد صادق عن عمر يناهز 80 عامًا. وأعلن نجله لؤي عبر حسابه على “فيسبوك” الخبر قائلاً: “إنّا لله وإنّا إليه راجعون.. توفي إلى رحمة الله الراجل العظيم والدي (سيد صادق)”. وأوضح أن صلاة الجنازة ستقام عقب صلاة الجمعة في مسجد الشرطة بالشيخ زايد، على أن يوارى جثمانه …  وفاة الفنان المصري سيد صادق عن عمر ناهز 80 عاما     .', 'size': 2}], 'main_title': 'وفاة الفنان المصري سيد صادق'}, {'community_id': '1', 'articles': [{'id': '185', 'title': 'الوالي أمزازي يُنهي فوضى صالونات التدليك بأكادير بعد سنوات من الإنفلات', 'source': 'rue20.com', 'link': 'https://rue20.com/927243.html', 'summary': 'الوالي أمزازي يُنهي فوضى صالونات التدليك بأكادير بعد سنوات من الإنفلات.  | متابعة في خطوة حازمة، أصدر والي جهة سوس ماسة، سعيد أمزازي، قرارا يقضي بإغلاق جميع صالونات التدليك التي تنشط خارج الإطار القانوني، أو تشتغل بدون التراخيص الرسمية اللازمة، وذلك في سياق حملة أمنية موسعة لتطهير المدينة من الأنشطة المشبوهة التي كانت تتستر وراء لافتة “التدليك”. ويأتي هذا القرار الصارم بعد أن تحولت الخبر الوالي أمزازي يُنهي فوضى صالونات التدليك بأكادير بعد سنوات من الإنفلات  .', 'size': 2}, {'id': '424', 'title': 'الوالي أمزازي يحاصر فوضى صالونات التدليك بأكادير بعد سنوات من الإنفلات', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%a7%d9%84%d9%88%d8%a7%d9%84%d9%8a-%d8%a3%d9%85%d8%b2%d8%a7%d8%b2%d9%8a-%d9%8a%d8%ad%d8%a7%d8%b5%d8%b1-%d9%81%d9%88%d8%b6%d9%89-%d8%b5%d8%a7%d9%84%d9%88%d9%86%d8%a7%d8%aa-%d8%a7%d9%84%d8%aa%d8%af/', 'summary': 'الوالي أمزازي يحاصر فوضى صالونات التدليك بأكادير بعد سنوات من الإنفلات. -متابعات أصدر والي جهة سوس ماسة، سعيد أمزازي، قرارا يقضي بإغلاق جميع صالونات التدليك التي تنشط خارج الإطار القانوني، أو تشتغل بدون التراخيص الرسمية اللازمة، وذلك في سياق حملة...  الوالي أمزازي يحاصر فوضى صالونات التدليك بأكادير بعد سنوات من الإنفلات     .', 'size': 2}], 'main_title': 'الوالي أمزازي يُنهي فوضى صالونات التدليك بأكادير بعد سنوات من الإنفلات'}, {'community_id': '2', 'articles': [{'id': '225', 'title': 'حر ورعد قوي مصحوبا بالبرَد والرياح من الخميس إلى الأحد', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/225715/', 'summary': 'حر ورعد قوي مصحوبا بالبرَد والرياح من الخميس إلى الأحد. أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل موجة حر من اليوم الخميس إلى يوم الأحد المقبل، وزخات رعدية قوية مع تساقط محلي للبرَد وهبات رياح اليوم الخميس، بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة برتقالي، أنه من المرتقب تسجيل درجات حرارة تتراوح ما بين 44 و47 درجة من الخميس', 'size': 4}, {'id': '381', 'title': 'موجة حر مع الشركي تستمر إلى الثلاثاء المقبل', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%85%d9%88%d8%ac%d8%a9-%d8%ad%d8%b1-%d9%85%d8%b9-%d8%a7%d9%84%d8%b4%d8%b1%d9%83%d9%8a-%d8%aa%d8%b3%d8%aa%d9%85%d8%b1-%d8%a5%d9%84%d9%89-%d8%a7%d9%84%d8%ab%d9%84%d8%a7%d8%ab%d8%a7%d8%a1-%d8%a7%d9%84/', 'summary': 'موجة حر مع الشركي تستمر إلى الثلاثاء المقبل. أفادت المديرية العامة للأرصاد الجوية أنه يرتقب تسجيل موجة حر مع الشركي من اليوم الجمعة إلى غاية يوم الثلاثاء المقبل، وزخات رعدية مع تساقط البرد وهبات رياح اليوم الجمعة، بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة برتقالي، أنه من المرتقب تسجيل درجات حرارة تتراوح ما بين 39 و43 درجة اليوم  موجة حر مع الشركي تستمر إلى الثلاثاء المقبل     .', 'size': 4}, {'id': '399', 'title': 'موجة حرّ شديدة تضرب مناطق المملكة من الجمعة إلى الثلاثاء المقبل', 'source': 'rue20.com', 'link': 'https://rue20.com/927364.html', 'summary': 'موجة حرّ شديدة تضرب مناطق المملكة من الجمعة إلى الثلاثاء المقبل.  | الرباط أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل موجة حر مع الشركي من اليوم الجمعة إلى غاية يوم الثلاثاء المقبل، وزخات رعدية مع تساقط البرَد وهبات رياح اليوم الجمعة، بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة برتقالي، أنه من المرتقب تسجيل درجات حرارة تتراوح ما بين الخبر موجة حرّ شديدة تضرب مناطق المملكة من الجمعة إلى الثلاثاء المقبل  .', 'size': 4}, {'id': '437', 'title': 'نشرة إندارية: موجة حر مع الشركي وزخات رعدية مرتقبة من الجمعة إلى الثلاثاء بعدد من مناطق المملكة', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%86%d8%b4%d8%b1%d8%a9-%d8%a5%d9%86%d8%af%d8%a7%d8%b1%d9%8a%d8%a9-%d9%85%d9%88%d8%ac%d8%a9-%d8%ad%d8%b1-%d9%85%d8%b9-%d8%a7%d9%84%d8%b4%d8%b1%d9%83%d9%8a-%d9%88%d8%b2%d8%ae%d8%a7%d8%aa-%d8%b1%d8%b9/', 'summary': 'نشرة إندارية: موجة حر مع الشركي وزخات رعدية مرتقبة من الجمعة إلى الثلاثاء بعدد من مناطق المملكة. أفادت المديرية العامة للأرصاد الجوية، بأنه يرتقب تسجيل موجة حر مع الشركي من اليوم الجمعة إلى غاية يوم الثلاثاء المقبل، وزخات رعدية مع تساقط البرَد وهبات رياح اليوم الجمعة، بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة برتقالي، أنه من المرتقب تسجيل درجات حرارة تتراوح ما بين 39 و43 …  نشرة إندارية: موجة حر مع الشركي وزخات رعدية مرتقبة من الجمعة إلى الثلاثاء بعدد من مناطق المملكة     .', 'size': 4}], 'main_title': 'حر ورعد قوي مصحوبا بالبرَد والرياح من الخميس إلى الأحد'}, {'community_id': '4', 'articles': [{'id': '372', 'title': 'العثور على جثة العامل الثاني في حادث انهيار بئر معدني بإميضر', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1091601.html', 'summary': 'العثور على جثة العامل الثاني في حادث انهيار بئر معدني بإميضر. إثر انهيار بئر معدني بمنجم للفضة بجماعة إميضر، نواحي إقليم تنغير. ظهرت المقالة العثور على جثة العامل الثاني في حادث انهيار بئر معدني بإميضر  .', 'size': 3}, {'id': '394', 'title': 'وفاة عامل إثر انهيار في منجم الفضة بإميضر', 'source': 'rue20.com', 'link': 'https://rue20.com/927389.html', 'summary': 'وفاة عامل إثر انهيار في منجم الفضة بإميضر.  | متابعة شهد منجم الفضة الواقع بجماعة إميضر، التابعة لإقليم تنغير، بعد زوال اليوم الجمعة 8 غشت، حادث انهيار داخل أحد الأنفاق، أسفر عن مصرع عامل تحت الأنقاض. وبحسب مصادر محلية، فقد تمكنت فرق الإنقاذ من انتشال أحد العاملين وهو على قيد الحياة، حيث تم نقله على وجه السرعة إلى المستشفى في حالة الخبر وفاة عامل إثر انهيار في منجم الفضة بإميضر  .', 'size': 3}, {'id': '414', 'title': 'وفاة عامل إثر انهيار منجمي بإميضر ضواحي تنغير', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d9%88%d9%81%d8%a7%d8%a9-%d8%b9%d8%a7%d9%85%d9%84-%d8%a5%d8%ab%d8%b1-%d8%a7%d9%86%d9%87%d9%8a%d8%a7%d8%b1-%d9%85%d9%86%d8%ac%d9%85%d9%8a-%d8%a8%d8%a5%d9%85%d9%8a%d8%b6%d8%b1-%d8%b6%d9%88%d8%a7%d8%ad/', 'summary': 'وفاة عامل إثر انهيار منجمي بإميضر ضواحي تنغير. -متابعات شهد منجم الفضة الواقع بجماعة إميضر، التابعة لإقليم تنغير، بعد زوال اليوم الجمعة 8 غشت، حادث انهيار داخل أحد الأنفاق، أسفر عن مصرع عامل تحت الأنقاض. وبحسب مصادر...  وفاة عامل إثر انهيار منجمي بإميضر ضواحي تنغير     .', 'size': 3}], 'main_title': 'العثور على جثة العامل الثاني في حادث انهيار بئر معدني بإميضر'}, {'community_id': '0', 'articles': [{'id': '408', 'title': 'الاحتفال باليوم الوطني للمغاربة المقيمين بالخارج تحت شعار “ورش الرقمنة: تعزيز لخدمات القرب الموجهة لمغاربة العالم”', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/472031.html', 'summary': 'الاحتفال باليوم الوطني للمغاربة المقيمين بالخارج تحت شعار “ورش الرقمنة: تعزيز لخدمات القرب الموجهة لمغاربة العالم”. يخلد قطاع المغاربة المقيمين بالخارج، بعد غد الأحد (10 غشت)، اليوم الوطني للمغاربة المقيمين بالخارج تحت شعار ” ورش الرقمنة: تعزيز لخدمات القرب الموجهة لمغاربة العالم”، وذلك تجسيدا للعناية الخاصة التي يوليها الملك محمد السادس لأفراد الجالية المغربية بالخارج.', 'size': 2}, {'id': '434', 'title': 'المغرب يحتفي بأبنائه في المهجر ببرامج صيفية تعزز الانتماء للوطن وتواكب ورش الرقمنة (صور)', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d9%8a%d8%ad%d8%aa%d9%81%d9%8a-%d8%a8%d8%a3%d8%a8%d9%86%d8%a7%d8%a6%d9%87-%d9%81%d9%8a-%d8%a7%d9%84%d9%85%d9%87%d8%ac%d8%b1-%d8%a8%d8%a8%d8%b1%d8%a7%d9%85%d8%ac/', 'summary': 'المغرب يحتفي بأبنائه في المهجر ببرامج صيفية تعزز الانتماء للوطن وتواكب ورش الرقمنة (صور). يحظى المواطنون المغاربة المقيمون بالخارج، والذين يزيد عددهم عن خمسة ملايين شخص موزعين على أكثر من مائة بلد، بعناية خاصة من طرف الملك محمد السادس، من خلال تعليماته السامية الرامية إلى النهوض بأوضاعهم وشؤونهم. وفي هذا الإطار، يعمل قطاع المغاربة المقيمين بالخارج على تعبئة استثنائية خلال الفترة الصيفية لمواكبة هذه الفئة، عبر برامج …  المغرب يحتفي بأبنائه في المهجر ببرامج صيفية تعزز الانتماء للوطن وتواكب ورش الرقمنة (صور)     .', 'size': 2}], 'main_title': 'الاحتفال باليوم الوطني للمغاربة المقيمين بالخارج تحت شعار “ورش الرقمنة: تعزيز لخدمات القرب الموجهة لمغاربة العالم”'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    