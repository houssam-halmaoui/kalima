<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 19/07/2025 - 18h28</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '110', 'title': 'بأكثر من 53 مليار.. البواري يطلق مشاريع استراتيجية تعزز التنمية الفلاحية في إقليم وزان', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/economy/409559.html', 'summary': 'بأكثر من 53 مليار.. البواري يطلق مشاريع استراتيجية تعزز التنمية الفلاحية في إقليم وزان. في خطوة نوعية لتعزيز التنمية الفلاحية والقروية بإقليم وزان، قام وزير الفلاحة والصيد البحري والتنمية القروية والمياه والغابات، أحمد البواري، يوم الجمعة 18 يوليوز 2025،', 'size': 2}, {'id': '224', 'title': 'إقليم وزان.. تدشين مشاريع للتنمية الفلاحية والقروية في إطار استراتيجية الجيل الأخضر', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%a5%d9%82%d9%84%d9%8a%d9%85-%d9%88%d8%b2%d8%a7%d9%86-%d8%aa%d8%af%d8%b4%d9%8a%d9%86-%d9%85%d8%b4%d8%a7%d8%b1%d9%8a%d8%b9-%d9%84%d9%84%d8%aa%d9%86%d9%85%d9%8a%d8%a9-%d8%a7%d9%84%d9%81%d9%84%d8%a7/', 'summary': 'إقليم وزان.. تدشين مشاريع للتنمية الفلاحية والقروية في إطار استراتيجية الجيل الأخضر. قام وزير الفلاحة والصيد البحري والتنمية القروية والمياه والغابات، أحمد البواري، اليوم الجمعة، بزيارة ميدانية لإقليم وزان، حيث أشرف على إطلاق وتدشين عدة مشاريع  إقليم وزان.. تدشين مشاريع للتنمية الفلاحية والقروية في إطار استراتيجية الجيل الأخضر     .', 'size': 2}], 'main_title': 'بأكثر من 53 مليار.. البواري يطلق مشاريع استراتيجية تعزز التنمية الفلاحية في إقليم وزان'}, {'community_id': '1', 'articles': [{'id': '132', 'title': 'بسبب غلاء المعيشة.. الناس ما بقاتش كتوفر!', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a8%d8%b3%d8%a8%d8%a8-%d8%ba%d9%84%d8%a7%d8%a1-%d8%a7%d9%84%d9%85%d8%b9%d9%8a%d8%b4%d8%a9-%d8%a7%d9%84%d9%86%d8%a7%d8%b3-%d9%85%d8%a7-%d8%a8%d9%82%d8%a7%d8%aa%d8%b4-%d9%83%d8%aa%d9%88%d9%81%d8%b1/', 'summary': 'بسبب غلاء المعيشة.. الناس ما بقاتش كتوفر!. أظهرت نتائج بحث الظرفية لدى الأسر، المنجز من طرف المندوبية السامية للتخطيط، برسم الفصل الثاني من سنة 2025، أن 8،7 في المائة من الأسر صرحت بقدرتها على الادخار خلال 12 شهرا المقبلة. وأوضحت المندوبية، في مذكرة إخبارية، أن رصيد هذا المؤشر استقر في مستوى سلبي بلغ ناقص 82،6 نقطة، مقابل ناقص 77،6 نقطة خلال الفصل', 'size': 2}, {'id': '242', 'title': 'مندوبية التخطيط: 76% من الأسر المغربية تُقرّ بتدهور مستوى معيشتها', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%85%d9%86%d8%af%d9%88%d8%a8%d9%8a%d8%a9-%d8%a7%d9%84%d8%aa%d8%ae%d8%b7%d9%8a%d8%b7-76-%d9%85%d9%86-%d8%a7%d9%84%d8%a3%d8%b3%d8%b1-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8%d9%8a%d8%a9-%d8%aa%d9%8f/', 'summary': 'مندوبية التخطيط: 76% من الأسر المغربية تُقرّ بتدهور مستوى معيشتها. كشفت المندوبية السامية للتخطيط أن معدل الأسر التي صرحت بتدهور مستوى المعيشة خلال 12 شهرا السابقة بلغ 76 في المائة، فيما اعتبرت 17،2 في المائة منها استقراره و6،8 في المائة تحسنه. وبحسب المندوبية، فقد استقر مؤشر ثقة الأسر في 54،6 نقطة خلال الفصل الثاني من سنة 2025 عوض 46،6 نقطة مسجلة خلال الفصل …  مندوبية التخطيط: 76% من الأسر المغربية تُقرّ بتدهور مستوى معيشتها     .', 'size': 2}], 'main_title': 'بسبب غلاء المعيشة.. الناس ما بقاتش كتوفر!'}, {'community_id': '8', 'articles': [{'id': '135', 'title': 'لقجع: البنيات التحتية والاستثمارات المرتبطة بـ”كان 2025″ تندرج ضمن مقاربة منسجمة للإعداد لـ”مونديال 2030″', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%84%d9%82%d8%ac%d8%b9-%d8%a7%d9%84%d8%a8%d9%86%d9%8a%d8%a7%d8%aa-%d8%a7%d9%84%d8%aa%d8%ad%d8%aa%d9%8a%d8%a9-%d9%88%d8%a7%d9%84%d8%a7%d8%b3%d8%aa%d8%ab%d9%85%d8%a7%d8%b1%d8%a7%d8%aa-%d8%a7%d9%84/', 'summary': 'لقجع: البنيات التحتية والاستثمارات المرتبطة بـ”كان 2025″ تندرج ضمن مقاربة منسجمة للإعداد لـ”مونديال 2030″. أكد الوزير المنتدب المكلف بالميزانية، فوزي لقجع، اليوم الجمعة (18 يوليوز) بالرباط، أن مشاريع البنيات التحتية والاستثمارات وأشغال البناء، التي تم إطلاقها في إطار تنظيم كأس أمم إفريقيا 2025، تندرج في إطار إستراتيجية قائمة على مبدأ الاستمرارية بغية الإعداد بشكل ناجع ومستدام لاحتضان كأس العالم 2030. وأوضح لقجع، خلال ندوة وزارية نظمت بالمدرسة الوطنية العليا', 'size': 2}, {'id': '195', 'title': 'لقجع : مشاريع مونديال 2030 تندرج ضمن إستراتيجية مستدامة تنموية إقتصادياً وترابياً', 'source': 'rue20.com', 'link': 'https://rue20.com/921671.html', 'summary': 'لقجع : مشاريع مونديال 2030 تندرج ضمن إستراتيجية مستدامة تنموية إقتصادياً وترابياً. . الرباط أكد الوزير المنتدب المكلف بالميزانية، فوزي لقجع، اليوم الجمعة بالرباط، أن مشاريع البنيات التحتية والاستثمارات وأشغال البناء، التي تم إطلاقها في إطار تنظيم كأس أمم إفريقيا 2025، تندرج في إطار إستراتيجية قائمة على مبدأ الاستمرارية بغية الإعداد بشكل ناجع ومستدام لاحتضان كأس العالم 2030. وأوضح السيد لقجع، خلال ندوة وزارية نظمت بالمدرسة الخبر لقجع : مشاريع مونديال 2030 تندرج ضمن إستراتيجية مستدامة تنموية إقتصادياً وترابياً  .', 'size': 2}], 'main_title': 'لقجع: البنيات التحتية والاستثمارات المرتبطة بـ”كان 2025″ تندرج ضمن مقاربة منسجمة للإعداد لـ”مونديال 2030″'}, {'community_id': '3', 'articles': [{'id': '155', 'title': 'مونديال 2030 يفتح أبواب الأمل.. المغرب يرتقب خلق 100 ألف فرصة شغل سنويا', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/318696/', 'summary': 'مونديال 2030 يفتح أبواب الأمل.. المغرب يرتقب خلق 100 ألف فرصة شغل سنويا. أكدت وزيرة الاقتصاد والمالية، نادية فتاح، اليوم الجمعة بالرباط، أن تنظيم المملكة لكأس العالم 2030، بشكل مشترك مع إسبانيا والبرتغال، من شأنه تمكين المغرب من خلق أزيد من 100 ألف فرصة شغل سنويا. وقالت فتاح، خلال الجلسة الثانية المنظمة في إطار الدورة الثامنة لـ “منتدى المغرب اليوم”، المنعقدة تحت الرعاية السامية لصاحب الجلالة الملك محمد', 'size': 2}, {'id': '192', 'title': 'فتاح علوي: تنظيم مونديال 2030 سيخلق أزيد من 100 ألف فرصة شغل سنوياً بالمغرب', 'source': 'rue20.com', 'link': 'https://rue20.com/921705.html', 'summary': 'فتاح علوي: تنظيم مونديال 2030 سيخلق أزيد من 100 ألف فرصة شغل سنوياً بالمغرب. . الرباط أكدت وزيرة الاقتصاد والمالية، نادية فتاح، اليوم الجمعة بالرباط، أن تنظيم المملكة لكأس العالم 2030، بشكل مشترك مع إسبانيا والبرتغال، من شأنه تمكين المغرب من خلق أزيد من 100 ألف فرصة شغل سنويا. وقالت السيدة فتاح، خلال الجلسة الثانية المنظمة في إطار الدورة الثامنة لـ “منتدى المغرب اليوم”، المنعقدة تحت الرعاية السامية الخبر فتاح علوي: تنظيم مونديال 2030 سيخلق أزيد من 100 ألف فرصة شغل سنوياً بالمغرب  .', 'size': 2}], 'main_title': 'مونديال 2030 يفتح أبواب الأمل.. المغرب يرتقب خلق 100 ألف فرصة شغل سنويا'}, {'community_id': '5', 'articles': [{'id': '157', 'title': 'الرئيس السوري يدعو لوقف شامل لإطلاق النار في السويداء ويحذر من مشاريع الانفصال', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1086576.html', 'summary': 'الرئيس السوري يدعو لوقف شامل لإطلاق النار في السويداء ويحذر من مشاريع الانفصال. دعا الرئيس السوري أحمد الشرع، السبت، العشائر العربية وطائفة الدروز في محافظة السويداء جنوبي البلاد إلى الوقوف “صفا واحدا” والالتزام بوقف النار، مؤكدا أن بلاده “ليست ميدانا لمشاريع الانفصال والطائفية”. جاء ذلك في كلمة متلفزة عقب إعلان الرئاسة السورية “وقفا شاملا وفوريا” لإطلاق النار على خلفية أحداث العنف الأخيرة في السويداء. وقال الرئيس الشرع إن ظهرت المقالة الرئيس السوري يدعو لوقف شامل لإطلاق النار في السويداء ويحذر من مشاريع الانفصال  .', 'size': 2}, {'id': '182', 'title': 'أحداث السويداء.. الشرع: لن يفلت أي شخص من المحاسبة', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a3%d8%ad%d8%af%d8%a7%d8%ab-%d8%a7%d9%84%d8%b3%d9%88%d9%8a%d8%af%d8%a7%d8%a1-%d8%a7%d9%84%d8%b4%d8%b1%d8%b9-%d9%84%d9%86-%d9%8a%d9%81%d9%84%d8%aa-%d8%a3%d9%8a-%d8%b4%d8%ae%d8%b5-%d9%85%d9%86/', 'summary': 'أحداث السويداء.. الشرع: لن يفلت أي شخص من المحاسبة. أكد الرئيس السوري، أحمد الشرع، السبت، التزام الدولة "حماية الأقليات" في البلاد ومحاسبة جميع "المنتهكين من أي طرف كان". وقال الشرع في كلمة وجهها الى السوريين "تلتزم الدولة السورية بحماية الأقليات والطوائف كافة في البلاد وهي ماضية في محاسبة جميع المنتهكين من اي طرف كان"، وأوضح أنه "لن يفلت أي شخص من المحاسبة ونتبرأ من  أحداث السويداء.. الشرع: لن يفلت أي شخص من المحاسبة     .', 'size': 2}], 'main_title': 'الرئيس السوري يدعو لوقف شامل لإطلاق النار في السويداء ويحذر من مشاريع الانفصال'}, {'community_id': '2', 'articles': [{'id': '185', 'title': 'حالة الطقس: انخفاض في درجات الحرارة وزخات رعدية', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%ad%d8%a7%d9%84%d8%a9-%d8%a7%d9%84%d8%b7%d9%82%d8%b3-%d8%a7%d9%86%d8%ae%d9%81%d8%a7%d8%b6-%d9%81%d9%8a-%d8%af%d8%b1%d8%ac%d8%a7%d8%aa-%d8%a7%d9%84%d8%ad%d8%b1%d8%a7%d8%b1%d8%a9-%d9%88%d8%b2%d8%ae/', 'summary': 'حالة الطقس: انخفاض في درجات الحرارة وزخات رعدية. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم السبت، أن تنخفض درجات الحرارة في مجموع أرجاء البلاد مع طقس حار نسبيا بأقصى الجنوب الشرقي وداخل الأقاليم الصحراوية للمملكة. كما يرتقب تشكل ضباب محلي فوق السهول الشمالية والسواحل الوسطى خلال الليلة القادمة، فضلا عن نزول قطرات مطرية ما بين سيدي إفني والعيون خلال الصباح والليل. وستتكون أيضا  حالة الطقس: انخفاض في درجات الحرارة وزخات رعدية     .', 'size': 2}, {'id': '227', 'title': 'طقس السبت.. حار نسبيا في بعض المناطق بالمملكة', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/224906/', 'summary': 'طقس السبت.. حار نسبيا في بعض المناطق بالمملكة. كواليس اليوم تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليوم السبت، أن تنخفض درجات الحرارة في مجموع أرجاء البلاد مع طقس حار نسبيا بأقصى الجنوب الشرقي وداخل الأقاليم الصحراوية للمملكة. كما يرتقب تشكل ضباب محلي فوق السهول الشمالية والسواحل الوسطى خلال الليلة القادمة، فضلا عن نزول قطرات مطرية ما بين سيدي إفني والعيون خلال الصباح', 'size': 3}, {'id': '249', 'title': 'توقعات أحوال الطقس لليوم السبت بالمغرب', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%aa%d9%88%d9%82%d8%b9%d8%a7%d8%aa-%d8%a3%d8%ad%d9%88%d8%a7%d9%84-%d8%a7%d9%84%d8%b7%d9%82%d8%b3-%d9%84%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%b3%d8%a8%d8%aa-%d8%a8%d8%a7%d9%84%d9%85%d8%ba%d8%b1-10/', 'summary': 'توقعات أحوال الطقس لليوم السبت بالمغرب. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم السبت، أن تنخفض درجات الحرارة في مجموع أرجاء البلاد مع طقس حار نسبيا بأقصى الجنوب الشرقي وداخل الأقاليم الصحراوية للمملكة. كما يرتقب تشكل ضباب محلي فوق السهول الشمالية والسواحل الوسطى خلال الليلة القادمة، فضلا عن نزول قطرات مطرية ما بين سيدي إفني والعيون خلال الصباح والليل. …  توقعات أحوال الطقس لليوم السبت بالمغرب     .', 'size': 2}], 'main_title': 'طقس السبت.. حار نسبيا في بعض المناطق بالمملكة'}, {'community_id': '4', 'articles': [{'id': '356', 'title': 'إنفانتينو: المغرب أصبح أحد المراكز العالمية لكرة القدم', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a5%d9%86%d9%81%d8%a7%d9%86%d8%aa%d9%8a%d9%86%d9%88-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d8%a3%d8%b5%d8%a8%d8%ad-%d8%a3%d8%ad%d8%af-%d8%a7%d9%84%d9%85%d8%b1%d8%a7%d9%83%d8%b2-%d8%a7%d9%84%d8%b9/', 'summary': 'إنفانتينو: المغرب أصبح أحد المراكز العالمية لكرة القدم. أكد رئيس الاتحاد الدولي لكرة القدم (الفيفا)، جياني إنفانتينو، اليوم السبت (19 يوليوز)، أن المغرب أصبح أحد المراكز العالمية لكرة القدم. وعبر إنفانتينو، لدى وصوله اليوم إلى الرباط، عن سعادته بالتواجد في المغرب، مضيفا أنه يتشرف بالقدوم إلى المغرب، “البلد الذي يعشق ويعيش على إيقاعات كرة القدم كل يوم”. وأكد رئيس الفيفا أن المنتخبات المغربية', 'size': 2}, {'id': '398', 'title': 'رئيس الفيفا: المغرب أصبح أحد المراكز العالمية لكرة القدم', 'source': 'machahid24.com', 'link': 'https://machahid24.com/sport/470031.html', 'summary': 'رئيس الفيفا: المغرب أصبح أحد المراكز العالمية لكرة القدم. متابعة أكد رئيس الاتحاد الدولي لكرة القدم (الفيفا)، جياني إنفانتينو، اليوم السبت، أن المغرب أصبح أحد المراكز العالمية لكرة القدم. وعبر إنفانتينو، لدى وصوله اليوم إلى الرباط، عن سعادته بالتواجد في المغرب، مضيفا أنه يتشرف بالقدوم إلى المغرب، “البلد الذي يعشق ويعيش على إيقاعات كرة القدم كل يوم”. وأكد رئيس الفيفا أن المنتخبات المغربية لكرة …', 'size': 2}], 'main_title': 'إنفانتينو: المغرب أصبح أحد المراكز العالمية لكرة القدم'}, {'community_id': '9', 'articles': [{'id': '375', 'title': 'إدارة سجن الناظور تكشف ملابسات وفاة نزيل وترد على “شائعات الغموض”', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1086584.html', 'summary': 'إدارة سجن الناظور تكشف ملابسات وفاة نزيل وترد على “شائعات الغموض”. قدمت إدارة السجن المحلي بالناظور، اليوم السبت، توضيحات بشأن ظروف وملابسات وفاة سجين شاب داخل المؤسسة، بعد تداول أخبار عن وفاة غامضة. وأكدت الإدارة أن السجين (م.ق) المعتقل بتهمة الاتجار في المشروبات الكحولية بدون رخصة، نُقل إلى المستشفى الإقليمي بالناظور يوم 18 يوليوز بسبب صعوبات في التنفس، وكان يعاني من مرض عضال في الحنجرة. وأضافت ظهرت المقالة إدارة سجن الناظور تكشف ملابسات وفاة نزيل وترد على “شائعات الغموض”  .', 'size': 2}, {'id': '427', 'title': 'السجين المُتوفي بالناظور كان يعاني من مرض عضال على مستوى الحنجرة', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/224922/', 'summary': 'السجين المُتوفي بالناظور كان يعاني من مرض عضال على مستوى الحنجرة. ردا على بعض المقالات والتدوينات المنشورة بخصوص “وفاة غامضة لسجين شاب بالسجن المحلي بالناظور”، تتقدم إدارة هذه المؤسسة إلى الرأي العام بالتوضيحات التالية: – بتاريخ 18 يوليوز تم إخراج السجين (م.ق)، المعتقل قيد حياته بالسجن المحلي الناظور بتهمة الاتجار في المشروبات الكحولية بدون رخصة، إلى المستشفى الإقليمي بالناظور، وذلك بعد معاناته من صعوبات في التنفس،', 'size': 2}], 'main_title': 'إدارة سجن الناظور تكشف ملابسات وفاة نزيل وترد على “شائعات الغموض”'}, {'community_id': '6', 'articles': [{'id': '381', 'title': 'سجن الناظور يوضح ملابسات وفاة سجين: "الوفاة طبيعية.. وكان يعاني من مرض عضال"', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%b3%d8%ac%d9%86-%d8%a7%d9%84%d9%86%d8%a7%d8%b8%d9%88%d8%b1-%d9%8a%d9%88%d8%b6%d8%ad-%d9%85%d9%84%d8%a7%d8%a8%d8%b3%d8%a7%d8%aa-%d9%88%d9%81%d8%a7%d8%a9-%d8%b3%d8%ac%d9%8a%d9%86-%d8%a7%d9%84/', 'summary': 'سجن الناظور يوضح ملابسات وفاة سجين: "الوفاة طبيعية.. وكان يعاني من مرض عضال". نفت إدارة السجن المحلي بالناظور أن تكون وفاة سجين شاب داخل المؤسسة ناتجة عن ظروف غامضة أو غير طبيعية، مؤكدة أن المعني بالأمر كان يعاني من مرض عضال، وتلقى العلاجات اللازمة بشكل منتظم، سواء داخل المؤسسة أو خارجها. وجاء في بيان توضيحي صادر عنها، أن السجين المتوفى (م.ق)، المعتقل بتهمة الاتجار في المشروبات الكحولية بدون  سجن الناظور يوضح ملابسات وفاة سجين: "الوفاة طبيعية.. وكان يعاني من مرض عضال"     .', 'size': 2}, {'id': '432', 'title': 'إدارة سجن الناظور: وفاة السجين الشاب كانت نتيجة “مرض عضال”', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%a5%d8%af%d8%a7%d8%b1%d8%a9-%d8%b3%d8%ac%d9%86-%d8%a7%d9%84%d9%86%d8%a7%d8%b8%d9%88%d8%b1-%d9%88%d9%81%d8%a7%d8%a9-%d8%a7%d9%84%d8%b3%d8%ac%d9%8a%d9%86-%d8%a7%d9%84%d8%b4%d8%a7%d8%a8-%d9%83%d8%a7/', 'summary': 'إدارة سجن الناظور: وفاة السجين الشاب كانت نتيجة “مرض عضال”. المساء اليوم: قالت إدارة السجن المحلي بالناظور، في بيان لها اليوم السبت، إن السجين الشاب الذي توفي أمس، الجمعة، كان يعاني من مرض عضال واستفاد من كل الخدمات الطبية اللازمة، نافية أن يكون الأمر يتعلق', 'size': 2}], 'main_title': 'سجن الناظور يوضح ملابسات وفاة سجين: "الوفاة طبيعية.. وكان يعاني من مرض عضال"'}, {'community_id': '7', 'articles': [{'id': '386', 'title': 'إنفانتينو من المغرب: المملكة باتت فاعلا عالميا في كرة القدم', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a5%d9%86%d9%81%d8%a7%d9%86%d8%aa%d9%8a%d9%86%d9%88-%d9%85%d9%86-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d8%a7%d9%84%d9%85%d9%85%d9%84%d9%83%d8%a9-%d8%a8%d8%a7%d8%aa%d8%aa-%d9%81%d8%a7%d8%b9%d9%84/', 'summary': 'إنفانتينو من المغرب: المملكة باتت فاعلا عالميا في كرة القدم. حط جياني إنفانتينو، رئيس الاتحاد الدولي لكرة القدم"فيفا"، اليوم السبت، الرحال في المغرب في زيارة رسمية. ووجد إنفانتينو في استقباله، رئيس الجامعة الملكية المغربية لكرة القدم، فوزي لقجع. إنفانتينو في تصريح مقتضب للقناة الرسمية لجامعة الكرة على "يوتوب"، جدد سعادته بالتواجد مرة أخرى في المغرب. ونوه رئيس "فيفا"، باحتضان المملكة لعدد من التظاهرات الكروية القارية  إنفانتينو من المغرب: المملكة باتت فاعلا عالميا في كرة القدم     .', 'size': 2}, {'id': '391', 'title': 'إنفانتينو : المغرب أصبح قوة كروية عالمية وأنا سعيد بتنظيم مونديال السيدات لأقل من 17 عاماً بالمملكة', 'source': 'rue20.com', 'link': 'https://rue20.com/921788.html', 'summary': 'إنفانتينو : المغرب أصبح قوة كروية عالمية وأنا سعيد بتنظيم مونديال السيدات لأقل من 17 عاماً بالمملكة.  الرباط وصل رئيس الاتحاد الدولي لكرة القدم، جياني إنفانتينو، إلى المملكة المغربية، اليوم، من أجل متابعة منافسات كأس أمم أفريقيا للسيدات، المقامة حاليًا على الأراضي المغربية. وكان في استقبال إنفانتينو بمطار الرباط سلا، فوزي لقجع، رئيس الجامعة الملكية المغربية لكرة القدم، حيث تبادل الطرفان كلمات الترحيب وأكدا على عمق التعاون بين “الفيفا” والكرة المغربية، الخبر إنفانتينو : المغرب أصبح قوة كروية عالمية وأنا سعيد بتنظيم مونديال السيدات لأقل من 17 عاماً بالمملكة  .', 'size': 2}], 'main_title': 'إنفانتينو من المغرب: المملكة باتت فاعلا عالميا في كرة القدم'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    