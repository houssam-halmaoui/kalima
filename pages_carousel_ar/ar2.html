<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 04/09/2025 - 12h25</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '3', 'title': 'مسؤول بريطاني يشيد بمكانة المغرب', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d9%85%d8%b3%d8%a4%d9%88%d9%84-%d8%a8%d8%b1%d9%8a%d8%b7%d8%a7%d9%86%d9%8a-%d9%8a%d8%b4%d9%8a%d8%af-%d8%a8%d9%85%d9%83%d8%a7%d9%86%d8%a9-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-1618470.html', 'summary': 'مسؤول بريطاني يشيد بمكانة المغرب. قال هاميش فالكونر، نائب كاتب الدولة المكلف بالشؤون البرلمانية في وزارة الخارجية البريطانية، إن الحوار الاستراتيجي بين المغرب والمملكة المتحدة، الذي انعقد في يونيو الماضي بالرباط، شكل “تغييرا مهما” في العلاقات بين البلدين. وذكر فالكونر، في تصريح أمام مجلس العموم البريطاني، بأن “ديفيد لامي، وزير الخارجية، ترأس، بشكل مشترك، يوم فاتح يونيو الماضي بالرباط، دورة  مسؤول بريطاني يشيد بمكانة المغرب     - هسبريس جريدة إلكترونية مغربية .', 'size': 3}, {'id': '146', 'title': 'المملكة المتحدة تؤكد دعمها لمخطط الحكم الذاتي وتعتبر الحوار مع المغرب محطة فارقة', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/322438/', 'summary': 'المملكة المتحدة تؤكد دعمها لمخطط الحكم الذاتي وتعتبر الحوار مع المغرب محطة فارقة. قال هاميش فالكونر، نائب كاتب الدولة المكلف بالشؤون البرلمانية في وزارة الخارجية البريطانية، إن الحوار الاستراتيجي بين المغرب والمملكة المتحدة، الذي انعقد في يونيو الماضي بالرباط، شكل “تغييرا مهما” في العلاقات بين البلدين. وذكر فالكونر في تصريح أمام مجلس العموم البريطاني، بأن “وزير الخارجية ديفيد لامي ترأس بشكل مشترك، يوم 1 يونيو الماضي بالرباط، دورة', 'size': 4}, {'id': '196', 'title': 'مسؤول بريطاني: الحوار الاستراتيجي المغرب-المملكة المتحدة شكل”تغييرا مهما” في العلاقات بين البلدين', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/474444.html', 'summary': 'مسؤول بريطاني: الحوار الاستراتيجي المغرب-المملكة المتحدة شكل”تغييرا مهما” في العلاقات بين البلدين. و.م.ع قال هاميش فالكونر، نائب كاتب الدولة المكلف بالشؤون البرلمانية في وزارة الخارجية البريطانية، إن الحوار الاستراتيجي بين المغرب والمملكة المتحدة، الذي انعقد في يونيو الماضي بالرباط، شكل “تغييرا مهما” في العلاقات بين البلدين. وذكر فالكونر في تصريح أمام مجلس العموم البريطاني، بأن “وزير الخارجية ديفيد لامي ترأس بشكل مشترك، يوم 1 يونيو الماضي بالرباط، …', 'size': 2}, {'id': '356', 'title': 'مسؤول بريطاني رفيع أمام مجلس العموم: الحوار الإستراتيجي شكل تغييراً مهماً في العلاقات مع المغرب', 'source': 'rue20.com', 'link': 'https://rue20.com/933593.html', 'summary': 'مسؤول بريطاني رفيع أمام مجلس العموم: الحوار الإستراتيجي شكل تغييراً مهماً في العلاقات مع المغرب.  | الرباط قال هاميش فالكونر، نائب كاتب الدولة المكلف بالشؤون البرلمانية في وزارة الخارجية البريطانية، إن الحوار الاستراتيجي بين المغرب والمملكة المتحدة، الذي انعقد في يونيو الماضي بالرباط، شكل “تغييرا مهما” في العلاقات بين البلدين. وذكر فالكونر في تصريح أمام مجلس العموم البريطاني، بأن “وزير الخارجية ديفيد لامي ترأس بشكل مشترك، يوم 1 الخبر مسؤول بريطاني رفيع أمام مجلس العموم: الحوار الإستراتيجي شكل تغييراً مهماً في العلاقات مع المغرب  .', 'size': 3}], 'main_title': 'المملكة المتحدة تؤكد دعمها لمخطط الحكم الذاتي وتعتبر الحوار مع المغرب محطة فارقة'}, {'community_id': '1', 'articles': [{'id': '101', 'title': 'تحويلات الجالية المغربية تسجل رقماً قياسياً جديداً', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/national/412105.html', 'summary': 'تحويلات الجالية المغربية تسجل رقماً قياسياً جديداً. أفاد مكتب الصرف بأن تحويلات المغاربة المقيمين بالخارج سجلت سنة 2024 رقما قياسيا بلغ 119 مليار درهم، أي بارتفاع بنسبة 3,3 في المائة مقارنة بالسنة', 'size': 5}, {'id': '126', 'title': 'تجاوز 119 مليار درهم.. مغاربة المهجر يُحققون رقما قياسيًا في التحويلات', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%aa%d8%ac%d8%a7%d9%88%d8%b2-119-%d9%85%d9%84%d9%8a%d8%a7%d8%b1-%d8%af%d8%b1%d9%87%d9%85-%d9%85%d8%ba%d8%a7%d8%b1%d8%a8%d8%a9-%d8%a7%d9%84%d9%85%d9%87%d8%ac%d8%b1-%d9%8a%d9%8f%d8%ad%d9%82%d9%82/', 'summary': 'تجاوز 119 مليار درهم.. مغاربة المهجر يُحققون رقما قياسيًا في التحويلات. في تقريره الأخير حول ميزان المدفوعات، كشف مكتب الصرف بأن تحويلات المغاربة المقيمين بالخارج سجلت رقما قياسيا بلغ 119 مليار درهم، أي بارتفاع بنسبة 3,3 في المائة سنة 2024 مقارنة بالسنة التي قبلها. وأوضح المكتب، في تقريره حول ميزان المدفوعات ووضع الاستثمار الدولي برسم سنة 2024، أن هذه المداخيل حققت معدل نمو سنوي متوسط بنسبة', 'size': 5}, {'id': '148', 'title': 'مداخيل المغاربة المقيمين بالخارج.. رقم قياسي بلغ 119 مليار درهم', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/322422/', 'summary': 'مداخيل المغاربة المقيمين بالخارج.. رقم قياسي بلغ 119 مليار درهم. أفاد مكتب الصرف بأن تحويلات المغاربة المقيمين بالخارج سجلت سنة 2024 رقما قياسيا بلغ 119 مليار درهم، أي بارتفاع بنسبة 3,3 في المائة مقارنة بالسنة السابقة. وأوضح المكتب، في تقريره حول ميزان المدفوعات ووضع الاستثمار الدولي برسم سنة 2024، أن هذه المداخيل حققت معدل نمو سنوي متوسط بنسبة 5,7 في المائة خلال الفترة 2021-2024. وكشف', 'size': 5}, {'id': '234', 'title': 'تحويلات مغاربة العالم سجلت رقما قياسيا سنة 2024', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%aa%d8%ad%d9%88%d9%8a%d9%84%d8%a7%d8%aa-%d9%85%d8%ba%d8%a7%d8%b1%d8%a8%d8%a9-%d8%a7%d9%84%d8%b9%d8%a7%d9%84%d9%85-%d8%b3%d8%ac%d9%84%d8%aa-%d8%b1%d9%82%d9%85%d8%a7-%d9%82%d9%8a%d8%a7%d8%b3%d9%8a/', 'summary': 'تحويلات مغاربة العالم سجلت رقما قياسيا سنة 2024. المساء اليوم: أفاد مكتب الصرف بأن تحويلات المغاربة المقيمين بالخارج سجلت سنة 2024 رقما قياسيا بلغ 119 مليار درهم، أي بارتفاع بنسبة 3,3 في المائة مقارنة بالسنة السابقة. وأوضح المكتب، في تقريره حول ميزان المدفوعات', 'size': 5}, {'id': '247', 'title': 'مكتب الصرف: تحويلات المغاربة المقيمين بالخارج تحقق رقما قياسيا بـ119 مليار درهم في 2024', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%85%d9%83%d8%aa%d8%a8-%d8%a7%d9%84%d8%b5%d8%b1%d9%81-%d8%aa%d8%ad%d9%88%d9%8a%d9%84%d8%a7%d8%aa-%d8%a7%d9%84%d9%85%d8%ba%d8%a7%d8%b1%d8%a8%d8%a9-%d8%a7%d9%84%d9%85%d9%82%d9%8a%d9%85%d9%8a%d9%86-5/', 'summary': 'مكتب الصرف: تحويلات المغاربة المقيمين بالخارج تحقق رقما قياسيا بـ119 مليار درهم في 2024. كشف مكتب الصرف بأن تحويلات المغاربة المقيمين بالخارج سجلت سنة 2024 رقما قياسيا بلغ 119 مليار درهم، أي بارتفاع بنسبة 3,3 في المائة مقارنة بالسنة السابقة. وأضاف المكتب، في تقريره حول ميزان المدفوعات ووضع الاستثمار الدولي برسم سنة 2024، أن هذه المداخيل حققت معدل نمو سنوي متوسط بنسبة 5,7 في المائة خلال الفترة …  مكتب الصرف: تحويلات المغاربة المقيمين بالخارج تحقق رقما قياسيا بـ119 مليار درهم في 2024     .', 'size': 5}], 'main_title': 'تحويلات الجالية المغربية تسجل رقماً قياسياً جديداً'}, {'community_id': '2', 'articles': [{'id': '113', 'title': 'توقيف شخص متورط في انتحال صفة مسؤولين أمنيين وعسكريين', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/412117.html', 'summary': 'توقيف شخص متورط في انتحال صفة مسؤولين أمنيين وعسكريين. تمكنت عناصر الشرطة بالأمن الجهوي بورزازات بتنسيق مع نظيرتها بمدينة سلا، على ضوء معلومات وفرتها مصالح المديرية العامة لمراقبة التراب الوطني، اليوم الأربعاء 3 غشت', 'size': 4}, {'id': '150', 'title': 'الأمن يضع حدا لمحتال بورزازات استغل صفات عسكرية وأمنية للنصب', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/322425/', 'summary': 'الأمن يضع حدا لمحتال بورزازات استغل صفات عسكرية وأمنية للنصب. تمكنت عناصر الشرطة بالأمن الجهوي بورزازات بتنسيق مع نظيرتها بمدينة سلا، على ضوء معلومات وفرتها مصالح المديرية العامة لمراقبة التراب الوطني، اليوم الأربعاء 3 غشت الجاري، من توقيف شخص يشتبه في تورطه في انتحال صفة ينظمها القانون والنصب والاحتيال. وكان المشتبه فيه قد انتحل صفة مسؤولين عسكريين وأمنيين، وعرّض مجموعة من الأشخاص للنصب والاحتيال بمدينة', 'size': 4}, {'id': '212', 'title': 'الأمن يوقف محتالًا انتحل صفة مسؤولين عسكريين وأمنيين', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%a7%d9%84%d9%86%d8%b5%d8%a8-%d9%88%d8%a7%d9%84%d8%a7%d8%ad%d8%aa%d9%8a%d8%a7%d9%84-%d9%88%d8%b1%d8%b2%d8%a7%d8%b2%d8%a7%d8%aa/', 'summary': 'الأمن يوقف محتالًا انتحل صفة مسؤولين عسكريين وأمنيين.  – متابعات تمكنت عناصر الشرطة بـ الأمن الجهوي بورزازات، بتنسيق مع نظيرتها بمدينة سلا، وبتعاون مع مصالح المديرية العامة لمراقبة التراب الوطني، اليوم الأربعاء 3 غشت الجاري، من...  الأمن يوقف محتالًا انتحل صفة مسؤولين عسكريين وأمنيين     .', 'size': 3}, {'id': '223', 'title': 'مصالح “الديستي” تطيح بمتورط في انتحال صفة مسؤولين عسكريين وأمنيين بغرض النصب', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/226637/', 'summary': 'مصالح “الديستي” تطيح بمتورط في انتحال صفة مسؤولين عسكريين وأمنيين بغرض النصب. تمكنت عناصر الشرطة بالأمن الجهوي بورزازات بتنسيق مع نظيرتها بمدينة سلا، على ضوء معلومات وفرتها مصالح المديرية العامة لمراقبة التراب الوطني، اليوم الأربعاء 3 غشت الجاري، من توقيف شخص يشتبه في تورطه في انتحال صفة ينظمها القانون والنصب والاحتيال. وكان المشتبه فيه قد انتحل صفة مسؤولين عسكريين وأمنيين، وعرّض مجموعة من الأشخاص للنصب والاحتيال بمدينة', 'size': 3}, {'id': '387', 'title': 'توقيف شخص بورزازات بشبهة انتحال صفة والنصب والاحتيال', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%aa%d9%88%d9%82%d9%8a%d9%81-%d8%b4%d8%ae%d8%b5-%d8%a8%d9%88%d8%b1%d8%b2%d8%a7%d8%b2%d8%a7%d8%aa-%d8%a8%d8%b4%d8%a8%d9%87%d8%a9-%d8%a7%d9%86%d8%aa%d8%ad%d8%a7%d9%84-%d8%b5%d9%81%d8%a9-%d9%88%d8%a7/', 'summary': 'توقيف شخص بورزازات بشبهة انتحال صفة والنصب والاحتيال. تمكنت عناصر الشرطة بالأمن الجهوي بورزازات، بتنسيق مع نظيرتها بمدينة سلا، على ضوء معلومات وفرتها مصالح المديرية العامة لمراقبة التراب الوطني، أمس الأربعاء 3 غشت 2025، من توقيف شخص يشتبه في تورطه في انتحال صفة ينظمها القانون والنصب والاحتيال. وكشفت مصادر أمنية، أن المشتبه فيه قد انتحل صفة مسؤولين عسكريين وأمنيين، وعرّض مجموعة …  توقيف شخص بورزازات بشبهة انتحال صفة والنصب والاحتيال     .', 'size': 5}], 'main_title': 'توقيف شخص بورزازات بشبهة انتحال صفة والنصب والاحتيال'}, {'community_id': '3', 'articles': [{'id': '117', 'title': 'الحكم الصادر في حق ابتسام لشكر بعد إساءتها لـ"الذات الإلهية"', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/412123.html', 'summary': 'الحكم الصادر في حق ابتسام لشكر بعد إساءتها لـ"الذات الإلهية". أدانت المحكمة الابتدائية بالرباط، مساء الأربعاء 3 شتنبر 2025، الناشطة النسوية ابتسام لشكر، بسنتين ونصف حبسا نافذا وغرامة مالية حددت في 50 ألف درهم، على', 'size': 5}, {'id': '147', 'title': 'سنتان ونصف حبسا نافذا لابتسام لشكر بتهمة الإساءة للدين الإسلامي', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/322441/', 'summary': 'سنتان ونصف حبسا نافذا لابتسام لشكر بتهمة الإساءة للدين الإسلامي. أصدرت المحكمة الابتدائية بالرباط، اليوم الأربعاء، حكماً يقضي بالحبس النافذ لمدة سنتين ونصف في حق ابتسام لشكر، مع تغريمها مبلغاً مالياً قدره خمسون ألف درهم، على خلفية قضية أثارت جدلاً واسعاً في الأوساط الإعلامية ومواقع التواصل الاجتماعي خلال الأسابيع الماضية. وجاء الحكم بعد أن وضعت المتهمة رهن الاعتقال منذ 10 غشت الماضي، مباشرة عقب نشرها', 'size': 3}, {'id': '177', 'title': 'سنتان ونصف حبسا نافذا بحق ابتسام لشكر بعد حادث "التيشورت"', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%b3%d9%86%d8%aa%d8%a7%d9%86-%d9%88%d9%86%d8%b5%d9%81-%d8%ad%d8%a8%d8%b3%d8%a7-%d9%86%d8%a7%d9%81%d8%b0%d8%a7-%d8%a8%d8%ad%d9%82-%d8%a7%d8%a8%d8%aa%d8%b3%d8%a7%d9%85-%d9%84%d8%b4%d9%83%d8%b1-%d8%a8/', 'summary': 'سنتان ونصف حبسا نافذا بحق ابتسام لشكر بعد حادث "التيشورت". قضت المحكمة الابتدائية بالرباط، اليوم الأربعاء، بسنتين ونصف حبسا نافذا وغرامة مالية قدرها 50 ألف درهم، في حق المدافعة عن الحريات الفردية ابتسام لشكر. وكانت هيئة دفاع الناشطة الحقوقية قد طالبت، خلال جلسة الأسبوع الماضي، بتمتيعها بالسراح المؤقت، فيما جرى اعتقالها يوم 10 غشت الجاري بالرباط. وأوضحت هيئة الدفاع في مرافعتها أن موكلتها تعاني من  سنتان ونصف حبسا نافذا بحق ابتسام لشكر بعد حادث "التيشورت"     .', 'size': 4}, {'id': '192', 'title': 'القضاء يدين ابتسام لشكر بسنتين ونصف حبسا نافذا', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/474455.html', 'summary': 'القضاء يدين ابتسام لشكر بسنتين ونصف حبسا نافذا. أدانت المحكمة الابتدائية بالرباط، مساء اليوم الأربعاء، الناشطة المثيرة للجدل ابتسام لشكر، بسنتين ونصف السنة حبسا نافذا، وغرامة مالية تناهز 50 ألف درهم، بتهمة الإساءة للذات الإلهية. وكانت ابتسام لشكر، قد نشرت قبل أسابيع، صورة لها بحسابها على إحدى منصات التواصل الاجتماعي، تظهر فيها وهي ترتدي قميصا مكتوب عليه عبارات مسيئة للذات الإلهية، وأرفقت الصورة …', 'size': 3}, {'id': '241', 'title': 'ابتدائية الرباط تدين المدعوة ابتسام لشكر بالحبس النافذ', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d8%a8%d8%aa%d8%af%d8%a7%d8%a6%d9%8a%d8%a9-%d8%a7%d9%84%d8%b1%d8%a8%d8%a7%d8%b7-%d8%aa%d8%af%d9%8a%d9%86-%d8%a7%d9%84%d9%85%d8%af%d8%b9%d9%88%d8%a9-%d8%a7%d8%a8%d8%aa%d8%b3%d8%a7%d9%85-%d9%84/', 'summary': 'ابتدائية الرباط تدين المدعوة ابتسام لشكر بالحبس النافذ. أصدرت المحكمة الابتدائية بالرباط، اليوم الأربعاء 3 شتنبر 2025، حكما يقضي بإدانة الناشطة ابتسام لشكر بسنتين ونصف حبسا نافذا، إضافة إلى غرامة 50 ألف درهم، وذلك على خلفية متابعتها بتهمة الإساءة إلى الذات الإلهية. وكانت هيئة الدفاع قد التمست تمتيع لشكر بالسراح المؤقت مراعاة لوضعها الصحي، حيث أكدت حاجتها إلى عملية جراحية في …  ابتدائية الرباط تدين المدعوة ابتسام لشكر بالحبس النافذ     .', 'size': 2}], 'main_title': 'الحكم الصادر في حق ابتسام لشكر بعد إساءتها لـ"الذات الإلهية"'}, {'community_id': '4', 'articles': [{'id': '159', 'title': 'فيدرالية اليسار تقترح تخفيض الدعم العمومي للأحزاب عند تورط برلمانييها في قضايا فساد', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1097043.html', 'summary': 'فيدرالية اليسار تقترح تخفيض الدعم العمومي للأحزاب عند تورط برلمانييها في قضايا فساد. دعا حزب فيدرالية اليسار الديمقراطي، ضمن مذكرته للإصلاح الانتخابي، ظهرت المقالة فيدرالية اليسار تقترح تخفيض الدعم العمومي للأحزاب عند تورط برلمانييها في قضايا فساد  .', 'size': 2}, {'id': '199', 'title': 'فيدرالية اليسار ترفع مقترحات لتحقيق المناصفة في انتخابات 2026', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/474433.html', 'summary': 'فيدرالية اليسار ترفع مقترحات لتحقيق المناصفة في انتخابات 2026. قدمت فيدرالية اليسار الديمقراطي في مذكرتها الموجهة إلى وزارة الداخلية بشأن الانتخابات التشريعية المقبلة، عدة مقترحات.', 'size': 2}], 'main_title': 'فيدرالية اليسار تقترح تخفيض الدعم العمومي للأحزاب عند تورط برلمانييها في قضايا فساد'}, {'community_id': '5', 'articles': [{'id': '181', 'title': 'طقس اليوم: استمرار الجو الحار بهذه المناطق', 'source': 'soltana.ma', 'link': 'https://soltana.ma/1357754.html', 'summary': 'طقس اليوم: استمرار الجو الحار بهذه المناطق. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الأربعاء، أن يظل الطقس حارا نسبيا بالجنوب الشرقي للبلاد، والمنطقة الشرقية والسهول غرب الأطلس وداخل الأقاليم الجنوبية. ويرتقب، كذلك، تشكل سحب منخفضة كثيفة بالسواحل الوسطى مع كتل ضبابية محلية خلال الصباح والليل. كما سيكون الطقس هادئا مع سماء صافية الى قليلة السحب.وستتراوح درجات الحرارة الدنيا، ما بين 20', 'size': 4}, {'id': '323', 'title': 'توقعات طقس اليوم الخميس', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/322458/', 'summary': 'توقعات طقس اليوم الخميس. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الخميس، أن يظل الطقس حارا نسبيا بكل من السهول المتواجدة غرب الأطلس والجنوب-الشرقي وبأقصى جنوب البلاد. كما يرتقب تشكل سحب منخفضة كثيفة بعض الشيء ومصحوبة بكتل من الضباب على السواحل الوسطى والواجهة المتوسطية وبالشمال الغربي للأقاليم الصحراوية للمملكة خلال الليل والصباح. وتتوقع المديرية أيضا بعض القطرات مصحوبة برعد', 'size': 4}, {'id': '332', 'title': 'توقعات الأرصاد الجوية لطقس الخميس', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-587745.html', 'summary': 'توقعات الأرصاد الجوية لطقس الخميس. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليوم الخميس، أن يظل الطقس حارا نسبيا بكل من السهول المتواجدة غرب الأطلس والجنوب-الشرقي وبأقصى جنوب البلاد. كما يرتقب تشكل سحب منخفضة كثيفة بعض الشيء ومصحوبة بكتل من الضباب على السواحل الوسطى والواجهة المتوسطية وبالشمال الغربي للأقاليم الصحراوية للمملكة خلال الليل والصباح. وتتوقع المديرية أيضا بعض', 'size': 4}, {'id': '351', 'title': 'طقس حار مع سحب منخفضة متوقع اليوم الخميس', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%b7%d9%82%d8%b3-%d8%ad%d8%a7%d8%b1-%d9%85%d8%b9-%d8%b3%d8%ad%d8%a8-%d9%85%d9%86%d8%ae%d9%81%d8%b6%d8%a9-%d9%85%d8%aa%d9%88%d9%82%d8%b9-%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%ae%d9%85%d9%8a/', 'summary': 'طقس حار مع سحب منخفضة متوقع اليوم الخميس. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الخميس، أن يظل الطقس حارا نسبيا بكل من السهول المتواجدة غرب الأطلس والجنوب-الشرقي وبأقصى جنوب البلاد. كما يرتقب تشكل سحب منخفضة كثيفة بعض الشيء ومصحوبة بكتل من الضباب على السواحل الوسطى والواجهة المتوسطية وبالشمال الغربي للأقاليم الصحراوية للمملكة خلال الليل والصباح. وتتوقع المديرية، أيضا، بعض القطرات مصحوبة برعد  طقس حار مع سحب منخفضة متوقع اليوم الخميس     .', 'size': 5}, {'id': '394', 'title': 'طقس حار نسبي ورياح قوية مرتقبة اليوم الخميس بالمغرب', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%b7%d9%82%d8%b3-%d8%ad%d8%a7%d8%b1-%d9%86%d8%b3%d8%a8%d9%8a-%d9%88%d8%b1%d9%8a%d8%a7%d8%ad-%d9%82%d9%88%d9%8a%d8%a9-%d9%85%d8%b1%d8%aa%d9%82%d8%a8%d8%a9-%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84/', 'summary': 'طقس حار نسبي ورياح قوية مرتقبة اليوم الخميس بالمغرب. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الخميس، أن يظل الطقس حارا نسبيا بكل من السهول المتواجدة غرب الأطلس والجنوب-الشرقي وبأقصى جنوب البلاد. كما يرتقب تشكل سحب منخفضة كثيفة بعض الشيء ومصحوبة بكتل من الضباب على السواحل الوسطى والواجهة المتوسطية وبالشمال الغربي للأقاليم الصحراوية للمملكة خلال الليل والصباح. وتتوقع المديرية أيضا بعض القطرات …  طقس حار نسبي ورياح قوية مرتقبة اليوم الخميس بالمغرب     .', 'size': 2}], 'main_title': 'طقس حار مع سحب منخفضة متوقع اليوم الخميس'}, {'community_id': '6', 'articles': [{'id': '182', 'title': 'جلالة الملك يترأس الخميس إحياء ليلة المولد النبوي الشريف بمسجد حسان بالرباط', 'source': 'rue20.com', 'link': 'https://rue20.com/933521.html', 'summary': 'جلالة الملك يترأس الخميس إحياء ليلة المولد النبوي الشريف بمسجد حسان بالرباط.  . الرباط أعلنت وزارة القصور الملكية والتشريفات والأوسمة أن أمير المؤمنين صاحب الجلالة الملك محمد السادس، نصره الله، سيترأس يوم غد الخميس إحياء ليلة المولد النبوي الشريف بمسجد حسان بمدينة الرباط. وفي ما يلي نص بلاغ الوزارة بهذا الخصوص: “تعلن وزارة القصور الملكية والتشريفات والأوسمة أن أمير المؤمنين صاحب الجلالة الملك محمد السادس الخبر جلالة الملك يترأس الخميس إحياء ليلة المولد النبوي الشريف بمسجد حسان بالرباط  .', 'size': 4}, {'id': '222', 'title': 'جلالة الملك يترأس غدا الخميس إحياء ليلة المولد النبوي الشريف بمسجد حسان بالرباط', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/226642/', 'summary': 'جلالة الملك يترأس غدا الخميس إحياء ليلة المولد النبوي الشريف بمسجد حسان بالرباط. أعلنت وزارة القصور الملكية والتشريفات والأوسمة أن أمير المؤمنين صاحب الجلالة الملك محمد السادس، نصره الله، سيترأس يوم غد الخميس إحياء ليلة المولد النبوي الشريف بمسجد حسان بمدينة الرباط. وفي ما يلي نص بلاغ الوزارة بهذا الخصوص: “تعلن وزارة القصور الملكية والتشريفات والأوسمة أن أمير المؤمنين صاحب الجلالة الملك محمد السادس نصره الله وأيده سيترأس', 'size': 4}, {'id': '230', 'title': 'الملك محمد السادس يترأس إحياء ليلة المولد النبوي بمسجد حسان بالرباط', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7%d8%af%d8%b3-%d9%8a%d8%aa%d8%b1%d8%a3%d8%b3-%d8%a5%d8%ad%d9%8a%d8%a7%d8%a1-%d9%84%d9%8a%d9%84%d8%a9-%d8%a7%d9%84%d9%85/', 'summary': 'الملك محمد السادس يترأس إحياء ليلة المولد النبوي بمسجد حسان بالرباط. المساء اليوم – الرباط: أعلنت وزارة القصور الملكية والتشريفات والأوسمة أن الملك محمد السادس، سيترأس يوم غد الخميس إحياء ليلة المولد النبوي الشريف بمسجد حسان بمدينة الرباط. وفي ما يلي نص بلاغ الوزارة بهذا الخصوص:', 'size': 4}, {'id': '242', 'title': 'أمير المؤمنين الملك محمد السادس يترأس غدا الخميس إحياء ليلة المولد النبوي الشريف بمسجد حسان بالرباط', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a3%d9%85%d9%8a%d8%b1-%d8%a7%d9%84%d9%85%d8%a4%d9%85%d9%86%d9%8a%d9%86-%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7%d8%af%d8%b3-%d9%8a%d8%aa%d8%b1%d8%a3%d8%b3-4/', 'summary': 'أمير المؤمنين الملك محمد السادس يترأس غدا الخميس إحياء ليلة المولد النبوي الشريف بمسجد حسان بالرباط. أعلنت وزارة القصور الملكية والتشريفات والأوسمة أن أمير المؤمنين الملك محمد السادس، سيترأس يوم غد الخميس 04 شتنبر 2025، إحياء ليلة المولد النبوي الشريف بمسجد حسان بمدينة الرباط. وفي ما يلي نص بلاغ الوزارة بهذا الخصوص: “تعلن وزارة القصور الملكية والتشريفات والأوسمة أن أمير المؤمنين صاحب الجلالة الملك محمد السادس نصره الله وأيده …  أمير المؤمنين الملك محمد السادس يترأس غدا الخميس إحياء ليلة المولد النبوي الشريف بمسجد حسان بالرباط     .', 'size': 4}], 'main_title': 'جلالة الملك يترأس الخميس إحياء ليلة المولد النبوي الشريف بمسجد حسان بالرباط'}, {'community_id': '7', 'articles': [{'id': '191', 'title': 'صادرات المغرب تؤمن ثلث احتياجات إسبانيا من الخضر و الفواكه', 'source': 'rue20.com', 'link': 'https://rue20.com/933456.html', 'summary': 'صادرات المغرب تؤمن ثلث احتياجات إسبانيا من الخضر و الفواكه.  | الرباط سجّلت صادرات المغرب من الفواكه والخضروات الطازجة إلى إسبانيا نموًا لافتًا خلال الأشهر الأربعة الأولى من عام 2025، حيث بلغت قيمتها نحو 729 مليون دولار أمريكي (672 مليون يورو)، ما يمثل زيادة بنسبة 28% مقارنةً بالفترة نفسها من عام 2024. وتُعد إسبانيا من أبرز شركاء المغرب التجاريين في القطاع الفلاحي، إذ الخبر صادرات المغرب تؤمن ثلث احتياجات إسبانيا من الخضر و الفواكه  .', 'size': 2}, {'id': '325', 'title': 'المغرب يُؤمّن احتياجات إسبانيا من الخضر والفواكه', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-587780.html', 'summary': 'المغرب يُؤمّن احتياجات إسبانيا من الخضر والفواكه. ط.غ شهدت صادرات المغرب من الفواكه والخضروات الطازجة إلى السوق الإسبانية ارتفاعا كبيرا خلال الأشهر الأربعة الأولى من عام 2025، حيث بلغت قيمتها نحو 729 مليون دولار أمريكي (ما يعادل 672 مليون يورو)، مسجلة زيادة بنسبة 28 في المائة مقارنة بالفترة نفسها من عام 2024. وتُعد إسبانيا من أبرز الوجهات', 'size': 2}], 'main_title': 'صادرات المغرب تؤمن ثلث احتياجات إسبانيا من الخضر و الفواكه'}, {'community_id': '9', 'articles': [{'id': '270', 'title': 'بوريطة يشارك في اجتماع وزاري بمصر', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d8%a8%d9%88%d8%b1%d9%8a%d8%b7%d8%a9-%d9%8a%d8%b4%d8%a7%d8%b1%d9%83-%d9%81%d9%8a-%d8%a7%d8%ac%d8%aa%d9%85%d8%a7%d8%b9-%d9%88%d8%b2%d8%a7%d8%b1%d9%8a-%d8%a8%d9%85%d8%b5%d8%b1-1618606.html', 'summary': 'بوريطة يشارك في اجتماع وزاري بمصر. حلّ ناصر بوريطة، وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج، صباح اليوم الخميس، بالقاهرة، للمشاركة في اجتماع الدورة الرابعة والستين بعد المائة لمجلس جامعة الدول العربية على المستوى الوزاري. وإلى جانب أشغال مجلس الجامعة، شارك ناصر بوريطة، بهذه المناسبة، في اجتماع اللجنة الوزارية العربية المكلفة بالتحرك الدولي لمواجهة السياسات والإجراءات الإسرائيلية غير القانونية في  بوريطة يشارك في اجتماع وزاري بمصر     - هسبريس جريدة إلكترونية مغربية .', 'size': 3}, {'id': '284', 'title': 'بوريطة بالقاهرة للمشاركة في اجتماع مجلس جامعة الدول العربية', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-654312.html', 'summary': 'بوريطة بالقاهرة للمشاركة في اجتماع مجلس جامعة الدول العربية. هبة بريس حل وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج ناصر بوريطة ، صباح اليوم الخميس بالقاهرة، للمشاركة في اجتماع الدورة 164 لمجلس جامعة الدول العربية على المستوى الوزاري. وإلى جانب أشغال مجلس الجامعة، شارك ناصر بوريطة، بهذه المناسبة، في اجتماع اللجنة الوزارية العربية المكلفة بالتحرك الدولي لمواجهة السياسات والإجراءات الإسرائيلية غير القانونية في مدينة القدس المحتلة.', 'size': 3}, {'id': '379', 'title': 'بوريطة في القاهرة', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/226650/', 'summary': 'بوريطة في القاهرة. القاهرة – حل وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج ناصر بوريطة، صباح اليوم الخميس بالقاهرة، للمشاركة في اجتماع الدورة 164 لمجلس جامعة الدول العربية على المستوى الوزاري. وإلى جانب أشغال مجلس الجامعة، شارك ناصر بوريطة، بهذه المناسبة، في اجتماع اللجنة الوزارية العربية المكلفة بالتحرك الدولي لمواجهة السياسات والإجراءات الإسرائيلية غير القانونية في مدينة', 'size': 2}, {'id': '390', 'title': 'ناصر بوريطة يشارك في الدورة 164 لمجلس جامعة الدول العربية على المستوى الوزاري', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%86%d8%a7%d8%b5%d8%b1-%d8%a8%d9%88%d8%b1%d9%8a%d8%b7%d8%a9-%d9%8a%d8%b4%d8%a7%d8%b1%d9%83-%d9%81%d9%8a-%d8%a7%d9%84%d8%af%d9%88%d8%b1%d8%a9-164-%d9%84%d9%85%d8%ac%d9%84%d8%b3-%d8%ac%d8%a7%d9%85/', 'summary': 'ناصر بوريطة يشارك في الدورة 164 لمجلس جامعة الدول العربية على المستوى الوزاري. وصل وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج ناصر بوريطة، صباح اليوم الخميس 04 شتنبر 2025 إلى القاهرة، للمشاركة في اجتماع الدورة 164 لمجلس جامعة الدول العربية على المستوى الوزاري. وبالموازاة مع أشغال مجلس الجامعة، شارك ناصر بوريطة في اجتماع اللجنة الوزارية العربية المكلفة بالتحرك الدولي لمواجهة السياسات والإجراءات الإسرائيلية غير القانونية في …  ناصر بوريطة يشارك في الدورة 164 لمجلس جامعة الدول العربية على المستوى الوزاري     .', 'size': 2}], 'main_title': 'بوريطة يشارك في اجتماع وزاري بمصر'}, {'community_id': '8', 'articles': [{'id': '299', 'title': 'لشبونة.. مصرع 15 شخصاً في حادث خروج قطار جبلي مائل عن مساره', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/world/412132.html', 'summary': 'لشبونة.. مصرع 15 شخصاً في حادث خروج قطار جبلي مائل عن مساره. شهدت العاصمة البرتغالية لشبونة حادثاً مأساوياً، بعد خروج إحدى عربتي قطار "غلوريا" الجبلي المائل الشهير عن مساره وتحطمها، ما أسفر عن مقتل ما لا يقل', 'size': 2}, {'id': '385', 'title': 'مصرع 15 شخصا في تحطم قطار جبلي بالبرتغال', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d9%85%d8%b5%d8%b1%d8%b9-15-%d8%b4%d8%ae%d8%b5%d8%a7-%d9%81%d9%8a-%d8%aa%d8%ad%d8%b7%d9%85-%d9%82%d8%b7%d8%a7%d8%b1-%d8%ac%d8%a8%d9%84%d9%8a-%d8%a8%d8%a7%d9%84%d8%a8%d8%b1%d8%aa%d8%ba%d8%a7%d9%84/', 'summary': 'مصرع 15 شخصا في تحطم قطار جبلي بالبرتغال. المساء اليوم – وكالات: لقي 15 شخصا على الأقل مصرعهم وأصيب 18 آخرين إثر خروج عربة قطار غلوريا الجبلي المائل عن مسارها وتحطمه في العاصمة لشبونة، حسب ما أعلنت السلطات البرتغالية مساء أمس الأربعاء. وأفادت', 'size': 2}], 'main_title': 'لشبونة.. مصرع 15 شخصاً في حادث خروج قطار جبلي مائل عن مساره'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    