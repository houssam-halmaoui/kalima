<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 08/09/2025 - 06h13</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '3', 'articles': [{'id': '0', 'title': 'قمة تؤيد الوحدة الترابية للدول', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d9%82%d9%85%d8%a9-%d8%aa%d8%a4%d9%8a%d8%af-%d8%a7%d9%84%d9%88%d8%ad%d8%af%d8%a9-%d8%a7%d9%84%d8%aa%d8%b1%d8%a7%d8%a8%d9%8a%d8%a9-%d9%84%d9%84%d8%af%d9%88%d9%84-1620441.html', 'summary': 'قمة تؤيد الوحدة الترابية للدول. كرست قمة إفريقيا-الكاريكوم (الجماعة الكاريبية) الثانية، التي تنعقد اليوم الأحد بأديس أبابا، مبادئ احترام السيادة والوحدة الترابية للدول، والمسؤولية الرئيسية لمجلس الأمن التابع للأمم المتحدة في الحفاظ على السلم والأمن الدوليين. وكرس إعلان أديس أبابا، الذي توج أشغال قمة إفريقيا-الكاريكوم الثانية حول الشراكة العابرة للقارات من أجل العدالة التعويضية للأفارقة وللأشخاص من أصول إفريقية، مبادئ  قمة تؤيد الوحدة الترابية للدول     - هسبريس جريدة إلكترونية مغربية .', 'size': 2}, {'id': '179', 'title': 'قمة إفريقيا-الكاريكوم الثانية تكرس مبادئ احترام السيادة والوحدة الترابية للدول', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/474739.html', 'summary': 'قمة إفريقيا-الكاريكوم الثانية تكرس مبادئ احترام السيادة والوحدة الترابية للدول. كرست قمة إفريقيا-الكاريكوم (الجماعة الكاريبية) الثانية، التي تنعقد اليوم الأحد بأديس أبابا، مبادئ احترام السيادة والوحدة الترابية للدول والمسؤولية الرئيسية لمجلس الأمن التابع للأمم المتحدة في الحفاظ على السلم والأمن الدوليين، باعتبارها مبادئ أساسية لميثاق الأمم المتحدة.', 'size': 2}], 'main_title': 'قمة تؤيد الوحدة الترابية للدول'}, {'community_id': '1', 'articles': [{'id': '6', 'title': 'إبراز المبادرة الأطلسية في أديس أبابا', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d8%a5%d8%a8%d8%b1%d8%a7%d8%b2-%d8%a7%d9%84%d9%85%d8%a8%d8%a7%d8%af%d8%b1%d8%a9-%d8%a7%d9%84%d8%a3%d8%b7%d9%84%d8%b3%d9%8a%d8%a9-%d9%81%d9%8a-%d8%a3%d8%af%d9%8a%d8%b3-%d8%a3%d8%a8%d8%a7%d8%a8%d8%a7-1620379.html', 'summary': 'إبراز المبادرة الأطلسية في أديس أبابا. تم، اليوم الأحد في أديس أبابا، تسليط الضوء على المبادرة الملكية الأطلسية، باعتبارها تجسيدا للتعاون الفاعل جنوب-جنوب بين إفريقيا ومنطقة الكاريبي، وذلك خلال قمة إفريقيا-الكاريكوم الثانية. وأكد السفير الممثل الدائم للمملكة المغربية لدى الاتحاد الإفريقي واللجنة الاقتصادية لإفريقيا، محمد عروشي، في كلمته خلال قمة إفريقيا-الكاريكوم الثانية، أن “المبادرة الملكية الأطلسية تشكل، وفق الرؤية المستنيرة لصاحب  إبراز المبادرة الأطلسية في أديس أبابا     - هسبريس جريدة إلكترونية مغربية .', 'size': 2}, {'id': '223', 'title': 'المبادرة الملكية الأطلسية تتصدر أشغال قمة إفريقيا–الكاريكوم الثانية في أديس أبابا', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d9%85%d8%a8%d8%a7%d8%af%d8%b1%d8%a9-%d8%a7%d9%84%d9%85%d9%84%d9%83%d9%8a%d8%a9-%d8%a7%d9%84%d8%a3%d8%b7%d9%84%d8%b3%d9%8a%d8%a9-%d8%aa%d8%aa%d8%b5%d8%af%d8%b1-%d8%a3%d8%b4%d8%ba%d8%a7/', 'summary': 'المبادرة الملكية الأطلسية تتصدر أشغال قمة إفريقيا–الكاريكوم الثانية في أديس أبابا. تم، اليوم الأحد 7 شتنبر 2025 في أديس أبابا، تسليط الضوء على المبادرة الملكية الأطلسية، باعتبارها تجسيدا للتعاون الفاعل جنوب-جنوب بين إفريقيا ومنطقة الكاريبي، وذلك خلال قمة إفريقيا-الكاريكوم الثانية. وأكد السفير الممثل الدائم للمملكة المغربية لدى الاتحاد الإفريقي واللجنة الاقتصادية لإفريقيا، محمد عروشي، في كلمته خلال قمة إفريقيا-الكاريكوم الثانية، أن المبادرة الملكية الأطلسية تشكل، …  المبادرة الملكية الأطلسية تتصدر أشغال قمة إفريقيا–الكاريكوم الثانية في أديس أبابا     .', 'size': 2}], 'main_title': 'إبراز المبادرة الأطلسية في أديس أبابا'}, {'community_id': '9', 'articles': [{'id': '30', 'title': 'محمد السادس يهنئ الرئيس البرازيلي ويؤكد استمرار التعاون بين البلدين', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-655199.html', 'summary': 'محمد السادس يهنئ الرئيس البرازيلي ويؤكد استمرار التعاون بين البلدين. هبة بريس بعث صاحب الجلالة الملك محمد السادس برقية تهنئة إلى لويس ايناسيو لولا دا سيلفا، رئيس الجمهورية الفدرالية للبرازيل، وذلك بمناسبة العيد الوطني لبلاده. وقال جلالة الملك، في هذه البرقية ” بمناسبة تخليد الجمهورية الفدرالية للبرازيل لعيدها الوطني، يسرني أن أبعث إليكم بأحر التهاني وأصدق المتمنيات للشعب البرازيلي بتحقيق ما يرجوه من اطراد التقدم والرفاه”. ومما جاء في هذه البرقية أيضا “كما يطيب لي بنفس المناسبة، أن أعرب لفخامتكم عن عزمي الراسخ على مواصلة العمل سويا معكم، من أجل مزيد إثراء وتطوير العلاقات المتميزة التي تربط بين المملكة المغربية والجمهورية الفدرالية للبرازيل، بما يدفع قدما بتعاونهما المشترك في كافة المجالات، ويستجيب لتطلعات شعبينا الصديقين”.', 'size': 2}, {'id': '222', 'title': 'الملك محمد السادس يهنئ الرئيس البرازيلي بمناسبة العيد الوطني لبلاده', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7%d8%af%d8%b3-%d9%8a%d9%87%d9%86%d8%a6-%d8%a7%d9%84%d8%b1%d8%a6%d9%8a%d8%b3-%d8%a7%d9%84%d8%a8%d8%b1%d8%a7%d8%b2%d9%8a-2/', 'summary': 'الملك محمد السادس يهنئ الرئيس البرازيلي بمناسبة العيد الوطني لبلاده. بعث الملك محمد السادس برقية تهنئة إلى لويس ايناسيو لولا دا سيلفا، رئيس الجمهورية الفدرالية للبرازيل، وذلك بمناسبة العيد الوطني لبلاده. وقال الملك محمد السادس، في هذه البرقية ” بمناسبة تخليد الجمهورية الفدرالية للبرازيل لعيدها الوطني، يسرني أن أبعث إليكم بأحر التهاني وأصدق المتمنيات للشعب البرازيلي بتحقيق ما يرجوه من اطراد التقدم والرفاه”. …  الملك محمد السادس يهنئ الرئيس البرازيلي بمناسبة العيد الوطني لبلاده     .', 'size': 2}], 'main_title': 'محمد السادس يهنئ الرئيس البرازيلي ويؤكد استمرار التعاون بين البلدين'}, {'community_id': '11', 'articles': [{'id': '40', 'title': 'نشرة إنذارية: زخات رعدية وهبات رياح اليوم الأحد بعدة مناطق', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-655177.html', 'summary': 'نشرة إنذارية: زخات رعدية وهبات رياح اليوم الأحد بعدة مناطق. هبة بريس - الرباط حذرت المديرية العامة للأرصاد الجوية ، اليوم الأحد 7 شتنبر 2025، من زخات رعدية مصحوبة بهبات رياح في بعض مناطق المملكة. وأوضحت المديرية في نشرة إنذارية أن هذه الأمطار والزخات الرعدية ستهم عمالات وأقاليم السمارة، فكيك، تاوريرت، كرسيف، وبوجدور، مع توقع تساقطات مطرية تتراوح بين 25 و35 ملم. ومن المنتظر أن تبدأ الأمطار والزخات الرعدية ابتداءً من الساعة 13:00 وتستمر إلى غاية الساعة 23:00 مساءً.', 'size': 2}, {'id': '304', 'title': 'بمقاييس تصل إلى 35 ملمتر.. زخات رعدية قوية متوقعة في عدد من المناطق', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a8%d9%85%d9%82%d8%a7%d9%8a%d9%8a%d8%b3-%d8%aa%d8%b5%d9%84-%d8%a5%d9%84%d9%89-35-%d9%85%d9%84%d9%85%d8%aa%d8%b1-%d8%b2%d8%ae%d8%a7%d8%aa-%d8%b1%d8%b9%d8%af%d9%8a%d8%a9-%d9%82%d9%88%d9%8a%d8%a9/', 'summary': 'بمقاييس تصل إلى 35 ملمتر.. زخات رعدية قوية متوقعة في عدد من المناطق. أصدرت المديرية العامة للأرصاد الجوية الوطنية نشرة إنذارية من مستوى يقظة برتقالي، محذرة من زخات رعدية قوية مصحوبة برياح عاتية متوقعة في عدد من أقاليم المملكة اليوم الأحد (07 شتنبر). وتشير النشرة الإنذارية إلى أن الاضطراب الجوي، يشمل أقاليم منها، السمارة، فكيك، تاوريرت، كرسيف، وبوجدور، حيث ينتظر تسجيل كميات أمطار تتراوح بين 25 إلى 35', 'size': 2}], 'main_title': 'نشرة إنذارية: زخات رعدية وهبات رياح اليوم الأحد بعدة مناطق'}, {'community_id': '4', 'articles': [{'id': '68', 'title': 'ولاية أمن أسفي تنفي صحة ما ورد في شريط فيديو يزعم ارتكاب سرقة في الشريط الساحلي بالمدينة', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/205834', 'summary': 'ولاية أمن أسفي تنفي صحة ما ورد في شريط فيديو يزعم ارتكاب سرقة في الشريط الساحلي بالمدينة.  تفاعل الأمن الإقليمي بمدينة أسفي، بجدية كبيرة، مع شريط فيديو منشور على صفحات مواقع التواصل الاجتماعي، يظهر فيه شخصان يتنازعان حول حقيبة باستعمال السلاح الأبيض في الشريط الساحلي بالمدينة، ومشفوع بتعليق كاذب يزعم بأنها عملية للسرقة. وقد أوضحت الأبحاث والتحريات المنجزة على ضوء هذا الشريط، أن الأمر لا يتعلق بعملية للسرقة وإنما بتبادل للعنف', 'size': 3}, {'id': '106', 'title': 'فيديو نزاع مسلح حول حقيبة يستنفر الأجهزة الأمنية', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/412325.html', 'summary': 'فيديو نزاع مسلح حول حقيبة يستنفر الأجهزة الأمنية. تفاعل الأمن الإقليمي بمدينة أسفي، بجدية كبيرة، مع شريط فيديو منشور على صفحات مواقع التواصل الاجتماعي، يظهر فيه شخصان يتنازعان حول حقيبة باستعمال السلاح الأبيض', 'size': 2}, {'id': '324', 'title': 'أمن آسفي يوضح حقيقة فيديو “السرقة”', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/322740/', 'summary': 'أمن آسفي يوضح حقيقة فيديو “السرقة”. تفاعل الأمن الإقليمي بمدينة أسفي، بجدية كبيرة، مع شريط فيديو منشور على صفحات مواقع التواصل الاجتماعي، يظهر فيه شخصان يتنازعان حول حقيبة باستعمال السلاح الأبيض في الشريط الساحلي بالمدينة، ومشفوع بتعليق كاذب يزعم بأنها عملية للسرقة. وقد أوضحت الأبحاث والتحريات المنجزة على ضوء هذا الشريط، أن الأمر لا يتعلق بعملية للسرقة وإنما بتبادل للعنف من', 'size': 2}], 'main_title': 'ولاية أمن أسفي تنفي صحة ما ورد في شريط فيديو يزعم ارتكاب سرقة في الشريط الساحلي بالمدينة'}, {'community_id': '7', 'articles': [{'id': '71', 'title': 'من بينها المغرب .. خسوف "قمر الدم" يلون سماء عدد من الدول العربية مساء غد الأحد', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/last/412284.html', 'summary': 'من بينها المغرب .. خسوف "قمر الدم" يلون سماء عدد من الدول العربية مساء غد الأحد. يستعد المغاربة على غرار عدد من سكان المعمور، مساء يوم غد الأحد 7 شتنبر، لمتابعة خسوف قمري كلي يُحوِّل وجه القمر إلى لون أحمر داكن فيما', 'size': 2}, {'id': '217', 'title': 'خسوف القمر اليوم: جزء يمكن رؤيته من المغرب', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%ae%d8%b3%d9%88%d9%81-%d8%a7%d9%84%d9%82%d9%85%d8%b1-%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d8%ac%d8%b2%d8%a1-%d9%8a%d9%85%d9%83%d9%86-%d8%b1%d8%a4%d9%8a%d8%aa%d9%87-%d9%85%d9%86-%d8%a7%d9%84%d9%85%d8%ba/', 'summary': 'خسوف القمر اليوم: جزء يمكن رؤيته من المغرب. المساء اليوم – متابعات: تشهد دول الوطن العربي خسوفا قمريا يبدأ اليوم الأحد 7 سبتمبر، وفي أثناء الظاهرة سيبدو وجه القمر البدر كأنه يتآكل شيئًا فشيئًا بقدر يسير حتى يصل إلى لحظة يتحول فيها القمر', 'size': 2}], 'main_title': 'من بينها المغرب .. خسوف "قمر الدم" يلون سماء عدد من الدول العربية مساء غد الأحد'}, {'community_id': '13', 'articles': [{'id': '105', 'title': 'زلزال الحوز.. تعبئة متواصلة بمراكش من أجل تنفيذ عملية إعادة البناء على الوجه الأمثل', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/national/412323.html', 'summary': 'زلزال الحوز.. تعبئة متواصلة بمراكش من أجل تنفيذ عملية إعادة البناء على الوجه الأمثل. تتميز عملية إعادة بناء وتأهيل المنازل المتضررة بمراكش جراء زلزال الحوز بالسرعة في تنفيذ الأشغال، بفضل التعبئة المتواصلة لمختلف الأطراف المعنية، وذلك تنفيذا للتوجيهات الملكية', 'size': 4}, {'id': '143', 'title': 'عامان على “زلزال الحوز”.. 85% من المتضررين يعودون إلى منازلهم بمراكش', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1097843.html', 'summary': 'عامان على “زلزال الحوز”.. 85% من المتضررين يعودون إلى منازلهم بمراكش. تتميز عملية إعادة بناء وتأهيل المنازل المتضررة بمراكش جراء زلزال الحوز بالسرعة في تنفيذ الأشغال، بفضل التعبئة المتواصلة لمختلف الأطراف المعنية، وذلك تنفيذا للتوجيهات الملكية السامية. وبلغت نسبة تقدم أشغال إعادة بناء وتأهيل المساكن المتضررة جزئيا أو كليا، والتي انطلقت في فبراير 2024، حوالي 85 في المائة، بعد بناء وتدعيم ما يقارب 2620 مسكنا وفق ظهرت المقالة عامان على “زلزال الحوز”.. 85% من المتضررين يعودون إلى منازلهم بمراكش  .', 'size': 5}, {'id': '160', 'title': 'زلزال الحوز.. تعبئة متواصلة بمراكش لتنفيذ عملية إعادة البناء', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%b2%d9%84%d8%b2%d8%a7%d9%84-%d8%a7%d9%84%d8%ad%d9%88%d8%b2-%d8%aa%d8%b9%d8%a8%d8%a6%d8%a9-%d9%85%d8%aa%d9%88%d8%a7%d8%b5%d9%84%d8%a9-%d8%a8%d9%85%d8%b1%d8%a7%d9%83%d8%b4-%d9%84%d8%aa%d9%86%d9%81/', 'summary': 'زلزال الحوز.. تعبئة متواصلة بمراكش لتنفيذ عملية إعادة البناء. بلغت نسبة تقدم أشغال إعادة بناء وتأهيل المساكن المتضررة من زلزال الحوز جزئيا أو كليا، والتي انطلقت في فبراير 2024، حوالي 85 في المائة، بعد بناء وتدعيم ما يقارب 2620 مسكنا وفق معايير تقنية صارمة، حسب ما أفادت به السلطات المحلية. وبفضل الدعم والمراقبة الدقيقة التي تباشرها السلطات المحلية، من المتوقع أن تبلغ هذه  زلزال الحوز.. تعبئة متواصلة بمراكش لتنفيذ عملية إعادة البناء     .', 'size': 5}, {'id': '176', 'title': 'في زمن قياسي.. إعادة بناء 2600 منزل بمراكش وفق المعايير المضادة للزلازل', 'source': 'rue20.com', 'link': 'https://rue20.com/934221.html', 'summary': 'في زمن قياسي.. إعادة بناء 2600 منزل بمراكش وفق المعايير المضادة للزلازل.  / متابعة تتميز عملية إعادة بناء وتأهيل المنازل المتضررة بمراكش جراء زلزال الحوز بالسرعة في تنفيذ الأشغال، بفضل التعبئة المتواصلة لمختلف الأطراف المعنية، وذلك تنفيذا للتوجيهات الملكية السامية. وبلغت نسبة تقدم أشغال إعادة بناء وتأهيل المساكن المتضررة جزئيا أو كليا، والتي انطلقت في فبراير 2024، حوالي 85 في المائة، بعد بناء وتدعيم ما الخبر في زمن قياسي.. إعادة بناء 2600 منزل بمراكش وفق المعايير المضادة للزلازل  .', 'size': 5}, {'id': '267', 'title': 'تقدم 85 % في إعادة البناء بمراكش', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d8%aa%d9%82%d8%af%d9%85-85-%d9%81%d9%8a-%d8%a5%d8%b9%d8%a7%d8%af%d8%a9-%d8%a7%d9%84%d8%a8%d9%86%d8%a7%d8%a1-%d8%a8%d9%85%d8%b1%d8%a7%d9%83%d8%b4-1620316.html', 'summary': 'تقدم 85 % في إعادة البناء بمراكش. تتميز عملية إعادة بناء وتأهيل المنازل المتضررة بمراكش جراء زلزال الحوز بالسرعة في تنفيذ الأشغال، بفضل التعبئة المتواصلة لمختلف الأطراف المعنية، وذلك تنفيذا للتوجيهات الملكية. وبلغت نسبة تقدم أشغال إعادة بناء وتأهيل المساكن المتضررة جزئيا أو كليا، التي انطلقت في فبراير 2024، حوالي 85 في المائة، بعد بناء وتدعيم ما يقارب 2620 مسكنا وفق معايير  تقدم 85 % في إعادة البناء بمراكش     - هسبريس جريدة إلكترونية مغربية .', 'size': 4}], 'main_title': 'عامان على “زلزال الحوز”.. 85% من المتضررين يعودون إلى منازلهم بمراكش'}, {'community_id': '8', 'articles': [{'id': '125', 'title': 'الحوز.. عملية إعادة بناء المنازل ما بعد الزلزال في مراحلها النهائية', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a7%d9%84%d8%ad%d9%88%d8%b2-%d8%b9%d9%85%d9%84%d9%8a%d8%a9-%d8%a5%d8%b9%d8%a7%d8%af%d8%a9-%d8%a8%d9%86%d8%a7%d8%a1-%d8%a7%d9%84%d9%85%d9%86%d8%a7%d8%b2%d9%84-%d9%85%d8%a7-%d8%a8%d8%b9%d8%af/', 'summary': 'الحوز.. عملية إعادة بناء المنازل ما بعد الزلزال في مراحلها النهائية. دخلت عملية إعادة بناء المنازل المتضررة من الزلزال الذي ضرب إقليم الحوز في شتنبر 2023، مراحلها النهائية وذلك بفضل التعبئة غير المسبوقة الجميع الأطراف المعنية، وهو ما تعكسه الأرقام التي كشف عنها منسق برنامج إعادة البناء وتأهيل المناطق المتضررة جراء الزلزال، حسن إيغيغي. وأوضح السيد إيغيغي، في تصريح لوكالة المغرب العربي للأنباء، أن مستوى تقدم', 'size': 3}, {'id': '138', 'title': 'مسؤول: 91% من منازل الحوز أعيد بناؤها وفق معايير مضادة للزلازل', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1097847.html', 'summary': 'مسؤول: 91% من منازل الحوز أعيد بناؤها وفق معايير مضادة للزلازل. دخلت عملية إعادة بناء المنازل المتضررة من الزلزال الذي ضرب إقليم الحوز في شتنبر 2023، مراحلها النهائية وذلك بفضل التعبئة غير المسبوقة الجميع الأطراف المعنية، وهو ما تعكسه الأرقام التي كشف عنها منسق برنامج إعادة البناء وتأهيل المناطق المتضررة جراء الزلزال، حسن إيغيغي. وأوضح إيغيغي، في تصريح لوكالة المغرب العربي للأنباء، أن مستوى تقدم أشغال ظهرت المقالة مسؤول: 91% من منازل الحوز أعيد بناؤها وفق معايير مضادة للزلازل  .', 'size': 3}, {'id': '180', 'title': 'مسؤول: عملية إعادة بناء المنازل ما بعد زلزال الحوز في مراحلها النهائية', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/474736.html', 'summary': 'مسؤول: عملية إعادة بناء المنازل ما بعد زلزال الحوز في مراحلها النهائية. دخلت عملية إعادة بناء المنازل المتضررة من الزلزال الذي ضرب إقليم الحوز في شتنبر 2023، مراحلها النهائية وذلك بفضل التعبئة غير المسبوقة لجميع الأطراف المعنية، وهو ما تعكسه الأرقام التي كشف عنها منسق برنامج إعادة البناء وتأهيل المناطق المتضررة جراء الزلزال، حسن إيغيغي.', 'size': 3}], 'main_title': 'الحوز.. عملية إعادة بناء المنازل ما بعد الزلزال في مراحلها النهائية'}, {'community_id': '5', 'articles': [{'id': '137', 'title': 'أديس أبابا.. قمة إفريقيا–الكاريكوم الثانية تكرس الوحدة الترابية والمبادرة الأطلسية تتصدر أشغالها', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1097867.html', 'summary': 'أديس أبابا.. قمة إفريقيا–الكاريكوم الثانية تكرس الوحدة الترابية والمبادرة الأطلسية تتصدر أشغالها. أكدت قمة إفريقيا–الكاريكوم الثانية، المنعقدة اليوم الأحد بأديس أبابا، على تكريس مبادئ احترام الوحدة الترابية للدول وسيادتها وعدم التدخل في شؤونها الداخلية، في الوقت الذي تصدرت فيه المبادرة الملكية الأطلسية أشغال القمة باعتبارها تجسيدا للتعاون الفاعل بين إفريقيا ومنطقة الكاريبي. ففي إعلانها الختامي، شددت القمة على أن احترام السيادة والوحدة الترابية وحسن الجوار تعد مبادئ ظهرت المقالة أديس أبابا.. قمة إفريقيا–الكاريكوم الثانية تكرس الوحدة الترابية والمبادرة الأطلسية تتصدر أشغالها  .', 'size': 2}, {'id': '181', 'title': 'أديس أبابا.. تسليط الضوء على المبادرة الملكية الأطلسية أمام قمة إفريقيا-الكاريكوم الثانية', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/474733.html', 'summary': 'أديس أبابا.. تسليط الضوء على المبادرة الملكية الأطلسية أمام قمة إفريقيا-الكاريكوم الثانية. تم اليوم الأحد في أديس أبابا، تسليط الضوء على المبادرة الملكية الأطلسية، باعتبارها تجسيدا للتعاون الفاعل جنوب-جنوب بين إفريقيا ومنطقة الكاريبي، وذلك خلال قمة إفريقيا-الكاريكوم الثانية.', 'size': 2}], 'main_title': 'أديس أبابا.. قمة إفريقيا–الكاريكوم الثانية تكرس الوحدة الترابية والمبادرة الأطلسية تتصدر أشغالها'}, {'community_id': '12', 'articles': [{'id': '150', 'title': 'الأمم المتحدة تشيد بالقيادة المغربية في الدفع نحو توافق عالمي بشأن التنمية الاجتماعية', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1097821.html', 'summary': 'الأمم المتحدة تشيد بالقيادة المغربية في الدفع نحو توافق عالمي بشأن التنمية الاجتماعية. سلم السفير الممثل الدائم للمغرب لدى الأمم المتحدة، عمر هلال، برفقة نظيرته البلجيكية، صوفي دو سمدت، لرئيس الدورة الـ79 للجمعية العامة للأمم المتحدة المشروع النهائي لإعلان الدوحة السياسي حول التنمية الاجتماعية، والذي سيتم اعتماده من قبل قادة الدول والحكومات خلال القمة المزمع انعقادها في الفترة من 4 إلى 6 نونبر المقبل في العاصمة القطرية. ويعد ظهرت المقالة الأمم المتحدة تشيد بالقيادة المغربية في الدفع نحو توافق عالمي بشأن التنمية الاجتماعية  .', 'size': 3}, {'id': '185', 'title': 'هلال يختتم بنجاح المفاوضات بشأن “الإعلان السياسي” للقمة الاجتماعية الثانية في الدوحة', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/474717.html', 'summary': 'هلال يختتم بنجاح المفاوضات بشأن “الإعلان السياسي” للقمة الاجتماعية الثانية في الدوحة. سلم السفير الممثل الدائم للمغرب لدى الأمم المتحدة، عمر هلال، برفقة نظيرته البلجيكية، صوفي دو سمدت، لرئيس الدورة الـ79 للجمعية العامة للأمم المتحدة، المشروع النهائي لإعلان الدوحة السياسي حول التنمية الاجتماعية، والذي سيتم اعتماده من قبل قادة الدول والحكومات خلال القمة المزمع انعقادها في الفترة من 4 إلى 6 نونبر المقبل في العاصمة القطرية.', 'size': 3}, {'id': '236', 'title': 'هلال يختتم بنجاح مفاوضات الإعلان السياسي للقمة الاجتماعية المرتقبة في الدوحة', 'source': 'www.alalam.ma', 'link': 'https://www.alalam.ma/هلال-يختتم-بنجاح-مفاوضات-الإعلان-السياسي-للقمة-الاجتماعية_a29371.html', 'summary': 'هلال يختتم بنجاح مفاوضات الإعلان السياسي للقمة الاجتماعية المرتقبة في الدوحة.  سلم السفير الممثل الدائم للمغرب لدى الأمم المتحدة، السيد عمر هلال، برفقة نظيرته البلجيكية، صوفي دو سمدت، لرئيس الدورة الـ7...', 'size': 2}, {'id': '379', 'title': 'الأمم المتحدة: هلال يختتم بنجاح المفاوضات بشأن الإعلان السياسي للقمة الاجتماعية الثانية المرتقبة في الدوحة', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/226774/', 'summary': 'الأمم المتحدة: هلال يختتم بنجاح المفاوضات بشأن الإعلان السياسي للقمة الاجتماعية الثانية المرتقبة في الدوحة. سلم السفير الممثل الدائم للمغرب لدى الأمم المتحدة، السيد عمر هلال، برفقة نظيرته البلجيكية، صوفي دو سمدت، لرئيس الدورة الـ79 للجمعية العامة للأمم المتحدة المشروع النهائي لإعلان الدوحة السياسي حول التنمية الاجتماعية، والذي سيتم اعتماده من قبل قادة الدول والحكومات خلال القمة المزمع انعقادها في الفترة من 4 إلى 6 نونبر المقبل في العاصمة القطرية.', 'size': 4}], 'main_title': 'الأمم المتحدة: هلال يختتم بنجاح المفاوضات بشأن الإعلان السياسي للقمة الاجتماعية الثانية المرتقبة في الدوحة'}, {'community_id': '6', 'articles': [{'id': '195', 'title': 'الحوز.. عملية إعادة بناء المنازل ما بعد الزلزال في مراحلها النهائية (مسؤول)', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%a7%d9%84%d8%ad%d9%88%d8%b2-%d8%b9%d9%85%d9%84%d9%8a%d8%a9-%d8%a5%d8%b9%d8%a7%d8%af%d8%a9-%d8%a8%d9%86%d8%a7%d8%a1-%d8%a7%d9%84%d9%85%d9%86%d8%a7%d8%b2%d9%84-%d9%85%d8%a7-%d8%a8%d8%b9%d8%af/', 'summary': 'الحوز.. عملية إعادة بناء المنازل ما بعد الزلزال في مراحلها النهائية (مسؤول). دخلت عملية إعادة بناء المنازل المتضررة من الزلزال الذي ضرب إقليم الحوز في شتنبر 2023، مراحلها النهائية وذلك بفضل التعبئة غير المسبوقة الجميع الأطراف المعنية،  الحوز.. عملية إعادة بناء المنازل ما بعد الزلزال في مراحلها النهائية (مسؤول)     .', 'size': 2}, {'id': '215', 'title': 'مسؤول: بناء المنازل المتضررة من زلزال الحوز أشرفت على الانتهاء', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d9%85%d8%b3%d8%a4%d9%88%d9%84-%d8%a8%d9%86%d8%a7%d8%a1-%d8%a7%d9%84%d9%85%d9%86%d8%a7%d8%b2%d9%84-%d8%a7%d9%84%d9%85%d8%aa%d8%b6%d8%b1%d8%b1%d8%a9-%d9%85%d9%86-%d8%b2%d9%84%d8%b2%d8%a7%d9%84-%d8%a7/', 'summary': 'مسؤول: بناء المنازل المتضررة من زلزال الحوز أشرفت على الانتهاء. المساء اليوم: قال مسؤول في برنامج إعادة البناء بمناطق زلزال الحوز إن عملية بناء المنازل المتضررة من الزلزال الذي ضرب إقليم الحوز في شتنبر 2023، “دخلت مراحلها النهائية”. وكشف المنسق لبرنامج إعادة البناء وتأهيل المناطق', 'size': 2}], 'main_title': 'الحوز.. عملية إعادة بناء المنازل ما بعد الزلزال في مراحلها النهائية (مسؤول)'}, {'community_id': '0', 'articles': [{'id': '220', 'title': 'هيئات مهنية تواصل محاولات الإطاحة بمشروع تنظيم المجلس الوطني للصحافة', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d9%87%d9%8a%d8%a6%d8%a7%d8%aa-%d9%85%d9%87%d9%86%d9%8a%d8%a9-%d8%aa%d9%88%d8%a7%d8%b5%d9%84-%d9%85%d8%ad%d8%a7%d9%88%d9%84%d8%a7%d8%aa-%d8%a7%d9%84%d8%a5%d8%b7%d8%a7%d8%ad%d8%a9-%d8%a8%d9%85%d8%b4/', 'summary': 'هيئات مهنية تواصل محاولات الإطاحة بمشروع تنظيم المجلس الوطني للصحافة. المساء اليوم – الرباط: تواصل هيئات مهنية ونقابية تعبئتها ضد مشروع إعادة تنظيم المجلس الوطني للصحافة، مسنودة بقطاع واسع من الهيئات الحقوقية والمدنية. وفي بيان لعدد من هذه الهيئات المعارضة للمشروع، قالت إن الحكومة مستمرة', 'size': 2}, {'id': '341', 'title': 'المستشفيات تستقبل سجناء لقضاء العقوبات البديلة', 'source': 'rue20.com', 'link': 'https://rue20.com/934391.html', 'summary': 'المستشفيات تستقبل سجناء لقضاء العقوبات البديلة.  / الرباط راسل الكاتب العام لوزارة الصحة المدراء الجهويين للوزارة، من أجل تفعيل مقتضيات القانون رقم 43.22 المتعلق بالعقوبات البديلة، بخصوص إعداد لوائح الأعمال ذات المنفعة العامة وتحديد المصالح التابعة لوزارة الصحة والحماية الاجتماعية القابلة لاستقبال المحكوم عليهم بالأحكام البديلة للعقوبات السجنية. وزارة الصحة طلبت من المدراء الجهويين إقامة إمكانيات استقبال بعض الحالات الخبر المستشفيات تستقبل سجناء لقضاء العقوبات البديلة  .', 'size': 2}], 'main_title': 'هيئات مهنية تواصل محاولات الإطاحة بمشروع تنظيم المجلس الوطني للصحافة'}, {'community_id': '10', 'articles': [{'id': '303', 'title': 'الركراكي: لا نكشف جميع أوراقنا ومباراة زامبيا فُرصة لتجريب عناصر جديدة', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a7%d9%84%d8%b1%d9%83%d8%b1%d8%a7%d9%83%d9%8a-%d9%84%d8%a7-%d9%86%d9%83%d8%b4%d9%81-%d8%ac%d9%85%d9%8a%d8%b9-%d8%a3%d9%88%d8%b1%d8%a7%d9%82%d9%86%d8%a7-%d9%88%d9%85%d8%a8%d8%a7%d8%b1%d8%a7%d8%a9/', 'summary': 'الركراكي: لا نكشف جميع أوراقنا ومباراة زامبيا فُرصة لتجريب عناصر جديدة. أكد الناخب الوطني وليد الركراكي أن استراتيجية المنتخب المغربي تقوم على عدم الكشف عن جميع أوراقه قبل نهائيات كأس إفريقيا للأمم المقبلة، معتبرا أن مواجهة زامبيا برسم التصفيات المؤهلة لمونديال 2026 تمثل اختبارا مهما لهذه الخطة. وأوضح الركراكي، خلال الندوة الصحافية التي تسبق اللقاء المقرر يوم غد الاثنين، أن المباراة “ستكون مناسبة لإشراك لاعبين آخرين', 'size': 2}, {'id': '351', 'title': 'الركراكي: نحترم جميع خصومنا والهدف أمام زامبيا هو الفوز', 'source': 'machahid24.com', 'link': 'https://machahid24.com/sport/474748.html', 'summary': 'الركراكي: نحترم جميع خصومنا والهدف أمام زامبيا هو الفوز. أكد مدرب المنتخب الوطني المغربي لكرة القدم، وليد الركراكي، اليوم الأحد، أن المنتخب يحترم جميع الخصوم ويهدف للفوز على نظيره الزامبي في تصفيات كأس العالم 2026.', 'size': 2}, {'id': '373', 'title': 'وليد الركراكي: نحترم جميع الخصوم والهدف أمام زامبيا هو الفوز', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/226794/', 'summary': 'وليد الركراكي: نحترم جميع الخصوم والهدف أمام زامبيا هو الفوز. أكد مدرب المنتخب الوطني المغربي لكرة القدم، وليد الركراكي، اليوم الأحد، أن المنتخب يحترم جميع الخصوم ويهدف للفوز على نظيره الزامبي في تصفيات كأس العالم 2026. وأوضح المدرب وليد الركراكي، في المؤتمر الصحافي الذي يسبق مباراة أسود الأطلس ضد المنتخب الزامبي (الساعة الثانية بعد الظهر)، في إطار الجولة الثامنة عن المجموعة الخامسة من التصفيات الإفريقية', 'size': 3}], 'main_title': 'وليد الركراكي: نحترم جميع الخصوم والهدف أمام زامبيا هو الفوز'}, {'community_id': '2', 'articles': [{'id': '320', 'title': 'خاسر الجماعة المحظورة ينشر صور قديمة ومضللة عن زلزال الحوز في ذكراه الثانية', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/322763/', 'summary': 'خاسر الجماعة المحظورة ينشر صور قديمة ومضللة عن زلزال الحوز في ذكراه الثانية. لا يزال نشطاء جماعة العدل والإحسان المحظورة يستثمرون في مأساة ساكنة الحوز من المتضررين جراء الزلزال، الذي تحل ذكراه الثانية غدًا الاثنين. ولم يتورع حسن بناجح، أحد نشطاء الجماعة على مواقع التواصل الاجتماعي، عن نشر صورة قديمة التقطت قبل تسعة أشهر، وتقديمها على أساس أنها حديثة، موهمًا متابعيه بأن ساكنة الحوز ما زالوا يقطنون في', 'size': 2}, {'id': '376', 'title': 'حسن بناجح يعيد تدوير الأكاذيب: صورة قديمة لزلزال الحوز تتحول إلى أداة للتضليل', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/226782/', 'summary': 'حسن بناجح يعيد تدوير الأكاذيب: صورة قديمة لزلزال الحوز تتحول إلى أداة للتضليل. مرة أخرى، يعود حسن بناجح، القيادي في جماعة العدل والإحسان المحظورة، إلى هوايته القديمة في التضليل والتدليس، وهذه المرة عبر ملف حساس يرتبط بمأساة إنسانية عايشها المغاربة بكل تضامن وتعاطف، ألا وهو زلزال الحوز. فبعد أن بذلت الدولة، تحت إشراف وزارة الداخلية، جهودًا جبارة وغير مسبوقة في تدبير هذا الملف رغم كل الإكراهات التقنية واللوجستيكية،', 'size': 2}], 'main_title': 'خاسر الجماعة المحظورة ينشر صور قديمة ومضللة عن زلزال الحوز في ذكراه الثانية'}, {'community_id': '14', 'articles': [{'id': '322', 'title': 'أمن سلا يُحبط ترويج 1279 قرصا مهلوسا', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/322743/', 'summary': 'أمن سلا يُحبط ترويج 1279 قرصا مهلوسا. تمكنت عناصر الشرطة بالأمن الإقليمي بمدينة سلا بناءً على معلومات دقيقة وفرتها مصالح المديرية العامة لمراقبة التراب الوطني، مساء أمس السبت 6 شتنبر الجاري، من توقيف ثلاثة أشخاص تتراوح أعمارهم ما بين 20 و28 سنة، وذلك للاشتباه في تورطهم في قضية تتعلق بحيازة وترويج المخدرات والمؤثرات العقلية. وقد جرى توقيف المشتبه فيهم بأحد أحياء مدينة', 'size': 2}, {'id': '388', 'title': 'سلا.. توقيف ثلاثة أشخاص وحجز أزيد من 1200 قرص مخدر وجرعات كوكايين', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%b3%d9%84%d8%a7-%d8%aa%d9%88%d9%82%d9%8a%d9%81-%d8%ab%d9%84%d8%a7%d8%ab%d8%a9-%d8%a3%d8%b4%d8%ae%d8%a7%d8%b5-%d9%88%d8%ad%d8%ac%d8%b2-%d8%a3%d8%b2%d9%8a%d8%af-%d9%85%d9%86-1200-%d9%82%d8%b1%d8%b5/', 'summary': 'سلا.. توقيف ثلاثة أشخاص وحجز أزيد من 1200 قرص مخدر وجرعات كوكايين. أفاد مصدر أمني أن عناصر الشرطة بالأمن الإقليمي بمدينة سلا تمكنت بناءً على معلومات دقيقة وفرتها مصالح المديرية العامة لمراقبة التراب الوطني، مساء أمس السبت 6 شتنبر الجاري، من توقيف ثلاثة أشخاص تتراوح أعمارهم ما بين 20 و28 سنة، وذلك للاشتباه في تورطهم في قضية تتعلق بحيازة وترويج المخدرات والمؤثرات العقلية. وقد جرى …  سلا.. توقيف ثلاثة أشخاص وحجز أزيد من 1200 قرص مخدر وجرعات كوكايين     .', 'size': 2}], 'main_title': 'أمن سلا يُحبط ترويج 1279 قرصا مهلوسا'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    