<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 27/07/2025 - 06h28</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '29', 'title': 'الملك مبرقا رئيس المالديف: “متمنياتنا لكم بدوام الصحة والهناء”', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-643998.html', 'summary': 'الملك مبرقا رئيس المالديف: “متمنياتنا لكم بدوام الصحة والهناء”. هبة بريس بعث صاحب الجلالة الملك محمد السادس برقية تهنئة إلى رئيس جمهورية المالديف، فخامة السيد محمد مويزو، وذلك بمناسبة احتفال بلاده بعيدها الوطني. وأعرب جلالة الملك في هذه البرقية عن أحر تهانئ جلالته وأصدق متمنياته للرئيس محمد مويزو بدوام الصحة والهناء، ولشعب المالديف الشقيق باطراد التقدم والرخاء. ومما جاء في برقية جلالة الملك “وأغتنم هذه المناسبة السعيدة، لأعرب لفخامتكم عن اعتزازي العميق بما يربط بلدينا من علاقات أخوية متينة، قائمة على التضامن الفاعل، والتعاون المثمر، والتقدير المتبادل، مؤكدا لكم حرصي على مواصلة العمل سويا معكم من أجل ترسيخها أكثر وتطوير تعاوننا الثنائي في مختلف المجالات بما يستجيب وتطلعات شعبينا الشقيقين”.', 'size': 2}, {'id': '229', 'title': 'برقية تهنئة من الملك محمد السادس إلى رئيس جمهورية المالديف بمناسبة احتفال بلاده بعيدها الوطني', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a8%d8%b1%d9%82%d9%8a%d8%a9-%d8%aa%d9%87%d9%86%d8%a6%d8%a9-%d9%85%d9%86-%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7%d8%af%d8%b3-%d8%a5%d9%84%d9%89-%d8%b1-16/', 'summary': 'برقية تهنئة من الملك محمد السادس إلى رئيس جمهورية المالديف بمناسبة احتفال بلاده بعيدها الوطني. بعث الملك محمد السادس برقية تهنئة إلى رئيس جمهورية المالديف، محمد مويزو، وذلك بمناسبة احتفال بلاده بعيدها الوطني. وأعرب الملك محمد السادس في هذه البرقية عن أحر تهانئ جلالته وأصدق متمنياته للرئيس محمد مويزو بدوام الصحة والهناء، ولشعب المالديف الشقيق باطراد التقدم والرخاء. ومما جاء في برقية الملك محمد السادس “وأغتنم هذه المناسبة السعيدة، لأعرب لفخامتكم عن …  برقية تهنئة من الملك محمد السادس إلى رئيس جمهورية المالديف بمناسبة احتفال بلاده بعيدها الوطني     .', 'size': 2}], 'main_title': 'الملك مبرقا رئيس المالديف: “متمنياتنا لكم بدوام الصحة والهناء”'}, {'community_id': '1', 'articles': [{'id': '33', 'title': 'بحضور إنفانتينو ولقجع.. إفتتاح مقر الفيفا فرع إفريقيا بالمغرب', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-643983.html', 'summary': 'بحضور إنفانتينو ولقجع.. إفتتاح مقر الفيفا فرع إفريقيا بالمغرب. هبة بريس تم صباح اليوم السبت، الافتتاح الرسمي لمقر الاتحاد الدولي لكرة القدم (فيفا) – فرع إفريقيا، بمركب محمد السادس لكرة القدم في المعمورة، بحضور رئيس الفيفا جياني إنفانتينو، ورئيس الكونفدرالية الإفريقية لكرة القدم باتريس موتسيبي, ورئيس الجامعة الملكية المغربية لكرة القدم فوزي لقجع، إلى جانب شخصيات رياضية ومسؤولين آخرين. ويأتي هذا الافتتاح تتويجاً لاتفاقية تم توقيعها سابقاً بين الاتحاد الدولي لكرة القدم والحكومة المغربية والجامعة الملكية المغربية لكرة القدم، خلال حفل رسمي أقيم يوم الاثنين 16 دجنبر 2024 بقصر المؤتمرات بمدينة مراكش، بحضور شخصيات بارزة في الساحة الكروية الدولية. وسيمثل هذا المقر نقطة ارتكاز استراتيجية للفيفا في القارة الإفريقية، بما يعزز من تطوير البنية التحتية والتدبير الإداري والتقني لكرة القدم في مختلف بلدان القارة، كما يأتي تزامناً مع استعدادات المغرب لاحتضان نهائيات كأس العالم 2030، إلى جانب كل من إسبانيا والبرتغال.', 'size': 3}, {'id': '156', 'title': 'افتتاح أول مقر للفيفا في إفريقيا بالرباط بحضور إنفانتينو وموتسيبي ولقجع', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1088421.html', 'summary': 'افتتاح أول مقر للفيفا في إفريقيا بالرباط بحضور إنفانتينو وموتسيبي ولقجع. افتُتح صباح يومه السبت، المقر الجديد للاتحاد الدولي لكرة القدم “فيفا” بمدينة الرباط، بالقرب من مركب محمد السادس لكرة القدم، بحضور رئيس الفيفا جياني إنفانتينو، ورئيس الكونفدرالية الإفريقية لكرة القدم باتريس موتسيبي، إلى جانب رئيس الجامعة الملكية المغربية لكرة القدم فوزي لقجع، وممثلي عدد من الاتحادات الكروية القارية والدولية. ويُعد افتتاح هذا المقر خطوة تعكس ظهرت المقالة افتتاح أول مقر للفيفا في إفريقيا بالرباط بحضور إنفانتينو وموتسيبي ولقجع  .', 'size': 4}, {'id': '179', 'title': 'سلا.. افتتاح مكتب الاتحاد الدولي لكرة القدم في إفريقيا بمركب محمد السادس', 'source': 'machahid24.com', 'link': 'https://machahid24.com/sport/470736.html', 'summary': 'سلا.. افتتاح مكتب الاتحاد الدولي لكرة القدم في إفريقيا بمركب محمد السادس. متابعة تم، اليوم السبت، افتتاح مكتب الاتحاد الدولي لكرة القدم (فيفا) في إفريقيا بمركب محمد السادس لكرة القدم بسلا، وذلك خلال حفل ترأسه رئيس الاتحاد الدولي، جياني إنفانتينو. وجرت مراسم الافتتاح بحضور رئيس الكونفدرالية الإفريقية لكرة القدم، باتريس موتسيبي، ورئيس الجامعة الملكية المغربية لكرة القدم، فوزي لقجع، إلى جانب عدد من الشخصيات الأخرى. وفي كلمة …', 'size': 2}, {'id': '356', 'title': 'المغرب يُدشن صفحة جديدة في تاريخ الكرة الإفريقية بافتتاح أول مكتب للفيفا في القارة', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/319403/', 'summary': 'المغرب يُدشن صفحة جديدة في تاريخ الكرة الإفريقية بافتتاح أول مكتب للفيفا في القارة. تم، اليوم السبت، افتتاح مكتب الاتحاد الدولي لكرة القدم (فيفا) في إفريقيا بمركب محمد السادس لكرة القدم بسلا، وذلك خلال حفل ترأسه رئيس الاتحاد الدولي، جياني إنفانتينو. وجرت مراسم الافتتاح بحضور رئيس الكونفدرالية الإفريقية لكرة القدم، باتريس موتسيبي، ورئيس الجامعة الملكية المغربية لكرة القدم، فوزي لقجع، إلى جانب عدد من الشخصيات الأخرى. وفي كلمة بالمناسبة،', 'size': 5}, {'id': '394', 'title': 'إنفانتينو : جلالة الملك قام ببناء مركب كروي رائع ومذهل أصبح شاهداً على ريادة المغرب للنهوض بالكرة الأفريقية', 'source': 'rue20.com', 'link': 'https://rue20.com/924074.html', 'summary': 'إنفانتينو : جلالة الملك قام ببناء مركب كروي رائع ومذهل أصبح شاهداً على ريادة المغرب للنهوض بالكرة الأفريقية. . الرباط تم، اليوم السبت، افتتاح مكتب الاتحاد الدولي لكرة القدم (فيفا) في إفريقيا بمركب محمد السادس لكرة القدم بسلا، وذلك خلال حفل ترأسه رئيس الاتحاد الدولي، جياني إنفانتينو. وجرت مراسم الافتتاح بحضور رئيس الكونفدرالية الإفريقية لكرة القدم، باتريس موتسيبي، ورئيس الجامعة الملكية المغربية لكرة القدم، فوزي لقجع، إلى جانب عدد من الشخصيات الأخرى. الخبر إنفانتينو : جلالة الملك قام ببناء مركب كروي رائع ومذهل أصبح شاهداً على ريادة المغرب للنهوض بالكرة الأفريقية  .', 'size': 3}], 'main_title': 'المغرب يُدشن صفحة جديدة في تاريخ الكرة الإفريقية بافتتاح أول مكتب للفيفا في القارة'}, {'community_id': '2', 'articles': [{'id': '66', 'title': 'فتح باب الترشيح للدورة الرابعة للجائزة الوطنية للفنون التشكيلية برسم سنة 2025', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/204093', 'summary': 'فتح باب الترشيح للدورة الرابعة للجائزة الوطنية للفنون التشكيلية برسم سنة 2025. الأحداث من الرباط أعلنت وزارة الشباب والثقافة والتواصل -قطاع الثقافة، عن فتح باب الترشيح للدورة الرابعة للجائزة الوطنية للفنون التشكيلية، خلال الفترة الممتدة من 23 يوليوز إلى غاية 15 شتنبر 2025. وذكر بلاغ للوزارة أن هذه التظاهرة تهدف إلى تحفيز الفنانين وتشجيعهم على المبادرة والابتكار، وكذا اكتشاف ورعاية الطاقات الوطنية الواعدة من الشباب ومدها بالدعم', 'size': 2}, {'id': '213', 'title': 'فاتح شهر صفر 1447 هجرية غدا السبت', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/225197/', 'summary': 'فاتح شهر صفر 1447 هجرية غدا السبت. الرباط – أعلنت وزارة الأوقاف والشؤون الإسلامية أن فاتح شهر صفر لعام 1447 هجرية هو يوم غد السبت 26 يوليوز الجاري. وذكرت الوزارة، في بلاغ لها، أنها راقبت هلال شهر صفر لعام 1447 هجرية مساء اليوم الجمعة، فثبتت لديها رؤية الهلال ثبوتا شرعيا. وفي ما يلي نص البلاغ : “تنهي وزارة الأوقاف والشؤون الإسلامية إلى', 'size': 2}], 'main_title': 'فتح باب الترشيح للدورة الرابعة للجائزة الوطنية للفنون التشكيلية برسم سنة 2025'}, {'community_id': '3', 'articles': [{'id': '95', 'title': 'لقجع يرد على التضليل الإعلامي الإسباني ويقطع الشك باليقين حول ملعب نهائي مونديال 2030', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/sport/worldfoot/409955.html', 'summary': 'لقجع يرد على التضليل الإعلامي الإسباني ويقطع الشك باليقين حول ملعب نهائي مونديال 2030. خرج فوزي لقجع، رئيس لجنة تنظيم كأس العالم 2030 ورئيس الجامعة الملكية المغربية لكرة القدم، بتصريحات حاسمة وضع من خلالها حداً للتأويلات والتسريبات التي رافقت', 'size': 2}, {'id': '357', 'title': 'مونديال 2030.. لقجع يقطع الشك باليقين بشأن توزيع الملاعب', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/319390/', 'summary': 'مونديال 2030.. لقجع يقطع الشك باليقين بشأن توزيع الملاعب. في وقت تتكثف فيه الترتيبات الجارية لتنظيم نهائيات كأس العالم 2030، خرج فوزي لقجع، رئيس الجامعة الملكية المغربية لكرة القدم ورئيس لجنة التنظيم الثلاثية، ليوضح الصورة بشأن عدد من النقاط التي أثارت نقاشًا واسعًا في الأوساط الرياضية والإعلامية، على رأسها مسألة توزيع الملاعب والمباراة النهائية، إلى جانب تقييم سير مشاريع البنية التحتية المرتبطة بهذا الحدث', 'size': 2}], 'main_title': 'لقجع يرد على التضليل الإعلامي الإسباني ويقطع الشك باليقين حول ملعب نهائي مونديال 2030'}, {'community_id': '4', 'articles': [{'id': '114', 'title': 'مندوبية السجون ترد بقوة على الادعاءات الكاذبة لليوتيوبرز النصاب بشأن وفاة ضابط شرطة داخل سجن محلي', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%85%d9%86%d8%af%d9%88%d8%a8%d9%8a%d8%a9-%d8%a7%d9%84%d8%b3%d8%ac%d9%88%d9%86-%d8%aa%d8%b1%d8%af-%d8%a8%d9%82%d9%88%d8%a9-%d8%b9%d9%84%d9%89-%d8%a7%d9%84%d8%a7%d8%af%d8%b9%d8%a7%d8%a1%d8%a7%d8%aa/', 'summary': 'مندوبية السجون ترد بقوة على الادعاءات الكاذبة لليوتيوبرز النصاب بشأن وفاة ضابط شرطة داخل سجن محلي. قدمت المندوبية العامة لإدارة السجون وإعادة الإدماج توضيحات بشأن الفيديو المنشور من طرف أحد الأشخاص المقيمين خارج الوطن، والذي يدعي فيه “وفاة ضابط شرطة معتقل بالسجن المحلي عين السبع”. وكشفت المندوبية، في بيان لها، أن السجين المذكور في الفيديو (ع.ق) لا يزال على قيد الحياة، وهو معتقل حاليا بالسجن المحلي “العرجات 2” (وليس بالسجن المحلي', 'size': 3}, {'id': '354', 'title': 'المغرب يواجه حملات التضليل.. المندوبية تكشف زيف رواية “وفاة ضابط بالسجن”', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/319406/', 'summary': 'المغرب يواجه حملات التضليل.. المندوبية تكشف زيف رواية “وفاة ضابط بالسجن”. أكدت المندوبية العامة لإدارة السجون وإعادة الإدماج أن السجين المذكور في فيديو منشور من طرف أحد الأشخاص المقيمين خارج الوطن، يدعي فيه “وفاة ضابط شرطة معتقل بالسجن المحلي عين السبع”، لا يزال على قيد الحياة. وأوضحت المندوبية أن السجين المذكور في الفيديو (ع.ق) لا يزال على قيد الحياة، وهو معتقل حاليا بالسجن المحلي العرجات 2', 'size': 3}, {'id': '396', 'title': 'مندوبية السجون تنفي وفاة ضابط شرطة معتقل', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/470750.html', 'summary': 'مندوبية السجون تنفي وفاة ضابط شرطة معتقل. أكدت المندوبية العامة لإدارة السجون وإعادة الإدماج أن السجين المذكور في فيديو منشور من طرف أحد الأشخاص المقيمين خارج الوطن، يدعي فيه “وفاة ضابط شرطة معتقل بالسجن المحلي عين السبع”، لا يزال على قيد الحياة. وأوضحت المندوبية أن السجين المذكور في الفيديو (ع.ق) لا يزال على قيد الحياة، وهو معتقل حاليا بالسجن المحلي العرجات 2 …', 'size': 3}], 'main_title': 'مندوبية السجون ترد بقوة على الادعاءات الكاذبة لليوتيوبرز النصاب بشأن وفاة ضابط شرطة داخل سجن محلي'}, {'community_id': '5', 'articles': [{'id': '118', 'title': 'من الأحد للثلاثاء.. الحرارة غتوصل لـ48 درجة!', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%85%d9%86-%d8%a7%d9%84%d8%a3%d8%ad%d8%af-%d9%84%d9%84%d8%ab%d9%84%d8%a7%d8%ab%d8%a7%d8%a1-%d8%a7%d9%84%d8%ad%d8%b1%d8%a7%d8%b1%d8%a9-%d8%ba%d8%aa%d9%88%d8%b5%d9%84-%d9%84%d9%8048-%d8%af%d8%b1/', 'summary': 'من الأحد للثلاثاء.. الحرارة غتوصل لـ48 درجة!. أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل موجة حر، بدرجات حرارة تتراوح ما بين 42 و48 درجة، ابتداء من يوم غد الأحد إلى غاية يوم الثلاثاء بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة برتقالي، أنه يرتقب تسجيل موجة حر، تتراوح ما بين 45 و48 درجة، ستهم عمالات وأقاليم زاكورة،', 'size': 4}, {'id': '154', 'title': 'نشرة إنذارية تحذر من موجة حر\xa0بعدد من مناطق المملكة', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1088433.html', 'summary': 'نشرة إنذارية تحذر من موجة حر بعدد من مناطق المملكة. أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل موجة حر، بدرجات حرارة تتراوح ما بين 42 و48 درجة، ابتداء من يوم غد الأحد إلى غاية يوم الثلاثاء بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة برتقالي، أنه يرتقب تسجيل موجة حر، تتراوح ما بين 45 و48 درجة، ستهم عمالات وأقاليم زاكورة، ظهرت المقالة نشرة إنذارية تحذر من موجة حر بعدد من مناطق المملكة  .', 'size': 3}, {'id': '166', 'title': 'تحذير من موجة حر بدءا من الأحد إلى الثلاثاء', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%aa%d8%ad%d8%b0%d9%8a%d8%b1-%d9%85%d9%86-%d9%85%d9%88%d8%ac%d8%a9-%d8%ad%d8%b1-%d8%a8%d8%af%d8%a1%d8%a7-%d9%85%d9%86-%d8%a7%d9%84%d8%a3%d8%ad%d8%af-%d8%a5%d9%84%d9%89-%d8%a7%d9%84%d8%ab%d9%84%d8%a7/', 'summary': 'تحذير من موجة حر بدءا من الأحد إلى الثلاثاء. أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل موجة حر، بدرجات حرارة تتراوح ما بين 42 و48 درجة، ابتداء من يوم غد الأحد إلى غاية يوم الثلاثاء بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة برتقالي، أنه يرتقب تسجيل موجة حر، تتراوح ما بين 45 و48 درجة، ستهم عمالات وأقاليم زاكورة،  تحذير من موجة حر بدءا من الأحد إلى الثلاثاء     .', 'size': 3}, {'id': '185', 'title': 'نشرة إنذارية.. موجة حر من الأحد إلى الثلاثاء بعدد من مناطق المملكة', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/470710.html', 'summary': 'نشرة إنذارية.. موجة حر من الأحد إلى الثلاثاء بعدد من مناطق المملكة. أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل موجة حر، بدرجات حرارة تتراوح ما بين 42 و48 درجة، ابتداء من يوم غد الأحد إلى غاية يوم الثلاثاء بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة برتقالي، أنه يرتقب تسجيل موجة حر، تتراوح ما بين 45 و48 درجة، ستهم عمالات وأقاليم زاكورة، …', 'size': 2}], 'main_title': 'من الأحد للثلاثاء.. الحرارة غتوصل لـ48 درجة!'}, {'community_id': '6', 'articles': [{'id': '311', 'title': 'جلالة الملك يهنئ أعضاء المنتخب الوطني المغربي النسوي لكرة القدم على المسيرة المتألقة في كأس أمم إفريقيا', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/204108', 'summary': 'جلالة الملك يهنئ أعضاء المنتخب الوطني المغربي النسوي لكرة القدم على المسيرة المتألقة في كأس أمم إفريقيا.  بعث صاحب الجلالة الملك محمد السادس، نصره الله، برقية تهنئة إلى أعضاء المنتخب الوطني المغربي النسوي لكرة القدم على المسيرة المتألقة التي بصم عليها في كأس أمم إفريقيا للسيدات نسخة 2024. وقال جلالة الملك في هذه البرقية “فقد تتبعنا بكل اعتزاز مسيرتكن المتألقة في منافسات كأس أمم إفريقيا للسيدات (نسخة 2024)،والتي تكللت ببلوغكن', 'size': 4}, {'id': '344', 'title': 'بعد المسيرة المتألقة في “كان السيدات”.. جلالة الملك يهنئ أعضاء المنتخب الوطني النسوي', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a8%d8%b9%d8%af-%d8%a7%d9%84%d9%85%d8%b3%d9%8a%d8%b1%d8%a9-%d8%a7%d9%84%d9%85%d8%aa%d8%a3%d9%84%d9%82%d8%a9-%d9%81%d9%8a-%d9%83%d8%a7%d9%86-%d8%a7%d9%84%d8%b3%d9%8a%d8%af%d8%a7%d8%aa-%d8%ac/', 'summary': 'بعد المسيرة المتألقة في “كان السيدات”.. جلالة الملك يهنئ أعضاء المنتخب الوطني النسوي. بعث صاحب الجلالة الملك محمد السادس، نصره الله، برقية تهنئة إلى أعضاء المنتخب الوطني المغربي النسوي لكرة القدم على المسيرة المتألقة التي بصم عليها في كأس أمم إفريقيا للسيدات نسخة 2024. وقال جلالة الملك في هذه البرقية “فقد تتبعنا بكل اعتزاز مسيرتكن المتألقة في منافسات كأس أمم إفريقيا للسيدات (نسخة 2024)، والتي تكللت ببلوغكن للدور', 'size': 3}, {'id': '429', 'title': 'الملك محمد السادس يهنئ لاعبات المنتخب على “المسيرة المتألقة” خلال كأس إفريقيا', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7%d8%af%d8%b3-%d9%8a%d9%87%d9%86%d8%a6-%d9%84%d8%a7%d8%b9%d8%a8%d8%a7%d8%aa-%d8%a7%d9%84%d9%85%d9%86%d8%aa%d8%ae%d8%a8/', 'summary': 'الملك محمد السادس يهنئ لاعبات المنتخب على “المسيرة المتألقة” خلال كأس إفريقيا. المساء اليوم: بعث الملك محمد السادس، برقية تهنئة إلى أعضاء المنتخب الوطني المغربي النسوي لكرة القدم على المسيرة المتألقة التي بصم عليها في كأس أمم إفريقيا للسيدات نسخة 2024. وقال جلالة الملك في هذه البرقية', 'size': 4}, {'id': '433', 'title': 'الملك محمد السادس يهنئ المنتخب الوطني المغربي النسوي على المسيرة المتألقة في كأس أمم إفريقيا', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7%d8%af%d8%b3-%d9%8a%d9%87%d9%86%d8%a6-%d8%a7%d9%84%d9%85%d9%86%d8%aa%d8%ae%d8%a8-%d8%a7%d9%84%d9%88%d8%b7%d9%86%d9%8a/', 'summary': 'الملك محمد السادس يهنئ المنتخب الوطني المغربي النسوي على المسيرة المتألقة في كأس أمم إفريقيا. بعث الملك محمد السادس، برقية تهنئة إلى أعضاء المنتخب الوطني المغربي النسوي لكرة القدم على المسيرة المتألقة التي بصم عليها في كأس أمم إفريقيا للسيدات نسخة 2024. وقال الملك محمد السادس في هذه البرقية “فقد تتبعنا بكل اعتزاز مسيرتكن المتألقة في منافسات كأس أمم إفريقيا للسيدات (نسخة 2024)، والتي تكللت ببلوغكن للدور النهائي …  الملك محمد السادس يهنئ المنتخب الوطني المغربي النسوي على المسيرة المتألقة في كأس أمم إفريقيا     .', 'size': 3}], 'main_title': 'جلالة الملك يهنئ أعضاء المنتخب الوطني المغربي النسوي لكرة القدم على المسيرة المتألقة في كأس أمم إفريقيا'}, {'community_id': '7', 'articles': [{'id': '336', 'title': 'عاجل.. البحرية الإسرائيلية تقتحم السفينة حنظلة', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/world/409997.html', 'summary': 'عاجل.. البحرية الإسرائيلية تقتحم السفينة حنظلة. في خطوة تصعيدية غير مفاجئة، أقدمت البحرية الإسرائيلية، قبل قليل، على اقتحام سفينة "حنظلة" المحملة بالمساعدات الإنسانية والمتوجهة إلى قطاع غزة المحاصر، وذلك بعد أيام', 'size': 2}, {'id': '406', 'title': '“حكومة غزة”: اقتحام “الجيش الإسرائيلي” لسفينة حنظلة قرصنة بحرية', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%ad%d9%83%d9%88%d9%85%d8%a9-%d8%ba%d8%b2%d8%a9-%d8%a7%d9%82%d8%aa%d8%ad%d8%a7%d9%85-%d8%a7%d9%84%d8%ac%d9%8a%d8%b4-%d8%a7%d9%84%d8%a5%d8%b3%d8%b1%d8%a7%d8%a6%d9%8a%d9%84%d9%8a-%d9%84%d8%b3/', 'summary': '“حكومة غزة”: اقتحام “الجيش الإسرائيلي” لسفينة حنظلة قرصنة بحرية. اعتبرت حكومة غزة، الأحد، اقتحام الجيش الإسرائيلي لسفينة "حنظلة" في عرض البحر "جريمة قرصنة بحرية وانتهاك صارخ للقانون الدولي". وطالبت المجتمع الدولي بتأمين  “حكومة غزة”: اقتحام “الجيش الإسرائيلي” لسفينة حنظلة قرصنة بحرية     .', 'size': 2}], 'main_title': 'عاجل.. البحرية الإسرائيلية تقتحم السفينة حنظلة'}, {'community_id': '8', 'articles': [{'id': '346', 'title': 'مع ركلة جزاء مثيرة للجدل.. ريمونتادا نيجيرية تحرم لبؤات الأطلس من اللقب الإفريقي', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%85%d8%b9-%d8%b1%d9%83%d9%84%d8%a9-%d8%ac%d8%b2%d8%a7%d8%a1-%d9%85%d8%ab%d9%8a%d8%b1%d8%a9-%d9%84%d9%84%d8%ac%d8%af%d9%84-%d8%b1%d9%8a%d9%85%d9%88%d9%86%d8%aa%d8%a7%d8%af%d8%a7-%d9%86%d9%8a%d8%ac/', 'summary': 'مع ركلة جزاء مثيرة للجدل.. ريمونتادا نيجيرية تحرم لبؤات الأطلس من اللقب الإفريقي. تُوج المنتخب النيجيري للسيدات بلقب كأس أمم إفريقيا كان 2024، عقب فوزه على نظيره المغربي بثلاثة أهداف مقابل هدفين، في المباراة النهائية التي لعبت، اليوم السبت (26 يوليوز)، واحتضنها الملعب الأولمبي في الرباط. المباراة اتسمت بإيقاع مرتفع وندية كبيرة، وتمكنت لبؤات الأطلس من فرض سيطرتهن خلال الشوط الأول، حيث افتتحت غزلان شباك التسجيل في الدقيقة', 'size': 2}, {'id': '349', 'title': 'نيجيريا تقلب الطاولة على لبؤات الأطلس وتخطف لقب كأس إفريقيا', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/319421/', 'summary': 'نيجيريا تقلب الطاولة على لبؤات الأطلس وتخطف لقب كأس إفريقيا. توج المنتخب النيجيري للسيدات بلقب كأس أمم إفريقيا “المغرب 2024″، بعد مباراة مثيرة احتضنها الملعب الأولمبي بالعاصمة الرباط، وانتهت بفوزه على المنتخب المغربي بثلاثة أهداف مقابل هدفين، في نهائي مثّل ذروة المنافسة القارية وأبرز الوجه المشرق لكرة القدم النسوية الإفريقية. ودخل المنتخب المغربي اللقاء بثقة كبيرة، مدفوعًا بالحضور الجماهيري المكثف والتوهج الذي رافق مسيرته طيلة', 'size': 3}, {'id': '367', 'title': 'المنتخب النيجيري يجهض حلم لبؤات الأطلس” ويتوج بطلا لكأس إفريقيا للسيدات', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1088580.html', 'summary': 'المنتخب النيجيري يجهض حلم لبؤات الأطلس” ويتوج بطلا لكأس إفريقيا للسيدات. تُوج المنتخب النيجيري للسيدات بلقب كأس أمم إفريقيا “المغرب 2024”، بعد فوزه على المنتخب الوطني بثلاثة أهداف مقابل هدفين، في المباراة النهائية التي احتضنها الملعب الأولمبي بالعاصمة الرباط. واستهلت لبؤات الأطلس اللقاء بأسلوب هجومي منظم، تُوّج بهدف أول رائع عن طريق غزلان الشباك في الدقيقة الـ12، بعدما أطلقت تسديدة قوية من خارج منطقة الجزاء، استقرت ظهرت المقالة المنتخب النيجيري يجهض حلم لبؤات الأطلس” ويتوج بطلا لكأس إفريقيا للسيدات  .', 'size': 3}, {'id': '434', 'title': 'أخطاء تحكيمية كارثية تحرم المنتخب المغربي النسوي من لقب الـ”الكان”', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a3%d8%ae%d8%b7%d8%a7%d8%a1-%d8%aa%d8%ad%d9%83%d9%8a%d9%85%d9%8a%d8%a9-%d9%83%d8%a7%d8%b1%d8%ab%d9%8a%d8%a9-%d8%aa%d8%ad%d8%b1%d9%85-%d8%a7%d9%84%d9%85%d9%86%d8%aa%d8%ae%d8%a8-%d8%a7%d9%84%d9%85/', 'summary': 'أخطاء تحكيمية كارثية تحرم المنتخب المغربي النسوي من لقب الـ”الكان”. خسر المنتخب الوطني المغربي النسوي نهائي كأس أمم إفريقيا أمام نظيره النيجيري بنتيجة ثلاثة أهداف لهدفين، في مباراة مثيرة احتضنها الملعب الأولمبي بالعاصمة الرباط، وشهدت جدلاً تحكيمياً كبيراً طبع أطوار المواجهة. ورغم الأداء القوي الذي قدمته لبؤات الأطلس، خاصة خلال الشوط الأول الذي أنهينه متقدمات بهدفين لواحد، إلا أن قرارات تحكيمية مثيرة للجدل، …  أخطاء تحكيمية كارثية تحرم المنتخب المغربي النسوي من لقب الـ”الكان”     .', 'size': 2}], 'main_title': 'نيجيريا تقلب الطاولة على لبؤات الأطلس وتخطف لقب كأس إفريقيا'}, {'community_id': '9', 'articles': [{'id': '347', 'title': 'جمالي: ورش الدعم الاجتماعي المباشر تجسيد عملي للإرادة الملكية التي تبتغي إرساء عدالة اجتماعية حقيقية', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%ac%d9%85%d8%a7%d9%84%d9%8a-%d9%88%d8%b1%d8%b4-%d8%a7%d9%84%d8%af%d8%b9%d9%85-%d8%a7%d9%84%d8%a7%d8%ac%d8%aa%d9%85%d8%a7%d8%b9%d9%8a-%d8%a7%d9%84%d9%85%d8%a8%d8%a7%d8%b4%d8%b1-%d8%aa%d8%ac%d8%b3/', 'summary': 'جمالي: ورش الدعم الاجتماعي المباشر تجسيد عملي للإرادة الملكية التي تبتغي إرساء عدالة اجتماعية حقيقية. أكدت المديرة العامة للوكالة الوطنية للدعم الاجتماعي، وفاء جمالي، أن ورش الدعم الاجتماعي المباشر يمثل تجسيدا عمليا للإرادة الملكية التي تبتغي إرساء عدالة اجتماعية حقيقية وتحقيق كرامة المواطنين، مبرزة أن هذا الورش يؤسس لنموذج مغربي رائد في مجال الحماية الاجتماعية. وقالت جمالي، في تصريح لوكالة المغرب العربي للأنباء، إن نجاح هذا الورش يتطلب تعبئة جماعية', 'size': 2}, {'id': '374', 'title': 'جمالي: الدعم المباشر يجسد الإرادة الملكية وكلفته تجاوزت 25 مليار درهم في 2024', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1088546.html', 'summary': 'جمالي: الدعم المباشر يجسد الإرادة الملكية وكلفته تجاوزت 25 مليار درهم في 2024. أكدت المديرة العامة للوكالة الوطنية للدعم الاجتماعي، وفاء جمالي، أن ورش الدعم الاجتماعي المباشر يمثل تجسيدا عمليا للإرادة الملكية التي تبتغي إرساء عدالة اجتماعية حقيقية وتحقيق كرامة المواطنين، مبرزة أن هذا الورش يؤسس لنموذج مغربي رائد في مجال الحماية الاجتماعية. وقالت جمالي، في تصريح لوكالة المغرب العربي للأنباء، إن نجاح هذا الورش يتطلب تعبئة جماعية ظهرت المقالة جمالي: الدعم المباشر يجسد الإرادة الملكية وكلفته تجاوزت 25 مليار درهم في 2024  .', 'size': 2}], 'main_title': 'جمالي: ورش الدعم الاجتماعي المباشر تجسيد عملي للإرادة الملكية التي تبتغي إرساء عدالة اجتماعية حقيقية'}, {'community_id': '10', 'articles': [{'id': '348', 'title': 'وزيرة خارجية فلسطين: الدفاع عن القضية الفلسطينية والقدس الشريف ثابت أساسي في دبلوماسية جلالة الملك', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%88%d8%b2%d9%8a%d8%b1%d8%a9-%d8%ae%d8%a7%d8%b1%d8%ac%d9%8a%d8%a9-%d9%81%d9%84%d8%b3%d8%b7%d9%8a%d9%86-%d8%a7%d9%84%d8%af%d9%81%d8%a7%d8%b9-%d8%b9%d9%86-%d8%a7%d9%84%d9%82%d8%b6%d9%8a%d8%a9-%d8%a7/', 'summary': 'وزيرة خارجية فلسطين: الدفاع عن القضية الفلسطينية والقدس الشريف ثابت أساسي في دبلوماسية جلالة الملك. أكدت وزيرة الخارجية والمغتربين بدولة فلسطين، فارسين اغابكيان شاهين، أن الدفاع عن القضية الفلسطينية والقدس الشريف ثابت أساسي في دبلوماسية صاحب الجلالة الملك محمد السادس، رئيس لجنة القدس. وأبرزت الوزيرة الفلسطينية، في تصريحات صحفية بمناسبة عيد العرش المجيد، أن جلالة الملك ما فتئ يؤكد على أن دعم المغرب للقضية الفلسطينية ودفاعه عن القدس الشريف يشكلان', 'size': 3}, {'id': '358', 'title': 'شاهين: مواقف الملك محمد السادس تجاه فلسطين تترجمها مساعدات ملموسة على أرض الواقع', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/319396/', 'summary': 'شاهين: مواقف الملك محمد السادس تجاه فلسطين تترجمها مساعدات ملموسة على أرض الواقع. أكدت وزيرة الخارجية والمغتربين بدولة فلسطين، فارسين اغابكيان شاهين، أن الدفاع عن القضية الفلسطينية والقدس الشريف ثابت أساسي في دبلوماسية صاحب الجلالة الملك محمد السادس، رئيس لجنة القدس. وأبرزت الوزيرة الفلسطينية، في تصريحات صحفية بمناسبة عيد العرش المجيد، أن جلالة الملك ما فتئ يؤكد على أن دعم المغرب للقضية الفلسطينية ودفاعه عن القدس الشريف يشكلان', 'size': 3}, {'id': '362', 'title': 'الخارجية الفلسطينية: الدفاع عن القدس ثابت استراتيجي في دبلوماسية الملك محمد السادس', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1088468.html', 'summary': 'الخارجية الفلسطينية: الدفاع عن القدس ثابت استراتيجي في دبلوماسية الملك محمد السادس. أكدت وزيرة الخارجية والمغتربين بدولة فلسطين، فارسين اغابكيان شاهين، أن الدفاع عن القضية الفلسطينية والقدس الشريف ثابت أساسي في دبلوماسية الملك محمد السادس، رئيس لجنة القدس. وأبرزت الوزيرة الفلسطينية، في تصريحات صحفية بمناسبة عيد العرش المجيد، أن الملك ما فتئ يؤكد على أن دعم المغرب للقضية الفلسطينية ودفاعه عن القدس الشريف يشكلان ثابتا أساسيا في ظهرت المقالة الخارجية الفلسطينية: الدفاع عن القدس ثابت استراتيجي في دبلوماسية الملك محمد السادس  .', 'size': 3}], 'main_title': 'وزيرة خارجية فلسطين: الدفاع عن القضية الفلسطينية والقدس الشريف ثابت أساسي في دبلوماسية جلالة الملك'}, {'community_id': '11', 'articles': [{'id': '417', 'title': 'إنقاذ نسر بري.. بلاغ للوكالة الوطنية للمياه والغابات', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%a5%d9%86%d9%82%d8%a7%d8%b0-%d9%86%d8%b3%d8%b1-%d8%a8%d8%b1%d9%8a-%d8%a8%d9%84%d8%a7%d8%ba-%d9%84%d9%84%d9%88%d9%83%d8%a7%d9%84%d8%a9-%d8%a7%d9%84%d9%88%d8%b7%d9%86%d9%8a%d8%a9-%d9%84%d9%84%d9%85/', 'summary': 'إنقاذ نسر بري.. بلاغ للوكالة الوطنية للمياه والغابات. أعلنت الوكالة الوطنية للمياه والغابات، اليوم السبت، أنها أنقذت نسرا بريا بمنطقة جرادة وأعادت إطلاقه في بيئته الطبيعية، بعدما تم العثور عليه في حالة صحية حرجة  إنقاذ نسر بري.. بلاغ للوكالة الوطنية للمياه والغابات     .', 'size': 2}, {'id': '431', 'title': 'بعد هجوم كلاب ضالة: إعادة إطلاق نسر بري في جرادة', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%a8%d8%b9%d8%af-%d9%87%d8%ac%d9%88%d9%85-%d9%83%d9%84%d8%a7%d8%a8-%d8%b6%d8%a7%d9%84%d8%a9-%d8%a5%d8%b9%d8%a7%d8%af%d8%a9-%d8%a5%d8%b7%d9%84%d8%a7%d9%82-%d9%86%d8%b3%d8%b1-%d8%a8%d8%b1%d9%8a/', 'summary': 'بعد هجوم كلاب ضالة: إعادة إطلاق نسر بري في جرادة. المساء اليوم – جرادة: أعلنت الوكالة الوطنية للمياه والغابات، اليوم السبت، أنها أنقذت نسرا بريا بمنطقة جرادة وأعادت إطلاقه في بيئته الطبيعية، بعدما تم العثور عليه في حالة صحية حرجة يرجح أنها ناتجة عن هجوم', 'size': 2}], 'main_title': 'إنقاذ نسر بري.. بلاغ للوكالة الوطنية للمياه والغابات'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    