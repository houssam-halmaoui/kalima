<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 11/10/2025 - 06h15</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '4', 'articles': [{'id': '2', 'title': 'نص الخطاب الملكي أمام البرلمان', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d9%86%d8%b5-%d8%ae%d8%b7%d8%a7%d8%a8-%d8%a7%d9%84%d9%85%d9%84%d9%83-%d8%a3%d9%85%d8%a7%d9%85-%d8%a7%d9%84%d8%a8%d8%b1%d9%84%d9%85%d8%a7%d9%86-1637972.html', 'summary': 'نص الخطاب الملكي أمام البرلمان. الحمد لله، والصلاة والسلام على مولانا رسول الله وآله وصحبه. حضرات السيدات والسادة البرلمانيين المحترمين، نفتتح اليوم، بعون الله تعالى وتوفيقه، السنةَ الأخيرة من الولاية الحالية لمجلس النواب. وهي مناسبة للتعبير لكم عن تقديرنا للعمل الذي تقومون به، سواء في مجال التشريع ومراقبة العمل الحكومي، أو في تقييم السياسات العمومية. كما نود الإشادة بالجهود المبذولة  نص الخطاب الملكي أمام البرلمان     - هسبريس جريدة إلكترونية مغربية .', 'size': 3}, {'id': '57', 'title': 'نص الخطاب الملكي بمناسبة افتتاح البرلمان', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/207248', 'summary': 'نص الخطاب الملكي بمناسبة افتتاح البرلمان.  « الحمد لله، والصلاة والسلام على مولانا رسول الله وآله وصحبه. حضرات السيدات والسادة البرلمانيين المحترمين، نفتتح اليوم، بعون الله تعالى وتوفيقه، السنةَ الأخيرة من الولاية الحالية لمجلس النواب. وهي مناسبة للتعبير لكم عن تقديرنا للعمل الذي تقومون به، سواء في مجال التشريع ومراقبة العمل الحكومي، أو في تقييم السياسات العمومية. كما نود الإشادة', 'size': 3}, {'id': '120', 'title': 'بمناسبة افتتاح البرلمان.. نص الخطاب الملكي', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a8%d9%85%d9%86%d8%a7%d8%b3%d8%a8%d8%a9-%d8%a7%d9%81%d8%aa%d8%aa%d8%a7%d8%ad-%d8%a7%d9%84%d8%a8%d8%b1%d9%84%d9%85%d8%a7%d9%86-%d9%86%d8%b5-%d8%a7%d9%84%d8%ae%d8%b7%d8%a7%d8%a8-%d8%a7%d9%84%d9%85/', 'summary': 'بمناسبة افتتاح البرلمان.. نص الخطاب الملكي. « الحمد لله، والصلاة والسلام على مولانا رسول الله وآله وصحبه. حضرات السيدات والسادة البرلمانيين المحترمين، نفتتح اليوم، بعون الله تعالى وتوفيقه، السنةَ الأخيرة من الولاية الحالية لمجلس النواب. وهي مناسبة للتعبير لكم عن تقديرنا للعمل الذي تقومون به، سواء في مجال التشريع ومراقبة العمل الحكومي، أو في تقييم السياسات العمومية. كما نود الإشادة بالجهود المبذولة', 'size': 3}], 'main_title': 'نص الخطاب الملكي أمام البرلمان'}, {'community_id': '1', 'articles': [{'id': '8', 'title': 'محمد بورجي مدربا لنادي بانداري الكيني', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d9%85%d8%ad%d9%85%d8%af-%d8%a8%d9%88%d8%b1%d8%ac%d9%8a-%d9%85%d8%af%d8%b1%d8%a8%d8%a7-%d9%84%d8%a8%d8%a7%d9%86%d8%af%d8%a7%d8%b1%d9%8a-%d8%a7%d9%84%d9%83%d9%8a%d9%86%d9%8a-1637966.html', 'summary': 'محمد بورجي مدربا لنادي بانداري الكيني. أعلن نادي بانداري الكيني، الذي ينافس في دوري الدرجة الأولى الكيني لكرة القدم، عن تعيين الإطار المغربي محمد بورجي مدربا جديدا للفريق، خلفا لكين أوديامبو الذي تمت إقالته عقب بداية موسم مخيبة للآمال. ووقّع بورجي، البالغ من العمر 44 سنة، عقدا لمدة سنة واحدة مع النادي الذي يمثل مدينة مومباسا (جنوب كينيا)، وسيعاونه في مهامه  محمد بورجي مدربا لنادي بانداري الكيني     - هسبريس جريدة إلكترونية مغربية .', 'size': 2}, {'id': '181', 'title': 'الإطار المغربي محمد بورجي مدربا جديدا لنادي بانداري الكيني', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a7%d9%84%d8%a5%d8%b7%d8%a7%d8%b1-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8%d9%8a-%d9%85%d8%ad%d9%85%d8%af-%d8%a8%d9%88%d8%b1%d8%ac%d9%8a-%d9%85%d8%af%d8%b1%d8%a8%d8%a7-%d8%ac%d8%af%d9%8a%d8%af%d8%a7/', 'summary': 'الإطار المغربي محمد بورجي مدربا جديدا لنادي بانداري الكيني. أعلن نادي بانداري الكيني، الذي ينافس في دوري الدرجة الأولى الكيني لكرة القدم، عن تعيين الإطار المغربي محمد بورجي مدربا جديدا للفريق، خلفا لكين أوديامبو الذي تمت إقالته عقب بداية موسم مخيبة للآمال. ووقع بورجي، (44 سنة)، عقدا لمدة سنة واحدة مع النادي الذي يمثل مدينة مومباسا (جنوب كينيا)، وسيعاونه في مهامه مواطنه طارق بندامو  الإطار المغربي محمد بورجي مدربا جديدا لنادي بانداري الكيني     .', 'size': 2}], 'main_title': 'محمد بورجي مدربا لنادي بانداري الكيني'}, {'community_id': '11', 'articles': [{'id': '17', 'title': 'الملك: تأطير المواطنين والتعريف بالمبادرات ليست مسؤولية الحكومة وحدها', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-664914.html', 'summary': 'الملك: تأطير المواطنين والتعريف بالمبادرات ليست مسؤولية الحكومة وحدها. هبة بريس – الرباط أكد الملك محمد السادس على ضرورة إعطاء عناية خاصة لتأطير المواطنين والتعريف بالمبادرات التي تتخذها السلطات العمومية بمختلف القوانين والقرارات لاسيما تلك التي تهم حقوق و حريات المواطنين بصفة مباشرة. وذكر جلالته في خطابه بمناسبة افتتاح الدورة الأولى من السنة التشريعية الخامسة من الولاية التشريعية الحادية عشرة، اليوم الجمعة، أن هذه المسألة', 'size': 2}, {'id': '114', 'title': 'الملك أمام النواب: من غير المقبول التهاون في الاستثمار العمومي', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/national/414267.html', 'summary': 'الملك أمام النواب: من غير المقبول التهاون في الاستثمار العمومي. لتحقيق العدالة الاجتماعية في المغرب، شدد الملك محمد السادس على أهمية تعبئة كل الطاقات الوطنية. وعلى صعيد الأولويات، ركز الملك في افتتاح السنة التشريعية الخامسة والأخيرة', 'size': 2}, {'id': '122', 'title': 'جلالة الملك: العدالة الاجتماعية ومحاربة الفوارق المجالية “ليست مجرد شعار فارغ أو أولوية مرحلية”', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%ac%d9%84%d8%a7%d9%84%d8%a9-%d8%a7%d9%84%d9%85%d9%84%d9%83-%d8%a7%d9%84%d8%b9%d8%af%d8%a7%d9%84%d8%a9-%d8%a7%d9%84%d8%a7%d8%ac%d8%aa%d9%85%d8%a7%d8%b9%d9%8a%d8%a9-%d9%88%d9%85%d8%ad%d8%a7%d8%b1/', 'summary': 'جلالة الملك: العدالة الاجتماعية ومحاربة الفوارق المجالية “ليست مجرد شعار فارغ أو أولوية مرحلية”. أكد جلالة الملك محمد السادس أن العدالة الاجتماعية ومحاربة الفوارق المجالية “ليست مجرد شعار فارغ، أو أولوية مرحلية قد تتراجع أهميتها حسب الظروف”. وشدد جلالة الملك، في خطابه بمناسبة افتتاح الدورة الأولى من السنة التشريعية الخامسة من الولاية التشريعية الحادية عشرة، الذي ألقاه، اليوم الجمعة (10 أكتوبر) في مقر البرلمان، أن العدالة الاجتماعية “نعتبرها توجهاً', 'size': 6}, {'id': '134', 'title': 'الملك يحث الحكومة والمعارضة على تغليب المصلحة العليا للوطن', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/325878/', 'summary': 'الملك يحث الحكومة والمعارضة على تغليب المصلحة العليا للوطن. دعا جلالة الملك محمد السادس، اليوم الجمعة، بمناسبة افتتاح الدورة الخريفية للبرلمان، ممثلي الأمة إلى التعبئة الشاملة لمواجهة ما وصفه بعام حافل بالمشاريع والتحديات، مؤكداً على ضرورة توحيد الجهود بين الحكومة والبرلمان، أغلبيةً ومعارضة، من أجل تغليب المصلحة العليا للوطن والمواطنين. وأكد جلالة الملك في خطابه أن المرحلة المقبلة تستدعي قدراً عالياً من المسؤولية والنزاهة', 'size': 7}, {'id': '144', 'title': 'الملك يدعو إلى إعطاء عناية خاصة للمناطق الأكثر هشاشة وتوسيع نطاق المراكز القروية', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-593268.html', 'summary': 'الملك يدعو إلى إعطاء عناية خاصة للمناطق الأكثر هشاشة وتوسيع نطاق المراكز القروية. دعا الملك محمد السادس، إلى إعطاء عناية خاصة للمناطق الأكثر هشاشة بما يراعي خصوصياتها وطبيعة حاجياتها وخاصة مناطق الجبال والواحات، مؤكدا أنه “لا يمكن تحقيق التنمية الترابية المنسجمة بدون تكامل وتضامن فعلي بين المناطق والجهات”. وأضاف الملك محمد السادس، في خطابه أمام أعضاء مجلسي البرلمان بمناسبة افتتاح الدورة الأولى من السنة التشريعية الخامسة', 'size': 7}, {'id': '194', 'title': 'الملك: ننتظر وتيرة أسرع وأثراً أقوى من الجيل الجديد لبرامج التنمية الترابية', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/478191.html', 'summary': 'الملك: ننتظر وتيرة أسرع وأثراً أقوى من الجيل الجديد لبرامج التنمية الترابية. قال الملك محمد السادس إن “التحول الكبير الذي نسعى إلى تحقيقه على مستوى التنمية الترابية، يقتضي تغييراً ملموساً في العقليات وفي طرق العمل، وترسيخاً حقيقياً لثقافة النتائج، بناءً على معطيات ميدانية دقيقة، واستثماراً أمثل للتكنولوجيا الرقمية”. ودعا الملك محمد السادس في خطاب افتتاح الدورة التشريعية للبرلمان لوتيرة أسرع وأثراً أقوى من الجيل الجديد من برامج …', 'size': 5}, {'id': '241', 'title': 'الملك محمد السادس يدعو الحكومة والبرلمان إلى تغليب المصالح العليا للوطن والمواطنين', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7%d8%af%d8%b3-%d9%8a%d8%af%d8%b9%d9%88-%d8%a7%d9%84%d8%ad%d9%83%d9%88%d9%85%d8%a9-%d9%88%d8%a7%d9%84%d8%a8%d8%b1%d9%84/', 'summary': 'الملك محمد السادس يدعو الحكومة والبرلمان إلى تغليب المصالح العليا للوطن والمواطنين. دعا الملك محمد السادس، اليوم الجمعة 10 أكتوبر 2025، في خطابه خلال افتتاح الدورة الأولى من السنة التشريعية الخامسة من الولاية التشريعية الحادية عشرة، الحكومة والبرلمان (أغلبية ومعارضة) إلى تغليب المصلحة العليا للوطن والمواطنين. وقال الملك محمد السادس في خطابه السامي، “إن السنة التي نحن مقبلون عليها حافلة بالمشاريع والتحديات، وإننا ننتظر منكم …  الملك محمد السادس يدعو الحكومة والبرلمان إلى تغليب المصالح العليا للوطن والمواطنين     .', 'size': 4}, {'id': '406', 'title': 'جلالة الملك : تأطير المواطنين واجب “على عاتق الجميع” وليس الحكومة وحدها', 'source': 'rue20.com', 'link': 'https://rue20.com/944162.html', 'summary': 'جلالة الملك : تأطير المواطنين واجب “على عاتق الجميع” وليس الحكومة وحدها. . الرباط دعا الملك محمد السادس، في خطابه اليوم بمناسبة افتتاح البرلمان، إلى إعطاء عناية خاصة لتأطير المواطنين، والتعريف بالمبادرات التي تتخذها السلطات العمومية ومختلف القوانين والقرارات، ولا سيما تلك التي تهم حقوق وحريات المواطنين بصفة مباشرة، مؤكدا أن هذه المسألة ليست مسؤولية الحكومة وحدها، وإنما هي مسؤولية الجميع، وفي مقدمتهم البرلمانيون لأنهم يمثلون الخبر جلالة الملك : تأطير المواطنين واجب “على عاتق الجميع” وليس الحكومة وحدها  .', 'size': 5}, {'id': '420', 'title': 'الملك يدعو الحكومة والبرلمان إلى تعبئة كل الطاقات وتغليب المصالح العليا للوطن والمواطنين', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%8a%d8%af%d8%b9%d9%88-%d8%a7%d9%84%d8%ad%d9%83%d9%88%d9%85%d8%a9-%d9%88%d8%a7%d9%84%d8%a8%d8%b1%d9%84%d9%85%d8%a7%d9%86-%d8%a5%d9%84%d9%89-%d8%aa%d8%b9%d8%a8%d8%a6/', 'summary': 'الملك يدعو الحكومة والبرلمان إلى تعبئة كل الطاقات وتغليب المصالح العليا للوطن والمواطنين. دعا صاحب الجلالة الملك محمد السادس الحكومة والبرلمان إلى تعبئة كل الطاقات والإمكانات، وتغليب المصالح العليا للوطن والمواطنين. وقال جلالة الملك، في الخطاب السامي  الملك يدعو الحكومة والبرلمان إلى تعبئة كل الطاقات وتغليب المصالح العليا للوطن والمواطنين     .', 'size': 3}], 'main_title': 'الملك يحث الحكومة والمعارضة على تغليب المصلحة العليا للوطن'}, {'community_id': '10', 'articles': [{'id': '46', 'title': 'صدمة لترامب.. تتويج الفنزويلية ماريا كورينا ماتشادو بجائزة نوبل للسلام', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-664814.html', 'summary': 'صدمة لترامب.. تتويج الفنزويلية ماريا كورينا ماتشادو بجائزة نوبل للسلام. هبة بريس – وكالات أعلنت لجنة نوبل النرويجية عن الفائز بجائزة نوبل للسلام لعام 2025، الجمعة، ومنحتها إلى زعيمة المعارضة الفنزويلية ماريا كورينا ماتشادو. وقالت لجنة نوبل النرويجية في بيان إن ماتشادو فازت “بفضل عملها الدؤوب في تعزيز الحقوق الديمقراطية لشعب فنزويلا ونضالها من أجل تحقيق انتقال عادل وسلمي من الدكتاتورية إلى الديمقراطية”. ولطالما قال', 'size': 2}, {'id': '234', 'title': 'لم تمنج لترامب.. زعيمة المعارضة الفنزويلية تظفر بجائزة نوبل للسلام', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d9%84%d9%85-%d8%aa%d9%85%d9%86%d8%ac-%d9%84%d8%aa%d8%b1%d8%a7%d9%85%d8%a8-%d8%b2%d8%b9%d9%8a%d9%85%d8%a9-%d8%a7%d9%84%d9%85%d8%b9%d8%a7%d8%b1%d8%b6%d8%a9-%d8%a7%d9%84%d9%81%d9%86%d8%b2%d9%88%d9%8a/', 'summary': 'لم تمنج لترامب.. زعيمة المعارضة الفنزويلية تظفر بجائزة نوبل للسلام. المساء اليوم – متابعات أعلنت لجنة نوبل عن الفائز بجائزة نوبل للسلام لعام 2025، اليوم الجمعة، ومنحتها إلى زعيمة المعارضة الفنزويلية ماريا كورينا ماتشادو. وقالت لجنة نوبل في بيان إن ماتشادو فازت “بفضل', 'size': 2}], 'main_title': 'صدمة لترامب.. تتويج الفنزويلية ماريا كورينا ماتشادو بجائزة نوبل للسلام'}, {'community_id': '8', 'articles': [{'id': '59', 'title': 'أشبال المنتخب المغربي يتأهلون إلى ربع نهائي مونديال الشيلي لأقل من 20 سنة بعد انتصار مستحق على كوريا الجنوبية', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/207241', 'summary': 'أشبال المنتخب المغربي يتأهلون إلى ربع نهائي مونديال الشيلي لأقل من 20 سنة بعد انتصار مستحق على كوريا الجنوبية.  بكل فخر واعتزاز، تمكن أشبال المنتخب المغربي لأقل من 20 سنة من حجز بطاقة التأهل إلى دور الربع من كأس العالم المقامة بدولة الشيلي، بعد فوزهم المستحق على منتخب كوريا الجنوبية بنتيجة 2 مقابل 1، في المباراة التي جرت مساء الخميس 9 أكتوبر 2025 على الساعة الثانية عشرة ليلاً بتوقيت المغرب. المنتخب المغربي أبان', 'size': 2}, {'id': '83', 'title': 'المنتخب المغربي يتخطى كوريا الجنوبية ويبلغ ربع نهائي كأس العالم بالشيلي', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/sport/lionatlas/414234.html', 'summary': 'المنتخب المغربي يتخطى كوريا الجنوبية ويبلغ ربع نهائي كأس العالم بالشيلي. حقق المنتخب المغربي لأقل من 20 سنة فوزًا ثمينًا على كوريا الجنوبية 2-1 في ختام مباريات ثمن النهائي من كأس العالم المقامة في الشيلي. افتتح المغرب', 'size': 2}], 'main_title': 'أشبال المنتخب المغربي يتأهلون إلى ربع نهائي مونديال الشيلي لأقل من 20 سنة بعد انتصار مستحق على كوريا الجنوبية'}, {'community_id': '7', 'articles': [{'id': '60', 'title': 'سلا.. شرطي يطلق رصـ ـاصة لتوقيف جـ ـانح هاجـ ـم الأمن بالسـ ـلاح الأبيض', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/207237', 'summary': 'سلا.. شرطي يطلق رصـ ـاصة لتوقيف جـ ـانح هاجـ ـم الأمن بالسـ ـلاح الأبيض.  اضطر موظف شرطة يعمل بفرقة مكافحة العصابات بالمصلحة الإقليمية للشرطة القضائية بمدينة سلا لاستعمال سلاحه الوظيفي، اليوم الخميس 09 أكتوبر الجاري، خلال تدخل أمني لتوقيف شخص يبلغ من العمر 22 سنة، من ذوي السوابق القضائية العديدة في الجرائم العنيفة، وذلك بعد تورطه في تعريض عناصر الشرطة لاعتداء جدي وخطير باستعمال السلاح الأبيض. وكانت عناصر', 'size': 2}, {'id': '72', 'title': 'إصابة مشتبه فيه خلال تدخل أمني في سلا', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/414219.html', 'summary': 'إصابة مشتبه فيه خلال تدخل أمني في سلا. اضطر موظف شرطة يعمل بفرقة مكافحة العصابات بالمصلحة الإقليمية للشرطة القضائية بمدينة سلا لاستعمال سلاحه الوظيفي، اليوم الخميس 09 أكتوبر الجاري، خلال تدخل أمني لتوقيف', 'size': 2}], 'main_title': 'سلا.. شرطي يطلق رصـ ـاصة لتوقيف جـ ـانح هاجـ ـم الأمن بالسـ ـلاح الأبيض'}, {'community_id': '9', 'articles': [{'id': '115', 'title': 'نص خطاب الملك محمد السادس أمام البرلمان', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/national/414268.html', 'summary': 'نص خطاب الملك محمد السادس أمام البرلمان. وجه صاحب الجلالة الملك محمد السادس، نصره الله، مرفوقا بولي العهد صاحب السمو الملكي الأمير مولاي الحسن، وصاحب السمو الملكي الأمير مولاي رشيد، اليوم الجمعة،', 'size': 2}, {'id': '221', 'title': 'النص الكامل لخطاب جلالة الملك في افتتاح البرلمان', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/228292/', 'summary': 'النص الكامل لخطاب جلالة الملك في افتتاح البرلمان. الرباط – وجه صاحب الجلالة الملك محمد السادس، نصره الله، مرفوقا بولي العهد صاحب السمو الملكي الأمير مولاي الحسن، وصاحب السمو الملكي الأمير مولاي رشيد، اليوم الجمعة، خطابا ساميا إلى أعضاء البرلمان بمناسبة افتتاح الدورة الأولى من السنة التشريعية الخامسة من الولاية التشريعية الحادية عشرة. وفي ما يلي نص الخطاب الملكي السامي : ” الحمد', 'size': 3}, {'id': '242', 'title': 'النص الكامل للخطاب الملكي بمناسبة افتتاح الدورة الخريفية للبرلمان', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d9%86%d8%b5-%d8%a7%d9%84%d9%83%d8%a7%d9%85%d9%84-%d9%84%d9%84%d8%ae%d8%b7%d8%a7%d8%a8-%d8%a7%d9%84%d9%85%d9%84%d9%83%d9%8a-%d8%a8%d9%85%d9%86%d8%a7%d8%b3%d8%a8%d8%a9-%d8%a7%d9%81%d8%aa-3/', 'summary': 'النص الكامل للخطاب الملكي بمناسبة افتتاح الدورة الخريفية للبرلمان. ألقى الملك محمد السادس، مرفوقا بولي العهد الأمير مولاي الحسن والأمير مولاي رشيد، اليوم الجمعة 10 أكتوبر 2025، خطابا ساميا أمام أعضاء البرلمان، بمناسبة افتتاح الدورة الأولى من السنة التشريعية الخامسة للولاية التشريعية الحادية عشرة. وفي ما يلي النص الكامل للخطاب الملكي بمناسبة افتتاح البرلمان – 10 أكتوبر 2025: « الحمد لله، والصلاة والسلام …  النص الكامل للخطاب الملكي بمناسبة افتتاح الدورة الخريفية للبرلمان     .', 'size': 2}], 'main_title': 'النص الكامل لخطاب جلالة الملك في افتتاح البرلمان'}, {'community_id': '5', 'articles': [{'id': '149', 'title': '“كان المغرب 2025″.. قرار جديد لـ”الكاف” يخص وسائل الإعلام', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-593241.html', 'summary': '“كان المغرب 2025″.. قرار جديد لـ”الكاف” يخص وسائل الإعلام. أعلن الاتحاد الإفريقي لكرة القدم (الكاف)، الجمعة، أنه قرر تمديد فترة اعتماد ممثلي وسائل الإعلام الخاصة بكأس الأمم الإفريقية (المغرب 2025) إلى غاية يوم الاثنين 20 أكتوبر الجاري، وذلك بعد الطلبات العالمية المتزايدة التي توصل بها. وأشار (الكاف)، على موقعه الرسمي، إلى أن الاهتمام غير المسبوق من مختلف أنحاء العالم من ممثلي', 'size': 3}, {'id': '342', 'title': 'كان 2025.. الاهتمام العالمي الكبير يدفع “الكاف” إلى تمديد فترة اعتماد وسائل الإعلام', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%83%d8%a7%d9%86-2025-%d8%a7%d9%84%d8%a7%d9%87%d8%aa%d9%85%d8%a7%d9%85-%d8%a7%d9%84%d8%b9%d8%a7%d9%84%d9%85%d9%8a-%d8%a7%d9%84%d9%83%d8%a8%d9%8a%d8%b1-%d9%8a%d8%af%d9%81%d8%b9-%d8%a7%d9%84%d9%83/', 'summary': 'كان 2025.. الاهتمام العالمي الكبير يدفع “الكاف” إلى تمديد فترة اعتماد وسائل الإعلام. أعلن الاتحاد الإفريقي لكرة القدم (الكاف)، اليوم الجمعة (10 أكتوبر)، أنه قرر تمديد فترة اعتماد ممثلي وسائل الإعلام الخاصة بكأس الأمم الإفريقية (المغرب 2025) إلى غاية يوم الاثنين 20 أكتوبر الجاري، وذلك بعد الطلبات العالمية المتزايدة التي توصل بها. وأشار “الكاف”، على موقعه الرسمي، إلى أن الاهتمام غير المسبوق من مختلف أنحاء العالم من ممثلي', 'size': 3}, {'id': '445', 'title': 'بسبب الطلبات المتزايدة: “الكاف” يمدد فترة اعتماد الصحافيين بكأس إفريقيا للأمم', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%a8%d8%b3%d8%a8%d8%a8-%d8%a7%d9%84%d8%b7%d9%84%d8%a8%d8%a7%d8%aa-%d8%a7%d9%84%d9%85%d8%aa%d8%b2%d8%a7%d9%8a%d8%af%d8%a9-%d8%a7%d9%84%d9%83%d8%a7%d9%81-%d9%8a%d9%85%d8%af%d8%af-%d9%81%d8%aa/', 'summary': 'بسبب الطلبات المتزايدة: “الكاف” يمدد فترة اعتماد الصحافيين بكأس إفريقيا للأمم. المساء اليوم: أعلن الاتحاد الإفريقي لكرة القدم (الكاف)، اليوم الجمعة، أنه قرر تمديد فترة اعتماد ممثلي وسائل الإعلام الخاصة بكأس الأمم الإفريقية (المغرب 2025) إلى غاية يوم الاثنين 20 أكتوبر الجاري، وذلك بعد الطلبات', 'size': 3}], 'main_title': '“كان المغرب 2025″.. قرار جديد لـ”الكاف” يخص وسائل الإعلام'}, {'community_id': '6', 'articles': [{'id': '152', 'title': 'تعيينات أمنية جديدة', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-593209.html', 'summary': 'تعيينات أمنية جديدة. أعلنت المديرية العامة للأمن الوطني، عن قائمة جديدة لعدد من التعيينات في مناصب المسؤولية بالمصالح اللاممركزة بولاية أمن أكادير، أشر عليها المدير العام للأمن الوطني عبد اللطيف حموشي. وقد همت التعيينات الجديدة التي 12 منصبا للمسؤولية في تخصصات مرتبطة بالأمن العمومي، وجاءت في سياق حركية داخلية بين رؤساء تسع دوائر للشرطة بالمنطقة الأمنية', 'size': 2}, {'id': '228', 'title': 'المديرية العامة للأمن الوطني تواصل تجديد النخب الأمنية.. تعيينات جديدة بولاية أمن أكادير', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/228275/', 'summary': 'المديرية العامة للأمن الوطني تواصل تجديد النخب الأمنية.. تعيينات جديدة بولاية أمن أكادير. في إطار استراتيجية المديرية العامة للأمن الوطني الرامية إلى ترسيخ مبدأ التداول على مناصب المسؤولية وفتح المجال أمام الكفاءات الأمنية الجديدة، أعلنت المديرية، بتأشير من مديرها العام عبد اللطيف حموشي، عن دفعة جديدة من التعيينات في مناصب المسؤولية على مستوى ولاية أمن أكادير. التعيينات الجديدة شملت 12 منصباً في تخصصات مختلفة تتعلق بالأمن العمومي،', 'size': 2}], 'main_title': 'تعيينات أمنية جديدة'}, {'community_id': '13', 'articles': [{'id': '166', 'title': 'المغاربة يترقبون خطاب الملك وسط آمال في التغيير والإصلاح', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1107221.html', 'summary': 'المغاربة يترقبون خطاب الملك وسط آمال في التغيير والإصلاح. يترقب المغاربة، اليوم، بكل اهتمام، الخطاب الملكي السامي الذي سيلقيه صاحب الجلالة الملك محمد السادس نصره الله وأيده، بمناسبة افتتاح السنة التشريعية الجديدة، وهو الحدث الدستوري الذي يُنظم سنوياً في كل ثاني جمعة من شهر أكتوبر داخل قبة البرلمان. ويُعد هذا الموعد مناسبة محورية في الحياة السياسية للمملكة، حيث يشكل انطلاقة رسمية للدورة التشريعية الجديدة، ظهرت المقالة المغاربة يترقبون خطاب الملك وسط آمال في التغيير والإصلاح  .', 'size': 2}, {'id': '335', 'title': 'الملك محمد السادس يعلن من البرلمان بداية مرحلة المحاسبة والمسؤولية الجماعية', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/writers/414283.html', 'summary': 'الملك محمد السادس يعلن من البرلمان بداية مرحلة المحاسبة والمسؤولية الجماعية. في لحظة مفصلية من الحياة السياسية الوطنية، ألقى صاحب الجلالة الملك محمد السادس نصره الله وأيده، خطاباً سامياً بمناسبة افتتاح الدورة الأولى من السنة التشريعية', 'size': 2}], 'main_title': 'المغاربة يترقبون خطاب الملك وسط آمال في التغيير والإصلاح'}, {'community_id': '0', 'articles': [{'id': '296', 'title': 'ماكرون يعيد تعيين لوكورنو ويكلفه بتشكيل حكومة جديدة', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-665012.html', 'summary': 'ماكرون يعيد تعيين لوكورنو ويكلفه بتشكيل حكومة جديدة. أعاد الرئيس الفرنسي إيمانويل ماكرون تعيين سيباستيان لوكورنو رئيسًا للوزراء يوم الجمعة، وكلفه بتشكيل حكومة جديدة، في خطوة تهدف إلى كسر الجمود السياسي الذي تواجهه فرنسا مع برلمان منقسم وصعوبة إقرار ميزانيات تقشفية. وجاء القرار بعد أربعة أيام من استقالة لوكورنو، عقب مفاوضات مطولة مع قادة الأحزاب السياسية الرئيسية في قصر الإليزيه. وأكد لوكورنو عبر', 'size': 2}, {'id': '408', 'title': 'الإليزيه: إعادة تعيين لوكورنو رئيسا للوزراء وتكليفه بتشكيل الحكومة', 'source': 'machahid24.com', 'link': 'https://machahid24.com/international/478207.html', 'summary': 'الإليزيه: إعادة تعيين لوكورنو رئيسا للوزراء وتكليفه بتشكيل الحكومة. متابعة أعلن مكتب الرئيس الفرنسي إيمانويل ماكرون، مساء اليوم الجمعة، إعادة تعيين سيباستيان لوكورنو رئيسا للوزراء، مع تكليفه بتشكيل حكومة جديدة. وقال قصر الإليزيه في بيان “سمى رئيس الجمهورية سيباستيان لوكورنو رئيساً للوزراء وكلفه بتشكيل الحكومة”. يأتي ذلك بعد أيام فقط من استقالة لوكورنو، ما تسبب بأزمة سياسية هي الأسوأ في فرنسا منذ 70 عاما. …', 'size': 2}], 'main_title': 'ماكرون يعيد تعيين لوكورنو ويكلفه بتشكيل حكومة جديدة'}, {'community_id': '12', 'articles': [{'id': '303', 'title': 'الطقس غدا السبت.. أمطار رعدية ورياح قوية', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-664991.html', 'summary': 'الطقس غدا السبت.. أمطار رعدية ورياح قوية. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليوم غد السبت، نزول أمطار قد تكون رعدية بالريف، والواجهة المتوسطية والمنطقة الشرقية. وسيلاحظ تشكل سحب منخفضة مع كتل ضبابية خلال الصباح والليل بالسواحل الأطلسية، مع هبوب رياح قوية نوعا ما بمنطقة طنجة والمنطقة الشرقية والسواحل الوسطى والجنوبية مع تناثر غبار محلي بالأقاليم الصحراوية للمملكة. وستتراوح درجات الحرارة الدنيا', 'size': 2}, {'id': '369', 'title': 'أمطار مرتقبة يوم غد السبت بهذه المناطق منالمملكة', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-593307.html', 'summary': 'أمطار مرتقبة يوم غد السبت بهذه المناطق منالمملكة. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليوم غد السبت، نزول أمطار قد تكون رعدية بالريف، والواجهة المتوسطية والمنطقة الشرقية. وسيلاحظ تشكل سحب منخفضة مع كتل ضبابية خلال الصباح والليل بالسواحل الأطلسية، مع هبوب رياح قوية نوعا ما بمنطقة طنجة والمنطقة الشرقية والسواحل الوسطى والجنوبية مع تناثر غبار محلي بالأقاليم الصحراوية للمملكة.', 'size': 2}], 'main_title': 'الطقس غدا السبت.. أمطار رعدية ورياح قوية'}, {'community_id': '2', 'articles': [{'id': '362', 'title': 'العلمي: الخطاب الملكي دعوة لتعزيز المسؤولية المشتركة بين مؤسسات الدولة', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/325900/', 'summary': 'العلمي: الخطاب الملكي دعوة لتعزيز المسؤولية المشتركة بين مؤسسات الدولة. أكد رئيس مجلس النواب، راشيد الطالبي العلمي، أن الخطاب السامي الذي وجهه صاحب الجلالة الملك محمد السادس، اليوم الجمعة، بمناسبة افتتاح الدورة الأولى من السنة التشريعية الخامسة من الولاية التشريعية الحادية عشرة، تضمن توجيهات سامية تروم تعزيز روح المسؤولية المشتركة لدى مختلف المؤسسات، من أجل المضي قدما في مسار التنمية الشاملة والمستدامة. وأوضح الطالبي العلمي،', 'size': 3}, {'id': '407', 'title': 'العلمي: خطاب الملك تضمن توجيهات سامية لتعزيز روح المسؤولية لدى مختلف المؤسسات', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/478210.html', 'summary': 'العلمي: خطاب الملك تضمن توجيهات سامية لتعزيز روح المسؤولية لدى مختلف المؤسسات. و.م.ع أكد رئيس مجلس النواب، راشيد الطالبي العلمي، أن الخطاب السامي الذي وجهه الملك محمد السادس، اليوم الجمعة، بمناسبة افتتاح الدورة الأولى من السنة التشريعية الخامسة من الولاية التشريعية الحادية عشرة، تضمن توجيهات سامية تروم تعزيز روح المسؤولية المشتركة لدى مختلف المؤسسات، من أجل المضي قدما في مسار التنمية الشاملة والمستدامة. وأوضح الطالبي العلمي، في …', 'size': 3}, {'id': '436', 'title': 'الطالبي العلمي: خطاب جلالة الملك تضمن توجيهات سامية', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/228309/', 'summary': 'الطالبي العلمي: خطاب جلالة الملك تضمن توجيهات سامية. أكد رئيس مجلس النواب، راشيد الطالبي العلمي، أن الخطاب السامي الذي وجهه صاحب الجلالة الملك محمد السادس، اليوم الجمعة، بمناسبة افتتاح الدورة الأولى من السنة التشريعية الخامسة من الولاية التشريعية الحادية عشرة، تضمن توجيهات سامية تروم تعزيز روح المسؤولية المشتركة لدى مختلف المؤسسات، من أجل المضي قدما في مسار التنمية الشاملة والمستدامة. وأوضح السيد الطالبي', 'size': 3}], 'main_title': 'العلمي: الخطاب الملكي دعوة لتعزيز المسؤولية المشتركة بين مؤسسات الدولة'}, {'community_id': '3', 'articles': [{'id': '374', 'title': 'الملك يستقبل رئيسي غرفتي البرلمان', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-593301.html', 'summary': 'الملك يستقبل رئيسي غرفتي البرلمان. استقبل الملك محمد السادس رئيس مجلس النواب راشيد الطالبي العلمي، الذي قدّم حصيلة أعمال المجلس برسم السنة التشريعية 2024-2025، إضافةً إلى منشورات أخرى صادرة عن المجلس. وفي السياق استقبل الملك رئيس مجلس المستشارين محمد ولد الرشيد، الذي قدم لجلالته عدة إصدارات تتضمن حصيلة أشغال مجلس المستشارين للسنة التشريعية 2024-2025. وترأس', 'size': 2}, {'id': '452', 'title': 'الملك محمد السادس يستقبل الطالبي العلمي وولد الرشيد', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7%d8%af%d8%b3-%d9%8a%d8%b3%d8%aa%d9%82%d8%a8%d9%84-%d8%a7%d9%84%d8%b7%d8%a7%d9%84%d8%a8%d9%8a-%d8%a7%d9%84%d8%b9%d9%84/', 'summary': 'الملك محمد السادس يستقبل الطالبي العلمي وولد الرشيد. استقبل الملك محمد السادس، رئيس مجلس النواب راشيد الطالبي العلمي، الذي قدّم حصيلة أعمال المجلس برسم السنة التشريعية 2024-2025، إضافةً إلى منشورات أخرى صادرة عن المجلس. وفي السياق ذاته، استقبل الملك محمد السادس، رئيس مجلس المستشارين محمد ولد الرشيد، الذي قدم لجلالته عدة إصدارات تتضمن حصيلة أشغال مجلس المستشارين للسنة التشريعية 2024-2025. وترأس …  الملك محمد السادس يستقبل الطالبي العلمي وولد الرشيد     .', 'size': 2}], 'main_title': 'الملك يستقبل رئيسي غرفتي البرلمان'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    