<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 29/06/2025 - 06h25</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '0', 'title': 'قيوح: التعاون مع إفريقيا أولوية ملكية', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d9%82%d9%8a%d9%88%d8%ad-%d8%a7%d9%84%d8%aa%d8%b9%d8%a7%d9%88%d9%86-%d9%85%d8%b9-%d8%a5%d9%81%d8%b1%d9%8a%d9%82%d9%8a%d8%a7-%d8%a3%d9%88%d9%84%d9%88%d9%8a%d8%a9-%d9%85%d9%84%d9%83%d9%8a%d8%a9-1583578.html', 'summary': 'قيوح: التعاون مع إفريقيا أولوية ملكية. أكد عبد الصمد قيوح، وزير النقل واللوجستيك، اليوم السبت بإسطنبول، أن المغرب، تحت القيادة المتبصرة للملك محمد السادس، جعل من التعاون الإفريقي محورا رئيسيا في سياسته الخارجية ونموذجه التنموي. وأوضح قيوح، في مداخلة له خلال جلسة رفيعة المستوى نُظّمت تحت عنوان “إطلاق إمكانات إفريقيا في مجال الربط”، في إطار منتدى الربط العالمي للنقل، أن المملكة  قيوح: التعاون مع إفريقيا أولوية ملكية     - هسبريس جريدة إلكترونية مغربية .', 'size': 2}, {'id': '122', 'title': 'منتدى إسطنبول.. المغرب يستعرض رؤيته لتكامل القارة الإفريقية', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%85%d9%86%d8%aa%d8%af%d9%89-%d8%a5%d8%b3%d8%b7%d9%86%d8%a8%d9%88%d9%84-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d9%8a%d8%b3%d8%aa%d8%b9%d8%b1%d8%b6-%d8%b1%d8%a4%d9%8a%d8%aa%d9%87-%d9%84%d8%aa%d9%83/', 'summary': 'منتدى إسطنبول.. المغرب يستعرض رؤيته لتكامل القارة الإفريقية. أكد عبد الصمد قيوح، وزير النقل واللوجستيك، اليوم السبت (28 يونيو) من إسطنبول، أن المغرب، بقيادة جلالة الملك محمد السادس، جعل من التعاون الإفريقي حجر الزاوية في سياسته الخارجية ونموذجه التنموي. وأوضح قيوح، خلال جلسة رفيعة المستوى نظمت تحت عنوان «إطلاق إمكانات إفريقيا في مجال الربط»، ضمن منتدى الربط العالمي للنقل، أن المملكة تؤمن بضرورة', 'size': 2}, {'id': '211', 'title': 'قيوح: المغرب بقيادة جلالة الملك جعل من التعاون الإفريقي محورا رئيسيا في سياسته الخارجية', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/223654/', 'summary': 'قيوح: المغرب بقيادة جلالة الملك جعل من التعاون الإفريقي محورا رئيسيا في سياسته الخارجية. وكالات أكد وزير النقل واللوجستيك، عبد الصمد قيوح، اليوم السبت بإسطنبول، أن المغرب، تحت القيادة المتبصرة لصاحب الجلالة الملك محمد السادس، جعل من التعاون الإفريقي محورا رئيسيا في سياسته الخارجية ونموذجه التنموي. وأوضح قيوح، في مداخلة له خلال جلسة رفيعة المستوى نُظمت تحت عنوان “إطلاق إمكانات إفريقيا في مجال الربط”، في إطار منتدى الربط', 'size': 3}], 'main_title': 'قيوح: المغرب بقيادة جلالة الملك جعل من التعاون الإفريقي محورا رئيسيا في سياسته الخارجية'}, {'community_id': '1', 'articles': [{'id': '9', 'title': 'مطار البيضاء يضبط مهرب كوكايين', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d9%85%d8%b7%d8%a7%d8%b1-%d8%a7%d9%84%d8%a8%d9%8a%d8%b6%d8%a7%d8%a1-%d9%8a%d8%b6%d8%a8%d8%b7-%d9%85%d9%87%d8%b1%d8%a8-%d9%83%d9%88%d9%83%d8%a7%d9%8a%d9%8a%d9%86-1583620.html', 'summary': 'مطار البيضاء يضبط مهرب كوكايين. تمكنت عناصر الأمن الوطني بمطار محمد الخامس الدولي بمدينة الدار البيضاء، أمس الجمعة، من توقيف مواطن ينحدر من إحدى دول إفريقيا جنوب الصحراء، يبلغ من العمر 24 سنة، وذلك للاشتباه في تورطه في قضية تتعلق بالتهريب الدولي لمخدر الكوكايين. وقد جرى توقيف المشتبه فيه مباشرة بعد وصوله على متن رحلة جوية قادمة من أحد المطارات  مطار البيضاء يضبط مهرب كوكايين     - هسبريس جريدة إلكترونية مغربية .', 'size': 5}, {'id': '123', 'title': 'عثر بحوزته على أزيد من 5 كلغ من الكوكايين.. توقيف إفريقي قادم من أمريكا الجنوبية في مطار محمد الخامس', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%b9%d8%ab%d8%b1-%d8%a8%d8%ad%d9%88%d8%b2%d8%aa%d9%87-%d8%b9%d9%84%d9%89-%d8%a3%d8%b2%d9%8a%d8%af-%d9%85%d9%86-5-%d9%83%d9%84%d8%ba-%d9%85%d9%86-%d8%a7%d9%84%d9%83%d9%88%d9%83%d8%a7%d9%8a%d9%8a/', 'summary': 'عثر بحوزته على أزيد من 5 كلغ من الكوكايين.. توقيف إفريقي قادم من أمريكا الجنوبية في مطار محمد الخامس. تمكنت عناصر الأمن الوطني بمطار محمد الخامس الدولي بمدينة الدار البيضاء، يوم أمس الجمعة (27 يونيو)، من توقيف مواطن ينحدر من إحدى دول إفريقيا جنوب الصحراء، يبلغ من العمر 24 سنة، وذلك للاشتباه في تورطه في قضية تتعلق بالتهريب الدولي لمخدر الكوكايين. وقد جرى توقيف المشتبه فيه مباشرة بعد وصوله على متن رحلة جوية قادمة', 'size': 5}, {'id': '163', 'title': '5.6 كيلو من الكوكايين بحوزة مسافر وصل مطار محمد الخامس قادما من أمريكا الجنوبية', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/5-6-%d9%83%d9%8a%d9%84%d9%88-%d9%85%d9%86-%d8%a7%d9%84%d9%83%d9%88%d9%83%d8%a7%d9%8a%d9%8a%d9%86-%d8%a8%d8%ad%d9%88%d8%b2%d8%a9-%d9%85%d8%b3%d8%a7%d9%81%d8%b1-%d9%88%d8%b5%d9%84-%d9%85%d8%b7%d8%a7/', 'summary': '5.6 كيلو من الكوكايين بحوزة مسافر وصل مطار محمد الخامس قادما من أمريكا الجنوبية. تمكنت عناصر الأمن الوطني بمطار محمد الخامس الدولي بمدينة الدار البيضاء، أمس الجمعة، من توقيف مواطن ينحدر من إحدى دول إفريقيا جنوب الصحراء، يبلغ من العمر 24 سنة، وذلك للاشتباه في تورطه في قضية تتعلق بالتهريب الدولي لمخدر الكوكايين. وقد جرى توقيف المشتبه فيه، وفق مصدر أمني، مباشرة بعد وصوله على متن رحلة جوية قادمة  5.6 كيلو من الكوكايين بحوزة مسافر وصل مطار محمد الخامس قادما من أمريكا الجنوبية     .', 'size': 5}, {'id': '339', 'title': 'الدار البيضاء.. تفتيش دقيق يطيح بمسافر إفريقي بحوزته 5,6 كلغ من الكوكايين', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/316829/', 'summary': 'الدار البيضاء.. تفتيش دقيق يطيح بمسافر إفريقي بحوزته 5,6 كلغ من الكوكايين. تمكنت عناصر الأمن الوطني بمطار محمد الخامس الدولي بمدينة الدار البيضاء، يوم أمس الجمعة 27 يونيو الجاري، من توقيف مواطن ينحدر من إحدى دول إفريقيا جنوب الصحراء، يبلغ من العمر 24 سنة، وذلك للاشتباه في تورطه في قضية تتعلق بالتهريب الدولي المخدر الكوكايين. وقد جرى توقيف المشتبه فيه مباشرة بعد وصوله على متن رحلة جوية', 'size': 5}, {'id': '364', 'title': 'توقيف إفريقي بمطار الدارالبيضاء بحوزته 5 كلغ من الكوكايين', 'source': 'rue20.com', 'link': 'https://rue20.com/916467.html', 'summary': 'توقيف إفريقي بمطار الدارالبيضاء بحوزته 5 كلغ من الكوكايين.  الرباط تمكنت عناصر الأمن الوطني بمطار محمد الخامس الدولي بمدينة الدار البيضاء، يوم أمس الجمعة 27 يونيو الجاري، من توقيف مواطن ينحدر من إحدى دول إفريقيا جنوب الصحراء، يبلغ من العمر 24 سنة، وذلك للاشتباه في تورطه في قضية تتعلق بالتهريب الدولي لمخدر الكوكايين. وقد جرى توقيف المشتبه فيه مباشرة بعد وصوله على متن الخبر توقيف إفريقي بمطار الدارالبيضاء بحوزته 5 كلغ من الكوكايين  .', 'size': 5}], 'main_title': 'مطار البيضاء يضبط مهرب كوكايين'}, {'community_id': '9', 'articles': [{'id': '64', 'title': 'الرباط.. توقيف متطرفة موالية لتنظيم “داعش” الإرهابي للاشتباه في تورطها في الإعداد والتحضير لتنفيذ مخطط إرهابي بالغ الخطورة', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/202680', 'summary': 'الرباط.. توقيف متطرفة موالية لتنظيم “داعش” الإرهابي للاشتباه في تورطها في الإعداد والتحضير لتنفيذ مخطط إرهابي بالغ الخطورة.  تمكن المكتب المركزي للأبحاث القضائية على ضوء معلومات استخباراتية دقيقة وفرتها المديرية العامة لمراقبة التراب الوطني، أمس الجمعة، من توقيف متطرفة موالية لتنظيم “داعش” الإرهابي، تبلغ من العمر 21 سنة وتتابع دراستها في أحد المعاهد التقنية العليا، وذلك للاشتباه في تورطها في الإعداد والتحضير لتنفيذ مخطط إرهابي بالغ الخطورة يستهدف المساس الخطير بالنظام العام.', 'size': 3}, {'id': '126', 'title': 'أعدت لمخطط إرهابي.. توقيف متطرفة موالية لـ”داعش” بالرباط', 'source': 'assabah.ma', 'link': 'https://assabah.ma/855987.html', 'summary': 'أعدت لمخطط إرهابي.. توقيف متطرفة موالية لـ”داعش” بالرباط. تمكن المكتب المركزي للأبحاث القضائية على ضوء معلومات استخباراتية دقيقة وفرتها المديرية العامة لمراقبة التراب الوطني، أمس الجمعة، من توقيف متطرفة موالية لتنظيم “داعش” الإرهابي، تبلغ من العمر 21 سنة وتتابع دراستها في أحد المعاهد التقنية العليا، وذلك للاشتباه في تورطها في الإعداد والتحضير لتنفيذ مخطط إرهابيأكمل القراءة » المقالة أعدت لمخطط إرهابي.. توقيف متطرفة موالية لـ”داعش” بالرباط  .', 'size': 2}, {'id': '220', 'title': 'عاجل.. توقيف طالبة متطرفة موالية لـ”داعش” خططت لتنفيذ هجوم إرهابي بالغ الخطورة', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/223615/', 'summary': 'عاجل.. توقيف طالبة متطرفة موالية لـ”داعش” خططت لتنفيذ هجوم إرهابي بالغ الخطورة. تمكن المكتب المركزي للأبحاث القضائية على ضوء معلومات استخباراتية دقيقة وفرتها المديرية العامة لمراقبة التراب الوطني، أمس الجمعة، من توقيف متطرفة موالية لتنظيم “داعش” الإرهابي، تبلغ من العمر 21 سنة وتتابع دراستها في أحد المعاهد التقنية العليا، وذلك للاشتباه في تورطها في الإعداد والتحضير لتنفيذ مخطط إرهابي بالغ الخطورة يستهدف المساس الخطير بالنظام العام.', 'size': 3}, {'id': '238', 'title': 'ضربة استباقية جديدة.. الأمن المغربي يُجهض مخططًا انتحاريًا تقوده شابة متطرفة', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%b6%d8%b1%d8%a8%d8%a9-%d8%a7%d8%b3%d8%aa%d8%a8%d8%a7%d9%82%d9%8a%d8%a9-%d8%ac%d8%af%d9%8a%d8%af%d8%a9-%d8%a7%d9%84%d8%a3%d9%85%d9%86-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8%d9%8a-%d9%8a%d9%8f%d8%ac/', 'summary': 'ضربة استباقية جديدة.. الأمن المغربي يُجهض مخططًا انتحاريًا تقوده شابة متطرفة. تمكن المكتب المركزي للأبحاث القضائية على ضوء معلومات استخباراتية دقيقة وفرتها المديرية العامة لمراقبة التراب الوطني، أمس الجمعة، من توقيف متطرفة موالية لتنظيم “داعش” الإرهابي، تبلغ من العمر 21 سنة وتتابع دراستها في أحد المعاهد التقنية العليا، وذلك للاشتباه في تورطها في الإعداد والتحضير لتنفيذ مخطط إرهابي بالغ الخطورة يستهدف المساس الخطير بالنظام …  ضربة استباقية جديدة.. الأمن المغربي يُجهض مخططًا انتحاريًا تقوده شابة متطرفة     .', 'size': 2}], 'main_title': 'الرباط.. توقيف متطرفة موالية لتنظيم “داعش” الإرهابي للاشتباه في تورطها في الإعداد والتحضير لتنفيذ مخطط إرهابي بالغ الخطورة'}, {'community_id': '3', 'articles': [{'id': '66', 'title': 'توقيف شخصين بابن جرير بسبب تعريضهما لعناصر الشرطة للإهانة وإحداث الفوضى وتعييب منشأة مخصصة للمنفعة العامة', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/202670', 'summary': 'توقيف شخصين بابن جرير بسبب تعريضهما لعناصر الشرطة للإهانة وإحداث الفوضى وتعييب منشأة مخصصة للمنفعة العامة.  أفادت النيابة العامة لدى المحكمة الابتدائية بابن جرير، بأنه على إثر ما يتم تداوله ببعض مواقع التواصل الاجتماعي من أخبار زائفة عن اعتقال تحكمي مزعوم لشخصين بابن جرير، فإن الأمر يتعلق في حقيقته بتوقيف قانوني لشخصين كانا في حالة سكر علني بين،وقاما بتعريض عناصر الشرطة للإهانة وإحداث الفوضى وتعييب منشآت مخصصة للمنفعة العامة.', 'size': 2}, {'id': '127', 'title': 'إهانة الشرطة وتخريب مقرهم يجر شخصين للاعتقال بابن جرير', 'source': 'assabah.ma', 'link': 'https://assabah.ma/855983.html', 'summary': 'إهانة الشرطة وتخريب مقرهم يجر شخصين للاعتقال بابن جرير. أفادت النيابة العامة لدى المحكمة الابتدائية بابن جرير، بأنه على إثر ما يتم تداوله ببعض مواقع التواصل الاجتماعي من أخبار زائفة عن اعتقال تحكمي مزعوم لشخصين بابن جرير، فإن الأمر يتعلق في حقيقته بتوقيف قانوني لشخصين كانا في حالة سكر علني بين، وقاما بتعريض عناصر الشرطة للإهانةأكمل القراءة » المقالة إهانة الشرطة وتخريب مقرهم يجر شخصين للاعتقال بابن جرير  .', 'size': 2}], 'main_title': 'توقيف شخصين بابن جرير بسبب تعريضهما لعناصر الشرطة للإهانة وإحداث الفوضى وتعييب منشأة مخصصة للمنفعة العامة'}, {'community_id': '4', 'articles': [{'id': '104', 'title': 'سور ثانوية ينهار على خمسيني وقطيعه بتيموليلت ويخلف مأساة صادمة', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/408369.html', 'summary': 'سور ثانوية ينهار على خمسيني وقطيعه بتيموليلت ويخلف مأساة صادمة. لقي رجل خمسيني مصرعه، صباح السبت 28 يونيو الجاري، إثر انهيار جزء من سور ثانوية عمر بن عبد العزيز التأهيلية بجماعة تيموليلت، التابعة لإقليم أزيلال،', 'size': 2}, {'id': '222', 'title': 'مقتل راعٍ وأغنامه في انهيار سور متهالك لمؤسسة تعليمية في أزيلال', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d9%85%d9%82%d8%aa%d9%84-%d8%b1%d8%a7%d8%b9%d9%8d-%d9%88%d8%a3%d8%ba%d9%86%d8%a7%d9%85%d9%87-%d9%81%d9%8a-%d8%a7%d9%86%d9%87%d9%8a%d8%a7%d8%b1-%d8%b3%d9%88%d8%b1-%d9%85%d8%aa%d9%87%d8%a7%d9%84%d9%83/', 'summary': 'مقتل راعٍ وأغنامه في انهيار سور متهالك لمؤسسة تعليمية في أزيلال. المساء اليوم – أزيلال: لقي راعي غنم مصرعه، صباح اليوم السبت، جراء انهيار جزء من سور ثانوية عمر بن عبد العزيز التأهيلية بجماعة تيموليلت بإقليم أزيلال. كما لقي نفس المصير قطيع من الغنم كان الهالك،', 'size': 2}], 'main_title': 'سور ثانوية ينهار على خمسيني وقطيعه بتيموليلت ويخلف مأساة صادمة'}, {'community_id': '5', 'articles': [{'id': '165', 'title': 'تلاميذ يشاركون في جهود لإعادة زملائهم المنقطعين إلى مقاعد الدراسة', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%aa%d9%84%d8%a7%d9%85%d9%8a%d8%b0-%d9%8a%d8%b4%d8%a7%d8%b1%d9%83%d9%88%d9%86-%d9%81%d9%8a-%d8%ac%d9%87%d9%88%d8%af-%d9%84%d8%a5%d8%b9%d8%a7%d8%af%d8%a9-%d8%b2%d9%85%d9%84%d8%a7%d8%a6%d9%87%d9%85/', 'summary': 'تلاميذ يشاركون في جهود لإعادة زملائهم المنقطعين إلى مقاعد الدراسة. يفتخر سعيد وضحى وهدى بنجاحهم في إقناع ثمانية تلاميذ بالعودة إلى الدراسة، في حملة لمكافحة الهدر المدرسي الذي يطال قرابة 280 ألف طفل سنويا في المغرب. يدرس التلاميذ الثلاثة في إعدادية جوهرة التي تستقبل أبناء الأرياف القريبة من مدينة تيفلت قرب الرباط. ويقول مدير المدرسة سعيد تموح إن بعض التلاميذ يعجز عن مواصلة الدراسة لأسباب  تلاميذ يشاركون في جهود لإعادة زملائهم المنقطعين إلى مقاعد الدراسة     .', 'size': 2}, {'id': '270', 'title': 'مبادرة تستعين بتلاميذ لإقناع "متسرّبين" بالعودة إلى مقاعد الدراسة بالمغرب', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d9%85%d8%a8%d8%a7%d8%af%d8%b1%d8%a9-%d8%aa%d8%b3%d8%aa%d8%b9%d9%8a%d9%86-%d8%a8%d8%aa%d9%84%d8%a7%d9%85%d9%8a%d8%b0-%d9%84%d8%a5%d9%82%d9%86%d8%a7%d8%b9-%d9%85%d8%aa%d8%b3%d8%b1%d9%91%d8%a8%d9%8a-1583758.html', 'summary': 'مبادرة تستعين بتلاميذ لإقناع "متسرّبين" بالعودة إلى مقاعد الدراسة بالمغرب. يفتخر سعيد وضحى وهدى بنجاحهم في إقناع ثمانية تلاميذ بالعودة إلى الدراسة، في حملة لمكافحة التسرّب المدرسي الذي يطال قرابة 280 ألف طفل سنويًّا في المغرب. يدرس التلاميذ الثلاثة في إعدادية جوهرة، التي تستقبل أبناء الأرياف القريبة من مدينة تيفلت في ضواحي الرباط. ويقول مدير المدرسة، سعيد تموح، إن بعض التلاميذ يعجزون عن مواصلة الدراسة  مبادرة تستعين بتلاميذ لإقناع "متسرّبين" بالعودة إلى مقاعد الدراسة بالمغرب     - هسبريس جريدة إلكترونية مغربية .', 'size': 2}], 'main_title': 'تلاميذ يشاركون في جهود لإعادة زملائهم المنقطعين إلى مقاعد الدراسة'}, {'community_id': '6', 'articles': [{'id': '166', 'title': 'تذاكر كأس أمم إفريقيا للسيدات متاحة للجمهور بأسعار تبدأ من 20 درهما', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%aa%d8%b0%d8%a7%d9%83%d8%b1-%d9%83%d8%a3%d8%b3-%d8%a3%d9%85%d9%85-%d8%a5%d9%81%d8%b1%d9%8a%d9%82%d9%8a%d8%a7-%d9%84%d9%84%d8%b3%d9%8a%d8%af%d8%a7%d8%aa-%d9%85%d8%aa%d8%a7%d8%ad%d8%a9-%d9%84%d9%84/', 'summary': 'تذاكر كأس أمم إفريقيا للسيدات متاحة للجمهور بأسعار تبدأ من 20 درهما. حددت الكونفدرالية الإفريقية لكرة القدم "الكاف"، يوم غد الأحد، موعدا لانطلاق عملية بيع تذاكر مباريات كأس أمم إفريقيا للسيدات"المغرب2024"، عبر منصة webook. ووفقا لبلاغ رسمي صادر عن "الكاف"، فإن المرحلة الأولى لعملية بيع التذاكر، كانت مخصصة حصريا لحاملي بطاقات الدفع "فيزا"، الشريك الرسمي للكونفدرالية الإفريقية منذ سنوات، والشريك الحصري لعمليات الدفع في عدد من المسابقات  تذاكر كأس أمم إفريقيا للسيدات متاحة للجمهور بأسعار تبدأ من 20 درهما     .', 'size': 2}, {'id': '398', 'title': 'انطلاق بيع تذاكر كأس إفريقيا للسيدات بالمغرب', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%86%d8%b7%d9%84%d8%a7%d9%82-%d8%a8%d9%8a%d8%b9-%d8%aa%d8%b0%d8%a7%d9%83%d8%b1-%d9%83%d8%a3%d8%b3-%d8%a5%d9%81%d8%b1%d9%8a%d9%82%d9%8a%d8%a7-%d9%84%d9%84%d8%b3%d9%8a%d8%af%d8%a7%d8%aa-%d8%a8/', 'summary': 'انطلاق بيع تذاكر كأس إفريقيا للسيدات بالمغرب. حددت الكونفدرالية الإفريقية لكرة القدم “الكاف”، يوم غد الأحد، موعدا لانطلاق عملية بيع تذاكر مباريات كأس أمم إفريقيا للسيدات”المغرب2024″، عبر منصة “webook”. ووفقا لبلاغ صادر عن “الكاف”، فإن المرحلة الأولى لعملية بيع التذاكر، كانت مخصصة حصريا لحاملي بطاقات الدفع “فيزا”، الشريك الرسمي للكونفدرالية الإفريقية منذ سنوات، والشريك الحصري لعمليات الدفع في عدد من المسابقات …  انطلاق بيع تذاكر كأس إفريقيا للسيدات بالمغرب     .', 'size': 2}], 'main_title': 'تذاكر كأس أمم إفريقيا للسيدات متاحة للجمهور بأسعار تبدأ من 20 درهما'}, {'community_id': '7', 'articles': [{'id': '169', 'title': 'توقعات أحوال الطقس لليوم السبت', 'source': 'soltana.ma', 'link': 'https://soltana.ma/1357481.html', 'summary': 'توقعات أحوال الطقس لليوم السبت. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم السبت، استمرار الطقس الحار إلى محليا جد حار بكل من السواحل والسهول الشمالية والوسطى ومناطق الأطلس الصغير، وأقصى الجنوب الشرقي للبلاد، وداخل الأقاليم الجنوبية. ويرتقب أيضا، تشكل خلايا رعدية ستعطي قطرات مطرية متفرقة أو زخات فوق كل من مناطق الأطلسين الكبير والمتوسط، وجنوب المنطقة الشرقية ومن المحتمل منطقة', 'size': 2}, {'id': '219', 'title': 'طقس السبت.. استمرار حرارة الجو مع قطرات مطرية في بعض المناطق', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/223617/', 'summary': 'طقس السبت.. استمرار حرارة الجو مع قطرات مطرية في بعض المناطق. كواليس اليوم تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليوم السبت، استمرار الطقس الحار إلى محليا جد حار بكل من السواحل والسهول الشمالية والوسطى ومناطق الأطلس الصغير، وأقصى الجنوب الشرقي للبلاد، وداخل الأقاليم الجنوبية. ويرتقب أيضا، تشكل خلايا رعدية ستعطي قطرات مطرية متفرقة أو زخات فوق كل من مناطق الأطلسين الكبير والمتوسط، وجنوب المنطقة الشرقية', 'size': 2}], 'main_title': 'توقعات أحوال الطقس لليوم السبت'}, {'community_id': '8', 'articles': [{'id': '214', 'title': 'أديس أبابا.. انطلاق الأطوار الإقصائية للدورة السادسة لمسابقة مؤسسة محمد السادس للعلماء الأفارقة', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/223643/', 'summary': 'أديس أبابا.. انطلاق الأطوار الإقصائية للدورة السادسة لمسابقة مؤسسة محمد السادس للعلماء الأفارقة. و م ع أعطيت، اليوم السبت بأديس أبابا، الانطلاقة الرسمية للأطوار الإقصائية للدورة السادسة لمسابقة مؤسسة محمد السادس للعلماء الأفارقة في حفظ وتلاوة وتجويد القرآن الكريم، بمبادرة من فرع المؤسسة في إثيوبيا. ويشارك في هذه الإقصائيات نحو ستين متسابقا من مختلف أنحاء البلاد، موزعين على أصناف المسابقة الثلاثة، ويتعلق الأمر بالحفظ الكامل مع الترتيل', 'size': 3}, {'id': '232', 'title': 'أديس أبابا.. انطلاق التصفيات الإقصائية للدورة 6 من مسابقة مؤسسة محمد السادس للعلماء الأفارقة في القرآن الكريم', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a3%d8%af%d9%8a%d8%b3-%d8%a3%d8%a8%d8%a7%d8%a8%d8%a7-%d8%a7%d9%86%d8%b7%d9%84%d8%a7%d9%82-%d8%a7%d9%84%d8%aa%d8%b5%d9%81%d9%8a%d8%a7%d8%aa-%d8%a7%d9%84%d8%a5%d9%82%d8%b5%d8%a7%d8%a6%d9%8a%d8%a9/', 'summary': 'أديس أبابا.. انطلاق التصفيات الإقصائية للدورة 6 من مسابقة مؤسسة محمد السادس للعلماء الأفارقة في القرآن الكريم. انطلقت اليوم السبت بالعاصمة الإثيوبية أديس أبابا، بشكل رسمي، التصفيات الإقصائية للدورة السادسة من مسابقة مؤسسة محمد السادس للعلماء الأفارقة في حفظ وتلاوة وتجويد القرآن الكريم، وذلك بمبادرة من فرع المؤسسة في إثيوبيا. وتعرف هذه الإقصائيات مشاركة نحو ستين متسابقا من مختلف أنحاء البلاد، موزعين على أصناف المسابقة الثلاثة، ويتعلق الأمر بالحفظ الكامل …  أديس أبابا.. انطلاق التصفيات الإقصائية للدورة 6 من مسابقة مؤسسة محمد السادس للعلماء الأفارقة في القرآن الكريم     .', 'size': 3}, {'id': '393', 'title': 'إثيوبيا: انطلاق مسابقة مؤسسة محمد السادس في حفظ وتجويد القرآن الكريم', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%a5%d8%ab%d9%8a%d9%88%d8%a8%d9%8a%d8%a7-%d8%a7%d9%86%d8%b7%d9%84%d8%a7%d9%82-%d9%85%d8%b3%d8%a7%d8%a8%d9%82%d8%a9-%d9%85%d8%a4%d8%b3%d8%b3%d8%a9-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7/', 'summary': 'إثيوبيا: انطلاق مسابقة مؤسسة محمد السادس في حفظ وتجويد القرآن الكريم. المساء اليوم: أعطيت بأديس أبابا، الانطلاقة الرسمية للأطوار الإقصائية للدورة السادسة لمسابقة مؤسسة محمد السادس للعلماء الأفارقة في حفظ وتلاوة وتجويد القرآن الكريم، بمبادرة من فرع المؤسسة في إثيوبيا. ويشارك في هذه الإقصائيات، التي انطلقت', 'size': 3}], 'main_title': 'أديس أبابا.. انطلاق الأطوار الإقصائية للدورة السادسة لمسابقة مؤسسة محمد السادس للعلماء الأفارقة'}, {'community_id': '10', 'articles': [{'id': '326', 'title': 'يشكلان موضوع أوامر دولية بإلقاء القبض صادرة عن السلطات القضائية لبلادهما.. توقيف مواطنين بريطانيين في أكادير', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%8a%d8%b4%d9%83%d9%84%d8%a7%d9%86-%d9%85%d9%88%d8%b6%d9%88%d8%b9-%d8%a3%d9%88%d8%a7%d9%85%d8%b1-%d8%af%d9%88%d9%84%d9%8a%d8%a9-%d8%a8%d8%a5%d9%84%d9%82%d8%a7%d8%a1-%d8%a7%d9%84%d9%82%d8%a8%d8%b6/', 'summary': 'يشكلان موضوع أوامر دولية بإلقاء القبض صادرة عن السلطات القضائية لبلادهما.. توقيف مواطنين بريطانيين في أكادير. تمكنت عناصر المصلحة الولائية للشرطة القضائية بمدينة أكادير، بناء على معلومات دقيقة وفرتها مصالح المديرية العامة لمراقبة التراب الوطني، زوال اليوم السبت (28 يونيو)، من توقيف مواطنين من جنسية بريطانية، يشكلان موضوع أوامر دولية بإلقاء القبض صادرة عن السلطات القضائية لبلادهما. وذكر مصدر أمني أنه تم توقيف المواطنين الأجنبيين خلال عملية أمنية بمنطقة “أنزا” بمدينة', 'size': 4}, {'id': '335', 'title': 'أكادير.. توقيف مواطنين من جنسية بريطانية يشكلان موضوع أوامر دولية', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/316864/', 'summary': 'أكادير.. توقيف مواطنين من جنسية بريطانية يشكلان موضوع أوامر دولية. تمكنت عناصر المصلحة الولائية للشرطة القضائية بمدينة أكادير بناء على معلومات دقيقة وفرتها مصالح المديرية العامة لمراقبة التراب الوطني، زوال اليوم السبت، من توقيف مواطنين من جنسية بريطانية، يشكلان موضوع أوامر دولية بإلقاء القبض صادرة عن السلطات القضائية لبلادهما. وذكر مصدر أمني أنه تم توقيف المواطنين الأجنبيين خلال عملية أمنية بمنطقة “أنزا” بمدينة أكادير، وذلك', 'size': 4}, {'id': '365', 'title': 'أكادير.. توقيف بريطانيين يشكلان موضوع أوامر دولية بإلقاء القبض', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/467868.html', 'summary': 'أكادير.. توقيف بريطانيين يشكلان موضوع أوامر دولية بإلقاء القبض. تمكنت عناصر المصلحة الولائية للشرطة القضائية بمدينة أكادير بناء على معلومات دقيقة وفرتها مصالح المديرية العامة لمراقبة التراب الوطني، زوال اليوم السبت، من توقيف مواطنين من جنسية بريطانية، يشكلان موضوع أوامر دولية بإلقاء القبض صادرة عن السلطات القضائية لبلادهما. وذكر مصدر أمني أنه تم توقيف المواطنين الأجنبيين خلال عملية أمنية بمنطقة “أنزا” بمدينة أكادير، وذلك …', 'size': 3}, {'id': '387', 'title': 'أكادير.. توقيف مواطنين بريطانيين مبحوث عنهما دوليا', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/223677/', 'summary': 'أكادير.. توقيف مواطنين بريطانيين مبحوث عنهما دوليا. كمال عسو اعتقلت عناصر المصلحة الولائية للشرطة القضائية بمدينة أكادير بناء على معلومات دقيقة وفرتها مصالح المديرية العامة لمراقبة التراب الوطني، زوال اليوم السبت، مواطنين من جنسية بريطانية، يشكلان موضوع أوامر دولية بإلقاء القبض صادرة عن السلطات القضائية لبلادهما. وأوضحت مصادر أمنية، أن توقيف المواطنين الأجنبيين جرى خلال عملية أمنية بمنطقة “أنزا” بمدينة أكادير،', 'size': 3}], 'main_title': 'يشكلان موضوع أوامر دولية بإلقاء القبض صادرة عن السلطات القضائية لبلادهما.. توقيف مواطنين بريطانيين في أكادير'}, {'community_id': '2', 'articles': [{'id': '328', 'title': 'دعا الأمم المتحدة ومجلس الأمن إلى متابعة هذا “الاعتداء الجبان”.. “الأحرار” يدين بشدة الهجوم الإرهابي على السمارة', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%af%d8%b9%d8%a7-%d8%a7%d9%84%d8%a3%d9%85%d9%85-%d8%a7%d9%84%d9%85%d8%aa%d8%ad%d8%af%d8%a9-%d9%88%d9%85%d8%ac%d9%84%d8%b3-%d8%a7%d9%84%d8%a3%d9%85%d9%86-%d8%a5%d9%84%d9%89-%d9%85%d8%aa%d8%a7%d8%a8/', 'summary': 'دعا الأمم المتحدة ومجلس الأمن إلى متابعة هذا “الاعتداء الجبان”.. “الأحرار” يدين بشدة الهجوم الإرهابي على السمارة. عبر حزب التجمع الوطني للأحرار عن استهجانه واستنكاره البالغ لـ”لاعتداء الجبان” لميليشيا جبهة البوليساريو، بواسطة مقذوفات تستهدف المدنيين بمدينة السمارة، المدينة الروحية للصحراء المغربية. وجدد حزب التجمع الوطني للأحرار، في بلاغ له، إدانته بأشد العبارات لهذا العمل الإرهابي، الذي يعبر عن حالة اليأس التي وصلت إليها الأطروحة الانفصالية لجبهة “البوليساريو” الوهمية، بسبب النجاحات المتتالية', 'size': 3}, {'id': '347', 'title': 'حزب الأحرار يدين بشدة الهجوم الإرهابي على مدينة السمارة', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1081573.html', 'summary': 'حزب الأحرار يدين بشدة الهجوم الإرهابي على مدينة السمارة. أكد حزب التجمع الوطني للأحرار أنه تابع “باستهجان كبير واستنكار بالغ” الاعتداء الذي وصفه بـ”الجبان” الذي قامت به ميليشيا جبهة البوليساريو، باستخدام مقذوفات استهدفت المدنيين في مدينة السمارة، المدينة الروحية للصحراء المغربية. وجدّد الحزب “إدانته بأشد العبارات لهذا العمل الإرهابي”، معتبرا أنه “يعبر عن حالة اليأس التي وصلت إليها الأطروحة الانفصالية لجبهة البوليساريو الوهمية، بسبب ظهرت المقالة حزب الأحرار يدين بشدة الهجوم الإرهابي على مدينة السمارة  .', 'size': 4}, {'id': '363', 'title': '“الأحرار” الحزب الوحيد الذي يدين الهجوم الإرهابي الجبان للبوليساريو على مدينة السمارة ويدعو إلى تدخل أممي', 'source': 'rue20.com', 'link': 'https://rue20.com/916472.html', 'summary': '“الأحرار” الحزب الوحيد الذي يدين الهجوم الإرهابي الجبان للبوليساريو على مدينة السمارة ويدعو إلى تدخل أممي.  الرباط أدان حزب التجمع الوطني للأحرار، بشدة، الهجوم الإرهابي الذي استهدف، ليلة الجمعة-السبت، مدينة السمارة بمقذوفات أطلقتها ميليشيا “البوليساريو” الانفصالية، في اعتداء وصفه بـ”الجبان” يستهدف المدنيين، ويعكس حالة اليأس التي باتت تعيشها الأطروحة الانفصالية. وقال بلاغ صادر عن الحزب إن التجمع الوطني للأحرار، يدين بأشد العبارات لهذا العمل الإرهابي الذي يعبر عن حالة اليأس الخبر “الأحرار” الحزب الوحيد الذي يدين الهجوم الإرهابي الجبان للبوليساريو على مدينة السمارة ويدعو إلى تدخل أممي  .', 'size': 2}, {'id': '395', 'title': 'التجمع الوطني للأحرار يدين بشدة الاعتداء الإرهابي لمليشيا البوليساريو الإرهابية على مدينة السمارة', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d8%aa%d8%ac%d9%85%d8%b9-%d8%a7%d9%84%d9%88%d8%b7%d9%86%d9%8a-%d9%84%d9%84%d8%a3%d8%ad%d8%b1%d8%a7%d8%b1-%d9%8a%d8%af%d9%8a%d9%86-%d8%a8%d8%b4%d8%af%d8%a9-%d8%a7%d9%84%d8%a7%d8%b9%d8%aa/', 'summary': 'التجمع الوطني للأحرار يدين بشدة الاعتداء الإرهابي لمليشيا البوليساريو الإرهابية على مدينة السمارة. استنكر حزب التجمع الوطني للأحرار “الاعتداء الجبان لميليشيا جبهة البوليساريو، بواسطة مقذوفات تستهدف المدنيين بمدينة السمارة، المدينة الروحية للصحراء المغربية”. وجدد الحزب في بلاغ توصل “” بنسخة منه، “إدانته بأشد العبارات لهذا العمل الإرهابي الذي يعبر عن حالة اليأس التي وصلت إليها الأطروحة الانفصالية لجبهة “البوليساريو” الوهمية، بسبب النجاحات المتتالية التاريخية التي حققتها …  التجمع الوطني للأحرار يدين بشدة الاعتداء الإرهابي لمليشيا البوليساريو الإرهابية على مدينة السمارة     .', 'size': 3}], 'main_title': 'حزب الأحرار يدين بشدة الهجوم الإرهابي على مدينة السمارة'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    