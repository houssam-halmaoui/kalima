<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 22/06/2025 - 12h24</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '4', 'articles': [{'id': '11', 'title': 'ترامب: قصفنا 3 منشآت نووية بإيران', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d8%aa%d8%b1%d8%a7%d9%85%d8%a8-%d9%82%d8%b5%d9%81%d9%86%d8%a7-3-%d9%85%d9%86%d8%b4%d8%a2%d8%aa-%d9%86%d9%88%d9%88%d9%8a%d8%a9-%d8%a8%d8%a5%d9%8a%d8%b1%d8%a7%d9%86-1580012.html', 'summary': 'ترامب: قصفنا 3 منشآت نووية بإيران. أعلن الرئيس الأمريكي دونالد ترامب السبت أن الجيش الأمريكي نفذ “هجوما ناجحا جدا” على ثلاثة مواقع نووية إيرانية، بينها منشأة فوردو لتخصيب اليورانيوم تحت الأرض. وقال ترامب في منشور على منصته “تروث سوشال”: “أتممنا هجومنا الناجح جدا على المواقع النووية الثلاثة في إيران، بما في ذلك فوردو ونطنز وأصفهان”. أضاف “أُسقطت حمولة كاملة من القنابل  ترامب: قصفنا 3 منشآت نووية بإيران     - هسبريس جريدة إلكترونية مغربية .', 'size': 2}, {'id': '336', 'title': 'غارات أمريكية مباغتة .. ترامب يعلن استهداف 3 منشآت نووية إيرانية', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-576373.html', 'summary': 'غارات أمريكية مباغتة .. ترامب يعلن استهداف 3 منشآت نووية إيرانية. أعلن الرئيس الأمريكي دونالد ترامب، الأحد، أن مقاتلات أمريكية نفذت “هجوما ناجحا للغاية” استهدف ثلاث منشآت نووية إيرانية، هي فوردو ونطنز وأصفهان، مؤكدا تدمير البنية التحتية لتلك المواقع بالكامل. وقال ترامب في منشور على منصته “تروث سوشال”، إن “حمولة كاملة من القنابل أسقطت على منشأة فوردو، الموقع الأساسي لبرنامج إيران النووي”، مشيرا', 'size': 2}], 'main_title': 'ترامب: قصفنا 3 منشآت نووية بإيران'}, {'community_id': '5', 'articles': [{'id': '13', 'title': 'ترامب: نفذنا هجوما ناحجا على فوردو ونطنز وأصفهان والطائرات عادت إلى قواعدها', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-633756.html', 'summary': 'ترامب: نفذنا هجوما ناحجا على فوردو ونطنز وأصفهان والطائرات عادت إلى قواعدها. هبة بريس أعلن الرئيس الأمريكي دونالد ترامب ، اليوم الأحد، أن الولايات المتحدة نفذت هجومًا ناجحًا استهدف ثلاث منشآت نووية إيرانية، وهي: فوردو، نطنز، وأصفهان. وأوضح ترامب، في تدوينة نشرها على منصته، أن "الطائرات الأمريكية نفذت العملية بنجاح وعادت إلى قواعدها سالمة"، مضيفًا: "نفذنا هجومًا ناجحًا للغاية على المواقع النووية الثلاثة".', 'size': 2}, {'id': '314', 'title': 'ترامب: الجيش الأمريكي دمر 3 منشآت نووية إيرانية بشكل كامل', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%aa%d8%b1%d8%a7%d9%85%d8%a8-%d8%a7%d9%84%d8%ac%d9%8a%d8%b4-%d8%a7%d9%84%d8%a3%d9%85%d8%b1%d9%8a%d9%83%d9%8a-%d8%af%d9%85%d8%b1-3-%d9%85%d9%86%d8%b4%d8%a2%d8%aa-%d9%86%d9%88%d9%88%d9%8a%d8%a9/', 'summary': 'ترامب: الجيش الأمريكي دمر 3 منشآت نووية إيرانية بشكل كامل. أعلن الرئيس الأمريكي دونالد ترامب، أن الجيش الأمريكي نفذ “هجوما ناجحا جدا” استهدف ثلاثة مواقع نووية إيرانية، من بينها منشأة فوردو لتخصيب اليورانيوم الواقعة تحت الأرض. وأكد ترامب أن الجيش الأمريكي دمر “بشكل تام وكامل” ثلاث منشآت نووية رئيسية في إيران، محذرا من ضربات أقسى “إذا لم تسع طهران إلى السلام، أو إذا قررت الرد”.', 'size': 2}, {'id': '356', 'title': 'ترامب يعلن عن هجوم على ثلاثة مواقع نووية إيرانية', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%aa%d8%b1%d8%a7%d9%85%d8%a8-%d9%8a%d8%b9%d9%84%d9%86-%d8%b9%d9%86-%d9%87%d8%ac%d9%88%d9%85-%d8%b9%d9%84%d9%89-%d8%ab%d9%84%d8%a7%d8%ab%d8%a9-%d9%85%d9%88%d8%a7%d9%82%d8%b9-%d9%86%d9%88%d9%88%d9%8a/', 'summary': 'ترامب يعلن عن هجوم على ثلاثة مواقع نووية إيرانية. أعلن الرئيس الأمريكي دونالد ترامب، في بيان صدر أمس السبت، أن الولايات المتحدة شنت هجوما على ثلاثة مواقع نووية إيرانية. وقال الرئيس الأمريكي: "لقد نفذنا هجوما ناجحا جدا على المواقع النووية الثلاثة في إيران، وهي فوردو، ونطنز وأصفهان"، موضحا أنه تم إلقاء شحنة من القنابل على الموقع الرئيسي، فوردو، جنوب طهران. وأضاف أن جميع الطائرات  ترامب يعلن عن هجوم على ثلاثة مواقع نووية إيرانية     .', 'size': 3}], 'main_title': 'ترامب يعلن عن هجوم على ثلاثة مواقع نووية إيرانية'}, {'community_id': '2', 'articles': [{'id': '63', 'title': 'زخات رعدية اليوم السبت وطقس حار من السبت إلى الأربعاء بعدد من مناطق المملكة', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/202348', 'summary': 'زخات رعدية اليوم السبت وطقس حار من السبت إلى الأربعاء بعدد من مناطق المملكة.  أفادت المديرية العامة للأرصاد الجوية بأنه من المرتقب تسجيل زخات رعدية مصحوبة بتساقط للبرد وهبات رياح اليوم السبت، وطقس حار من السبت إلى الأربعاء، بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة “برتقالي”، أن هذه الزخات الرعدية (من 15 إلى 25 ملم) ستهم عمالات وأقاليم كل من خريبكة وإفران', 'size': 5}, {'id': '92', 'title': 'نشرة إنذارية: زخات رعدية اليوم السبت وطقس حار من السبت إلى الأربعاء بعدد من مناطق المملكة', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/national/407958.html', 'summary': 'نشرة إنذارية: زخات رعدية اليوم السبت وطقس حار من السبت إلى الأربعاء بعدد من مناطق المملكة. أفادت المديرية العامة للأرصاد الجوية بأنه من المرتقب تسجيل زخات رعدية مصحوبة بتساقط للبرد وهبات رياح اليوم السبت، وطقس حار من السبت إلى الأربعاء، بعدد', 'size': 2}, {'id': '124', 'title': 'من السبت إلى الأربعاء.. زخات رعدية وطقس حار بعدد من مناطق المغرب', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%85%d9%86-%d8%a7%d9%84%d8%b3%d8%a8%d8%aa-%d8%a5%d9%84%d9%89-%d8%a7%d9%84%d8%a3%d8%b1%d8%a8%d8%b9%d8%a7%d8%a1-%d8%b2%d8%ae%d8%a7%d8%aa-%d8%b1%d8%b9%d8%af%d9%8a%d8%a9-%d9%88%d8%b7%d9%82%d8%b3/', 'summary': 'من السبت إلى الأربعاء.. زخات رعدية وطقس حار بعدد من مناطق المغرب. أفادت المديرية العامة للأرصاد الجوية بأنه من المرتقب تسجيل زخات رعدية مصحوبة بتساقط للبرد وهبات رياح اليوم السبت (21 يونيو)، وطقس حار من السبت إلى الأربعاء، بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة “برتقالي”، أن هذه الزخات الرعدية (من 15 إلى 25 ملم) ستهم عمالات وأقاليم كل من خريبكة وإفران', 'size': 2}, {'id': '178', 'title': 'نشرة إنذارية. زخات رعدية اليوم السبت وطقس حار من السبت إلى الأربعاء بهذه المدن', 'source': 'rue20.com', 'link': 'https://rue20.com/914755.html', 'summary': 'نشرة إنذارية. زخات رعدية اليوم السبت وطقس حار من السبت إلى الأربعاء بهذه المدن. . الرباط أفادت المديرية العامة للأرصاد الجوية بأنه من المرتقب تسجيل زخات رعدية مصحوبة بتساقط للبرد وهبات رياح اليوم السبت، وطقس حار من السبت إلى الأربعاء، بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة “برتقالي”، أن هذه الزخات الرعدية (من 15 إلى 25 ملم) ستهم عمالات وأقاليم كل من خريبكة الخبر نشرة إنذارية. زخات رعدية اليوم السبت وطقس حار من السبت إلى الأربعاء بهذه المدن  .', 'size': 2}, {'id': '190', 'title': 'نشرة إنذارية: زخات رعدية وطقس حار من السبت إلى الأربعاء', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/467178.html', 'summary': 'نشرة إنذارية: زخات رعدية وطقس حار من السبت إلى الأربعاء. أفادت المديرية العامة للأرصاد الجوية بأنه من المرتقب تسجيل زخات رعدية مصحوبة بتساقط للبرد وهبات رياح اليوم السبت، وطقس حار من السبت إلى الأربعاء، بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة “برتقالي”، أن هذه الزخات الرعدية (من 15 إلى 25 ملم) ستهم عمالات وأقاليم كل من خريبكة وإفران وخنيفرة والفقيه …', 'size': 2}], 'main_title': 'زخات رعدية اليوم السبت وطقس حار من السبت إلى الأربعاء بعدد من مناطق المملكة'}, {'community_id': '1', 'articles': [{'id': '72', 'title': 'كأس العالم للأندية 2025.. الترجي الرياضي التونس يفوز على لوس أنجلوس', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/sport/worldfoot/407936.html', 'summary': 'كأس العالم للأندية 2025.. الترجي الرياضي التونس يفوز على لوس أنجلوس. فاز الترجي الرياضي التونسي على لوس أنجلوس إف سي الأمريكي بنتيجة (1 - 0) في المباراة التي جمعتهما مساء أمس الجمعة على أرضية ملعب "ناشفيل"', 'size': 2}, {'id': '216', 'title': 'كأس العالم للأندية.. الترجي التونسي يحرز الفوز على نظيره لوس أنجلوس الأمريكي', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/223246/', 'summary': 'كأس العالم للأندية.. الترجي التونسي يحرز الفوز على نظيره لوس أنجلوس الأمريكي. كواليس اليوم أحرز الترجي الرياضي التونسي الفوز على نظيره لوس أنجلوس إف سي الأمريكي بنتيجة (1 – 0) في المباراة التي جمعتهما مساء أمس الجمعة على أرضية ملعب “ناشفيل” ، وذلك برسم الجولة الثانية بالمجموعة الرابعة من بطولة كأس العالم للأندية 2025 المقامة حاليا في الولايات المتحدة. وسجل الهدف الوحيد للفريق التونسي يوسف البلايلي', 'size': 2}], 'main_title': 'كأس العالم للأندية 2025.. الترجي الرياضي التونس يفوز على لوس أنجلوس'}, {'community_id': '0', 'articles': [{'id': '206', 'title': 'إسطنبول.. وكالة بيت مال القدس الشريف تعرض مبادراتها الإنسانية المتواصلة تجاه الفلسطينيين', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%a5%d8%b3%d8%b7%d9%86%d8%a8%d9%88%d9%84-%d9%88%d9%83%d8%a7%d9%84%d8%a9-%d8%a8%d9%8a%d8%aa-%d9%85%d8%a7%d9%84-%d8%a7%d9%84%d9%82%d8%af%d8%b3-%d8%a7%d9%84%d8%b4%d8%b1%d9%8a%d9%81-%d8%aa%d8%b9%d8%b1/', 'summary': 'إسطنبول.. وكالة بيت مال القدس الشريف تعرض مبادراتها الإنسانية المتواصلة تجاه الفلسطينيين.  – و م ع أحاطت وكالة بيت مال القدس الشريف، اليوم السبت بإسطنبول، مجلس وزراء خارجية منظمة التعاون الإسلامي الملتئم في دورته الحادية والخمسين، بالمبادرات الإنسانية المتواصلة للوكالة...  إسطنبول.. وكالة بيت مال القدس الشريف تعرض مبادراتها الإنسانية المتواصلة تجاه الفلسطينيين     .', 'size': 2}, {'id': '228', 'title': 'وكالة بيت مال القدس تحيط وزراء خارجية منظمة التعاون الإسلامي بمبادراتها الإنسانية المتواصلة تجاه الفلسطينيين', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%88%d9%83%d8%a7%d9%84%d8%a9-%d8%a8%d9%8a%d8%aa-%d9%85%d8%a7%d9%84-%d8%a7%d9%84%d9%82%d8%af%d8%b3-%d8%aa%d8%ad%d9%8a%d8%b7-%d9%88%d8%b2%d8%b1%d8%a7%d8%a1-%d8%ae%d8%a7%d8%b1%d8%ac%d9%8a%d8%a9-%d9%85/', 'summary': 'وكالة بيت مال القدس تحيط وزراء خارجية منظمة التعاون الإسلامي بمبادراتها الإنسانية المتواصلة تجاه الفلسطينيين. أحاطت وكالة بيت مال القدس الشريف، اليوم السبت بإسطنبول، مجلس وزراء خارجية منظمة التعاون الإسلامي الملتئم في دورته الحادية والخمسين، بالمبادرات الإنسانية المتواصلة للوكالة تجاه الفلسطينيين في القدس وغزة. وجاء في وثيقة وزعتها الوكالة على رؤساء الوفود وممثلي المنظمات المشاركة في الاجتماع المنعقد على مدى يومين (21-22 يونيو)، أن الوكالة، التابعة للجنة القدس …  وكالة بيت مال القدس تحيط وزراء خارجية منظمة التعاون الإسلامي بمبادراتها الإنسانية المتواصلة تجاه الفلسطينيين     .', 'size': 2}], 'main_title': 'إسطنبول.. وكالة بيت مال القدس الشريف تعرض مبادراتها الإنسانية المتواصلة تجاه الفلسطينيين'}, {'community_id': '3', 'articles': [{'id': '327', 'title': 'احتجاز الصحراويين في تندوف.. تقرير يفضح الانتهاكات ويدعو إلى تدخل دولي', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/316220/', 'summary': 'احتجاز الصحراويين في تندوف.. تقرير يفضح الانتهاكات ويدعو إلى تدخل دولي. في تقرير حاد اللهجة، حمل تحالف المنظمات غير الحكومية الصحراوية الدولة الجزائرية وتنظيم البوليساريو مسؤولية تدهور الأوضاع الإنسانية والحقوقية لآلاف الصحراويين المحتجزين بمخيمات تندوف، جنوب غرب الجزائر، وذلك تزامنا مع اليوم العالمي للاجئين. التحالف وصف المخيمات بـ”مناطق معزولة تعاني من انتهاك شبه تام لكرامة الإنسان”، وسط ظروف قال إنها “شديدة القساوة”، و”قبضة أمنية مشددة”', 'size': 2}, {'id': '347', 'title': 'تحالف يتهم الجزائر بـ”احتجاز” آلاف الصحراويين في تندوف وانتهاك حقوقهم', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1079494.html', 'summary': 'تحالف يتهم الجزائر بـ”احتجاز” آلاف الصحراويين في تندوف وانتهاك حقوقهم. سجل تحالف المنظمات غير الحكومية الصحراوية بمناسبة اليوم العالمي للاجئين، استمرار احتجاز آلاف الصحراويين بمخيمات تندوف جنوب غربي الجزائر، في ظروف وصفها بـ”شديدة القساوة” وانتهاكات لحقوق الإنسان، مشيرا إلى “شبه تغييب كامل لحماية الكرامة الإنسانية والحق في الحياة والسلامة الجسدية”، واشتداد القبضة الأمنية لأجهزة الأمن الجزائري وعناصر تابعة لتنظيم البوليساريو الانفصالي. وأعرب التحالف في بيان ظهرت المقالة تحالف يتهم الجزائر بـ”احتجاز” آلاف الصحراويين في تندوف وانتهاك حقوقهم  .', 'size': 2}], 'main_title': 'احتجاز الصحراويين في تندوف.. تقرير يفضح الانتهاكات ويدعو إلى تدخل دولي'}, {'community_id': '6', 'articles': [{'id': '334', 'title': 'توقعات أحوال الطقس ليوم الأحد بالمغرب', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-576356.html', 'summary': 'توقعات أحوال الطقس ليوم الأحد بالمغرب. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليوم الأحد، استمرار موجة الحر بكل من السايس وواد ملوية وسهول تادلة والرحامنة والجنوب الشرقي للبلاد وداخل الأقاليم الجنوبية للمملكة. كما سيلاحظ تشكل كتل ضبابية وسحب منخفضة بالسهول والسواحل الشمالية والوسطى للمحيط الأطلسي وغرب الأقاليم الصحراوية للمملكة. ويرتقب تمركز سحب غير مستقرة مرفوقة بقطرات', 'size': 3}, {'id': '358', 'title': 'استمرار موجة الحرارة اليوم الأحد', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a7%d8%b3%d8%aa%d9%85%d8%b1%d8%a7%d8%b1-%d9%85%d9%88%d8%ac%d8%a9-%d8%a7%d9%84%d8%ad%d8%b1%d8%a7%d8%b1%d8%a9-%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%a3%d8%ad%d8%af/', 'summary': 'استمرار موجة الحرارة اليوم الأحد. تتوقع المديرية العامة للأرصاد الجوية، اليوم الأحد، استمرار موجة الحر بكل من السايس وواد ملوية وسهول تادلة والرحامنة والجنوب الشرقي للبلاد وداخل الأقاليم الجنوبية للمملكة. كما سيلاحظ تشكل كتل ضبابية وسحب منخفضة بالسهول والسواحل الشمالية والوسطى للمحيط الأطلسي وغرب الأقاليم الصحراوية للمملكة. ويرتقب تمركز سحب غير مستقرة مرفوقة بقطرات مطرية رعدية أو زخات رعدية فوق  استمرار موجة الحرارة اليوم الأحد     .', 'size': 3}, {'id': '376', 'title': 'توقعات أحوال الطقس اليوم الأحد', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%aa%d9%88%d9%82%d8%b9%d8%a7%d8%aa-%d8%a3%d8%ad%d9%88%d8%a7%d9%84-%d8%a7%d9%84%d8%b7%d9%82%d8%b3-%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%a3%d8%ad%d8%af-38/', 'summary': 'توقعات أحوال الطقس اليوم الأحد. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليومه الأحد، استمرار موجة الحر بكل من السايس وواد ملوية وسهول تادلة والرحامنة والجنوب الشرقي للبلاد وداخل الأقاليم الجنوبية للمملكة. كما سيلاحظ تشكل كتل ضبابية وسحب منخفضة بالسهول والسواحل الشمالية والوسطى للمحيط الأطلسي وغرب الأقاليم الصحراوية للمملكة. ويرتقب تمركز سحب غير مستقرة مرفوقة بقطرات مطرية رعدية أو …  توقعات أحوال الطقس اليوم الأحد     .', 'size': 3}], 'main_title': 'توقعات أحوال الطقس ليوم الأحد بالمغرب'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    