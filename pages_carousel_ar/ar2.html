<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 22/07/2025 - 06h28</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '35', 'title': 'طاطا.. إحباط محاولة تهريب دولي للمخدرات وحجز ما يقارب 600 كلغ من الشيرا', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-642466.html', 'summary': 'طاطا.. إحباط محاولة تهريب دولي للمخدرات وحجز ما يقارب 600 كلغ من الشيرا. هبة بريس تمكنت عناصر الشرطة بالمنطقة الإقليمية للأمن بمدينة طاطا، خلال الساعات الأولى من صباح اليوم الاثنين 21 يوليوز الجاري، من إحباط محاولة للتهريب الدولي للمخدرات وحجز 598 كيلوغراما و 500 غراما من مخدر الشيرا. وقد تم تنفيذ هذه العملية الأمنية بتنسيق مع عناصر الدرك الملكي بالمنطقة القروية "فم الحصن"، التي تبعد بحوالي 120 كيلومترا عن مدينة طاطا، وأسفرت عن حجز 20 رزمة من مخدر الشيرا بلغ مجموع وزنها 598 كيلوغراما و500 غراما، والتي تم اكتشافها مخبأة في منطقة صخرية في انتظار عملية تهريبها. وقد فتحت مصالح الشرطة القضائية بمدينة طاطا بحثا قضائيا تحت إشراف النيابة العامة المختصة، وذلك للكشف عن جميع ظروف وملابسات وخلفيات هذه القضية، وكذا توقيف جميع المتورطين في الشبكة الإجرامية الضالعة في هذه العملية. وتندرج هذه العملية الأمنية في سياق المجهودات المكثفة والمتواصلة التي تبذلها مصالح المديرية العامة للأمن الوطني، لمكافحة التهريب الدولي للمخدرات والمؤثرات العقلية.', 'size': 2}, {'id': '134', 'title': 'إحباط محاولة تهريب دولي للمخدرات بطاطا', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/318899/', 'summary': 'إحباط محاولة تهريب دولي للمخدرات بطاطا. تمكنت عناصر الشرطة بالمنطقة الإقليمية للأمن بمدينة طاطا، خلال الساعات الأولى من صباح اليوم الاثنين 21 يوليوز الجاري، من إحباط محاولة للتهريب الدولي للمخدرات وحجز 598 كيلوغراما و 500 غراما من مخدر الشيرا. وقد تم تنفيذ هذه العملية الأمنية بتنسيق مع عناصر الدرك الملكي بالمنطقة القروية “فم الحصن”، التي تبعد بحوالي 120 كيلومترا عن', 'size': 3}, {'id': '221', 'title': 'طاطا.. إحباط محاولة للتهريب الدولي للمخدرات وحجز 598 كيلوغراما و 500 غراما من الشيرا', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/224993/', 'summary': 'طاطا.. إحباط محاولة للتهريب الدولي للمخدرات وحجز 598 كيلوغراما و 500 غراما من الشيرا. تمكنت عناصر الشرطة بالمنطقة الإقليمية للأمن بمدينة طاطا، خلال الساعات الأولى من صباح اليوم الاثنين 21 يوليوز الجاري، من إحباط محاولة للتهريب الدولي للمخدرات وحجز 598 كيلوغراما و 500 غراما من مخدر الشيرا. وقد تم تنفيذ هذه العملية الأمنية بتنسيق مع عناصر الدرك الملكي بالمنطقة القروية “فم الحصن”، التي تبعد بحوالي 120 كيلومترا عن مدينة', 'size': 2}], 'main_title': 'إحباط محاولة تهريب دولي للمخدرات بطاطا'}, {'community_id': '1', 'articles': [{'id': '84', 'title': 'كوكايين أمريكا الجنوبية يسقط في قبضة الأمن المغربي بميناء طنجة المتوسط', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/409664.html', 'summary': 'كوكايين أمريكا الجنوبية يسقط في قبضة الأمن المغربي بميناء طنجة المتوسط. تمكنت عناصر الشرطة بمنطقة أمن ميناء طنجة المتوسط، يوم الأحد 20 يوليوز الجاري، من إجهاض عملية للتهريب الدولي لشحنة بلغ مجموع وزنها 25 كيلوغراما من', 'size': 2}, {'id': '228', 'title': 'ميناء طنجة المتوسط: إجهاض عملية للتهريب الدولي لشحنة وزنها 25 كيلوغراما من الكوكايين الخام', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/224974/', 'summary': 'ميناء طنجة المتوسط: إجهاض عملية للتهريب الدولي لشحنة وزنها 25 كيلوغراما من الكوكايين الخام. تمكنت عناصر الشرطة بمنطقة أمن ميناء طنجة المتوسط، يوم الأحد 20 يوليوز الجاري، من إجهاض عملية للتهريب الدولي لشحنة بلغ مجموع وزنها 25 كيلوغراما من مخدر الكوكايين الخام، جرى حجزها على متن حاوية للنقل الدولي للبضائع. وكانت عملية المراقبة الأمنية التي أخضعت لها هذه الحاوية القادمة من أحد موانئ أمريكا الجنوبية والمتوجهة إلى ميناء هولندي،', 'size': 2}], 'main_title': 'كوكايين أمريكا الجنوبية يسقط في قبضة الأمن المغربي بميناء طنجة المتوسط'}, {'community_id': '2', 'articles': [{'id': '105', 'title': 'الأمن يضع يده على "صيد ثمين" بطاطا', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/409687.html', 'summary': 'الأمن يضع يده على "صيد ثمين" بطاطا. تمكنت عناصر الشرطة بالمنطقة الإقليمية للأمن بمدينة طاطا، خلال الساعات الأولى من صباح اليوم الاثنين 21 يوليوز الجاري، من إحباط محاولة للتهريب الدولي للمخدرات وحجز', 'size': 2}, {'id': '250', 'title': 'إحباط محاولة للتهريب الدولي للمخدرات بمدينة طاطا', 'source': 'www.alalam.ma', 'link': 'https://www.alalam.ma/إحباط-محاولة-للتهريب-الدولي-للمخدرات-بمدينة-طاطا_a28803.html', 'summary': 'إحباط محاولة للتهريب الدولي للمخدرات بمدينة طاطا. *العلم الإلكترونية* تمكنت عناصر الشرطة بالمنطقة الإقليمية للأمن بمدينة طاطا، خلال الساعات الأول...', 'size': 2}], 'main_title': 'الأمن يضع يده على "صيد ثمين" بطاطا'}, {'community_id': '3', 'articles': [{'id': '121', 'title': 'جلالة الملك يهنئ عاهلي بلجيكا بمناسبة العيد الوطني لبلدهما', 'source': 'assabah.ma', 'link': 'https://assabah.ma/860769.html', 'summary': 'جلالة الملك يهنئ عاهلي بلجيكا بمناسبة العيد الوطني لبلدهما. بعث صاحب الجلالة الملك محمد السادس برقية تهنئة إلى عاهلي مملكة بلجيكا، صاحب الجلالة الملك فيليب وصاحبة الجلالة الملكة ماتيلد، وذلك بمناسبة احتفال بلادهما بعيدها الوطني. وقال جلالة الملك، في هذه البرقية “يطيب لي، ومملكة بلجيكا تحتفل بعيدها الوطني، أن أبعث إليكم بأحر تهانئي، مقرونة بمتمنياتي الصادقةأكمل القراءة » المقالة جلالة الملك يهنئ عاهلي بلجيكا بمناسبة العيد الوطني لبلدهما  .', 'size': 2}, {'id': '241', 'title': 'الملك محمد السادس يهنئ عاهلي بلجيكا بمناسبة العيد الوطني لبلدهما', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7%d8%af%d8%b3-%d9%8a%d9%87%d9%86%d8%a6-%d8%b9%d8%a7%d9%87%d9%84%d9%8a-%d8%a8%d9%84%d8%ac%d9%8a%d9%83%d8%a7-%d8%a8%d9%85-3/', 'summary': 'الملك محمد السادس يهنئ عاهلي بلجيكا بمناسبة العيد الوطني لبلدهما. بعث الملك محمد السادس، برقية تهنئة إلى عاهلي مملكة بلجيكا، الملك فيليب والملكة ماتيلد، وذلك بمناسبة احتفال بلادهما بعيدها الوطني. وقال الملك محمد السادس، في هذه البرقية “يطيب لي، ومملكة بلجيكا تحتفل بعيدها الوطني، أن أبعث إليكم بأحر تهانئي، مقرونة بمتمنياتي الصادقة لكم ولكافة أفراد أسرتكم بدوام الصحة والهناء، وللشعب البلجيكي باطراد الرقي …  الملك محمد السادس يهنئ عاهلي بلجيكا بمناسبة العيد الوطني لبلدهما     .', 'size': 2}], 'main_title': 'جلالة الملك يهنئ عاهلي بلجيكا بمناسبة العيد الوطني لبلدهما'}, {'community_id': '4', 'articles': [{'id': '131', 'title': 'البنك الإفريقي للتنمية يمول برامج فلاحية في المغرب', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/318907/', 'summary': 'البنك الإفريقي للتنمية يمول برامج فلاحية في المغرب. وافق مجلس إدارة مجموعة البنك الإفريقي للتنمية على تمويل قدره 100 مليون أورو للمغرب من أجل تنفيذ برامج دعم الفلاحة التضامنية الشاملة للنساء والشباب. وأوضح البنك، في بيان، أن هذا المشروع يهدف إلى خلق فرص مستدامة للنساء والشباب، وتعزيز الأمن الغدائي، وتحسين إعداد الزراعة المغربية الصغيرة لمواجهة تحديات تغير المناخ. كما سيمكن هذا المشروع، بحسب', 'size': 3}, {'id': '143', 'title': '“البنك الأفريقي” يقرض المغرب 116 مليون دولار لدعم الفلاحة التضامنية', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-581328.html', 'summary': '“البنك الأفريقي” يقرض المغرب 116 مليون دولار لدعم الفلاحة التضامنية. وافق مجلس إدارة مجموعة البنك الإفريقي للتنمية على تخصيص تمويل بقيمة 100 مليون أورو للمغرب لدعم تنفيذ برامج الفلاحة التضامنية الشاملة التي تستهدف النساء والشباب. وأوضح البنك في بيان أن هذا التمويل يهدف إلى خلق فرص مستدامة للنساء والشباب وتعزيز الأمن الغذائي وتحسين قدرة الزراعة الصغيرة في المغرب على مواجهة تحديات', 'size': 2}, {'id': '210', 'title': 'تمويل جديد بقيمة 100 مليون أورو لدعم برامج الفلاحة التضامنية الشاملة', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%aa%d9%85%d9%88%d9%8a%d9%84-%d8%ac%d8%af%d9%8a%d8%af-%d8%a8%d9%82%d9%8a%d9%85%d8%a9-100-%d9%85%d9%84%d9%8a%d9%88%d9%86-%d8%a3%d9%88%d8%b1%d9%88-%d9%84%d8%af%d8%b9%d9%85-%d8%a8%d8%b1%d8%a7%d9%85/', 'summary': 'تمويل جديد بقيمة 100 مليون أورو لدعم برامج الفلاحة التضامنية الشاملة. وافق مجلس إدارة مجموعة البنك الإفريقي للتنمية على تمويل قدره 100 مليون أورو للمغرب من أجل تنفيذ برامج دعم الفلاحة التضامنية الشاملة للنساء والشباب.  تمويل جديد بقيمة 100 مليون أورو لدعم برامج الفلاحة التضامنية الشاملة     .', 'size': 2}], 'main_title': 'البنك الإفريقي للتنمية يمول برامج فلاحية في المغرب'}, {'community_id': '5', 'articles': [{'id': '137', 'title': 'مقدونيا الشمالية تعتبر مخطط الحكم الذاتي الأساس الوحيد لتسوية النزاع حول الصحراء', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/318891/', 'summary': 'مقدونيا الشمالية تعتبر مخطط الحكم الذاتي الأساس الوحيد لتسوية النزاع حول الصحراء. أكدت جمهورية مقدونيا الشمالية أنها “تعتبر مخطط الحكم الذاتي الذي تقدم به المغرب في 2007 ، الأساس الوحيد لتسوية هذا النزاع”. هذا الموقف تم التعبير عنه في الإعلان المشترك، الموقع من قبل وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج ناصر بوريطة ووزير الشؤون الخارجية والتجارة الخارجية لجمهورية مقدونيا الشمالية تيمتشو موتسونسكي، وذلك قي أعقاب', 'size': 2}, {'id': '225', 'title': 'جمهورية مقدونيا الشمالية: الحكم الذاتي هو الأساس الوحيد لتسوية نزاع الصحراء', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/224982/', 'summary': 'جمهورية مقدونيا الشمالية: الحكم الذاتي هو الأساس الوحيد لتسوية نزاع الصحراء. أكدت جمهورية مقدونيا الشمالية أنها “تعتبر مخطط الحكم الذاتي الذي تقدم به المغرب في 2007 ، الأساس الوحيد لتسوية هذا النزاع”. هذا الموقف تم التعبير عنه في الإعلان المشترك، الموقع من قبل وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج ناصر بوريطة ووزير الشؤون الخارجية والتجارة الخارجية لجمهورية مقدونيا الشمالية تيمتشو موتسونسكي، وذلك قي أعقاب', 'size': 2}], 'main_title': 'مقدونيا الشمالية تعتبر مخطط الحكم الذاتي الأساس الوحيد لتسوية النزاع حول الصحراء'}, {'community_id': '6', 'articles': [{'id': '170', 'title': '543 تعيينا جديدا ابتداء من شتنبر.. وزارة الصحة تُفعّل أكبر حركة لتوزيع الأطر الطبية نحو المناطق النائية', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/543-%d8%aa%d8%b9%d9%8a%d9%8a%d9%86%d8%a7-%d8%ac%d8%af%d9%8a%d8%af%d8%a7-%d8%a7%d8%a8%d8%aa%d8%af%d8%a7%d8%a1-%d9%85%d9%86-%d8%b4%d8%aa%d9%86%d8%a8%d8%b1-%d9%88%d8%b2%d8%a7%d8%b1%d8%a9-%d8%a7%d9%84/', 'summary': '543 تعيينا جديدا ابتداء من شتنبر.. وزارة الصحة تُفعّل أكبر حركة لتوزيع الأطر الطبية نحو المناطق النائية. أعلنت وزارة الصحة والحماية الاجتماعية عن تعيينات جديدة واسعة وغير مسبوقة في صفوف الأطر الطبية، في خطوة ترمي إلى تقليص الخصاص الكبير في الكفاءات الصحية، خاصة في المناطق القروية والنائية التي ظلت تعاني من تهميش مزمن على مستوى الخدمات الصحية. وأكد وزير الصحة، أمين التهراوي، خلال جلسة الأسئلة الشفوية بمجلس النواب، الاثنين، أن هذه التعيينات  543 تعيينا جديدا ابتداء من شتنبر.. وزارة الصحة تُفعّل أكبر حركة لتوزيع الأطر الطبية نحو المناطق النائية     .', 'size': 2}, {'id': '345', 'title': 'بينها 5 مستشفيات جامعية جديدة.. التهراوي يكشف تفاصيل مشاريع كبرى لتأهيل القطاع الصحي في أفق 2030', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a8%d9%8a%d9%86%d9%87%d8%a7-5-%d9%85%d8%b3%d8%aa%d8%b4%d9%81%d9%8a%d8%a7%d8%aa-%d8%ac%d8%a7%d9%85%d8%b9%d9%8a%d8%a9-%d8%ac%d8%af%d9%8a%d8%af%d8%a9-%d8%a7%d9%84%d8%aa%d9%87%d8%b1%d8%a7%d9%88%d9%8a/', 'summary': 'بينها 5 مستشفيات جامعية جديدة.. التهراوي يكشف تفاصيل مشاريع كبرى لتأهيل القطاع الصحي في أفق 2030. كشف أمين التهراوي، وزير الصحة والحماية الاجتماعية، عن مشاريع كبرى لتأهيل وتطوير المستشفيات العمومية بحلول 2030. وفي مداخلته خلال جلسة الأسئلة الشفوية بمجلس النواب، اليوم الاثنين (21 يوليوز)، أكد التهراوي، أن وزارة الصحة تعمل على “تنفيذ سياسة استثمارية طموحة تروم تعزيز العرض الاستشفائي وتوسيع التغطية المجالية وتحسين جودة الرعاية الصحية”. وأوضح المسؤول الحكومي، عن قطاع', 'size': 2}], 'main_title': '543 تعيينا جديدا ابتداء من شتنبر.. وزارة الصحة تُفعّل أكبر حركة لتوزيع الأطر الطبية نحو المناطق النائية'}, {'community_id': '7', 'articles': [{'id': '172', 'title': 'الحكومة تتحرك ضد استغلال الأطفال والمسنين في المحتوى الرقمي', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a7%d9%84%d8%ad%d9%83%d9%88%d9%85%d8%a9-%d8%aa%d8%aa%d8%ad%d8%b1%d9%83-%d8%b6%d8%af-%d8%a7%d8%b3%d8%aa%d8%ba%d9%84%d8%a7%d9%84-%d8%a7%d9%84%d8%a3%d8%b7%d9%81%d8%a7%d9%84-%d9%88%d8%a7%d9%84%d9%85/', 'summary': 'الحكومة تتحرك ضد استغلال الأطفال والمسنين في المحتوى الرقمي. كشف محمد المهدي بنسعيد، وزير الثقافة والشباب والاتصال، أن الحكومة بصدد إعداد مشروع قانون جديد يؤطر الممارسات الرقمية بصفة عامة، ويتصدى لاستغلال الأطفال والمسنين في المحتوى الرقمي. وقال الوزير، في جوابه عن سؤال شفهي تقدم به الفريق الاشتراكي ـ المعارضة الاتحادية خلال جلسة الأسئلة الشفوية بمجلس النواب اليوم الاثنين، "إن هذا الموضوع يهم جميع المؤسسات  الحكومة تتحرك ضد استغلال الأطفال والمسنين في المحتوى الرقمي     .', 'size': 3}, {'id': '184', 'title': 'الحكومة تكشف عن مشروع قانون لضبط “فوضى التواصل الإجتماعي”', 'source': 'rue20.com', 'link': 'https://rue20.com/922316.html', 'summary': 'الحكومة تكشف عن مشروع قانون لضبط “فوضى التواصل الإجتماعي”.  | الرباط أعلن محمد المهدي بنسعيد، وزير الشباب والثقافة والتواصل، عن إعداد الحكومة لمشروع قانون يهدف إلى تنظيم وضبط المحتوى الرقمي على الإنترنت. جاء ذلك في ردّه على سؤال يتعلق باستغلال الأطفال والمسنين في صناعة المحتوى الرقمي، وهو ما بات يشكل ظاهرة مثيرة للقلق في المجتمع. وأكد الوزير بنسعيد أن وزارته تقوم بحملات الخبر الحكومة تكشف عن مشروع قانون لضبط “فوضى التواصل الإجتماعي”  .', 'size': 3}, {'id': '372', 'title': 'بنسعيد يتشبث بـ”الاقتراع الفردي” في مجلس الصحافة ويرفض تعديلات “اللائحة”', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1087196.html', 'summary': 'بنسعيد يتشبث بـ”الاقتراع الفردي” في مجلس الصحافة ويرفض تعديلات “اللائحة”. رفض وزير الشباب والثقافة والتواصل، محمد المهدي بنسعيد، مساء اليوم الاثنين 21 يوليوز 2025، كل التعديلات التي تقدمت به فرق ومجموعة المعارضة على المادة 22 من مشروع قانون إعادة تنظيم المجلس الوطني للصحافة، مدافعا عن الإبقاء على نمط الاقتراع السري الاسمي وبالأغلبية النسبية في دورة واحدة. وخلال اجتماع لجنة التعليم والثقافة والاتصال بمجلس النواب، للبت ظهرت المقالة بنسعيد يتشبث بـ”الاقتراع الفردي” في مجلس الصحافة ويرفض تعديلات “اللائحة”  .', 'size': 3}], 'main_title': 'الحكومة تتحرك ضد استغلال الأطفال والمسنين في المحتوى الرقمي'}, {'community_id': '8', 'articles': [{'id': '180', 'title': 'بعد 30 اجتماعًا ماراطونيًا.. الحكومة تُطلق خطة ثورية لخفض أسعار الأدوية', 'source': 'rue20.com', 'link': 'https://rue20.com/922345.html', 'summary': 'بعد 30 اجتماعًا ماراطونيًا.. الحكومة تُطلق خطة ثورية لخفض أسعار الأدوية.  | الرباط أكد وزير الصحة والحماية الاجتماعية، أمين التهراوي، أن وزارته عقدت أكثر من 30 اجتماعا خلال الاشهر الماضية مع كافة الفاعلين المعنيين في صناعة واستيراد الأدوية. وذكر التهراوي، خلال جلسة الأسئلة الشفهية بمجلس النواب يوم الاثنين، أن الأمر يتعلق بالفيدراليات الصناعية ، هيئات الصيادلة، و هيئات التأمين. و أوضح وزير الصحة أنه الخبر بعد 30 اجتماعًا ماراطونيًا.. الحكومة تُطلق خطة ثورية لخفض أسعار الأدوية  .', 'size': 2}, {'id': '249', 'title': 'وزير الصحة يكشف عن مشاريع كبرى لتأهيل المستشفيات العمومية بحلول 2030', 'source': 'www.alalam.ma', 'link': 'https://www.alalam.ma/وزير-الصحة-يكشف-عن-مشاريع-كبرى-لتأهيل-المستشفيات-العمومية-بحلول_a28804.html', 'summary': 'وزير الصحة يكشف عن مشاريع كبرى لتأهيل المستشفيات العمومية بحلول 2030. *العلم الإلكترونية* قال وزير الصحة والحماية الاجتماعية السيد أمين التهراوي إن الوزارة تواص...', 'size': 2}, {'id': '396', 'title': 'التهراوي يقلب أدوار وزارة الصحة: تغييرات جذرية في الطريق لتوزيع الصلاحيات وتعزيز التنسيق', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a7%d9%84%d8%aa%d9%87%d8%b1%d8%a7%d9%88%d9%8a-%d9%8a%d9%82%d9%84%d8%a8-%d8%a3%d8%af%d9%88%d8%a7%d8%b1-%d9%88%d8%b2%d8%a7%d8%b1%d8%a9-%d8%a7%d9%84%d8%b5%d8%ad%d8%a9-%d8%aa%d8%ba%d9%8a%d9%8a%d8%b1/', 'summary': 'التهراوي يقلب أدوار وزارة الصحة: تغييرات جذرية في الطريق لتوزيع الصلاحيات وتعزيز التنسيق. كشف وزير الصحة والحماية الاجتماعية، أمين التهراوي، أن وزارته بصدد إجراء تعديل جذري في هيكلها الإداري والتنظيمي، لأول مرة منذ أكثر من ثلاثة عقود، بهدف إعادة تعريف أدوارها وصلاحياتها في ضوء التحولات الكبرى التي يشهدها القطاع الصحي بالمملكة. وقال الوزير، خلال جلسة الأسئلة الشفهية بمجلس النواب، الاثنين، إن الهيكلة الحالية تعود إلى سنة 1994، باستثناء  التهراوي يقلب أدوار وزارة الصحة: تغييرات جذرية في الطريق لتوزيع الصلاحيات وتعزيز التنسيق     .', 'size': 3}, {'id': '406', 'title': 'إطلاق برنامج وطني لإعادة تأهيل عشرات المسشفيات', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/470188.html', 'summary': 'إطلاق برنامج وطني لإعادة تأهيل عشرات المسشفيات. قال وزير الصحة والحماية الاجتماعية، أمين التهراوي، اليوم الاثنين، إن وزارته تواصل تنفيذ سياسة استثمارية طموحة تستهدف تطوير وتأهيل المؤسسات الاستشفائية في القطاع العمومي، بهدف تعزيز العرض الصحي. وحيال ذلك، أعلن الوزير عن إطلاق برنامج وطني لإعادة تأهيل 83 مستشفى بسعة تصل إلى 8700 سرير، منها 1729 سريرا مبرمجة لدخول الخدمة سنة 2025، و2056 سريرا …', 'size': 3}], 'main_title': 'التهراوي يقلب أدوار وزارة الصحة: تغييرات جذرية في الطريق لتوزيع الصلاحيات وتعزيز التنسيق'}, {'community_id': '9', 'articles': [{'id': '186', 'title': 'السفير الأمريكي الأسبق: البيت الأبيض يراهن على المغرب والسر في “رؤية الملك”', 'source': 'rue20.com', 'link': 'https://rue20.com/922270.html', 'summary': 'السفير الأمريكي الأسبق: البيت الأبيض يراهن على المغرب والسر في “رؤية الملك”.  | الرباط قال سفير الولايات المتحدة الأسبق بالمغرب، دوايت بوش، إن العلاقات الاستراتيجية القائمة بين المغرب والولايات المتحدة تتميز بمتانتها ويتعين أن تتعزز في المجالات ذات القيمة المضافة العالية. وفي حديث خص به وكالة المغرب العربي للأنباء، بمناسبة الذكرى الـ26 لاعتلاء صاحب الجلالة الملك محمد السادس عرش أسلافه المنعمين، أكد دوايت بوش أن الخبر السفير الأمريكي الأسبق: البيت الأبيض يراهن على المغرب والسر في “رؤية الملك”  .', 'size': 2}, {'id': '224', 'title': 'السفير الأسبق لواشنطن بالرباط: المغرب والولايات المتحدة.. علاقات استراتيجية تتطلع للمستقبل', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/224984/', 'summary': 'السفير الأسبق لواشنطن بالرباط: المغرب والولايات المتحدة.. علاقات استراتيجية تتطلع للمستقبل. واشنطن – قال سفير الولايات المتحدة الأسبق بالمغرب، دوايت بوش، إن العلاقات الاستراتيجية القائمة بين المغرب والولايات المتحدة تتميز بمتانتها ويتعين أن تتعزز في المجالات ذات القيمة المضافة العالية. وفي حديث خص به وكالة المغرب العربي للأنباء، بمناسبة الذكرى الـ26 لاعتلاء صاحب الجلالة الملك محمد السادس عرش أسلافه المنعمين، أكد السيد دوايت بوش أن هذه', 'size': 2}], 'main_title': 'السفير الأمريكي الأسبق: البيت الأبيض يراهن على المغرب والسر في “رؤية الملك”'}, {'community_id': '11', 'articles': [{'id': '307', 'title': 'ولاية أمن أكادير تنفي إساءة المعاملة وتكشف تفاصيل قضية تهديد بالأصول', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-642598.html', 'summary': 'ولاية أمن أكادير تنفي إساءة المعاملة وتكشف تفاصيل قضية تهديد بالأصول. أوضحت ولاية أمن أكادير ، في بيان رسمي صدر يوم الإثنين 21 يوليوز 2025، حقيقة الفيديو المتداول على موقع "فايسبوك"، والذي يظهر فيه شخص يتظلم من إجراءات بحث قضائي خضع له سابقاً بمفوضية الشرطة بأولاد تايمة. وأكدت مصالح الأمن أن المعني بالأمر سبق أن وُضع تحت الحراسة بسبب تورطه بتاريخ 2 يونيو 2024 في قضية تهديد بالقتل والتصفية الجسدية في حق الأصول، وهي قضية باشرت بشأنها الضابطة القضائية بحثاً تحت إشراف النيابة العامة المختصة، قبل أن تقرر هذه الأخيرة إيداعه بمؤسسة للاستشفاء العقلي نتيجة لسلوكيات عنيفة وعدوانية. وبخصوص ما ورد في الفيديو حول تعرضه لسوء المعاملة أثناء التحقيق، أوضحت ولاية الأمن أن هذه المزاعم خضعت سابقاً لبحث إداري لم يثبت وجود أي إخلال أو تقصير مهني من طرف موظفي الشرطة. وشددت ولاية أمن أكادير على حرصها الدائم على التفاعل الجدي والمسؤول مع ما يُنشر في وسائل الإعلام ومنصات التواصل الاجتماعي حول الشأن الأمني، مشيرة إلى أن التوضيح جاء لتنوير الرأي العام وتصحيح المغالطات التي وردت في التسجيل المصور.', 'size': 2}, {'id': '434', 'title': 'بيان حقيقة من ولاية أمن أكادير بشأن مزاعم سوء المعاملة بمفوضية أولاد تايمة', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a8%d9%8a%d8%a7%d9%86-%d8%ad%d9%82%d9%8a%d9%82%d8%a9-%d9%85%d9%86-%d9%88%d9%84%d8%a7%d9%8a%d8%a9-%d8%a3%d9%85%d9%86-%d8%a3%d9%83%d8%a7%d8%af%d9%8a%d8%b1-%d8%a8%d8%b4%d8%a3%d9%86-%d9%85%d8%b2%d8%a7/', 'summary': 'بيان حقيقة من ولاية أمن أكادير بشأن مزاعم سوء المعاملة بمفوضية أولاد تايمة. أكدت ولاية أمن أكادير، في بيان حقيقة، أنها اطلعت على شريط فيديو منشور على صفحة شخصية على موقع التواصل الاجتماعي “فايسبوك”، يظهر فيه صاحب هذه الصفحة الذي سبق أن كان في وضعية خلاف مع القانون، يتظلم من إجراءات البحث القضائي الذي كان قد خضع له بمفوضية الشرطة بأولاد تايمة. وأوضحت الولاية، في بيانها، …  بيان حقيقة من ولاية أمن أكادير بشأن مزاعم سوء المعاملة بمفوضية أولاد تايمة     .', 'size': 2}], 'main_title': 'ولاية أمن أكادير تنفي إساءة المعاملة وتكشف تفاصيل قضية تهديد بالأصول'}, {'community_id': '12', 'articles': [{'id': '333', 'title': 'المغرب على أعتاب ثورة مالية.. البنك المركزي يطلق تجارب مبتكرة لتحضير العملة الرقمية المستقبلية', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/economy/409703.html', 'summary': 'المغرب على أعتاب ثورة مالية.. البنك المركزي يطلق تجارب مبتكرة لتحضير العملة الرقمية المستقبلية. أعلن والي بنك المغرب، عبد اللطيف الجواهري، اليوم الاثنين بالرباط، أن البنك المركزي أجرى أول تجربة همت حالة استخدام الأداء من نظير إلى نظير (Peer-to-Peer)', 'size': 3}, {'id': '366', 'title': 'هل اقترب المغرب من إصدار عملته الرقمية؟', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/318913/', 'summary': 'هل اقترب المغرب من إصدار عملته الرقمية؟. أعلن والي بنك المغرب، عبد اللطيف الجواهري، اليوم الاثنين بالرباط، أن البنك المركزي أجرى أول تجربة همت حالة استخدام الأداء من نظير إلى نظير (Peer-to-Peer) بالتجزئة. وقال الجواهري، بمناسبة افتتاح الندوة القارية لجمعية البنوك المركزية الإفريقية لسنة 2025، المنعقدة تحت شعار “المخاطر السيبرانية والتكنولوجيات المالية المبتكرة.. تحديات وتدابير إستراتيجية”، “نحن بصدد إجراء تجربة أخرى، بالتعاون', 'size': 2}, {'id': '426', 'title': 'الجواهري: العملة الرقمية.. تجربة أولى حول حالة استخدام الأداء من نظير إلى نظير', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%a7%d9%84%d8%ac%d9%88%d8%a7%d9%87%d8%b1%d9%8a-%d8%a7%d9%84%d8%b9%d9%85%d9%84%d8%a9-%d8%a7%d9%84%d8%b1%d9%82%d9%85%d9%8a%d8%a9-%d8%aa%d8%ac%d8%b1%d8%a8%d8%a9-%d8%a3%d9%88%d9%84%d9%89-%d8%ad%d9%88/', 'summary': 'الجواهري: العملة الرقمية.. تجربة أولى حول حالة استخدام الأداء من نظير إلى نظير. أعلن والي بنك المغرب، عبد اللطيف الجواهري، اليوم الاثنين بالرباط، أن البنك المركزي أجرى أول تجربة همت حالة استخدام الأداء من نظير إلى نظير (Peer-to-Peer)  الجواهري: العملة الرقمية.. تجربة أولى حول حالة استخدام الأداء من نظير إلى نظير     .', 'size': 2}], 'main_title': 'المغرب على أعتاب ثورة مالية.. البنك المركزي يطلق تجارب مبتكرة لتحضير العملة الرقمية المستقبلية'}, {'community_id': '13', 'articles': [{'id': '335', 'title': 'لأول مرة منذ 1944.. وكالة الأنباء الفرنسية تخشى على مراسليها في غزة من الموت جوعاً', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/world/409704.html', 'summary': 'لأول مرة منذ 1944.. وكالة الأنباء الفرنسية تخشى على مراسليها في غزة من الموت جوعاً. أطلقت وكالة الأنباء الفرنسية (AFP) نداءً إنسانياً عاجلاً، محذّرة من احتمال فقدان مراسليها العاملين في قطاع غزة بسبب الجوع، في سابقة هي الأولى منذ تأسيسها', 'size': 2}, {'id': '385', 'title': 'وكالة الأنباء الفرنسية تحذر: نخشى أن يموت مراسلونا في غزة جوعا لأول مرة منذ تأسيسنا عام 1944', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1087135.html', 'summary': 'وكالة الأنباء الفرنسية تحذر: نخشى أن يموت مراسلونا في غزة جوعا لأول مرة منذ تأسيسنا عام 1944. أصدرت وكالة الأنباء الفرنسية (AFP) بيانا استثنائيا أعربت فيه عن خشيتها من أن يلقى مراسلوها في قطاع غزة حتفهم جوعا، معتبرة أن هذه هي المرة الأولى التي تواجه فيها مثل هذا التهديد منذ تأسيسها سنة 1944. وقالت الوكالة في بيانها إن فريقها الميداني داخل القطاع يضم كاتب نصوص مستقلا، وثلاثة مصورين، وستة مصوري فيديو، يعملون ظهرت المقالة وكالة الأنباء الفرنسية تحذر: نخشى أن يموت مراسلونا في غزة جوعا لأول مرة منذ تأسيسنا عام 1944  .', 'size': 2}], 'main_title': 'لأول مرة منذ 1944.. وكالة الأنباء الفرنسية تخشى على مراسليها في غزة من الموت جوعاً'}, {'community_id': '10', 'articles': [{'id': '364', 'title': 'بوريطة:\xa0المغرب يرغب في بناء شراكة متكافئة ومنفتحة مع الاقتصاد الأوروبي', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/318925/', 'summary': 'بوريطة: المغرب يرغب في بناء شراكة متكافئة ومنفتحة مع الاقتصاد الأوروبي. أكد وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج، ناصر بوريطة، اليوم الاثنين بسكوبي، أن المغرب، بفضل الرؤية المستنيرة لصاحب الجلالة الملك محمد السادس، يضطلع بدور محوري في تعزيز الاستقرار بإفريقيا والمتوسط والمنطقة العربية. وأوضح بوريطة، خلال ندوة صحفية مشتركة مع وزير الشؤون الخارجية والتجارة الخارجية بجمهورية مقدونيا الشمالية، تيمتشو موتسونسكي، أن “المغرب، بفضل الرؤية', 'size': 4}, {'id': '399', 'title': 'بوريطة: المغرب يرغب في بناء شراكة متكافئة مبنية على مصالح ونتائج ملموسة مع الاتحاد الأوروبي', 'source': 'rue20.com', 'link': 'https://rue20.com/922367.html', 'summary': 'بوريطة: المغرب يرغب في بناء شراكة متكافئة مبنية على مصالح ونتائج ملموسة مع الاتحاد الأوروبي.  . الرباط أكد وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج، ناصر بوريطة، اليوم الاثنين بسكوبي، أن المغرب، بفضل الرؤية المستنيرة لصاحب الجلالة الملك محمد السادس، يضطلع بدور محوري في تعزيز الاستقرار بإفريقيا والمتوسط والمنطقة العربية. وأوضح بوريطة، خلال ندوة صحفية مشتركة مع وزير الشؤون الخارجية والتجارة الخارجية بجمهورية مقدونيا الشمالية، تيمتشو موتسونسكي، الخبر بوريطة: المغرب يرغب في بناء شراكة متكافئة مبنية على مصالح ونتائج ملموسة مع الاتحاد الأوروبي  .', 'size': 3}, {'id': '405', 'title': 'بوريطة: الملك يضطلع بدور محوري في تعزيز الاستقرار بإفريقيا والمتوسط والمنطقة العربية', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/470191.html', 'summary': 'بوريطة: الملك يضطلع بدور محوري في تعزيز الاستقرار بإفريقيا والمتوسط والمنطقة العربية. و.م.ع أكد وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج، ناصر بوريطة، اليوم الاثنين بسكوبي، أن المغرب، بفضل الرؤية المستنيرة للملك محمد السادس، يضطلع بدور محوري في تعزيز الاستقرار بإفريقيا والمتوسط والمنطقة العربية. وأوضح بوريطة، خلال ندوة صحفية مشتركة مع وزير الشؤون الخارجية والتجارة الخارجية بجمهورية مقدونيا الشمالية، تيمتشو موتسونسكي، أن “المغرب، بفضل الرؤية المستنيرة …', 'size': 3}, {'id': '430', 'title': 'بوريطة: بفضل الرؤية المستنيرة لجلالة الملك، المغرب يضطلع بدور محوري في تعزيز الاستقرار الإقليمي', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/225002/', 'summary': 'بوريطة: بفضل الرؤية المستنيرة لجلالة الملك، المغرب يضطلع بدور محوري في تعزيز الاستقرار الإقليمي. سكوبي – أكد وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج، ناصر بوريطة، اليوم الاثنين بسكوبي، أن المغرب، بفضل الرؤية المستنيرة لصاحب الجلالة الملك محمد السادس، يضطلع بدور محوري في تعزيز الاستقرار بإفريقيا والمتوسط والمنطقة العربية. وأوضح السيد بوريطة، خلال ندوة صحفية مشتركة مع وزير الشؤون الخارجية والتجارة الخارجية بجمهورية مقدونيا الشمالية، تيمتشو موتسونسكي، أن', 'size': 4}], 'main_title': 'بوريطة:\xa0المغرب يرغب في بناء شراكة متكافئة ومنفتحة مع الاقتصاد الأوروبي'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    