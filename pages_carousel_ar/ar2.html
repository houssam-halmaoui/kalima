<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 26/07/2025 - 18h28</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '74', 'title': 'مؤسسة محمد السادس تفتح باب الاستفادة من منحة الحج لموسم 1447 هـ/2026 م', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/education/409905.html', 'summary': 'مؤسسة محمد السادس تفتح باب الاستفادة من منحة الحج لموسم 1447 هـ/2026 م. أعلنت مؤسسة محمد السادس للنهوض بالأعمال الاجتماعية للتربية والتكوين عن انطلاق عملية التسجيل للاستفادة من منحة الحج لفائدة المنخرطين المستوفين لشروط الأهلية، والراغبين في أداء', 'size': 2}, {'id': '215', 'title': 'إعلان فتح باب الترشيح لمنحة الحج 1447هـ/2026م بهذه المؤسسة', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%a5%d8%b9%d9%84%d8%a7%d9%86-%d9%81%d8%aa%d8%ad-%d8%a8%d8%a7%d8%a8-%d8%a7%d9%84%d8%aa%d8%b1%d8%b4%d9%8a%d8%ad-%d9%84%d9%85%d9%86%d8%ad%d8%a9-%d8%a7%d9%84%d8%ad%d8%ac-1447%d9%87%d9%80-2026%d9%85/', 'summary': 'إعلان فتح باب الترشيح لمنحة الحج 1447هـ/2026م بهذه المؤسسة. أعلنت مؤسسة محمد السادس للنهوض بالأعمال الاجتماعية للتربية والتكوين، اليوم الجمعة، فتح باب التسجيل للحصول على منحة الحج لفائدة منخرطيها المتوفرين  إعلان فتح باب الترشيح لمنحة الحج 1447هـ/2026م بهذه المؤسسة     .', 'size': 2}], 'main_title': 'مؤسسة محمد السادس تفتح باب الاستفادة من منحة الحج لموسم 1447 هـ/2026 م'}, {'community_id': '1', 'articles': [{'id': '98', 'title': 'التجمع الوطني للأحرار يثمّن الحصيلة الحكومية ويجدد دعمه للإصلاحات الكبرى', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/politic/409933.html', 'summary': 'التجمع الوطني للأحرار يثمّن الحصيلة الحكومية ويجدد دعمه للإصلاحات الكبرى. عقد المكتب السياسي لحزب التجمع الوطني للأحرار، اجتماعا مساء يوم الخميس بمدينة الرباط، برئاسة عزيز أخنوش، ألقى خلاله عرضا تناول مجموعة من القضايا الوطنية والدولية،', 'size': 2}, {'id': '204', 'title': '“الأحرار” يثمن الحصيلة الحكومية ويصفها بـ”المشرفة”', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/470676.html', 'summary': '“الأحرار” يثمن الحصيلة الحكومية ويصفها بـ”المشرفة”. ثمن المكتب السياسي لحزب التجمع الوطني للأحرار، الحصيلة الحكومية والتي وصفها بـ”المشرفة”. وعقد المكتب السياسي لحزب التجمع الوطني للأحرار، اجتماعا مساء أمس الخميس 24 يوليوز 2025 بمدينة الرباط، برئاسة عزيز أخنوش، ألقى خلاله عرضا تناول مجموعة من القضايا الوطنية والدولية، إلى جانب استعراض الوضعية السياسية والاجتماعية والاقتصادية الراهنة، وتدارس الجوانب التنظيمية الداخلية للحزب. وجاء في …', 'size': 2}], 'main_title': 'التجمع الوطني للأحرار يثمّن الحصيلة الحكومية ويجدد دعمه للإصلاحات الكبرى'}, {'community_id': '6', 'articles': [{'id': '156', 'title': 'نشرة إنذارية تحذر من موجة حر\xa0بعدد من مناطق المملكة', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1088433.html', 'summary': 'نشرة إنذارية تحذر من موجة حر بعدد من مناطق المملكة. أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل موجة حر، بدرجات حرارة تتراوح ما بين 42 و48 درجة، ابتداء من يوم غد الأحد إلى غاية يوم الثلاثاء بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة برتقالي، أنه يرتقب تسجيل موجة حر، تتراوح ما بين 45 و48 درجة، ستهم عمالات وأقاليم زاكورة، ظهرت المقالة نشرة إنذارية تحذر من موجة حر بعدد من مناطق المملكة  .', 'size': 4}, {'id': '186', 'title': 'موجة حر من الأحد إلى الثلاثاء بعدد من مناطق المملكة', 'source': 'rue20.com', 'link': 'https://rue20.com/923874.html', 'summary': 'موجة حر من الأحد إلى الثلاثاء بعدد من مناطق المملكة. . الرباط أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل موجة حر، بدرجات حرارة تتراوح ما بين 42 و48 درجة، ابتداء من يوم غد الأحد إلى غاية يوم الثلاثاء بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة برتقالي، أنه يرتقب تسجيل موجة حر، تتراوح ما بين 45 و48 درجة، ستهم الخبر موجة حر من الأحد إلى الثلاثاء بعدد من مناطق المملكة  .', 'size': 4}, {'id': '339', 'title': 'من الأحد للثلاثاء.. الحرارة غتوصل لـ48 درجة!', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%85%d9%86-%d8%a7%d9%84%d8%a3%d8%ad%d8%af-%d9%84%d9%84%d8%ab%d9%84%d8%a7%d8%ab%d8%a7%d8%a1-%d8%a7%d9%84%d8%ad%d8%b1%d8%a7%d8%b1%d8%a9-%d8%ba%d8%aa%d9%88%d8%b5%d9%84-%d9%84%d9%8048-%d8%af%d8%b1/', 'summary': 'من الأحد للثلاثاء.. الحرارة غتوصل لـ48 درجة!. أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل موجة حر، بدرجات حرارة تتراوح ما بين 42 و48 درجة، ابتداء من يوم غد الأحد إلى غاية يوم الثلاثاء بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة برتقالي، أنه يرتقب تسجيل موجة حر، تتراوح ما بين 45 و48 درجة، ستهم عمالات وأقاليم زاكورة،', 'size': 5}, {'id': '372', 'title': 'تحذير من موجة حر بدءا من الأحد إلى الثلاثاء', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%aa%d8%ad%d8%b0%d9%8a%d8%b1-%d9%85%d9%86-%d9%85%d9%88%d8%ac%d8%a9-%d8%ad%d8%b1-%d8%a8%d8%af%d8%a1%d8%a7-%d9%85%d9%86-%d8%a7%d9%84%d8%a3%d8%ad%d8%af-%d8%a5%d9%84%d9%89-%d8%a7%d9%84%d8%ab%d9%84%d8%a7/', 'summary': 'تحذير من موجة حر بدءا من الأحد إلى الثلاثاء. أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل موجة حر، بدرجات حرارة تتراوح ما بين 42 و48 درجة، ابتداء من يوم غد الأحد إلى غاية يوم الثلاثاء بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة برتقالي، أنه يرتقب تسجيل موجة حر، تتراوح ما بين 45 و48 درجة، ستهم عمالات وأقاليم زاكورة،  تحذير من موجة حر بدءا من الأحد إلى الثلاثاء     .', 'size': 4}, {'id': '391', 'title': 'نشرة إنذارية.. موجة حر من الأحد إلى الثلاثاء بعدد من مناطق المملكة', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/470710.html', 'summary': 'نشرة إنذارية.. موجة حر من الأحد إلى الثلاثاء بعدد من مناطق المملكة. أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل موجة حر، بدرجات حرارة تتراوح ما بين 42 و48 درجة، ابتداء من يوم غد الأحد إلى غاية يوم الثلاثاء بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة برتقالي، أنه يرتقب تسجيل موجة حر، تتراوح ما بين 45 و48 درجة، ستهم عمالات وأقاليم زاكورة، …', 'size': 2}], 'main_title': 'من الأحد للثلاثاء.. الحرارة غتوصل لـ48 درجة!'}, {'community_id': '3', 'articles': [{'id': '158', 'title': 'افتتاح أول مقر للفيفا في إفريقيا بالرباط بحضور إنفانتينو وموتسيبي ولقجع', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1088421.html', 'summary': 'افتتاح أول مقر للفيفا في إفريقيا بالرباط بحضور إنفانتينو وموتسيبي ولقجع. افتُتح صباح يومه السبت، المقر الجديد للاتحاد الدولي لكرة القدم “فيفا” بمدينة الرباط، بالقرب من مركب محمد السادس لكرة القدم، بحضور رئيس الفيفا جياني إنفانتينو، ورئيس الكونفدرالية الإفريقية لكرة القدم باتريس موتسيبي، إلى جانب رئيس الجامعة الملكية المغربية لكرة القدم فوزي لقجع، وممثلي عدد من الاتحادات الكروية القارية والدولية. ويُعد افتتاح هذا المقر خطوة تعكس ظهرت المقالة افتتاح أول مقر للفيفا في إفريقيا بالرباط بحضور إنفانتينو وموتسيبي ولقجع  .', 'size': 3}, {'id': '310', 'title': 'بحضور إنفانتينو ولقجع.. إفتتاح مقر الفيفا فرع إفريقيا بالمغرب', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-643983.html', 'summary': 'بحضور إنفانتينو ولقجع.. إفتتاح مقر الفيفا فرع إفريقيا بالمغرب. هبة بريس تم صباح اليوم السبت، الافتتاح الرسمي لمقر الاتحاد الدولي لكرة القدم (فيفا) – فرع إفريقيا، بمركب محمد السادس لكرة القدم في المعمورة، بحضور رئيس الفيفا جياني إنفانتينو، ورئيس الكونفدرالية الإفريقية لكرة القدم باتريس موتسيبي, ورئيس الجامعة الملكية المغربية لكرة القدم فوزي لقجع، إلى جانب شخصيات رياضية ومسؤولين آخرين. ويأتي هذا الافتتاح تتويجاً لاتفاقية تم توقيعها سابقاً بين الاتحاد الدولي لكرة القدم والحكومة المغربية والجامعة الملكية المغربية لكرة القدم، خلال حفل رسمي أقيم يوم الاثنين 16 دجنبر 2024 بقصر المؤتمرات بمدينة مراكش، بحضور شخصيات بارزة في الساحة الكروية الدولية. وسيمثل هذا المقر نقطة ارتكاز استراتيجية للفيفا في القارة الإفريقية، بما يعزز من تطوير البنية التحتية والتدبير الإداري والتقني لكرة القدم في مختلف بلدان القارة، كما يأتي تزامناً مع استعدادات المغرب لاحتضان نهائيات كأس العالم 2030، إلى جانب كل من إسبانيا والبرتغال.', 'size': 2}, {'id': '418', 'title': 'بحضور لقجع.. الفيفا يفتتح مكتبه الإقليمي في العاصمة الرباط', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a8%d8%ad%d8%b6%d9%88%d8%b1-%d9%84%d9%82%d8%ac%d8%b9-%d8%a7%d9%84%d9%81%d9%8a%d9%81%d8%a7-%d9%8a%d9%81%d8%aa%d8%aa%d8%ad-%d9%85%d9%83%d8%aa%d8%a8%d9%87-%d8%a7%d9%84%d8%a5%d9%82%d9%84%d9%8a%d9%85/', 'summary': 'بحضور لقجع.. الفيفا يفتتح مكتبه الإقليمي في العاصمة الرباط. افتتح الاتحاد الدولي لكرة القدم “الفيفا”، يومه السبت، مكتبه الإقليمي في إفريقيا، بالعاصمة المغربية الرباط، حيث جرت مراسيم تدشين هذا المكتب بحضور رئيس “الفيفا”، جياني إنفانتينو، ورئيس الاتحاد الإفريقي لكرة القدم، باتريس موتسيبي، إلى جانب فوزي لقجع، رئيس الجامعة الملكية المغربية لكرة القدم. وقد شيد المكتب الإقليمي لـ”الفيفا” بمحاذاة مركز محمد السادس لكرة القدم …  بحضور لقجع.. الفيفا يفتتح مكتبه الإقليمي في العاصمة الرباط     .', 'size': 2}], 'main_title': 'افتتاح أول مقر للفيفا في إفريقيا بالرباط بحضور إنفانتينو وموتسيبي ولقجع'}, {'community_id': '2', 'articles': [{'id': '164', 'title': 'بنك المغرب يكشف ارتفاع تغطية المخاطر إلى 69%.. والديون المتعثرة تتراجع لـ 97 مليارا', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1088394.html', 'summary': 'بنك المغرب يكشف ارتفاع تغطية المخاطر إلى 69%.. والديون المتعثرة تتراجع لـ 97 مليارا. أفاد بنك المغرب بأن الديون المتعثرة للبنوك تراجعت بنسبة 2,7 في المائة لتصل إلى رصيد قدره 97,4 مليار درهم برسم السنة المالية 2024. وأورد البنك في تقريره السنوي حول الإشراف البنكي أن هذا المستوى يمثل معدل خسارة بلغ 8,4 في المائة، بتحسن قدره 0,1 نقطة مقارنة بالسنة السابقة. وهكذا، يظهر التحليل حسب درجة المخاطر أن ظهرت المقالة بنك المغرب يكشف ارتفاع تغطية المخاطر إلى 69%.. والديون المتعثرة تتراجع لـ 97 مليارا  .', 'size': 3}, {'id': '179', 'title': 'ودائع البنوك تتجاوز 1.2 تريليون درهم في 2024 بدعم من التسوية الجبائية', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%88%d8%af%d8%a7%d8%a6%d8%b9-%d8%a7%d9%84%d8%a8%d9%86%d9%88%d9%83-%d8%aa%d8%aa%d8%ac%d8%a7%d9%88%d8%b2-1-2-%d8%aa%d8%b1%d9%8a%d9%84%d9%8a%d9%88%d9%86-%d8%af%d8%b1%d9%87%d9%85-%d9%81%d9%8a-2024/', 'summary': 'ودائع البنوك تتجاوز 1.2 تريليون درهم في 2024 بدعم من التسوية الجبائية. كشف بنك المغرب، في تقريره السنوي حول الإشراف البنكي، أن الودائع البنكية لزبائن البنوك بلغت 1275 مليار درهم مع نهاية سنة 2024، مسجلة ارتفاعا قويا بنسبة 9,2 في المائة مقارنة بزيادة بلغت 3,4 في المائة سنة 2023. وعزا البنك هذا الارتفاع بشكل جزئي إلى عملية التسوية الطوعية للوضعية الجبائية للأشخاص الذاتيين التي أطلقتها الحكومة، والتي  ودائع البنوك تتجاوز 1.2 تريليون درهم في 2024 بدعم من التسوية الجبائية     .', 'size': 3}, {'id': '242', 'title': 'البنوك والنوافذ التشاركية تمنح 33,8 مليار درهم من التمويلات في 2024', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d8%a8%d9%86%d9%88%d9%83-%d9%88%d8%a7%d9%84%d9%86%d9%88%d8%a7%d9%81%d8%b0-%d8%a7%d9%84%d8%aa%d8%b4%d8%a7%d8%b1%d9%83%d9%8a%d8%a9-%d8%aa%d9%85%d9%86%d8%ad-338-%d9%85%d9%84%d9%8a%d8%a7/', 'summary': 'البنوك والنوافذ التشاركية تمنح 33,8 مليار درهم من التمويلات في 2024. أفاد بنك المغرب في تقريره السنوي حول الإشراف البنكي أن حجم التمويلات التشاركية التي قدمتها الأبناك والنوافذ التشاركية بلغ 33,8 مليار درهم خلال سنة 2024، مسجلا بذلك ارتفاعا بنسبة 19,9% مقارنة مع العام السابق. وأوضح التقرير أن هذه التمويلات التشاركية شكلت نسبة 86,9% من إجمالي التمويلات الممنوحة خلال السنة، مقارنة بـ86,4% في 2023. …  البنوك والنوافذ التشاركية تمنح 33,8 مليار درهم من التمويلات في 2024     .', 'size': 3}], 'main_title': 'بنك المغرب يكشف ارتفاع تغطية المخاطر إلى 69%.. والديون المتعثرة تتراجع لـ 97 مليارا'}, {'community_id': '5', 'articles': [{'id': '184', 'title': 'حالة الطقس: أجواء حارة ورياح قوية وأمطار متفرقة', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%ad%d8%a7%d9%84%d8%a9-%d8%a7%d9%84%d8%b7%d9%82%d8%b3-%d8%a3%d8%ac%d9%88%d8%a7%d8%a1-%d8%ad%d8%a7%d8%b1%d8%a9-%d9%88%d8%b1%d9%8a%d8%a7%d8%ad-%d9%82%d9%88%d9%8a%d8%a9-%d9%88%d8%a3%d9%85%d8%b7%d8%a7/', 'summary': 'حالة الطقس: أجواء حارة ورياح قوية وأمطار متفرقة. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليوم غد السبت، أن يكون الطقس حارا نسبيا إلى حار محليا بكل من السهول الداخلية بالجنوب الشرقي، وجنوب المنطقة الشرقية، والأقاليم الجنوبية. وستهم سحب ركامية شيئا ما غير مستقرة شمال الأطلس الكبير وسفوحه الشرقية، وكذا جنوب المنطقة الشرقية، مع نزول قطرات مطرية متفرقة فوق الواجهة المتوسطية وشمال كل من  حالة الطقس: أجواء حارة ورياح قوية وأمطار متفرقة     .', 'size': 2}, {'id': '245', 'title': 'توقعات أحوال الطقس في العديد من مناطق المملكة اليوم السبت', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%aa%d9%88%d9%82%d8%b9%d8%a7%d8%aa-%d8%a3%d8%ad%d9%88%d8%a7%d9%84-%d8%a7%d9%84%d8%b7%d9%82%d8%b3-%d9%81%d9%8a-%d8%a7%d9%84%d8%b9%d8%af%d9%8a%d8%af-%d9%85%d9%86-%d9%85%d9%86%d8%a7%d8%b7%d9%82-94/', 'summary': 'توقعات أحوال الطقس في العديد من مناطق المملكة اليوم السبت. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليومه السبت، أن يكون الطقس حارا نسبيا إلى حار محليا بكل من السهول الداخلية بالجنوب الشرقي، وجنوب المنطقة الشرقية، والأقاليم الجنوبية. وستهم سحب ركامية شيئا ما غير مستقرة شمال الأطلس الكبير وسفوحه الشرقية، وكذا جنوب المنطقة الشرقية، مع نزول قطرات مطرية متفرقة فوق الواجهة المتوسطية وشمال كل …  توقعات أحوال الطقس في العديد من مناطق المملكة اليوم السبت     .', 'size': 2}], 'main_title': 'حالة الطقس: أجواء حارة ورياح قوية وأمطار متفرقة'}, {'community_id': '4', 'articles': [{'id': '225', 'title': 'صاحب الجلالة يقدم تعزية مؤثرة في وفاة الفنان التشكيلي عفيف بناني', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/225213/', 'summary': 'صاحب الجلالة يقدم تعزية مؤثرة في وفاة الفنان التشكيلي عفيف بناني. الرباط – بعث صاحب الجلالة الملك محمد السادس برقية تعزية ومواساة إلى أفراد أسرة المرحوم الفنان التشكيلي، عفيف بناني. وقال جلالة الملك، في هذه البرقية “تلقينا ببالغ التأثر نعي الفنان التشكيلي المرحوم عفيف بناني، تغمده الله بسابغ رحمته ورضاه”. ومما جاء في هذه البرقية، أيضا “وبهذه المناسبة المحزنة، نعرب عن تعازينا الحارة ومواساتنا الصادقة لكم،', 'size': 2}, {'id': '243', 'title': 'برقية تعزية ومواساة من الملك محمد السادس إلى أفراد أسرة المرحوم الفنان التشكيلي عفيف بناني', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a8%d8%b1%d9%82%d9%8a%d8%a9-%d8%aa%d8%b9%d8%b2%d9%8a%d8%a9-%d9%88%d9%85%d9%88%d8%a7%d8%b3%d8%a7%d8%a9-%d9%85%d9%86-%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3-40/', 'summary': 'برقية تعزية ومواساة من الملك محمد السادس إلى أفراد أسرة المرحوم الفنان التشكيلي عفيف بناني. بعث الملك محمد السادس برقية تعزية ومواساة إلى أفراد أسرة المرحوم الفنان التشكيلي، عفيف بناني. وقال الملك محمد السادس، في هذه البرقية “تلقينا ببالغ التأثر نعي الفنان التشكيلي المرحوم عفيف بناني، تغمده الله بسابغ رحمته ورضاه”. ومما جاء في هذه البرقية، أيضا “وبهذه المناسبة المحزنة، نعرب عن تعازينا الحارة ومواساتنا الصادقة لكم، ولكافة …  برقية تعزية ومواساة من الملك محمد السادس إلى أفراد أسرة المرحوم الفنان التشكيلي عفيف بناني     .', 'size': 2}], 'main_title': 'صاحب الجلالة يقدم تعزية مؤثرة في وفاة الفنان التشكيلي عفيف بناني'}, {'community_id': '7', 'articles': [{'id': '306', 'title': 'الملك مبرقا رئيس المالديف: “متمنياتنا لكم بدوام الصحة والهناء”', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-643998.html', 'summary': 'الملك مبرقا رئيس المالديف: “متمنياتنا لكم بدوام الصحة والهناء”. هبة بريس بعث صاحب الجلالة الملك محمد السادس برقية تهنئة إلى رئيس جمهورية المالديف، فخامة السيد محمد مويزو، وذلك بمناسبة احتفال بلاده بعيدها الوطني. وأعرب جلالة الملك في هذه البرقية عن أحر تهانئ جلالته وأصدق متمنياته للرئيس محمد مويزو بدوام الصحة والهناء، ولشعب المالديف الشقيق باطراد التقدم والرخاء. ومما جاء في برقية جلالة الملك “وأغتنم هذه المناسبة السعيدة، لأعرب لفخامتكم عن اعتزازي العميق بما يربط بلدينا من علاقات أخوية متينة، قائمة على التضامن الفاعل، والتعاون المثمر، والتقدير المتبادل، مؤكدا لكم حرصي على مواصلة العمل سويا معكم من أجل ترسيخها أكثر وتطوير تعاوننا الثنائي في مختلف المجالات بما يستجيب وتطلعات شعبينا الشقيقين”.', 'size': 2}, {'id': '417', 'title': 'برقية تهنئة من الملك محمد السادس إلى رئيس جمهورية المالديف بمناسبة احتفال بلاده بعيدها الوطني', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a8%d8%b1%d9%82%d9%8a%d8%a9-%d8%aa%d9%87%d9%86%d8%a6%d8%a9-%d9%85%d9%86-%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7%d8%af%d8%b3-%d8%a5%d9%84%d9%89-%d8%b1-16/', 'summary': 'برقية تهنئة من الملك محمد السادس إلى رئيس جمهورية المالديف بمناسبة احتفال بلاده بعيدها الوطني. بعث الملك محمد السادس برقية تهنئة إلى رئيس جمهورية المالديف، محمد مويزو، وذلك بمناسبة احتفال بلاده بعيدها الوطني. وأعرب الملك محمد السادس في هذه البرقية عن أحر تهانئ جلالته وأصدق متمنياته للرئيس محمد مويزو بدوام الصحة والهناء، ولشعب المالديف الشقيق باطراد التقدم والرخاء. ومما جاء في برقية الملك محمد السادس “وأغتنم هذه المناسبة السعيدة، لأعرب لفخامتكم عن …  برقية تهنئة من الملك محمد السادس إلى رئيس جمهورية المالديف بمناسبة احتفال بلاده بعيدها الوطني     .', 'size': 2}], 'main_title': 'الملك مبرقا رئيس المالديف: “متمنياتنا لكم بدوام الصحة والهناء”'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    