<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 13/07/2025 - 18h26</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '2', 'articles': [{'id': '68', 'title': 'بني ملال: إنهاء الشكل الاحتجاجي الذي انخرط فيه شخص اعتصم فوق خزان مياه بجماعة أولاد يوسف', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/203355', 'summary': 'بني ملال: إنهاء الشكل الاحتجاجي الذي انخرط فيه شخص اعتصم فوق خزان مياه بجماعة أولاد يوسف.  أفادت السلطات المحلية بإقليم بني ملال أنه تم، مساء أمس الجمعة، إنهاء الشكل الاحتجاجي الذي انخرط فيه شخص يبلغ من العمر حوالي 45 سنة،من خلال الاعتصام فوق خزان مياه مرتفع بالجماعة الترابية أولاد يوسف، وذلك بتسجيل قيام المعني بالأمر بالإلقاء بنفسه من أعلى الخزان واضعا حبلا على عنقه، لينقل إثر ذلك للمستشفى الجهوي', 'size': 4}, {'id': '178', 'title': 'سلطات بني ملال تكشف تفاصيل واقعة الشاطو وتعلن عن بقاء المعتصم على قيد الحياة', 'source': 'rue20.com', 'link': 'https://rue20.com/919665.html', 'summary': 'سلطات بني ملال تكشف تفاصيل واقعة الشاطو وتعلن عن بقاء المعتصم على قيد الحياة. . مراكش أفادت السلطات المحلية بإقليم بني ملال أنه تم مساء أمس الجمعة 11 يوليوز 2025، إنهاء الشكل الاحتجاجي الذي انخرط فيه شخص يبلغ من العمر حوالي 45 سنة، من خلال الاعتصام فوق خزان مياه مرتفع بالجماعة الترابية أولاد يوسف، وذلك بتسجيل قيام المعني بالأمر بالإلقاء بنفسه من أعلى الخزان واضعا حبلا على عنقه، الخبر سلطات بني ملال تكشف تفاصيل واقعة الشاطو وتعلن عن بقاء المعتصم على قيد الحياة  .', 'size': 3}, {'id': '219', 'title': 'عاجل.. السلطات تكشف تفاصيل ليلة الرعب مع “بوعبيد” بني ملال', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/224569/', 'summary': 'عاجل.. السلطات تكشف تفاصيل ليلة الرعب مع “بوعبيد” بني ملال. أفادت السلطات المحلية بإقليم بني ملال أنه تم مساء أمس الجمعة 11 يوليوز 2025، إنهاء الشكل الاحتجاجي الذي انخرط فيه شخص يبلغ من العمر حوالي 45 سنة، من خلال الاعتصام فوق خزان مياه مرتفع بالجماعة الترابية أولاد يوسف، وذلك بتسجيل قيام المعني بالأمر بالإلقاء بنفسه من أعلى الخزان واضعا حبلا على عنقه، لينقل إثر ذلك', 'size': 3}, {'id': '228', 'title': 'نهاية غير سعيدة ل”التشويق الممل” في خزان بني ملال', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d9%86%d9%87%d8%a7%d9%8a%d8%a9-%d8%ba%d9%8a%d8%b1-%d8%b3%d8%b9%d9%8a%d8%af%d8%a9-%d9%84%d8%a7%d9%84%d8%aa%d8%b4%d9%88%d9%8a%d9%82-%d8%a7%d9%84%d9%85%d9%85%d9%84-%d9%81%d9%8a-%d8%ae%d8%b2%d8%a7/', 'summary': 'نهاية غير سعيدة ل”التشويق الممل” في خزان بني ملال. المساء اليوم: أفادت السلطات المحلية بإقليم بني ملال أنه تم، مساء أمس الجمعة، إنهاء الشكل الاحتجاجي الذي انخرط فيه شخص يبلغ من العمر حوالي 45 سنة، من خلال الاعتصام فوق خزان مياه مرتفع بالجماعة الترابية', 'size': 2}], 'main_title': 'بني ملال: إنهاء الشكل الاحتجاجي الذي انخرط فيه شخص اعتصم فوق خزان مياه بجماعة أولاد يوسف'}, {'community_id': '1', 'articles': [{'id': '113', 'title': 'نهائي مونديال الأندية.. التوقيت والقنوات الناقلة لموقعة باريس سان جيرمان وتشلسي', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/sport/worldfoot/409223.html', 'summary': 'نهائي مونديال الأندية.. التوقيت والقنوات الناقلة لموقعة باريس سان جيرمان وتشلسي. تتجه أنظار عشاق كرة القدم مساء اليوم الأحد إلى ملعب "ميتلايف" بالولايات المتحدة الأمريكية، حيث تُختتم منافسات كأس العالم للأندية 2025 في نسختها الجديدة، التي', 'size': 2}, {'id': '376', 'title': 'نهائي مونديال الأندية يحمل مفاجآت عديدة وسط تدابير أمنية مشددة', 'source': 'machahid24.com', 'link': 'https://machahid24.com/sport/469364.html', 'summary': 'نهائي مونديال الأندية يحمل مفاجآت عديدة وسط تدابير أمنية مشددة. تتجه أنظار جماهير كرة القدم اليوم الأحد، صوب ملعب "ميتلايف" بالولايات المتحدة الأمريكية الذي سيحتضن نهائي كأس العالم للأندية 2025.', 'size': 2}], 'main_title': 'نهائي مونديال الأندية.. التوقيت والقنوات الناقلة لموقعة باريس سان جيرمان وتشلسي'}, {'community_id': '0', 'articles': [{'id': '134', 'title': 'نشرة إنذارية.. موجة حر من الثلاثاء إلى الجمعة بعدد من المدن', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/318153/', 'summary': 'نشرة إنذارية.. موجة حر من الثلاثاء إلى الجمعة بعدد من المدن. أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل موجة حر بدرجات حرارة تتراوح ما بين 40 و47 درجة، ابتداء من بعد غد الثلاثاء إلى غاية يوم الجمعة، بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة برتقالي، أنه يرتقب تسجيل موجة حر، من الثلاثاء إلى الجمعة، بدرجات حرارة تتراوح ما بين 44', 'size': 5}, {'id': '145', 'title': 'موجة حر قوية تضرب المغرب من الثلاثاء إلى الجمعة', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1085127.html', 'summary': 'موجة حر قوية تضرب المغرب من الثلاثاء إلى الجمعة. أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل موجة حر بدرجات حرارة تتراوح ما بين 40 و47 درجة، ابتداء من بعد غد الثلاثاء إلى غاية يوم الجمعة، بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة برتقالي، أنه يرتقب تسجيل موجة حر، من الثلاثاء إلى الجمعة، بدرجات حرارة تتراوح ما بين 44 ظهرت المقالة موجة حر قوية تضرب المغرب من الثلاثاء إلى الجمعة  .', 'size': 5}, {'id': '164', 'title': 'نشرة إنذارية.. موجة حر من الثلاثاء إلى الجمعة بعدد من مناطق المملكة', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%86%d8%b4%d8%b1%d8%a9-%d8%a5%d9%86%d8%b0%d8%a7%d8%b1%d9%8a%d8%a9-%d9%85%d9%88%d8%ac%d8%a9-%d8%ad%d8%b1-%d9%85%d9%86-%d8%a7%d9%84%d8%ab%d9%84%d8%a7%d8%ab%d8%a7%d8%a1-%d8%a5%d9%84%d9%89-%d8%a7/', 'summary': 'نشرة إنذارية.. موجة حر من الثلاثاء إلى الجمعة بعدد من مناطق المملكة. أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل موجة حر بدرجات حرارة تتراوح ما بين 40 و47 درجة، ابتداء من بعد غد الثلاثاء إلى غاية يوم الجمعة، بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة برتقالي، أنه يرتقب تسجيل موجة حر، من الثلاثاء إلى الجمعة، بدرجات حرارة تتراوح ما بين 44  نشرة إنذارية.. موجة حر من الثلاثاء إلى الجمعة بعدد من مناطق المملكة     .', 'size': 5}, {'id': '214', 'title': 'نشرة إنذارية.. موجة حر تجتاح العديد من المناطق بالمملكة', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/224588/', 'summary': 'نشرة إنذارية.. موجة حر تجتاح العديد من المناطق بالمملكة. كواليس اليوم أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل موجة حر بدرجات حرارة تتراوح ما بين 40 و47 درجة، ابتداء من بعد غد الثلاثاء إلى غاية يوم الجمعة، بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة برتقالي، أنه يرتقب تسجيل موجة حر، من الثلاثاء إلى الجمعة، بدرجات حرارة تتراوح', 'size': 5}, {'id': '311', 'title': 'موجة حر من الثلاثاء إلى الجمعة بعدد من مناطق المملكة', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/203379', 'summary': 'موجة حر من الثلاثاء إلى الجمعة بعدد من مناطق المملكة.  أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل موجة حر بدرجات حرارة تتراوح ما بين 40 و47 درجة، ابتداء من بعد غد الثلاثاء إلى غاية يوم الجمعة، بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة برتقالي، أنه يرتقب تسجيل موجة حر،من الثلاثاء إلى الجمعة،بدرجات حرارة تتراوح مابين 44 و47', 'size': 5}], 'main_title': 'نشرة إنذارية.. موجة حر من الثلاثاء إلى الجمعة بعدد من المدن'}, {'community_id': '6', 'articles': [{'id': '141', 'title': 'دراسة تحذر من مخاطر أدوية إنقاص الوزن على المراهقين والرجال', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/varietes/318125/', 'summary': 'دراسة تحذر من مخاطر أدوية إنقاص الوزن على المراهقين والرجال. أثارت أدوية إنقاص الوزن مثل “أوزمبيك” و”ويغوفي” مخاوف جديدة بسبب تأثيرها على صحة المراهقين والرجال، حسب دراسة حديثة. وأجريت الدراسة على 1543 شابا تتراوح أعمارهم بين 15 و35 عاما في كندا والولايات المتحدة، ووجد الباحثون أن من تناولوا هذه الأدوية الموصوفة طبيا خلال العام الماضي كانوا أكثر عرضة للإصابة باضطرابات سلوكية واضطرابات في الأكل مثل', 'size': 2}, {'id': '171', 'title': 'دراسة تحذر من تأثير أدوية إنقاص الوزن على صحة المراهقين والرجال', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%af%d8%b1%d8%a7%d8%b3%d8%a9-%d8%aa%d8%ad%d8%b0%d8%b1-%d9%85%d9%86-%d8%aa%d8%a3%d8%ab%d9%8a%d8%b1-%d8%a3%d8%af%d9%88%d9%8a%d8%a9-%d8%a5%d9%86%d9%82%d8%a7%d8%b5-%d8%a7%d9%84%d9%88%d8%b2%d9%86-%d8%b9/', 'summary': 'دراسة تحذر من تأثير أدوية إنقاص الوزن على صحة المراهقين والرجال. أثارت دراسة حديثة أجريت على 1543 شابا تتراوح أعمارهم بين 15 و35 عاما في كندا والولايات المتحدة مخاوف بشأن تناول أدوية إنقاص الوزن مثل "أوزمبيك" و"ويغوفي" نظرا لتأثيرها على صحة المراهقين والرجال. وكشفت الدراسة أن من تناولوا هذه الأدوية الموصوفة طبيا خلال العام الماضي كانوا أكثر عرضة للإصابة باضطرابات سلوكية واضطرابات في الأكل مثل الإفراط  دراسة تحذر من تأثير أدوية إنقاص الوزن على صحة المراهقين والرجال     .', 'size': 2}], 'main_title': 'دراسة تحذر من مخاطر أدوية إنقاص الوزن على المراهقين والرجال'}, {'community_id': '7', 'articles': [{'id': '172', 'title': 'كأس أمم إفريقيا للسيدات.. لبؤات الأطلس يتأهلن لربع النهائي', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%83%d8%a3%d8%b3-%d8%a3%d9%85%d9%85-%d8%a5%d9%81%d8%b1%d9%8a%d9%82%d9%8a%d8%a7-%d9%84%d9%84%d8%b3%d9%8a%d8%af%d8%a7%d8%aa-%d9%84%d8%a8%d8%a4%d8%a7%d8%aa-%d8%a7%d9%84%d8%a3%d8%b7%d9%84%d8%b3-%d9%8a/', 'summary': 'كأس أمم إفريقيا للسيدات.. لبؤات الأطلس يتأهلن لربع النهائي. تأهل المنتخب المغربي النسوي لكرة القدم، الذي أظهر روحا قتالية كبيرة، إلى ربع نهائي كأس أمم إفريقيا (المغرب-2024)، عقب فوزه مساء أمس السبت، على نظيره السنغالي بهدف دون رد، في المباراة التي احتضنها الملعب الأولمبي بالرباط، لحساب الجولة الثالثة من منافسات المجموعة الأولى. وفرضت لبؤات الأطلس منذ بداية المواجهة، أسلوب لعب هجومي مع الاعتماد على  كأس أمم إفريقيا للسيدات.. لبؤات الأطلس يتأهلن لربع النهائي     .', 'size': 2}, {'id': '215', 'title': 'كأس إفريقيا للسيدات.. لبؤات الأطلس يتأهلن إلى الدور ربع النهائي', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/224585/', 'summary': 'كأس إفريقيا للسيدات.. لبؤات الأطلس يتأهلن إلى الدور ربع النهائي. كواليس اليوم ضمن المنتخب المغربي النسوي لكرة القدم بطاقة التأهل إلى الدور ربع النهائي لكأس أمم إفريقيا لكرة القدم للسيدات (المغرب-2024)، عقب فوزه على نظيره السنغالي بهدف دون رد، في المباراة التي جمعتهما مساء أمس السبت على أرضية الملعب الأولمبي بالرباط، برسم الجولة الثالثة من منافسات المجموعة الأولى. وأحرزت ياسمين مرابط هدف الفوز والتأهل', 'size': 2}], 'main_title': 'كأس أمم إفريقيا للسيدات.. لبؤات الأطلس يتأهلن لربع النهائي'}, {'community_id': '3', 'articles': [{'id': '226', 'title': 'وزارة التعليم تكشف عن الإحصائيات النهائية لامتحانات البكالوريا', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d9%88%d8%b2%d8%a7%d8%b1%d8%a9-%d8%a7%d9%84%d8%aa%d8%b9%d9%84%d9%8a%d9%85-%d8%aa%d9%83%d8%b4%d9%81-%d8%b9%d9%86-%d8%a7%d9%84%d8%a5%d8%ad%d8%b5%d8%a7%d8%a6%d9%8a%d8%a7%d8%aa-%d8%a7%d9%84%d9%86%d9%87/', 'summary': 'وزارة التعليم تكشف عن الإحصائيات النهائية لامتحانات البكالوريا. المساء اليوم: أعلنت وزارة التربية الوطنية والتعليم الأولي والرياضة أن عدد المترشحين الممدرسين في التعليم العمومي والخصوصي الذين اجتازوا بنجاح امتحانات نيل شهادة البكالوريا، بمجموع الدورتين العادية والاستدراكية معا برسم دورة 2025، بلغ 311 ألفا', 'size': 2}, {'id': '389', 'title': '311 ألفا و625 مترشحة ومترشحا ممدرسا حصلوا على شهادة البكالوريا برسم دورة 2025', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/224591/', 'summary': '311 ألفا و625 مترشحة ومترشحا ممدرسا حصلوا على شهادة البكالوريا برسم دورة 2025. كواليس اليوم أعلنت وزارة التربية الوطنية والتعليم الأولي والرياضة أن عدد المترشحات والمترشحين الممدرسين في التعليم العمومي والخصوصي الذين اجتازوا بنجاح امتحانات نيل شهادة البكالوريا، بمجموع الدورتين العادية والاستدراكية معا برسم دورة 2025، بلغ 311 ألفا و 625 ناجحة وناجحا. وأوضح بلاغ للوزارة، أمس السبت، أن نسبة النجاح بمجموع الدورتين بلغت 83,3 في المائة', 'size': 2}], 'main_title': 'وزارة التعليم تكشف عن الإحصائيات النهائية لامتحانات البكالوريا'}, {'community_id': '8', 'articles': [{'id': '290', 'title': 'الملك يهنئ رئيس مونتينيغرو بمناسبة العيد الوطني لبلاده', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-640156.html', 'summary': 'الملك يهنئ رئيس مونتينيغرو بمناسبة العيد الوطني لبلاده. هبة بريس بعث الملك محمد السادس برقية تهنئة إلى جاكوف ميلاتوفيتش، رئيس جمهورية مونتينيغرو؛ وذلك بمناسبة احتفال بلاده بعيدها الوطني. وأعرب الملك، في هذه البرقية، عن أحر التهاني وأصدق المتمنيات للرئيس جاكوف ميلاتوفيتش بدوام الصحة والسعادة، ولبلده الصديق بمزيد التقدم والرخاء. ومما جاء في البرقية الملكية: “أغتنم هذه المناسبة السعيدة، لأعرب لكم عن تثميني لمستوى علاقات الصداقة والتعاون التي تجمع بلدينا، والتي يحدونا حرص مشترك على المضي قدما في تعزيزها والارتقاء بتعاوننا الثنائي ليشمل مختلف المجالات، خدمة للمصالح المشتركة لشعبيْنا الصديقيْن”.', 'size': 2}, {'id': '394', 'title': 'الملك محمد السادس يهنئ رئيس جمهورية مونتينيغرو بمناسبة احتفال بلاده بعيدها الوطني', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7%d8%af%d8%b3-%d9%8a%d9%87%d9%86%d8%a6-%d8%b1%d8%a6%d9%8a%d8%b3-%d8%ac%d9%85%d9%87%d9%88%d8%b1%d9%8a%d8%a9-%d9%85%d9%88-2/', 'summary': 'الملك محمد السادس يهنئ رئيس جمهورية مونتينيغرو بمناسبة احتفال بلاده بعيدها الوطني. بعث الملك محمد السادس، برقية تهنئة إلى رئيس جمهورية مونتينيغرو، جاكوف ميلاتوفيتش، وذلك بمناسبة احتفال بلاده بعيدها الوطني. وأعرب الملك محمد السادس في هذه البرقية، عن أحر التهاني وأصدق المتمنيات للرئيس جاكوف ميلاتوفيتش بدوام الصحة والسعادة، ولبلده الصديق بمزيد التقدم والرخاء. ومما جاء في برقية الملك محمد السادس “وأغتنم هذه المناسبة السعيدة، لأعرب لكم عن تثميني لمستوى علاقات الصداقة …  الملك محمد السادس يهنئ رئيس جمهورية مونتينيغرو بمناسبة احتفال بلاده بعيدها الوطني     .', 'size': 2}], 'main_title': 'الملك يهنئ رئيس مونتينيغرو بمناسبة العيد الوطني لبلاده'}, {'community_id': '5', 'articles': [{'id': '333', 'title': 'اختتام فعاليات النسخة الـ18 على إيقاعات كناوة وعرض للأمريكي Macklemore', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/celebrites/318168/', 'summary': 'اختتام فعاليات النسخة الـ18 على إيقاعات كناوة وعرض للأمريكي Macklemore. أسدل الستار، مساء أمس السبت بالدار البيضاء، على فعاليات الدورة الثامنة عشرة من مهرجان جازابلانكا، في أجواء حماسية من خلال عرضين موسيقيين متميزين، جمع أحدهما بين رمزين من رموز موسيقى كناوة، مهدي ناسولي وحميد القصري، فيما كان الثاني من توقيع مغني الراب الأمريكي Macklemore، الذي أبهر الجمهور الحاضر بمنصة “أنفا بارك”. منذ الدقائق الأولى من', 'size': 2}, {'id': '375', 'title': 'جازابلانكا.. اختتام النسخة الـ18 على إيقاعات كناوة وعرض مبهر للفنان “Macklemore”', 'source': 'machahid24.com', 'link': 'https://machahid24.com/panorama/469368.html', 'summary': 'جازابلانكا.. اختتام النسخة الـ18 على إيقاعات كناوة وعرض مبهر للفنان “Macklemore”. أسدل الستار مساء أمس السبت بالدار البيضاء، على فعاليات الدورة الثامنة عشرة من مهرجان جازابلانكا، في أجواء حماسية من خلال عرضين موسيقيين متميزين، جمع أحدهما بين رمزين من رموز موسيقى كناوة، مهدي ناسولي وحميد القصري، فيما كان الثاني من توقيع مغني الراب الأمريكي Macklemore، الذي أبهر الجمهور الحاضر بمنصة "أنفا بارك".', 'size': 2}], 'main_title': 'اختتام فعاليات النسخة الـ18 على إيقاعات كناوة وعرض للأمريكي Macklemore'}, {'community_id': '4', 'articles': [{'id': '363', 'title': 'اعتصام الخزان المائي.. مجلس حقوق الإنسان يستنكر تطوراته الخطيرة', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a7%d8%b9%d8%aa%d8%b5%d8%a7%d9%85-%d8%a7%d9%84%d8%ae%d8%b2%d8%a7%d9%86-%d8%a7%d9%84%d9%85%d8%a7%d8%a6%d9%8a-%d9%85%d8%ac%d9%84%d8%b3-%d8%ad%d9%82%d9%88%d9%82-%d8%a7%d9%84%d8%a5%d9%86%d8%b3%d8%a7/', 'summary': 'اعتصام الخزان المائي.. مجلس حقوق الإنسان يستنكر تطوراته الخطيرة. أعرب المجلس الوطني لحقوق الإنسان عن استيائه من التطورات الخطيرة الأخيرة التي شهدها اعتصام "ب. ز" على سطح خزان مائي شاهق، وتمنى أن تستقر حالة عنصر الوقاية المدنية "ش. ي" الذي تعرض للاعتداء فوق سطح الخزان، وحالة عنصر الدرك الملكي "ب. ع" و "ب. ز" ويتجاوزوا مرحلة الخطر. ونبه المجلس، من خلال البيان الذي توصل  اعتصام الخزان المائي.. مجلس حقوق الإنسان يستنكر تطوراته الخطيرة     .', 'size': 2}, {'id': '372', 'title': 'بوعياش : البث المباشر للحظات إعتصام “الشاطو” مرفوض والمجلس إستجاب لبعض مطالب المعتصِم', 'source': 'rue20.com', 'link': 'https://rue20.com/919695.html', 'summary': 'بوعياش : البث المباشر للحظات إعتصام “الشاطو” مرفوض والمجلس إستجاب لبعض مطالب المعتصِم. . الرباط عبر المجلس الوطني لحقوق الإنسان عن أسفه للتطورات الخطيرة الأخيرة التي شهدها اعتصام السيد ب. ز. على سطح خزان مائي شاهق ويتمنى أن تستقر حالة عنصر الوقاية المدنية ش. ي. الذي تعرض للاعتداء فوق سطح الخزان، وحالة عنصر الدرك الملكي ب. ع. والسيد ب. ز. ويتجاوزوا مرحلة الخطر. وذكر المجلس أنه بتوجيهات الخبر بوعياش : البث المباشر للحظات إعتصام “الشاطو” مرفوض والمجلس إستجاب لبعض مطالب المعتصِم  .', 'size': 2}], 'main_title': 'اعتصام الخزان المائي.. مجلس حقوق الإنسان يستنكر تطوراته الخطيرة'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    