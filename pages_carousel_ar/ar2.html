<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 05/08/2025 - 18h29</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '1', 'articles': [{'id': '42', 'title': 'الطقس غدا الثلاثاء.. ارتفاع درجات الحرارة ورياح قوية وزخات رعدية بالأطلس والجنوب الشرقي', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-646655.html', 'summary': 'الطقس غدا الثلاثاء.. ارتفاع درجات الحرارة ورياح قوية وزخات رعدية بالأطلس والجنوب الشرقي. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليوم غد الثلاثاء، أن يظل الطقس حارا بكل من سهول تادلة والرحامنة ومنطقة السايس ووالماس والجنوب الشرقي والمنطقة الشرقية وداخل الأقاليم الجنوبية. ويرتقب نزول قطرات مطرية أو زخات رعدية مصحوبة بهبات رياح وذلك فوق مرتفعات الأطلس والجنوب الشرقي والمنطقة الشرقية وشرق الريف. وستكون السماء غائمة جزئيا بالأقاليم الصحراوية للمملكة، فضلا عن تشكل كتل من الضباب فوق السهول والسواحل الشمالية والوسطى. كما يتوقع تسجيل هبات رياح قوية نوعا ما بالأقاليم الجنوبية مع تناثر غبار محليا. وستتراوح درجات الحرارة الدنيا ما بين 27 درجة و 32 درجة بأقصى الجنوب الشرقي والجنوب، وما بين 23 درجة و 26 درجة بالسهول الواقعة غرب الأطلس وفي ما تبقى من الجنوب-الشرقي وبداخل الأقاليم الجنوبية، وما بين 10 درجات و 14 درجة بمرتفعات الأطلسين الكبير والمتوسط، وما بين 17 درجة و 22 درجة بباقي جهات المملكة. وستكون درجات الحرارة خلال النهار في ارتفاع. وسيكون البحر هادئا إلى قليل الهيجان بالواجهة المتوسطية والبوغاز وشمال الدار البيضاء، وقليل الهيجان إلى هائج بالجنوب.', 'size': 2}, {'id': '164', 'title': 'طقس حار مع زخات مطرية متوقع اليوم الثلاثاء', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%b7%d9%82%d8%b3-%d8%ad%d8%a7%d8%b1-%d9%85%d8%b9-%d8%b2%d8%ae%d8%a7%d8%aa-%d9%85%d8%b7%d8%b1%d9%8a%d8%a9-%d9%85%d8%aa%d9%88%d9%82%d8%b9-%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%ab%d9%84%d8%a7/', 'summary': 'طقس حار مع زخات مطرية متوقع اليوم الثلاثاء. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الثلاثاء، أن يظل الطقس حارا بكل من سهول تادلة والرحامنة ومنطقة السايس ووالماس والجنوب الشرقي والمنطقة الشرقية وداخل الأقاليم الجنوبية. ويرتقب نزول قطرات مطرية أو زخات رعدية مصحوبة بهبات رياح وذلك فوق مرتفعات الأطلس والجنوب الشرقي والمنطقة الشرقية وشرق الريف. وستكون السماء غائمة جزئيا بالأقاليم الصحراوية للمملكة، فضلا  طقس حار مع زخات مطرية متوقع اليوم الثلاثاء     .', 'size': 3}, {'id': '228', 'title': 'توقعات أحوال الطقس في العديد من مناطق المملكة اليوم الثلاثاء', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%aa%d9%88%d9%82%d8%b9%d8%a7%d8%aa-%d8%a3%d8%ad%d9%88%d8%a7%d9%84-%d8%a7%d9%84%d8%b7%d9%82%d8%b3-%d9%81%d9%8a-%d8%a7%d9%84%d8%b9%d8%af%d9%8a%d8%af-%d9%85%d9%86-%d9%85%d9%86%d8%a7%d8%b7%d9%82-97/', 'summary': 'توقعات أحوال الطقس في العديد من مناطق المملكة اليوم الثلاثاء. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليومه الثلاثاء، أن يظل الطقس حارا بكل من سهول تادلة والرحامنة ومنطقة السايس ووالماس والجنوب الشرقي والمنطقة الشرقية وداخل الأقاليم الجنوبية. ويرتقب نزول قطرات مطرية أو زخات رعدية مصحوبة بهبات رياح وذلك فوق مرتفعات الأطلس والجنوب الشرقي والمنطقة الشرقية وشرق الريف. وستكون السماء غائمة جزئيا بالأقاليم الصحراوية …  توقعات أحوال الطقس في العديد من مناطق المملكة اليوم الثلاثاء     .', 'size': 2}], 'main_title': 'طقس حار مع زخات مطرية متوقع اليوم الثلاثاء'}, {'community_id': '7', 'articles': [{'id': '69', 'title': 'نشرة إنذارية: موجة حر وزخات رعدية مصحوبة بالبر د وبهبات رياح مرتقبة من الإثنين إلى الجمعة بعدد من مناطق المملكة', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/national/410493.html', 'summary': 'نشرة إنذارية: موجة حر وزخات رعدية مصحوبة بالبر د وبهبات رياح مرتقبة من الإثنين إلى الجمعة بعدد من مناطق المملكة. أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل موجة حر من اليوم الاثنين إلى يوم الجمعة المقبل، وزخات رعدية مصحوبة بتساقط البر د وبهبات رياح', 'size': 4}, {'id': '140', 'title': 'موجة حر وزخات رعدية مصحوبة بالبرد ورياح مرتقبة\xa0بعدد من مناطق المملكة', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1090679.html', 'summary': 'موجة حر وزخات رعدية مصحوبة بالبرد ورياح مرتقبة بعدد من مناطق المملكة. أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل موجة حر من اليوم الثلاثاء إلى يوم الجمعة المقبل، وزخات رعدية مصحوبة بتساقط البرد وبهبات رياح اليوم الثلاثاء، بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة برتقالي، أنه من المرتقب تسجيل درجات حرارة تتراوح ما بين 40 و44 درجة اليوم الثلاثاء وغدا الأربعاء ظهرت المقالة موجة حر وزخات رعدية مصحوبة بالبرد ورياح مرتقبة بعدد من مناطق المملكة  .', 'size': 4}, {'id': '157', 'title': 'نشرة إنذارية: موجة حر وزخات رعدية مصحوبة بالبرد ورياح من الثلاثاء إلى الجمعة', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%86%d8%b4%d8%b1%d8%a9-%d8%a5%d9%86%d8%b0%d8%a7%d8%b1%d9%8a%d8%a9-%d9%85%d9%88%d8%ac%d8%a9-%d8%ad%d8%b1-%d9%88%d8%b2%d8%ae%d8%a7%d8%aa-%d8%b1%d8%b9%d8%af%d9%8a%d8%a9-%d9%85%d8%b5%d8%ad%d9%88%d8%a8-3/', 'summary': 'نشرة إنذارية: موجة حر وزخات رعدية مصحوبة بالبرد ورياح من الثلاثاء إلى الجمعة. أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل موجة حر من اليوم الثلاثاء إلى يوم الجمعة المقبل، وزخات رعدية مصحوبة بتساقط البرد وبهبات رياح اليوم الثلاثاء، بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة برتقالي، أنه من المرتقب تسجيل درجات حرارة تتراوح ما بين 40 و44 درجة اليوم الثلاثاء وغدا الأربعاء  نشرة إنذارية: موجة حر وزخات رعدية مصحوبة بالبرد ورياح من الثلاثاء إلى الجمعة     .', 'size': 4}, {'id': '224', 'title': 'نشرة إنذارية: موجة حر وزخات رعدية مصحوبة بالبرَد وبهبات رياح مرتقبة بعدد من مناطق المملكة', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%86%d8%b4%d8%b1%d8%a9-%d8%a5%d9%86%d8%b0%d8%a7%d8%b1%d9%8a%d8%a9-%d9%85%d9%88%d8%ac%d8%a9-%d8%ad%d8%b1-%d9%88%d8%b2%d8%ae%d8%a7%d8%aa-%d8%b1%d8%b9%d8%af%d9%8a%d8%a9-%d9%85%d8%b5%d8%ad%d9%88%d8%a8-4/', 'summary': 'نشرة إنذارية: موجة حر وزخات رعدية مصحوبة بالبرَد وبهبات رياح مرتقبة بعدد من مناطق المملكة. أفادت المديرية العامة للأرصاد الجوية، بأنه يرتقب تسجيل موجة حر من الثلاثاء إلى الجمعة المقبل، وزخات رعدية مصحوبة بتساقط البرَد وبهبات رياح اليوم الثلاثاء، بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة برتقالي، أنه من المرتقب تسجيل درجات حرارة تتراوح ما بين 40 و44 درجة اليوم الثلاثاء وغدا الأربعاء …  نشرة إنذارية: موجة حر وزخات رعدية مصحوبة بالبرَد وبهبات رياح مرتقبة بعدد من مناطق المملكة     .', 'size': 4}], 'main_title': 'نشرة إنذارية: موجة حر وزخات رعدية مصحوبة بالبر د وبهبات رياح مرتقبة من الإثنين إلى الجمعة بعدد من مناطق المملكة'}, {'community_id': '4', 'articles': [{'id': '90', 'title': 'توقيف قائد بعمالة مراكش للاشتباه في تورطه في قضية فساد', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/410517.html', 'summary': 'توقيف قائد بعمالة مراكش للاشتباه في تورطه في قضية فساد. في إطار تتبعها اليومي لأداء رجال السلطة وحرصا منها على تقيدهم الدائم بأخلاقيات المرفق العام، قامت وزارة الداخلية بتوقيف قائد بعمالة مراكش، وذلك على خلفية', 'size': 4}, {'id': '113', 'title': 'بسبب تورطه بإحدى جرائم الفساد.. توقيف قائد بعمالة مراكش', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a8%d8%b3%d8%a8%d8%a8-%d8%aa%d9%88%d8%b1%d8%b7%d9%87-%d8%a8%d8%a5%d8%ad%d8%af%d9%89-%d8%ac%d8%b1%d8%a7%d8%a6%d9%85-%d8%a7%d9%84%d9%81%d8%b3%d8%a7%d8%af-%d8%aa%d9%88%d9%82%d9%8a%d9%81-%d9%82%d8%a7/', 'summary': 'بسبب تورطه بإحدى جرائم الفساد.. توقيف قائد بعمالة مراكش. في إطار تتبعها اليومي لأداء رجال السلطة وحرصا منها على تقيدهم الدائم بأخلاقيات المرفق العام، قامت وزارة الداخلية بتوقيف قائد بعمالة مراكش، وذلك على خلفية فتح بحث قضائي، تحت إشراف النيابة العامة المختصة، يتعلق بالاشتباه في تورطه بإحدى جرائم الفساد. وذكر بلاغ لوزارة الداخلية أنه سيتم تفعيل الإجراءات الإدارية المناسبة في حق المعني بالأمر، وفقا', 'size': 4}, {'id': '163', 'title': 'للاشتباه في تورطه بإحدى جرائم الفساد.. توقيف قائد بعمالة مراكش', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%84%d9%84%d8%a7%d8%b4%d8%aa%d8%a8%d8%a7%d9%87-%d9%81%d9%8a-%d8%aa%d9%88%d8%b1%d8%b7%d9%87-%d8%a8%d8%a5%d8%ad%d8%af%d9%89-%d8%ac%d8%b1%d8%a7%d8%a6%d9%85-%d8%a7%d9%84%d9%81%d8%b3%d8%a7%d8%af-%d8%aa/', 'summary': 'للاشتباه في تورطه بإحدى جرائم الفساد.. توقيف قائد بعمالة مراكش. في إطار تتبعها اليومي لأداء رجال السلطة وحرصا منها على تقيدهم الدائم بأخلاقيات المرفق العام، قامت وزارة الداخلية بتوقيف قائد بعمالة مراكش، وذلك على خلفية فتح بحث قضائي، تحت إشراف النيابة العامة المختصة، يتعلق بالاشتباه في تورطه بإحدى جرائم الفساد. وذكر بلاغ لوزارة الداخلية أنه سيتم تفعيل الإجراءات الإدارية المناسبة في حق المعني بالأمر، وفقا  للاشتباه في تورطه بإحدى جرائم الفساد.. توقيف قائد بعمالة مراكش     .', 'size': 4}, {'id': '207', 'title': 'توقيف قائد بعمالة مراكش للاشتباه في تورطه بإحدى جرائم الفساد', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/225640/', 'summary': 'توقيف قائد بعمالة مراكش للاشتباه في تورطه بإحدى جرائم الفساد. الرباط – في إطار تتبعها اليومي لأداء رجال السلطة وحرصا منها على تقيدهم الدائم بأخلاقيات المرفق العام، قامت وزارة الداخلية بتوقيف قائد بعمالة مراكش، وذلك على خلفية فتح بحث قضائي، تحت إشراف النيابة العامة المختصة، يتعلق بالاشتباه في تورطه بإحدى جرائم الفساد. وذكر بلاغ لوزارة الداخلية أنه سيتم تفعيل الإجراءات الإدارية المناسبة في حق', 'size': 4}], 'main_title': 'توقيف قائد بعمالة مراكش للاشتباه في تورطه في قضية فساد'}, {'community_id': '3', 'articles': [{'id': '110', 'title': 'حصيلة الودائع البنكية خلال 2024.. الأصول البنكية للأسر المغربية تبلغ 1109 مليار درهم', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%ad%d8%b5%d9%8a%d9%84%d8%a9-%d8%a7%d9%84%d9%88%d8%af%d8%a7%d8%a6%d8%b9-%d8%a7%d9%84%d8%a8%d9%86%d9%83%d9%8a%d8%a9-%d8%ae%d9%84%d8%a7%d9%84-2024-%d8%a7%d9%84%d8%a3%d8%b5%d9%88%d9%84-%d8%a7%d9%84/', 'summary': 'حصيلة الودائع البنكية خلال 2024.. الأصول البنكية للأسر المغربية تبلغ 1109 مليار درهم. أفاد التقرير السنوي الثاني عشر حول الاستقرار المالي أن الأصول المالية للأسر واصلت نموها لتبلغ 1109 مليار درهم في سنة 2024، أي بزيادة قدرها 8,1 في المائة مقارنة بالسنة السابقة. وأوضح التقرير الصادر عن بنك المغرب، وهيئة مراقبة التأمينات والاحتياط الاجتماعي، والهيئة المغربية لسوق الرساميل أن هذا الارتفاع انعكس بشكل أساسي على مستوى الودائع البنكية', 'size': 3}, {'id': '159', 'title': 'مدخرات المغاربة بلغت 1109 مليارات درهم خلال 2024', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%85%d8%af%d8%ae%d8%b1%d8%a7%d8%aa-%d8%a7%d9%84%d9%85%d8%ba%d8%a7%d8%b1%d8%a8%d8%a9-%d8%a8%d9%84%d8%ba%d8%aa-1109-%d9%85%d9%84%d9%8a%d8%a7%d8%b1-%d8%af%d8%b1%d9%87%d9%85-%d8%ae%d9%84%d8%a7%d9%84-202/', 'summary': 'مدخرات المغاربة بلغت 1109 مليارات درهم خلال 2024. أفاد التقرير السنوي الثاني عشر حول الاستقرار المالي أن الأصول المالية للأسر واصلت نموها لتبلغ 1109 مليارات درهم في سنة 2024، أي بزيادة قدرها 8,1 في المائة مقارنة بالسنة السابقة. وأوضح التقرير الصادر عن بنك المغرب، وهيئة مراقبة التأمينات والاحتياط الاجتماعي، والهيئة المغربية لسوق الرساميل أن هذا الارتفاع انعكس بشكل أساسي على مستوى الودائع البنكية  مدخرات المغاربة بلغت 1109 مليارات درهم خلال 2024     .', 'size': 3}, {'id': '225', 'title': 'ارتفاع القروض الاستهلاكية في المغرب إلى 162 مليار درهم خلال سنة 2024', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d8%b1%d8%aa%d9%81%d8%a7%d8%b9-%d8%a7%d9%84%d9%82%d8%b1%d9%88%d8%b6-%d8%a7%d9%84%d8%a7%d8%b3%d8%aa%d9%87%d9%84%d8%a7%d9%83%d9%8a%d8%a9-%d9%81%d9%8a-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d8%a5/', 'summary': 'ارتفاع القروض الاستهلاكية في المغرب إلى 162 مليار درهم خلال سنة 2024. أفاد التقرير السنوي الثاني عشر حول الاستقرار المالي، الصادر عن بنك المغرب وهيئة مراقبة التأمينات والاحتياط الاجتماعي والهيئة المغربية لسوق الرساميل، بأن جاري القروض الاستهلاكية بلغ 162 مليار درهم خلال سنة 2024، مسجلا ارتفاعا بنسبة 7,9 في المائة، مقارنة بـ6,1 في المائة سنة 2023. ويعكس هذا النمو الإيجابي زيادة بنسبة 11,5 في المائة …  ارتفاع القروض الاستهلاكية في المغرب إلى 162 مليار درهم خلال سنة 2024     .', 'size': 3}], 'main_title': 'حصيلة الودائع البنكية خلال 2024.. الأصول البنكية للأسر المغربية تبلغ 1109 مليار درهم'}, {'community_id': '6', 'articles': [{'id': '147', 'title': 'سيارة تيسلا الذكية تتسبب في حادثة دهس خطيرة بمارينا أكادير', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1090629.html', 'summary': 'سيارة تيسلا الذكية تتسبب في حادثة دهس خطيرة بمارينا أكادير. أفادت مصادر مطلعة أن سيارة ذكية من نوع “تيسلا” تسببت مساء الاثنين، في حادث دهس خطير عند مدخل مارينا أكادير، بعدما فقد السائق السيطرة عليها بسبب خلل تقني مفاجئ. ذات المصادر، أكدت أن الحادث أسفر عن إصابة رجل بجروح بليغة، استدعت نقله في حالة حرجة إلى المركز الاستشفائي الجهوي الحسن الثاني، فيما أصيبت زوجته التي ظهرت المقالة سيارة تيسلا الذكية تتسبب في حادثة دهس خطيرة بمارينا أكادير  .', 'size': 2}, {'id': '174', 'title': 'فقدان السيطرة على سيارة تيسلا يخلف حادثة خطيرة بمارينا أكادير', 'source': 'rue20.com', 'link': 'https://rue20.com/926562.html', 'summary': 'فقدان السيطرة على سيارة تيسلا يخلف حادثة خطيرة بمارينا أكادير.  . متابعة شهدت مارينا أكادير، مساء الإثنين 4 غشت 2025، حادث سير خطير، بعدما دهست سيارة من نوع “تيسلا” رجلًا وزوجته. ووفقًا لمصادر محلية، فإن الحادث نجم عن خلل تقني في ذاكرة نظام القيادة الذكية للسيارة، ما تسبب في فقدان السائق السيطرة على المركبة، ووقوع الاصطدام بشكل مفاجئ. وقد أسفر الحادث عن إصابة الخبر فقدان السيطرة على سيارة تيسلا يخلف حادثة خطيرة بمارينا أكادير  .', 'size': 2}], 'main_title': 'سيارة تيسلا الذكية تتسبب في حادثة دهس خطيرة بمارينا أكادير'}, {'community_id': '8', 'articles': [{'id': '158', 'title': 'كأس العالم لأقل من 17 سنة.. المنتخب الوطني يخوض تجمعا إعداديا مغلقا بسلا', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%83%d8%a3%d8%b3-%d8%a7%d9%84%d8%b9%d8%a7%d9%84%d9%85-%d9%84%d8%a3%d9%82%d9%84-%d9%85%d9%86-17-%d8%b3%d9%86%d8%a9-%d8%a7%d9%84%d9%85%d9%86%d8%aa%d8%ae%d8%a8-%d8%a7%d9%84%d9%88%d8%b7%d9%86%d9%8a/', 'summary': 'كأس العالم لأقل من 17 سنة.. المنتخب الوطني يخوض تجمعا إعداديا مغلقا بسلا. يخوض المنتخب الوطني المغربي لكرة القدم لأقل من 17 سنة، ابتداء من الاثنين، تجمعا إعداديا مغلقا بمركب محمد السادس لكرة القدم بالمعمورة، استعدادا لكأس العالم المقبلة لهذه الفئة بقطر. وذكر بلاغ للجامعة الملكية المغربية لكرة القدم أن هذا التجمع الإعدادي، الذي يمتد إلى غاية 22 غشت الجاري، يأتي للوقوف على الجاهزية البدنية والتقنية للاعبين. ولهذا  كأس العالم لأقل من 17 سنة.. المنتخب الوطني يخوض تجمعا إعداديا مغلقا بسلا     .', 'size': 2}, {'id': '185', 'title': 'كأس العالم لأقل من 17 سنة.. المنتخب الوطني يخوض تجمعا إعداديا', 'source': 'machahid24.com', 'link': 'https://machahid24.com/sport/471649.html', 'summary': 'كأس العالم لأقل من 17 سنة.. المنتخب الوطني يخوض تجمعا إعداديا. يخوض المنتخب الوطني المغربي لكرة القدم لأقل من 17 سنة، ابتداء من الاثنين، تجمعا إعداديا مغلقا بمركب محمد السادس لكرة القدم بالمعمورة، وذلك استعدادا لكأس العالم المقبلة لهذه الفئة بقطر. وذكر بلاغ للجامعة الملكية المغربية لكرة القدم أن هذا التجمع الإعدادي، الذي يمتد إلى غاية 22 غشت الجاري، يأتي للوقوف على الجاهزية البدنية والتقنية للاعبين. …', 'size': 2}], 'main_title': 'كأس العالم لأقل من 17 سنة.. المنتخب الوطني يخوض تجمعا إعداديا مغلقا بسلا'}, {'community_id': '5', 'articles': [{'id': '162', 'title': 'بتنسيق مع "لادجيد".. مالي تعلن تحرير أربعة سائقي شاحنات مغاربة', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a8%d8%aa%d9%86%d8%b3%d9%8a%d9%82-%d9%85%d8%b9-%d9%84%d8%a7%d8%af%d8%ac%d9%8a%d8%af-%d9%85%d8%a7%d9%84%d9%8a-%d8%aa%d8%b9%d9%84%d9%86-%d8%aa%d8%ad%d8%b1%d9%8a%d8%b1-%d8%a3%d8%b1%d8%a8%d8%b9/', 'summary': 'بتنسيق مع "لادجيد".. مالي تعلن تحرير أربعة سائقي شاحنات مغاربة. أعلنت حكومة جمهورية مالي، أمس الاثنين، أنه تم مساء الأحد تحرير أربعة سائقي شاحنات مغاربة كانوا قد اختطفوا في يناير الماضي بشمال شرق بوركينا فاسو قرب الحدود مع النيجر. وجاء في بلاغ للحكومة المالية، أوردته القناة الرسمية، أن "حكومة جمهورية مالي تعلم الرأيين الوطني والدولي أن أربعة سائقي شاحنات مغاربة كانوا قد اختطفوا في 18  بتنسيق مع "لادجيد".. مالي تعلن تحرير أربعة سائقي شاحنات مغاربة     .', 'size': 5}, {'id': '183', 'title': 'الحكومة المالية تعلن عن تحرير 4 سائقي شاحنات مغاربة', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/471655.html', 'summary': 'الحكومة المالية تعلن عن تحرير 4 سائقي شاحنات مغاربة. أعلنت حكومة جمهورية مالي، اليوم الاثنين، أنه تم مساء أمس الأحد تحرير أربعة سائقي شاحنات مغاربة كانوا قد اختطفوا في يناير الماضي بشمال شرق بوركينا فاسو قرب الحدود مع النيجر. وجاء في بلاغ للحكومة المالية، أوردته القناة الرسمية، أن “حكومة جمهورية مالي تعلم الرأيين الوطني والدولي أن أربعة سائقي شاحنات مغاربة كانوا قد اختطفوا في …', 'size': 5}, {'id': '197', 'title': 'تحرير 4 سائقي شاحنات مغاربة عن طريق مالي', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%aa%d8%ad%d8%b1%d9%8a%d8%b1-4-%d8%b3%d8%a7%d8%a6%d9%82%d9%8a-%d8%b4%d8%a7%d8%ad%d9%86%d8%a7%d8%aa-%d9%85%d8%ba%d8%a7%d8%b1%d8%a8%d8%a9-%d8%b9%d9%86-%d8%b7%d8%b1%d9%8a%d9%82-%d9%85%d8%a7%d9%84%d9%8a/', 'summary': 'تحرير 4 سائقي شاحنات مغاربة عن طريق مالي. أعلنت حكومة جمهورية مالي، اليوم الاثنين، أنه تم مساء أمس الأحد تحرير أربعة سائقي شاحنات مغاربة كانوا قد اختطفوا في يناير الماضي بشمال شرق بوركينا فاسو  تحرير 4 سائقي شاحنات مغاربة عن طريق مالي     .', 'size': 4}, {'id': '230', 'title': 'تنسيق استخباراتي مالي – مغربي يُمكّن من تحرير سائقي شاحنات مغاربة اختطفوا يناير الماضي ببوركينا فاسو', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%aa%d9%86%d8%b3%d9%8a%d9%82-%d8%a7%d8%b3%d8%aa%d8%ae%d8%a8%d8%a7%d8%b1%d8%a7%d8%aa%d9%8a-%d9%85%d8%a7%d9%84%d9%8a-%d9%85%d8%ba%d8%b1%d8%a8%d9%8a-%d9%8a%d9%8f%d9%85%d9%83%d9%91%d9%86-%d9%85%d9%86/', 'summary': 'تنسيق استخباراتي مالي – مغربي يُمكّن من تحرير سائقي شاحنات مغاربة اختطفوا يناير الماضي ببوركينا فاسو. أعلنت حكومة جمهورية مالي، اليوم الاثنين، أنه تم مساء أمس الأحد تحرير أربعة سائقي شاحنات مغاربة كانوا قد اختطفوا في يناير الماضي بشمال شرق بوركينا فاسو قرب الحدود مع النيجر. وجاء في بلاغ للحكومة المالية، أوردته القناة الرسمية، أن “حكومة جمهورية مالي تعلم الرأيين الوطني والدولي أن أربعة سائقي شاحنات مغاربة كانوا قد …  تنسيق استخباراتي مالي – مغربي يُمكّن من تحرير سائقي شاحنات مغاربة اختطفوا يناير الماضي ببوركينا فاسو     .', 'size': 4}, {'id': '324', 'title': 'باماكو.. تحرير أربعة سائقي شاحنات مغاربة', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/204663', 'summary': 'باماكو.. تحرير أربعة سائقي شاحنات مغاربة.  أعلنت حكومة جمهورية مالي،اليوم الاثنين، أنه تم مساء أمس الأحد تحرير أربعة سائقي شاحنات مغاربة كانوا قد اختطفوا في يناير الماضي بشمال شرق بوركينا فاسو قرب الحدود مع النيجر. وجاء في بلاغ للحكومة المالية، أوردته القناة الرسمية، أن “حكومة جمهورية مالي تعلم الرأيين الوطني والدولي أن أربعة سائقي شاحنات مغاربة كانوا قد اختطفوا', 'size': 5}], 'main_title': 'بتنسيق مع "لادجيد".. مالي تعلن تحرير أربعة سائقي شاحنات مغاربة'}, {'community_id': '9', 'articles': [{'id': '173', 'title': 'تيك توك تشن حملة واسعة بالمغرب وتحذف أزيد من مليون فيديو', 'source': 'rue20.com', 'link': 'https://rue20.com/926568.html', 'summary': 'تيك توك تشن حملة واسعة بالمغرب وتحذف أزيد من مليون فيديو.  | متابعة كشفت منصة تيك توك في تقريرها حول تطبيق قواعد المجتمع للربع الأول من عام 2025 عن حذف أكثر من 16.5 مليون مقطع فيديو حول العالم بسبب انتهاكها لسياسات المنصة، من بينها 1,040,981 فيديو تم حذفه في المغرب. ووفقًا للبيانات الواردة في التقرير، بلغ معدل الحذف الاستباقي في المغرب 98.9%، ما يشير الخبر تيك توك تشن حملة واسعة بالمغرب وتحذف أزيد من مليون فيديو  .', 'size': 2}, {'id': '335', 'title': '"تيك توك" تحكم قبضتها على المحتوى المغربي: حذف مليون فيديو في 3 أشهر!', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/410547.html', 'summary': '"تيك توك" تحكم قبضتها على المحتوى المغربي: حذف مليون فيديو في 3 أشهر!. في تقريرها الأخير حول إنفاذ إرشادات المجتمع، كشفت منصة "تيك توك" عن حذف 1,040,981 فيديو مخالف في المغرب خلال الربع الأول من سنة 2025، في', 'size': 2}, {'id': '388', 'title': '"تيك توك" تحذف أزيد من مليون فيديو من المحتوى المغربي', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%aa%d9%8a%d9%83-%d8%aa%d9%88%d9%83-%d8%aa%d8%ad%d8%b0%d9%81-%d8%a3%d8%b2%d9%8a%d8%af-%d9%85%d9%86-%d9%85%d9%84%d9%8a%d9%88%d9%86-%d9%81%d9%8a%d8%af%d9%8a%d9%88-%d9%85%d9%86-%d8%a7%d9%84%d9%85/', 'summary': '"تيك توك" تحذف أزيد من مليون فيديو من المحتوى المغربي. كشف تقرير صادر عن منصة "تيك توك" بشأن "إنفاذ إرشادات المجتمع" للربع الأول من عام 2025، أن المنصة أزالت 1,040,981 فيديو مخالف خلال الربع الأول من العام، في المغرب وبلغ معدل الإزالة الاستباقية 98.9 في المائة من المحتوى المخالف دون بلاغات المستخدمين، بينما تمت إزالة 92.1 في المائة من المحتوى المخالف خلال أقل من 24  "تيك توك" تحذف أزيد من مليون فيديو من المحتوى المغربي     .', 'size': 3}], 'main_title': '"تيك توك" تحذف أزيد من مليون فيديو من المحتوى المغربي'}, {'community_id': '2', 'articles': [{'id': '180', 'title': 'فتح باب الترشيح للدورة الخامسة لمسابقة الأفلام القصيرة “المسيرة الخضراء من منظور صناع الصورة الشباب”', 'source': 'machahid24.com', 'link': 'https://machahid24.com/panorama/471666.html', 'summary': 'فتح باب الترشيح للدورة الخامسة لمسابقة الأفلام القصيرة “المسيرة الخضراء من منظور صناع الصورة الشباب”. أعلن المركز السينمائي المغربي عن فتح باب الترشيح للدورة الخامسة لمسابقة الأفلام القصيرة “المسيرة الخضراء من منظور صناع الصورة الشباب”. وأوضح المركز السينمائي، في بلاغ له، أن هذه المسابقة تنظم بتعاون مع وزارة الشباب والثقافة والتواصل، وتندرج في إطار الاحتفاء بالذكرى الـ50 للمسيرة الخضراء. وأشار المصدر ذاته إلى أن هذه التظاهرة، المفتوحة في وجه المخرجين …', 'size': 2}, {'id': '220', 'title': 'المركز السينمائي يفتح باب الترشيح لمسابقة الأفلام القصيرة عن المسيرة الخضراء', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%a7%d9%84%d9%85%d8%b1%d9%83%d8%b2-%d8%a7%d9%84%d8%b3%d9%8a%d9%86%d9%85%d8%a7%d8%a6%d9%8a-%d9%8a%d8%b9%d9%84%d9%86-%d9%81%d8%aa%d8%ad-%d8%a8%d8%a7%d8%a8-%d8%a7%d9%84%d8%aa%d8%b1%d8%b4%d9%8a%d8%ad/', 'summary': 'المركز السينمائي يفتح باب الترشيح لمسابقة الأفلام القصيرة عن المسيرة الخضراء. المساء اليوم: أعلن المركز السينمائي المغربي عن فتح باب الترشيح للدورة الخامسة لمسابقة الأفلام القصيرة “المسيرة الخضراء من منظور صناع الصورة الشباب”. وأوضح المركز السينمائي، في بيان له، أن هذه المسابقة تنظم بتعاون مع وزارة', 'size': 2}], 'main_title': 'فتح باب الترشيح للدورة الخامسة لمسابقة الأفلام القصيرة “المسيرة الخضراء من منظور صناع الصورة الشباب”'}, {'community_id': '0', 'articles': [{'id': '266', 'title': 'تكوين يجمع عسكريات أمميات بأكادير', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d8%aa%d9%83%d9%88%d9%8a%d9%86-%d9%8a%d8%ac%d9%85%d8%b9-%d8%b9%d8%b3%d9%83%d8%b1%d9%8a%d8%a7%d8%aa-%d8%a3%d9%85%d9%85%d9%8a%d8%a7%d8%aa-%d8%a8%d8%a3%d9%83%d8%a7%d8%af%d9%8a%d8%b1-1604439.html', 'summary': 'تكوين يجمع عسكريات أمميات بأكادير. بمقر قيادة القوات المسلحة الملكية للمنطقة الجنوبية بأكادير، انطلقت أمس الاثنين أشغال دورة تكوينية موجهة للنساء في عمليات الأمم المتحدة لحفظ السلام. تعرف هذه الدورة، التي تمتد لثلاثة أسابيع، مشاركة 23 امرأة عسكرية من 14 جنسية، لا سيما من القارة الإفريقية، وكذا من فرنسا، وألمانيا، وسويسرا، وكندا. وتندرج الدورة في إطار شراكة ثلاثية بين المغرب،  تكوين يجمع عسكريات أمميات بأكادير     - هسبريس جريدة إلكترونية مغربية .', 'size': 2}, {'id': '431', 'title': 'نساء الأمم المتحدة لحفظ السلام.. دورة تكوينية بمقر قيادة المنطقة الجنوبية بأكادير لفائدة عسكريات 14 بلدا', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/225650/', 'summary': 'نساء الأمم المتحدة لحفظ السلام.. دورة تكوينية بمقر قيادة المنطقة الجنوبية بأكادير لفائدة عسكريات 14 بلدا. أكادير – انطلقت، أمس الاثنين، بمقر قيادة القوات المسلحة الملكية للمنطقة الجنوبية بأكادير، أشغال دورة تكوينية موجهة للنساء في عمليات الأمم المتحدة لحفظ السلام. وتعرف هذه الدورة، التي تمتد لثلاثة أسابيع، مشاركة 23 امرأة عسكرية من 14 جنسية، لاسيما من القارة الإفريقية، وكذا من فرنسا، وألمانيا، وسويسرا، وكندا. وتندرج الدورة في إطار شراكة ثلاثية بين', 'size': 2}], 'main_title': 'تكوين يجمع عسكريات أمميات بأكادير'}, {'community_id': '10', 'articles': [{'id': '336', 'title': 'الإعلامي كريم حضري يتعرض لحادث خطير داخل منزله', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/410548.html', 'summary': 'الإعلامي كريم حضري يتعرض لحادث خطير داخل منزله. تعرض الإذاعي المغربي في "شدى إف إم"، كريم حضري، لحادث خطير داخل منزله، استدعى نقله على وجه السرعة إلى المستشفى. وقالت صفحة "شدى تيفي"، أن "الصحافي', 'size': 2}, {'id': '415', 'title': 'الصحافي كريم حضري يتعرض لحادث خطير داخل منزله وبنكيران يؤكد دعمه', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%a7%d9%84%d8%b5%d8%ad%d8%a7%d9%81%d9%8a-%d9%83%d8%b1%d9%8a%d9%85-%d8%ad%d8%b6%d8%b1%d9%8a-%d9%8a%d8%aa%d8%b9%d8%b1%d8%b6-%d9%84%d8%ad%d8%a7%d8%af%d8%ab-%d8%ae%d8%b7%d9%8a%d8%b1-%d8%af%d8%a7%d8%ae/', 'summary': 'الصحافي كريم حضري يتعرض لحادث خطير داخل منزله وبنكيران يؤكد دعمه. -متابعات تعرض الإذاعي المغربي في “شدى إف إم”، كريم حضري، لحادث خطير داخل منزله، استدعى نقله على وجه السرعة إلى المستشفى. وقالت صفحة “شدى تيفي”، أن “الصحافي كريم حضري...  الصحافي كريم حضري يتعرض لحادث خطير داخل منزله وبنكيران يؤكد دعمه     .', 'size': 2}], 'main_title': 'الإعلامي كريم حضري يتعرض لحادث خطير داخل منزله'}, {'community_id': '11', 'articles': [{'id': '343', 'title': 'انتخاب المغرب نائبا لرئيس مؤتمر الأمم المتحدة الثالث للبلدان النامية غير الساحلية', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/divers/410555.html', 'summary': 'انتخاب المغرب نائبا لرئيس مؤتمر الأمم المتحدة الثالث للبلدان النامية غير الساحلية. تم اليوم الثلاثاء بأوازا بتركمنستان، انتخاب المغرب في شخص السفير الممثل الدائم للمملكة لدى الأمم المتحدة، عمر هلال، نائبا لرئيس مؤتمر الأمم المتحدة الثالث للبلدان', 'size': 2}, {'id': '369', 'title': 'انتخاب المغرب نائبا لرئيس مؤتمر الأمم المتحدة للدول النامية غير الساحلية', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1090789.html', 'summary': 'انتخاب المغرب نائبا لرئيس مؤتمر الأمم المتحدة للدول النامية غير الساحلية. في شخص السفير الممثل الدائم للمملكة لدى الأمم المتحدة، عمر هلال. ظهرت المقالة انتخاب المغرب نائبا لرئيس مؤتمر الأمم المتحدة للدول النامية غير الساحلية  .', 'size': 2}], 'main_title': 'انتخاب المغرب نائبا لرئيس مؤتمر الأمم المتحدة الثالث للبلدان النامية غير الساحلية'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    