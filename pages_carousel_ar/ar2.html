<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 24/07/2025 - 18h30</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '87', 'title': 'السكتيوي يكشف عن اللائحة النهائية للمنتخب الوطني في الشان', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/sport/lionatlas/409813.html', 'summary': 'السكتيوي يكشف عن اللائحة النهائية للمنتخب الوطني في الشان. كشف الناخب الوطني للمنتخب المحلي لكرة القدم، طارق السكتيوي، اليوم الأربعاء بمركب محمد السادس بسلا، عن لائحة المنتخب المغربي المشاركة في بطولة إفريقيا للاعبين المحليين', 'size': 2}, {'id': '230', 'title': 'السكيتيوي يكشف لائحة اللاعبين في كأس إفريقيا للمحليين', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%a7%d9%84%d8%b3%d9%83%d9%8a%d8%aa%d9%8a%d9%88%d9%8a-%d9%8a%d9%83%d8%b4%d9%81-%d9%84%d8%a7%d8%a6%d8%ad%d8%a9-%d8%a7%d9%84%d9%84%d8%a7%d8%b9%d8%a8%d9%8a%d9%86-%d9%81%d9%8a-%d9%83%d8%a3%d8%b3-%d8%a5/', 'summary': 'السكيتيوي يكشف لائحة اللاعبين في كأس إفريقيا للمحليين. المساء اليوم – سلا: كشف الناخب الوطني للمنتخب المحلي لكرة القدم، طارق السكتيوي، اليوم الأربعاء بمركب محمد السادس بسلا، عن لائحة المنتخب المغربي المشاركة في بطولة إفريقيا للاعبين المحليين 2024، المقرر إجراؤها من 2 إلى', 'size': 2}], 'main_title': 'السكتيوي يكشف عن اللائحة النهائية للمنتخب الوطني في الشان'}, {'community_id': '4', 'articles': [{'id': '88', 'title': 'مالي تجر الجزائر نحو المحاسبة الدولية بعد ضبط شحنة أسلحة موجهة للإرهاب(وثيقة)', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/world/409814.html', 'summary': 'مالي تجر الجزائر نحو المحاسبة الدولية بعد ضبط شحنة أسلحة موجهة للإرهاب(وثيقة). في بيان رسمي شديد اللهجة، كشفت رئاسة الأركان العامة للجيش المالي عن إحباط محاولة كبيرة لتمرير شحنة ضخمة من المعدات اللوجستيكية نحو تنظيم إرهابي ينشط', 'size': 2}, {'id': '339', 'title': 'فضيحة جديدة لنظام الكابرانات.. مالي تضبط شحنة أسلحة قادمة من الجزائر موجهة لجماعة إرهابية', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%81%d8%b6%d9%8a%d8%ad%d8%a9-%d8%ac%d8%af%d9%8a%d8%af%d8%a9-%d9%84%d9%86%d8%b8%d8%a7%d9%85-%d8%a7%d9%84%d9%83%d8%a7%d8%a8%d8%b1%d8%a7%d9%86%d8%a7%d8%aa-%d9%85%d8%a7%d9%84%d9%8a-%d8%aa%d8%b6%d8%a8/', 'summary': 'فضيحة جديدة لنظام الكابرانات.. مالي تضبط شحنة أسلحة قادمة من الجزائر موجهة لجماعة إرهابية. \u200eيتواصل تورط نظام الكابرانات الجزائري في دعم الميليشيات والجماعات الإرهابية الناشطة بمنطقة الساحل، حيث تؤكد التقارير الاستخباراتية حجم الدعم والجهد الذي تبذله الجزائر لزعزعة أمن واستقرار دول الجوار. \u200eوفي أحدث التدخلات الكابرانية الداعمة للإرهاب في منطقة الساحل، أعلنت هيئة الأركان العامة للقوات المسلحة في مالي عن إحباط عملية تهريب كبيرة كانت في طريقها إلى تنظيم', 'size': 2}], 'main_title': 'مالي تجر الجزائر نحو المحاسبة الدولية بعد ضبط شحنة أسلحة موجهة للإرهاب(وثيقة)'}, {'community_id': '2', 'articles': [{'id': '91', 'title': 'غامبيا تجدد دعمها لسيادة المغرب على الصحراء', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/politic/409817.html', 'summary': 'غامبيا تجدد دعمها لسيادة المغرب على الصحراء. جددت جمهورية غامبيا دعمها لسيادة المغرب على منطقة الصحراء ولمبادرة الحكم الذاتي باعتبارها الحل الوحيد لتسوية النزاع الإقليمي حول الصحراء المغربية. وتم التأكيد على هذا الموقف', 'size': 2}, {'id': '433', 'title': 'غامبيا تجدد دعمها لمقترح الحكم الذاتي في الصحراء', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%ba%d8%a7%d9%85%d8%a8%d9%8a%d8%a7-%d8%aa%d8%ac%d8%af%d8%af-%d8%af%d8%b9%d9%85%d9%87%d8%a7-%d9%84%d9%85%d9%82%d8%aa%d8%b1%d8%ad-%d8%a7%d9%84%d8%ad%d9%83%d9%85-%d8%a7%d9%84%d8%b0%d8%a7%d8%aa%d9%8a/', 'summary': 'غامبيا تجدد دعمها لمقترح الحكم الذاتي في الصحراء. المساء اليوم؛ جددت غامبيا دعمها لسيادة المغرب على منطقة الصحراء ولمبادرة الحكم الذاتي باعتبارها الحل الوحيد لتسوية النزاع الإقليمي حول الصحراء المغربية. وتم التأكيد على هذا الموقف في بيان مشترك تم التوقيع عليه عقب محادثات', 'size': 2}], 'main_title': 'غامبيا تجدد دعمها لسيادة المغرب على الصحراء'}, {'community_id': '9', 'articles': [{'id': '107', 'title': 'رغم المنافسة الحادة..اتصالات المغرب تُسجل نتائج قوية في النصف الأول من 2025', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/economy/409837.html', 'summary': 'رغم المنافسة الحادة..اتصالات المغرب تُسجل نتائج قوية في النصف الأول من 2025. حققت مجموعة اتصالات المغرب رقم معاملات موحد بلغ 18,04 مليار درهم مع متم شهر يونيو 2025، مسجلا ارتفاعا بنسبة 0,9 في المائة. وذكرت المجموعة، في بلاغ', 'size': 2}, {'id': '177', 'title': 'اتصالات المغرب تحقق رقم معاملات موحد بقيمة 18,04 مليار درهم', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a7%d8%aa%d8%b5%d8%a7%d9%84%d8%a7%d8%aa-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d8%aa%d8%ad%d9%82%d9%82-%d8%b1%d9%82%d9%85-%d9%85%d8%b9%d8%a7%d9%85%d9%84%d8%a7%d8%aa-%d9%85%d9%88%d8%ad%d8%af-%d8%a8/', 'summary': 'اتصالات المغرب تحقق رقم معاملات موحد بقيمة 18,04 مليار درهم. حققت مجموعة اتصالات المغرب رقم معاملات موحد بلغ 18,04 مليار درهم مع متم شهر يونيو 2025، مسجلا ارتفاعا بنسبة 0,9 في المائة. وذكرت المجموعة، في بلاغ لها حول نتائجها المالية، أن تراجع أنشطة الهاتف المحمول بالمغرب قابله تسارع نمو عائدات الفروع (Moov Africa) ونمو (Data Fixe) بالمغرب. وأضاف المصدر ذاته، أن رقم المعاملات الموحد خلال  اتصالات المغرب تحقق رقم معاملات موحد بقيمة 18,04 مليار درهم     .', 'size': 2}], 'main_title': 'رغم المنافسة الحادة..اتصالات المغرب تُسجل نتائج قوية في النصف الأول من 2025'}, {'community_id': '11', 'articles': [{'id': '114', 'title': 'في تقييم لحصيلة السنة الانتدابية.. التقدم والاشتراكية يسجل “عجز” الحكومة عن الوفاء بمعظم التزاماتها', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%81%d9%8a-%d8%aa%d9%82%d9%8a%d9%8a%d9%85-%d9%84%d8%ad%d8%b5%d9%8a%d9%84%d8%a9-%d8%a7%d9%84%d8%b3%d9%86%d8%a9-%d8%a7%d9%84%d8%a7%d9%86%d8%aa%d8%af%d8%a7%d8%a8%d9%8a%d8%a9-%d8%a7%d9%84%d8%aa%d9%82/', 'summary': 'في تقييم لحصيلة السنة الانتدابية.. التقدم والاشتراكية يسجل “عجز” الحكومة عن الوفاء بمعظم التزاماتها. سجل النائب البرلماني رشيد حموني، رئيس فريق التقدم والاشتراكية في مجلس النواب، “عجز” الحكومة عن الوفاء بمعظم التزاماتها، بعد أربع سنوات من الانتداب الحكومي. الدعم الحكومي والدعم الاجتماعي المباشر وأوضح البرلماني حموني، في قراءة سياسية تقييمية بخصوص حصيلة السنة الانتدابية، التشريعية والحكومية 2024-2025، إجراءات الدعم الحكومي “معظمها لم يكن له أثر، أو أن أثره محدود', 'size': 2}, {'id': '380', 'title': 'تقييم السنة التشريعية.. التقدم والاشتراكية يوجه انتقادات لاذعة لأداء الحكومة', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%aa%d9%82%d9%8a%d9%8a%d9%85-%d8%a7%d9%84%d8%b3%d9%86%d8%a9-%d8%a7%d9%84%d8%aa%d8%b4%d8%b1%d9%8a%d8%b9%d9%8a%d8%a9-%d8%a7%d9%84%d8%aa%d9%82%d8%af%d9%85-%d9%88%d8%a7%d9%84%d8%a7%d8%b4%d8%aa%d8%b1/', 'summary': 'تقييم السنة التشريعية.. التقدم والاشتراكية يوجه انتقادات لاذعة لأداء الحكومة. كشف رئيس فريق التقدم والاشتراكية بمجلس النواب، رشيد حموني، أن الحكومة تعجز عن الوفاء بمعظم التزاماتها، فبفعل الغلاء المتواصل في أسعار معظم المواد الاستهلاكية والخدمات، تراجعت القدرة الشرائية لحواليْ 80 في المائة من الأسر المغربية، وأقل من 2 في المائة من الأسر لها القُدرة على الادخار. ورغم التحسُّن الطفيف في معدل التضخم إلاَّ أن الأسعار  تقييم السنة التشريعية.. التقدم والاشتراكية يوجه انتقادات لاذعة لأداء الحكومة     .', 'size': 2}], 'main_title': 'في تقييم لحصيلة السنة الانتدابية.. التقدم والاشتراكية يسجل “عجز” الحكومة عن الوفاء بمعظم التزاماتها'}, {'community_id': '6', 'articles': [{'id': '141', 'title': 'الرجاء يعلن عن خطوة غير مسبوقة', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-581791.html', 'summary': 'الرجاء يعلن عن خطوة غير مسبوقة. أعلن نادي الرجاء الرياضي عن إطلاق حملة انخراط جديدة تحت شعار “لا يعني أن تكون منخرطا فقط، بل أن تكون من صنّاع القرار”. وتهدف هذه المبادرة إلى بلوغ رقم قياسي غير مسبوق يتمثل في استقطاب 1000 منخرط، في سابقة هي الأولى من نوعها في تاريخ النادي، وذلك بهدف تعزيز مشاركة الجماهير الرجاوية', 'size': 2}, {'id': '169', 'title': 'اليوم يبدأ التاريخ.. الرجاء يطلق حملة 1000 منخرط', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d9%8a%d8%a8%d8%af%d8%a3-%d8%a7%d9%84%d8%aa%d8%a7%d8%b1%d9%8a%d8%ae-%d8%a7%d9%84%d8%b1%d8%ac%d8%a7%d8%a1-%d9%8a%d8%b7%d9%84%d9%82-%d8%ad%d9%85%d9%84%d8%a9-1000-%d9%85/', 'summary': 'اليوم يبدأ التاريخ.. الرجاء يطلق حملة 1000 منخرط. أعلن نادي الرجاء الرياضي، اليوم الخميس، عن إطلاق حملة انخراط غير مسبوقة تستهدف بلوغ رقم قياسي يتمثل في 1000 منخرط. ويهدف النادي بهاته الخطوة إلى توسيع قاعدة المشاركة الجماهيرية وتعزيز دور المناصرين في صناعة القرار داخل النادي. وأفاد بلاغ رسمي صادر عن إدارة الرجاء أن الحملة ستطلق تحت شعار: "أن تكون منخرطا لا يعني فقط  اليوم يبدأ التاريخ.. الرجاء يطلق حملة 1000 منخرط     .', 'size': 4}, {'id': '367', 'title': 'بهدف بلوغ 1000 عضو .. الرجاء يطلق حملة استثنائية واسعة للانخراط', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1087894.html', 'summary': 'بهدف بلوغ 1000 عضو .. الرجاء يطلق حملة استثنائية واسعة للانخراط. أطلق نادي الرجاء الرياضي، صباح يومه الأربعاء، حملة جديدة للانخراط تهدف إلى الوصول إلى 1000 منخرط سيستفيدون من مجموعة من الصلاحيات داخل النادي. وأكد الفريق الأخضر في بلاغ له أن الهدف من هذه الحملة هو تحويل برلمان الرجاء إلى قوة تقريرية حقيقية تعكس تطلعات الجماهير، خاصة في هذه المرحلة التي يعيش فيها النادي تحولات كثيرة، ظهرت المقالة بهدف بلوغ 1000 عضو .. الرجاء يطلق حملة استثنائية واسعة للانخراط  .', 'size': 2}, {'id': '401', 'title': 'الرجاء يطلق حملة 1000 منخرط', 'source': 'machahid24.com', 'link': 'https://machahid24.com/sport/470511.html', 'summary': 'الرجاء يطلق حملة 1000 منخرط. أعلن نادي الرجاء الرياضي، اليوم الخميس، عن إطلاق حملة انخراط غير مسبوقة تستهدف بلوغ رقم قياسي يتمثل في 1000 منخرط. وتهدف هذه الخطوة، حسب بلاغ صادر عن إدارة الفريق الأخضر، إلى توسيع قاعدة المشاركة الجماهيرية وتعزيز دور المناصرين في صناعة القرار داخل النادي. وأفاد ذات المصدر أن الحملة ستطلق تحت شعار: “أن تكون منخرطا لا …', 'size': 2}], 'main_title': 'اليوم يبدأ التاريخ.. الرجاء يطلق حملة 1000 منخرط'}, {'community_id': '1', 'articles': [{'id': '173', 'title': 'مكتب الصرف: 62 في المائة من المبادلات التجارية تمت مع أوروبا خلال 2024', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%85%d9%83%d8%aa%d8%a8-%d8%a7%d9%84%d8%b5%d8%b1%d9%81-62-%d9%81%d9%8a-%d8%a7%d9%84%d9%85%d8%a7%d8%a6%d8%a9-%d9%85%d9%86-%d8%a7%d9%84%d9%85%d8%a8%d8%a7%d8%af%d9%84%d8%a7%d8%aa-%d8%a7%d9%84%d8%aa/', 'summary': 'مكتب الصرف: 62 في المائة من المبادلات التجارية تمت مع أوروبا خلال 2024. أفاد مكتب الصرف أن المبادلات التجارية للمغرب ما تزال تهيمن عليها أوروبا، حيث بلغت حصتها 62 في المائة خلال سنة 2024، مقابل 63،2 في المائة سنة 2023. وأوضح المكتب، في تقريره السنوي حول التجارة الخارجية للمغرب، أن 56،4 في المائة من الواردات مصدرها أوروبا، في حين تم توجيه 71،4 في المائة من الصادرات نحوها. وحسب  مكتب الصرف: 62 في المائة من المبادلات التجارية تمت مع أوروبا خلال 2024     .', 'size': 2}, {'id': '436', 'title': 'أوروبا تستحوذ على 62% من المبادلات التجارية للمغرب في 2024', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a3%d9%88%d8%b1%d9%88%d8%a8%d8%a7-%d8%aa%d8%b3%d8%aa%d8%ad%d9%88%d8%b0-%d8%b9%d9%84%d9%89-62-%d9%85%d9%86-%d8%a7%d9%84%d9%85%d8%a8%d8%a7%d8%af%d9%84%d8%a7%d8%aa-%d8%a7%d9%84%d8%aa%d8%ac%d8%a7%d8%b1/', 'summary': 'أوروبا تستحوذ على 62% من المبادلات التجارية للمغرب في 2024. أكد مكتب الصرف أن المبادلات التجارية للمغرب ظلت متركزة بشكل كبير مع أوروبا خلال سنة 2024، إذ بلغت حصتها 62 في المائة من إجمالي المبادلات، مقابل 63,2 في المائة سنة 2023، وهو ما يعكس استمرار هيمنة الشركاء الأوروبيين على العلاقات الاقتصادية للمملكة رغم جهود تنويع الأسواق. وأوضح التقرير السنوي لمكتب الصرف حول التجارة …  أوروبا تستحوذ على 62% من المبادلات التجارية للمغرب في 2024     .', 'size': 2}], 'main_title': 'مكتب الصرف: 62 في المائة من المبادلات التجارية تمت مع أوروبا خلال 2024'}, {'community_id': '8', 'articles': [{'id': '176', 'title': 'المغرب يسجل فائضا تجاريا بـ15،9 مليار درهم مع فرنسا خلال 2024', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d9%8a%d8%b3%d8%ac%d9%84-%d9%81%d8%a7%d8%a6%d8%b6%d8%a7-%d8%aa%d8%ac%d8%a7%d8%b1%d9%8a%d8%a7-%d8%a8%d9%8015%d8%8c9-%d9%85%d9%84%d9%8a%d8%a7%d8%b1-%d8%af%d8%b1/', 'summary': 'المغرب يسجل فائضا تجاريا بـ15،9 مليار درهم مع فرنسا خلال 2024. أفاد مكتب الصرف أن الميزان التجاري بين المغرب وفرنسا، ثاني شريك تجاري للمملكة، سجل فائضا بقيمة 15،9 مليار درهم، خلال سنة 2024، مقابل 11،9 مليار درهم سنة 2023. وأشار المكتب، في تقريره السنوي حول التجارة الخارجية للمغرب لسنة 2024، إلى أن هذا الميزان يسجل فائضا تجاريا منذ سنة 2017. وأبرز المصدر ذاته، أنه بالنسبة لإسبانيا،  المغرب يسجل فائضا تجاريا بـ15،9 مليار درهم مع فرنسا خلال 2024     .', 'size': 2}, {'id': '314', 'title': 'تقرير: المغرب يسجل فائضا تجاريا بـ15،9 مليار درهم مع فرنسا', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-643346.html', 'summary': 'تقرير: المغرب يسجل فائضا تجاريا بـ15،9 مليار درهم مع فرنسا. هبة بريس أفاد مكتب الصرف بأن الميزان التجاري بين المغرب وفرنسا، ثاني شريك تجاري للمملكة، سجل فائضا بقيمة 15،9 مليار درهم، خلال سنة 2024، مقابل 11،9 مليار درهم سنة 2023. وأشار المكتب، في تقريره السنوي حول التجارة الخارجية للمغرب لسنة 2024، إلى أن هذا الميزان يسجل فائضا تجاريا منذ سنة 2017. وأبرز المصدر ذاته، أنه بالنسبة لإسبانيا، الشريك التجاري الأول للمغرب، فقد ظل الميزان التجاري معها في حالة عجز، بلغ 18،2 مليار درهم خلال سنة 2024. وفي ما يتعلق بالمبادلات التجارية مع الصين، فقد سجلت عجزا تجاريا قدره 86،3 مليار درهم سنة 2024، مقابل 72،5 مليار درهم سنة 2023. كما أفاد مكتب الصرف بأن العجز التجاري مع الولايات المتحدة واصل تفاقمه ليبلغ 57 مليار درهم خلال السنة الماضية. في المقابل، سجل العجز التجاري مع ألمانيا تراجعا بقيمة 585 مليون درهم في سنة 2024 مقارنة ب 2023، ليستقر عند 16،4 مليار درهم.', 'size': 2}], 'main_title': 'المغرب يسجل فائضا تجاريا بـ15،9 مليار درهم مع فرنسا خلال 2024'}, {'community_id': '10', 'articles': [{'id': '325', 'title': 'الرباط : المجلس الأعلى للقنص يعقد دورته العادية برئاسة وزير الفلاحة', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/203975', 'summary': 'الرباط : المجلس الأعلى للقنص يعقد دورته العادية برئاسة وزير الفلاحة. الاحداث نت✍️م ع.الإدريسي عقد المجلس الأعلى للقنص، برئاسة وزير الفلاحة والصيد البحري والتنمية القروية والمياه والغابات أحمد البواري، اجتماعه يوم الخميس 24 يوليوز 2025 بمدينة الرباط، بحضور كل من المدير العام للوكالة الوطنية للمياه والغابات عبد الرحيم هومي و رئيس الجامعة الملكية المغربية للقنص أحمد الموساوي. وتميز جدول أعمال هذه الدورة حسب البلاغ الذي توصلت', 'size': 2}, {'id': '379', 'title': 'القنص بالمغرب.. رقم معاملات القطاع يرتفع إلى مليار درهم', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a7%d9%84%d9%82%d9%86%d8%b5-%d8%a8%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d8%b1%d9%82%d9%85-%d9%85%d8%b9%d8%a7%d9%85%d9%84%d8%a7%d8%aa-%d8%a7%d9%84%d9%82%d8%b7%d8%a7%d8%b9-%d9%8a%d8%b1%d8%aa%d9%81/', 'summary': 'القنص بالمغرب.. رقم معاملات القطاع يرتفع إلى مليار درهم. انعقدت، اليوم الخميس بالرباط، الدورة العادية للمجلس الأعلى للقنص برئاسة وزير الفلاحة والصيد البحري والتنمية القروية والمياه والغابات، أحمد البواري، وبحضور كل من المدير العام للوكالة الوطنية للمياه والغابات عبد الرحيم هومي، ورئيس الجامعة الملكية المغربية للقنص، أحمد الموساوي. وذكر بلاغ للوكالة الوطنية للمياه والغابات أنه جرى خلال هذا الاجتماع تقديم حصيلة مشجعة للموسم المنصرم،  القنص بالمغرب.. رقم معاملات القطاع يرتفع إلى مليار درهم     .', 'size': 2}], 'main_title': 'الرباط : المجلس الأعلى للقنص يعقد دورته العادية برئاسة وزير الفلاحة'}, {'community_id': '13', 'articles': [{'id': '329', 'title': 'وسيط المملكة يرفع تقريره السنوي للملك..زيادة قياسية في التظلمات وهذه القطاعات الأكثر تعرضا للشكاوى', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/national/409845.html', 'summary': 'وسيط المملكة يرفع تقريره السنوي للملك..زيادة قياسية في التظلمات وهذه القطاعات الأكثر تعرضا للشكاوى. رفع وسيط المملكة تقريره السنوي لعام 2024 إلى الملك محمد السادس، حيث سجل زيادة ملحوظة في عدد التظلمات والملفات التي تمت معالجتها مقارنة بالعام الماضي.', 'size': 4}, {'id': '366', 'title': '160 طفلا من أبناء المفرج عنهم في قضايا التطرف يستفيدون من برامج صيفية', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1087988.html', 'summary': '160 طفلا من أبناء المفرج عنهم في قضايا التطرف يستفيدون من برامج صيفية. أعطت مؤسسة محمد السادس لإعادة إدماج السجناء الانطلاقة ظهرت المقالة 160 طفلا من أبناء المفرج عنهم في قضايا التطرف يستفيدون من برامج صيفية  .', 'size': 4}, {'id': '395', 'title': 'مؤسسة محمد السادس لإعادة إدماج السجناء تطلق الأنشطة الصيفية لفائدة أبناء المفرج عنهم في قضايا التطرف والإرهاب', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/470537.html', 'summary': 'مؤسسة محمد السادس لإعادة إدماج السجناء تطلق الأنشطة الصيفية لفائدة أبناء المفرج عنهم في قضايا التطرف والإرهاب. أعطت مؤسسة محمد السادس لإعادة إدماج السجناء، الانطلاقة الرسمية للموسم الجديد للأنشطة التربوية الصيفية لفائدة أبناء المفرج عنهم في قضايا التطرف والإرهاب.', 'size': 4}, {'id': '429', 'title': 'مؤسسة محمد السادس لإعادة إدماج السجناء تدشن الأنشطة الصيفية لأبناء المفرج عنهم في قضايا التطرف', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d9%85%d8%a4%d8%b3%d8%b3%d8%a9-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7%d8%af%d8%b3-%d9%84%d8%a5%d8%b9%d8%a7%d8%af%d8%a9-%d8%a5%d8%af%d9%85%d8%a7%d8%ac-%d8%a7%d9%84%d8%b3%d8%ac%d9%86%d8%a7/', 'summary': 'مؤسسة محمد السادس لإعادة إدماج السجناء تدشن الأنشطة الصيفية لأبناء المفرج عنهم في قضايا التطرف. المساء اليوم: أعطت مؤسسة محمد السادس لإعادة إدماج السجناء الانطلاقة الرسمية للموسم الجديد للأنشطة التربوية الصيفية لفائدة أبناء المفرج عنهم في قضايا التطرف والإرهاب. وأوضحت المؤسسة، في بيان لها اليوم الخميس، أن هذه المبادرة، المنظمة', 'size': 4}], 'main_title': 'وسيط المملكة يرفع تقريره السنوي للملك..زيادة قياسية في التظلمات وهذه القطاعات الأكثر تعرضا للشكاوى'}, {'community_id': '12', 'articles': [{'id': '336', 'title': 'بفضل معلومات من "ديستي".. توقيف شبكة متورطة في تصوير ونشر فيديوهات جنسية على مواقع أجنبية', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/409852.html', 'summary': 'بفضل معلومات من "ديستي".. توقيف شبكة متورطة في تصوير ونشر فيديوهات جنسية على مواقع أجنبية. تمكنت عناصر الشرطة بولاية أمن القنيطرة بناءً على معلومات دقيقة وفرتها مصالح المديرية العامة لمراقبة التراب الوطني، اليوم الخميس 24 يوليوز الجاري، من توقيف سيدتين', 'size': 2}, {'id': '342', 'title': 'التحريض على الفساد وتصوير ونشر محتويات رقمية تتضمن مواد إباحية.. توقيف سيدتين وشخص ثالث في القنيطرة', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a7%d9%84%d8%aa%d8%ad%d8%b1%d9%8a%d8%b6-%d8%b9%d9%84%d9%89-%d8%a7%d9%84%d9%81%d8%b3%d8%a7%d8%af-%d9%88%d8%aa%d8%b5%d9%88%d9%8a%d8%b1-%d9%88%d9%86%d8%b4%d8%b1-%d9%85%d8%ad%d8%aa%d9%88%d9%8a%d8%a7/', 'summary': 'التحريض على الفساد وتصوير ونشر محتويات رقمية تتضمن مواد إباحية.. توقيف سيدتين وشخص ثالث في القنيطرة. تمكنت عناصر الشرطة بولاية أمن القنيطرة، بناءً على معلومات دقيقة وفرتها مصالح المديرية العامة لمراقبة التراب الوطني، اليوم الخميس (24 يوليوز)، من توقيف سيدتين وشخص ثالث، وذلك للاشتباه في تورطهم في قضية تتعلق بالتحريض على الفساد وتصوير ونشر محتويات رقمية تتضمن مواد إباحية. وتشير المعطيات الخاصة بالبحث إلى تورط الموقوفين في تصوير مواد إباحية وعرضها', 'size': 4}, {'id': '383', 'title': 'القنيطرة.. تفكيك شبكة تبيع أشرطة جنسية مصورة بالأقنعة', 'source': 'rue20.com', 'link': 'https://rue20.com/923196.html', 'summary': 'القنيطرة.. تفكيك شبكة تبيع أشرطة جنسية مصورة بالأقنعة.  ا الرباط تمكنت عناصر الشرطة بولاية أمن القنيطرة بناءً على معلومات دقيقة وفرتها مصالح المديرية العامة لمراقبة التراب الوطني، اليوم الخميس 24 يوليوز الجاري، من توقيف سيدتين وشخص ثالث، وذلك للاشتباه في تورطهم في قضية تتعلق بالتحريض على الفساد وتصوير ونشر محتويات رقمية تتضمن مواد إباحية. وتشير المعطيات الخاصة بالبحث إلى تورط الموقوفين الخبر القنيطرة.. تفكيك شبكة تبيع أشرطة جنسية مصورة بالأقنعة  .', 'size': 3}, {'id': '435', 'title': 'توقيف 3 أشخاص بالقنيطرة بشبهة التحريض على الفساد وتصوير ونشر محتويات رقمية تتضمن مواد إباحية', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%aa%d9%88%d9%82%d9%8a%d9%81-3-%d8%a3%d8%b4%d8%ae%d8%a7%d8%b5-%d8%a8%d8%a7%d9%84%d9%82%d9%86%d9%8a%d8%b7%d8%b1%d8%a9-%d8%a8%d8%b4%d8%a8%d9%87%d8%a9-%d8%a7%d9%84%d8%aa%d8%ad%d8%b1%d9%8a%d8%b6-%d8%b9/', 'summary': 'توقيف 3 أشخاص بالقنيطرة بشبهة التحريض على الفساد وتصوير ونشر محتويات رقمية تتضمن مواد إباحية. تمكنت عناصر الشرطة بولاية أمن القنيطرة بناءً على معلومات دقيقة وفرتها مصالح المديرية العامة لمراقبة التراب الوطني، اليوم الخميس 24 يوليوز الجاري، من توقيف سيدتين وشخص ثالث، وذلك للاشتباه في تورطهم في قضية تتعلق بالتحريض على الفساد وتصوير ونشر محتويات رقمية تتضمن مواد إباحية. وكشفت مصادر أمنية، أن المعطيات الخاصة بالبحث، تشير إلى …  توقيف 3 أشخاص بالقنيطرة بشبهة التحريض على الفساد وتصوير ونشر محتويات رقمية تتضمن مواد إباحية     .', 'size': 3}], 'main_title': 'التحريض على الفساد وتصوير ونشر محتويات رقمية تتضمن مواد إباحية.. توقيف سيدتين وشخص ثالث في القنيطرة'}, {'community_id': '5', 'articles': [{'id': '352', 'title': 'بـ38 مليار درهم.. أخنوش يشرف على توقيع اتفاق للحكومة مع مكتب المطارات', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1088033.html', 'summary': 'بـ38 مليار درهم.. أخنوش يشرف على توقيع اتفاق للحكومة مع مكتب المطارات. ترأس رئيس الحكومة عزيز أخنوش، الخميس 24 يوليوز 2025 بالرباط، مراسم التوقيع على بروتوكول اتفاق بين الحكومة والمكتب الوطني للمطارات، يمتد من سنة 2025 إلى 2030، بقيمة استثمارية إجمالية تبلغ 38 مليار درهم. وبموجب هذا التعاقد ذي الطابع الاستراتيجي، سيتم تطوير الطاقة الاستيعابية لمطارات مراكش وأكادير وطنجة وفاس، وبناء محطة جوية جديدة عبارة عن منصة ظهرت المقالة بـ38 مليار درهم.. أخنوش يشرف على توقيع اتفاق للحكومة مع مكتب المطارات  .', 'size': 2}, {'id': '382', 'title': 'حكومة أخنوش الحكومة توقع اتفاقاً استثمارياً تاريخياً بـ38 مليار درهم لتطوير المطارات وبناء مطار جديد بالدارالبيضاء', 'source': 'rue20.com', 'link': 'https://rue20.com/923222.html', 'summary': 'حكومة أخنوش الحكومة توقع اتفاقاً استثمارياً تاريخياً بـ38 مليار درهم لتطوير المطارات وبناء مطار جديد بالدارالبيضاء.  الرباط ترأس رئيس الحكومة عزيز أخنوش، يوم الخميس 24 يوليوز 2025 بالرباط، مراسم التوقيع على بروتوكول اتفاق بين الحكومة والمكتب الوطني للمطارات، يمتد من سنة 2025 إلى 2030، بقيمة استثمارية إجمالية تبلغ 38 مليار درهم. وحسب بلاغ لرئاسة الحكومة فإنه بموجب هذا التعاقد ذي الطابع الاستراتيجي، سيتم تطوير الطاقة الاستيعابية لمطارات مراكش وأكادير وطنجة الخبر حكومة أخنوش الحكومة توقع اتفاقاً استثمارياً تاريخياً بـ38 مليار درهم لتطوير المطارات وبناء مطار جديد بالدارالبيضاء  .', 'size': 2}], 'main_title': 'بـ38 مليار درهم.. أخنوش يشرف على توقيع اتفاق للحكومة مع مكتب المطارات'}, {'community_id': '7', 'articles': [{'id': '361', 'title': 'قانون مالية 2026 .. الحكومة تعد بمواصلة تنزيل الأوراش الكبرى وضبط العجز في 3.5%', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1088004.html', 'summary': 'قانون مالية 2026 .. الحكومة تعد بمواصلة تنزيل الأوراش الكبرى وضبط العجز في 3.5%. أفادت نادية فتاح، وزيرة الاقتصاد والمالية، أن الاقتصاد الوطني أبان عن درجة عالية من الصمود والاستدامة، رغم التحديات الراهنة، حيث من المنتظر أن يتسارع معدل النمو إلى حدود 4,5% خلال هذه السنة، بفعل دينامية الأنشطة غير الفلاحية التي سجلت تحسنا متواصلا للسنة الثالثة على التوالي. وسلطت فتاح ضمن عرض حول تنفيذ قانون المالية لسنة 2025 ظهرت المقالة قانون مالية 2026 .. الحكومة تعد بمواصلة تنزيل الأوراش الكبرى وضبط العجز في 3.5%  .', 'size': 2}, {'id': '375', 'title': 'مالية 2026.. فتاح تتوقع بلوغ نمو الاقتصاد الوطني 4.5 في المائة', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%85%d8%a7%d9%84%d9%8a%d8%a9-2026-%d9%81%d8%aa%d8%a7%d8%ad-%d8%aa%d8%aa%d9%88%d9%82%d8%b9-%d8%a8%d9%84%d9%88%d8%ba-%d9%86%d9%85%d9%88-%d8%a7%d9%84%d8%a7%d9%82%d8%aa%d8%b5%d8%a7%d8%af-%d8%a7%d9%84/', 'summary': 'مالية 2026.. فتاح تتوقع بلوغ نمو الاقتصاد الوطني 4.5 في المائة. أكدت وزيرة الاقتصاد والمالية، نادية فتاح أنه من المتوقع أن يسجل نمو الاقتصاد الوطني خلال سنة 2026 نسبة 4.5 في المائة، وذلك على ضوء الفرضيات المعتمدة. وأوضحت فتاح، في عرض لها حول تنفيذ ميزانية 2025 والإطار العام لإعداد مشروع قانون المالية لسنة 2026 وللبرمجة الميزانياتية لثلاث سنوات 2026-2028، خلال اجتماع مشترك بين لجنة المالية والتنمية  مالية 2026.. فتاح تتوقع بلوغ نمو الاقتصاد الوطني 4.5 في المائة     .', 'size': 2}], 'main_title': 'قانون مالية 2026 .. الحكومة تعد بمواصلة تنزيل الأوراش الكبرى وضبط العجز في 3.5%'}, {'community_id': '3', 'articles': [{'id': '378', 'title': 'طارق: توصلنا بـ8000 ملف سنة 2024 وهيمنة ثلاثي المال والإدارة والعقار مستمرة', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%b7%d8%a7%d8%b1%d9%82-%d8%aa%d9%88%d8%b5%d9%84%d9%86%d8%a7-%d8%a8%d9%808000-%d9%85%d9%84%d9%81-%d8%b3%d9%86%d8%a9-2024-%d9%88%d9%87%d9%8a%d9%85%d9%86%d8%a9-%d8%ab%d9%84%d8%a7%d8%ab%d9%8a-%d8%a7/', 'summary': 'طارق: توصلنا بـ8000 ملف سنة 2024 وهيمنة ثلاثي المال والإدارة والعقار مستمرة. كشف حسن طارق، وسيط المملكة، أن عدد الملفات التي توصلت بها المؤسسة سجل منحى تصاعديا خلال السنوات الثلاث الأخيرة، منتقلا من 5900 ملف سنة 2022 إلى 7200 ملف سنة 2023، ليصل إلى ما يقارب 8000 ملف خلال سنة 2024. واعتبر طارق، خلال الندوة الصحفية التي خصصت لتقديم تقرير مؤسسة الوسيط لسنة 2024 اليوم الخميس بالرباط،  طارق: توصلنا بـ8000 ملف سنة 2024 وهيمنة ثلاثي المال والإدارة والعقار مستمرة     .', 'size': 2}, {'id': '396', 'title': 'عدد الملفات الواردة على مؤسسة وسيط المملكة بلغ 7948 ملفا سنة 2024', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/470533.html', 'summary': 'عدد الملفات الواردة على مؤسسة وسيط المملكة بلغ 7948 ملفا سنة 2024. قال وسيط المملكة، حسن طارق، اليوم الخميس بالرباط، إن عدد الملفات الواردة على المؤسسة خلال سنة 2024، بلغ 7948 ملفا، منها 5755 تظلما (72,41 في المائة)، و2182 ملف توجيه (27,45 في المائة)، فيما بلغ عدد طلبات التسوية الودية 11 ملفا. وأوضح طارق، خلال عرض التقرير السنوي لمؤسسة وسيط المملكة برسم سنة 2024، أن خريطة التظلم …', 'size': 2}, {'id': '440', 'title': 'حسن طارق: الاختلالات الإدارية والاجتماعية والاقتصادية تتصدر تحديات المرفق العمومي', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%ad%d8%b3%d9%86-%d8%b7%d8%a7%d8%b1%d9%82-%d8%a7%d9%84%d8%a7%d8%ae%d8%aa%d9%84%d8%a7%d9%84%d8%a7%d8%aa-%d8%a7%d9%84%d8%a5%d8%af%d8%a7%d8%b1%d9%8a%d8%a9-%d9%88%d8%a7%d9%84%d8%a7%d8%ac%d8%aa%d9%85/', 'summary': 'حسن طارق: الاختلالات الإدارية والاجتماعية والاقتصادية تتصدر تحديات المرفق العمومي. ألقى وسيط المملكة حسن طارق، خلال ندوة صحفية عقدها اليوم الخميس بالرباط، الضوء بشكل خاص على الاختلالات المرفقية المرتبطة بالسياسات والبرامج الاجتماعية، وتشمل هذه الاختلالات قضايا حيوية تمس المواطن بشكل مباشر، مثل الحق في السكن اللائق، والحق في التغطية والتأمين الإجباري عن المرض، وكذلك الحق في المعاش والاستفادة من أنظمة التقاعد. كما تطرق …  حسن طارق: الاختلالات الإدارية والاجتماعية والاقتصادية تتصدر تحديات المرفق العمومي     .', 'size': 3}], 'main_title': 'حسن طارق: الاختلالات الإدارية والاجتماعية والاقتصادية تتصدر تحديات المرفق العمومي'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    