<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 02/09/2025 - 18h28</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '8', 'articles': [{'id': '87', 'title': 'مجلس الحكومة يناقش الخميس مشاريع قوانين واتفاقية قضائية', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/national/411991.html', 'summary': 'مجلس الحكومة يناقش الخميس مشاريع قوانين واتفاقية قضائية. ينعقد، الخميس المقبل، مجلس للحكومة برئاسة عزيز أخنوش، رئيس الحكومة.وذكر بلاغ لرئاسة الحكومة أن المجلس سيتدارس فى بدايته مشروع قانون يتعلق بتغيير وتتميم الظهير الشريف', 'size': 2}, {'id': '248', 'title': 'مشاريع قوانين في مجلس الحكومة الخميس', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d9%85%d8%b4%d8%a7%d8%b1%d9%8a%d8%b9-%d9%82%d9%88%d8%a7%d9%86%d9%8a%d9%86-%d9%81%d9%8a-%d9%85%d8%ac%d9%84%d8%b3-%d8%a7%d9%84%d8%ad%d9%83%d9%88%d9%85%d8%a9-%d8%a7%d9%84%d8%ae%d9%85%d9%8a%d8%b3/', 'summary': 'مشاريع قوانين في مجلس الحكومة الخميس. المساء اليوم – الرباط: ينعقد، الخميس المقبل، مجلس للحكومة برئاسة عزيز أخنوش، رئيس الحكومة. وذكر بيان لرئاسة الحكومة أن المجلس سيتدارس فى بدايته مشروع قانون يتعلق بتغيير وتتميم الظهير الشريف بمثابة قانون المتعلق بتعويض المصابين', 'size': 2}], 'main_title': 'مجلس الحكومة يناقش الخميس مشاريع قوانين واتفاقية قضائية'}, {'community_id': '1', 'articles': [{'id': '98', 'title': 'مجلة غلوبال فاينانس تصنف عبد اللطيف الجواهري ضمن أفضل محافظي البنوك المركزية في العالم', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/economy/412004.html', 'summary': 'مجلة غلوبال فاينانس تصنف عبد اللطيف الجواهري ضمن أفضل محافظي البنوك المركزية في العالم. صنفت مجلة "غلوبال فاينانس" الأمريكية، والي بنك المغرب، عبد اللطيف الجواهري، ضمن قائمة أفضل محافظي البنوك المركزية في العالم لسنة 2025. ونال السيد الجواهري درجة "أ"', 'size': 2}, {'id': '175', 'title': 'تصنيف الجواهري ضمن أفضل محافظي البنوك المركزية بالعالم.. وبنك المغرب يحقق الريادة عربيا', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1096573.html', 'summary': 'تصنيف الجواهري ضمن أفضل محافظي البنوك المركزية بالعالم.. وبنك المغرب يحقق الريادة عربيا. صنفت مجلة "غلوبال فاينانس" الأمريكية والي بنك المغرب ظهرت المقالة تصنيف الجواهري ضمن أفضل محافظي البنوك المركزية بالعالم.. وبنك المغرب يحقق الريادة عربيا  .', 'size': 2}], 'main_title': 'مجلة غلوبال فاينانس تصنف عبد اللطيف الجواهري ضمن أفضل محافظي البنوك المركزية في العالم'}, {'community_id': '6', 'articles': [{'id': '103', 'title': 'الأمن يفك لغز اختطاف طفلة بالبيضاء والفاعل حارس ليلي', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/412009.html', 'summary': 'الأمن يفك لغز اختطاف طفلة بالبيضاء والفاعل حارس ليلي. تمكنت عناصر الشرطة بولاية أمن الدار البيضاء بتنسيق ميداني مع مفوضية الشرطة بسوق السبت أولاد النمة، زوال اليوم الاثنين فاتح شتنبر الجاري، من توقيف حارس', 'size': 4}, {'id': '150', 'title': 'تفاصيل صادمة لاختطاف طفلة بالبيضاء والمتورط حارس ليلي', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-587442.html', 'summary': 'تفاصيل صادمة لاختطاف طفلة بالبيضاء والمتورط حارس ليلي. تمكنت عناصر الشرطة بولاية أمن الدار البيضاء بتنسيق ميداني مع مفوضية الشرطة بسوق السبت أولاد النمة، الاثنين فاتح شتنبر2025، من توقيف حارس ليلي يبلغ من العمر 38 سنة، وذلك للاشتباه في تورطه في اختطاف طفلة قاصر تبلغ من العمر سنتين. وحسب المعلومات الأولية للبحث، فقد تم التصريح باختفاء الفتاة القاصر بمدينة الدار البيضاء', 'size': 5}, {'id': '218', 'title': 'اعتقال حارس ليلي يشتبه تورطه في اختطاف طفلة بالبيضاء', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%a7%d8%b9%d8%aa%d9%82%d8%a7%d9%84-%d8%ad%d8%a7%d8%b1%d8%b3-%d9%84%d9%8a%d9%84%d9%8a-%d9%8a%d8%b4%d8%aa%d8%a8%d9%87-%d8%aa%d9%88%d8%b1%d8%b7%d9%87-%d9%81%d9%8a-%d8%a7%d8%ae%d8%aa%d8%b7%d8%a7%d9%81/', 'summary': 'اعتقال حارس ليلي يشتبه تورطه في اختطاف طفلة بالبيضاء. اعتقال حارس ليلي يشتبه تورطه في اختطاف طفلة بالبيضاء  – متابعات تمكنت عناصر الشرطة بولاية أمن الدار البيضاء، بتنسيق ميداني مع مفوضية الشرطة بسوق السبت أولاد النمة، زوال...  اعتقال حارس ليلي يشتبه تورطه في اختطاف طفلة بالبيضاء     .', 'size': 3}, {'id': '230', 'title': 'تنسيق أمني يطيح بحارس ليلي اختطف طفلة عمرها سنتين من الدار البيضاء', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/226574/', 'summary': 'تنسيق أمني يطيح بحارس ليلي اختطف طفلة عمرها سنتين من الدار البيضاء. تمكنت عناصر الشرطة بولاية أمن الدار البيضاء بتنسيق ميداني مع مفوضية الشرطة بسوق السبت أولاد النمة، زوال اليوم الاثنين فاتح شتنبر الجاري، من توقيف حارس ليلي يبلغ من العمر 38 سنة، وذلك للاشتباه في تورطه في اختطاف طفلة قاصر تبلغ من العمر سنتين. وحسب المعلومات الأولية للبحث، فقد تم التصريح باختفاء الطفلة بمدينة الدار البيضاء', 'size': 4}, {'id': '291', 'title': 'توقيف حارس ليلي في اختطاف رضيعة', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d8%aa%d9%88%d9%82%d9%8a%d9%81-%d8%ad%d8%a7%d8%b1%d8%b3-%d9%84%d9%8a%d9%84%d9%8a-%d9%81%d9%8a-%d8%a7%d8%ae%d8%aa%d8%b7%d8%a7%d9%81-%d8%b1%d8%b6%d9%8a%d8%b9%d8%a9-1617770.html', 'summary': 'توقيف حارس ليلي في اختطاف رضيعة. تمكنت عناصر الشرطة بولاية أمن الدار البيضاء، بتنسيق ميداني مع مفوضية الشرطة بسوق السبت أولاد النمة، زوال أمس الاثنين، من توقيف حارس ليلي يبلغ من العمر 38 سنة، يشتبه في تورطه في اختطاف رضيعة في السنة الثانية من عمرها. وحسب المعطيات المتوفرة، فإن المصالح الأمنية استنفرت مواردها بعد توصلها ببلاغ حول اختفاء الرضيعة في ظروف  توقيف حارس ليلي في اختطاف رضيعة     - هسبريس جريدة إلكترونية مغربية .', 'size': 3}], 'main_title': 'تفاصيل صادمة لاختطاف طفلة بالبيضاء والمتورط حارس ليلي'}, {'community_id': '3', 'articles': [{'id': '115', 'title': 'المغرب يشارك في الدورة السابعة لمعرض الصين والدول العربية بينتشوان', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/divers/412023.html', 'summary': 'المغرب يشارك في الدورة السابعة لمعرض الصين والدول العربية بينتشوان. بصم المغرب على مشاركة قوية في مختلف أنشطة الدورة السابعة لمعرض الصين والدول العربية، الذي نظم مؤخرا بينتشوان، عاصمة مقاطعة نينغشيا ذاتية الحكم بشمال وسط', 'size': 2}, {'id': '411', 'title': 'مشاركة قوية للمغرب في الدورة السابعة لمعرض الصين والدول العربية بينتشوان', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/474334.html', 'summary': 'مشاركة قوية للمغرب في الدورة السابعة لمعرض الصين والدول العربية بينتشوان. بصم المغرب على مشاركة قوية في مختلف أنشطة الدورة السابعة لمعرض الصين والدول العربية، الذي نظم مؤخرا بينتشوان، عاصمة مقاطعة نينغشيا ذاتية الحكم بشمال وسط الصين. وعرف هذا المعرض المنظم من طرف وزارة التجارة الصينية، والمجلس الصيني للترويج للتجارة الدولية، وحكومة نينغشيا، تحت شعار “الابتكار، التنمية الخضراء، والازدهار”، مشاركة أكثر من 7600 شخص، وحوالي 2200 …', 'size': 2}], 'main_title': 'المغرب يشارك في الدورة السابعة لمعرض الصين والدول العربية بينتشوان'}, {'community_id': '11', 'articles': [{'id': '148', 'title': 'توقعات طقس اليوم الثلاثاء', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/322249/', 'summary': 'توقعات طقس اليوم الثلاثاء. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الثلاثاء، أن يظل الطقس حارا نسبيا بالجنوب الشرقي للبلاد، والمنطقة الشرقية والسهول غرب الأطلس وداخل الأقاليم الجنوبية. ويرتقب، كذلك، تشكل سحب منخفضة كثيفة بالسواحل الوسطى مع كتل ضبابية محلية خلال الصباح والليل، كما سيكون الطقس هادئا مع سماء صافية الى قليلة السحب. وستتراوح درجات الحرارة الدنيا، ما بين', 'size': 4}, {'id': '151', 'title': 'توقعات “الأرصاد الجوية” لطقس يوم غد الثلاثاء بالمغرب', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-587437.html', 'summary': 'توقعات “الأرصاد الجوية” لطقس يوم غد الثلاثاء بالمغرب. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليوم غد الثلاثاء، أن يظل الطقس حارا نسبيا بالجنوب الشرقي للبلاد، والمنطقة الشرقية والسهول غرب الأطلس وداخل الأقاليم الجنوبية. ويرتقب، كذلك، تشكل سحب منخفضة كثيفة بالسواحل الوسطى مع كتل ضبابية محلية خلال الصباح والليل. كما سيكون الطقس هادئا مع سماء صافية الى قليلة السحب.', 'size': 3}, {'id': '187', 'title': 'طقس حار مع سحب منخفضة متوقع اليوم الثلاثاء', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%b7%d9%82%d8%b3-%d8%ad%d8%a7%d8%b1-%d9%85%d8%b9-%d8%b3%d8%ad%d8%a8-%d9%85%d9%86%d8%ae%d9%81%d8%b6%d8%a9-%d9%85%d8%aa%d9%88%d9%82%d8%b9-%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%ab%d9%84%d8%a7/', 'summary': 'طقس حار مع سحب منخفضة متوقع اليوم الثلاثاء. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الثلاثاء، أن يظل الطقس حارا نسبيا بالجنوب الشرقي للبلاد، والمنطقة الشرقية والسهول غرب الأطلس وداخل الأقاليم الجنوبية. ويرتقب، كذلك، تشكل سحب منخفضة كثيفة بالسواحل الوسطى مع كتل ضبابية محلية خلال الصباح والليل. كما سيكون الطقس هادئا مع سماء صافية الى قليلة السحب. وستتراوح درجات الحرارة الدنيا، ما بين  طقس حار مع سحب منخفضة متوقع اليوم الثلاثاء     .', 'size': 4}, {'id': '257', 'title': 'طقس حار في العديد من مناطق المملكة اليوم الثلاثاء', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%b7%d9%82%d8%b3-%d8%ad%d8%a7%d8%b1-%d9%81%d9%8a-%d8%a7%d9%84%d8%b9%d8%af%d9%8a%d8%af-%d9%85%d9%86-%d9%85%d9%86%d8%a7%d8%b7%d9%82-%d8%a7%d9%84%d9%85%d9%85%d9%84%d9%83%d8%a9-%d8%a7%d9%84%d9%8a-95/', 'summary': 'طقس حار في العديد من مناطق المملكة اليوم الثلاثاء. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليومه الثلاثاء، أن يظل الطقس حارا نسبيا بالجنوب الشرقي للبلاد، والمنطقة الشرقية والسهول غرب الأطلس وداخل الأقاليم الجنوبية. ويرتقب، كذلك، تشكل سحب منخفضة كثيفة بالسواحل الوسطى مع كتل ضبابية محلية خلال الصباح والليل، كما سيكون الطقس هادئا مع سماء صافية الى قليلة السحب. وستتراوح درجات الحرارة الدنيا، …  طقس حار في العديد من مناطق المملكة اليوم الثلاثاء     .', 'size': 2}, {'id': '393', 'title': 'طقس اليوم: استمرار الطقس الحارة بعدد من المناطق', 'source': 'soltana.ma', 'link': 'https://soltana.ma/1357740.html', 'summary': 'طقس اليوم: استمرار الطقس الحارة بعدد من المناطق. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الثلاثاء، أن يظل الطقس حارا نسبيا بالجنوب الشرقي للبلاد، والمنطقة الشرقية والسهول غرب الأطلس وداخل الأقاليم الجنوبية. ويرتقب، كذلك، تشكل سحب منخفضة كثيفة بالسواحل الوسطى مع كتل ضبابية محلية خلال الصباح والليل. كما سيكون الطقس هادئا مع سماء صافية الى قليلة السحب.وستتراوح درجات الحرارة الدنيا، ما بين 20', 'size': 4}], 'main_title': 'توقعات طقس اليوم الثلاثاء'}, {'community_id': '5', 'articles': [{'id': '149', 'title': 'الكاف يكشف هوية حكم موقعة المغرب والنيجر الحاسمة', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-587448.html', 'summary': 'الكاف يكشف هوية حكم موقعة المغرب والنيجر الحاسمة. عينت الكونفدرالية الإفريقية لكرة القدم (الكاف)، الحكم الدولي جان جاك ندالا من جمهورية الكونغو الديمقراطية، بإدارة المباراة المرتقبة بين المنتخب المغربي ونظيره النيجري، ضمن الجولة الخامسة من التصفيات الإفريقية المؤهلة إلى نهائيات كأس العالم 2026. وستُجرى المواجهة يوم الجمعة 5 شتنبر الجاري، على أرضية المركب الرياضي الأمير مولاي عبد الله بالرباط، الذي', 'size': 2}, {'id': '208', 'title': 'الحكم الكونغولي ندالا يدير مباراة المغرب ونيجيريا في تصفيات كأس العالم 2026', 'source': 'machahid24.com', 'link': 'https://machahid24.com/sport/474285.html', 'summary': 'الحكم الكونغولي ندالا يدير مباراة المغرب ونيجيريا في تصفيات كأس العالم 2026. عينت الكونفدرالية الإفريقية لكرة القدم “الكاف” الحكم الدولي “جان جاك ندالا”، من جمهورية الكونغو الديمقراطية، لقيادة المباراة التي ستجمع بين المنتخب المغربي ونظيره النيجيري، برسم الجولة الخامسة من التصفيات الإفريقية المؤهلة إلى نهائيات كأس العالم 2026. وستجرى المباراة المذكروة أعلاه، يوم الجمعة 5 شتنبر الجاري، على أرضية المركب الرياضي الأمير مولاي عبد الله بمدينة الرباط …', 'size': 2}], 'main_title': 'الكاف يكشف هوية حكم موقعة المغرب والنيجر الحاسمة'}, {'community_id': '12', 'articles': [{'id': '159', 'title': '891,9 مليار درهم نفقات الأسر بالمغرب سنة 2023.. خمس جهات تستحوذ على 74%', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1096650.html', 'summary': '891,9 مليار درهم نفقات الأسر بالمغرب سنة 2023.. خمس جهات تستحوذ على 74%. أظهرت الحسابات الجهوية لسنة 2023 الصادرة، اليوم الثلاثاء، عن المندوبية السامية للتخطيط، أن خمس جهات بالمملكة استحوذت على ما يقارب ثلاثة أرباع (74 في المائة) نفقات الاستهلاك النهائي للأسر. وأوضحت المندوبية في مذكرة إخبارية حول هذه الحسابات الجهوية أن الدار البيضاء-سطات استأثرت لوحدها بربع (25 في المائة) نفقات الاستهلاك النهائي للأسر على الصعيد الوطني، تليها ظهرت المقالة 891,9 مليار درهم نفقات الأسر بالمغرب سنة 2023.. خمس جهات تستحوذ على 74%  .', 'size': 2}, {'id': '192', 'title': 'تقرير رسمي : ثلاث جهات تسيطر على أكثر من نصف ثروة المغرب', 'source': 'rue20.com', 'link': 'https://rue20.com/932989.html', 'summary': 'تقرير رسمي : ثلاث جهات تسيطر على أكثر من نصف ثروة المغرب.  | الرباط أظهرت البيانات الصادرة عن المندوبية السامية للتخطيط أن ثلاث جهات بالمغرب تستحوذ على الجزء الأكبر من الناتج الداخلي الخام (PIB) الوطني خلال سنة 2023، حيث بلغت حصتها 58.5%، مع تصدر جهة الدار البيضاء – سطات المشهد بنسبة 32.2%. وفقاً لتقرير المندوبية الصادر الثلاثاء، تواصل جهة الدار البيضاء-سطات قيادة النشاط الاقتصادي بالمملكة، الخبر تقرير رسمي : ثلاث جهات تسيطر على أكثر من نصف ثروة المغرب  .', 'size': 2}], 'main_title': '891,9 مليار درهم نفقات الأسر بالمغرب سنة 2023.. خمس جهات تستحوذ على 74%'}, {'community_id': '9', 'articles': [{'id': '161', 'title': 'حادثة سير خطيرة تدخل عبد السلام وادو وطاقمه إلى المستشفى بجنوب أفريقيا', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1096634.html', 'summary': 'حادثة سير خطيرة تدخل عبد السلام وادو وطاقمه إلى المستشفى بجنوب أفريقيا. تعرّض المغربي عبد السلام وادو، مدرب أورلاندو بيراتس الجنوب أفريقي، لحادثة سير، بمدينة بورت إليزابيت، في ساعات متأخرة من أول أمس الأحد، وفقا لما كشفه النادي، ضمن بلاغ رسمي. وأورد النادي الجنوب أفريقي أن وادو وأعضاء الطاقم التقني للفريق، عند عودتهم على متن الحافلة الخاصة بالنادي من مباراة تشيبا يونايتد، عاينوا حادثة سير بين سيارتيْن، ظهرت المقالة حادثة سير خطيرة تدخل عبد السلام وادو وطاقمه إلى المستشفى بجنوب أفريقيا  .', 'size': 3}, {'id': '253', 'title': 'إصابة عبد السلام وادو وطاقمه في حادث سير بجنوب إفريقيا', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a5%d8%b5%d8%a7%d8%a8%d8%a9-%d8%b9%d8%a8%d8%af-%d8%a7%d9%84%d8%b3%d9%84%d8%a7%d9%85-%d9%88%d8%a7%d8%af%d9%88-%d9%88%d8%b7%d8%a7%d9%82%d9%85%d9%87-%d9%81%d9%8a-%d8%ad%d8%a7%d8%af%d8%ab-%d8%b3%d9%8a/', 'summary': 'إصابة عبد السلام وادو وطاقمه في حادث سير بجنوب إفريقيا. أعلن نادي أورلاندو بيراتس الجنوب إفريقي، في بلاغ رسمي، أن مدربه المغربي عبد السلام وادو وخمسة من أعضاء طاقمه التقني تعرضوا لحادثة سير خطيرة، أمس الإثنين، أثناء عودتهم من المباراة التي جمعت الفريق بنظيره تشيبا يونايتد لحساب الدوري المحلي. وأشار البيان إلى أنه جرى نقل وادو ومرافقيه على وجه السرعة إلى المستشفى، حيث …  إصابة عبد السلام وادو وطاقمه في حادث سير بجنوب إفريقيا     .', 'size': 3}, {'id': '328', 'title': 'عبد السلام وادو يتعرض لحادثة سير بجنوب إفريقيا', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/205634', 'summary': 'عبد السلام وادو يتعرض لحادثة سير بجنوب إفريقيا.  أعلن نادي أورلاندو بيراتس الجنوب إفريقي، اليوم الثلاثاء، عن تعرض مدربه المغربي عبد السلام وادو، الدولي السابق للمنتخب الوطني المغربي، لحادث سير خطير أثناء وجوده رفقة فريقه بجنوب إفريقيا. ووفقًا للنادي، فإن الحادث وقع بعد اصطدام حافلة الفريق بسيارة أخرى على الطريق، ما استدعى توقف الطاقم الفني واللاعبين للنزول من الحافلة قصد مساعدة المصابين', 'size': 3}], 'main_title': 'حادثة سير خطيرة تدخل عبد السلام وادو وطاقمه إلى المستشفى بجنوب أفريقيا'}, {'community_id': '4', 'articles': [{'id': '210', 'title': '5 جهات تستحوذ على ما يقارب ثلاثة أرباع نفقات الاستهلاك للأسر', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/5-%d8%ac%d9%87%d8%a7%d8%aa-%d8%aa%d8%b3%d8%aa%d8%ad%d9%88%d8%b0-%d8%b9%d9%84%d9%89-%d9%85%d8%a7-%d9%8a%d9%82%d8%a7%d8%b1%d8%a8-%d8%ab%d9%84%d8%a7%d8%ab%d8%a9-%d8%a3%d8%b1%d8%a8%d8%a7%d8%b9-%d9%86/', 'summary': '5 جهات تستحوذ على ما يقارب ثلاثة أرباع نفقات الاستهلاك للأسر.  – متابعة 5 جهات تستحوذ على ما يقارب ثلاثة أرباع نفقات الاستهلاك للأسر أظهرت الحسابات الجهوية لسنة 2023 الصادرة، اليوم الثلاثاء، عن المندوبية السامية للتخطيط، أن خمس جهات...  5 جهات تستحوذ على ما يقارب ثلاثة أرباع نفقات الاستهلاك للأسر     .', 'size': 2}, {'id': '267', 'title': '5 جهات تستحوذ على ثلاثة أرباع نفقات الاستهلاك للأسر', 'source': 'www.alalam.ma', 'link': 'https://www.alalam.ma/5-جهات-تستحوذ-على-ثلاثة-أرباع-نفقات-الاستهلاك-للأسر_a29324.html', 'summary': '5 جهات تستحوذ على ثلاثة أرباع نفقات الاستهلاك للأسر.  أظهرت الحسابات الجهوية لسنة 2023 الصادرة، الثلاثاء، عن المندوبية السامية للتخطيط، أن خمس جهات بالمملك...', 'size': 2}], 'main_title': '5 جهات تستحوذ على ما يقارب ثلاثة أرباع نفقات الاستهلاك للأسر'}, {'community_id': '7', 'articles': [{'id': '234', 'title': 'وزارة التربية الوطنية تعلن مواعيد التحاق الأساتذة والتلاميذ', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/226565/', 'summary': 'وزارة التربية الوطنية تعلن مواعيد التحاق الأساتذة والتلاميذ. الرباط- أعلنت وزارة التربية الوطنية والتعليم الأولي والرياضة عن المواعيد الرسمية لانطلاق الموسم الدراسي 2025-2026، مؤكدة أن الدراسة ستنطلق بشكل فعلي وإلزامي يوم الاثنين 8 شتنبر 2025. وأوضحت الوزارة، في بلاغ لها، أن يوم غدٍ الاثنين فاتح شتنبر سيخصص لالتحاق الأطر التربوية والإدارية بمؤسساتهم، بما في ذلك موظفو الإدارة التربوية والتدبير، وهيئات التفتيش والتأطير والمراقبة', 'size': 2}, {'id': '241', 'title': 'وزارة الأوقاف تحدد المرحلة الثانية لاستخلاص مصاريف الحج', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d9%88%d8%b2%d8%a7%d8%b1%d8%a9-%d8%a7%d9%84%d8%a3%d9%88%d9%82%d8%a7%d9%81-%d8%aa%d8%ad%d8%af%d8%af-%d8%a7%d9%84%d9%85%d8%b1%d8%ad%d9%84%d8%a9-%d8%a7%d9%84%d8%ab%d8%a7%d9%86%d9%8a%d8%a9-%d9%84%d8%a7/', 'summary': 'وزارة الأوقاف تحدد المرحلة الثانية لاستخلاص مصاريف الحج. المساء اليوم- الرباط: أعلنت وزارة الأوقاف والشؤون الإسلامية، اليوم الاثنين، أن المرحلة الثانية لاستخلاص مصاريف الحج لموسم 1447 هـ بالنسبة للمسجلين في لوائح الانتظار ستكون من 15 إلى 19 شتنبر الجاري. وأوضحت الوزارة في بيان', 'size': 2}], 'main_title': 'وزارة التربية الوطنية تعلن مواعيد التحاق الأساتذة والتلاميذ'}, {'community_id': '0', 'articles': [{'id': '288', 'title': 'بدء أشغال تهيئة خط الـTGV نحو مراكش', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d8%a3%d8%b4%d8%ba%d8%a7%d9%84-%d8%aa%d9%87%d9%8a%d8%a6%d8%a9-%d8%ae%d8%b7-%d8%a7%d9%84%d9%80-tgv-%d9%86%d8%ad%d9%88-%d9%85%d8%b1%d8%a7%d9%83%d8%b4-1617912.html', 'summary': 'بدء أشغال تهيئة خط الـTGV نحو مراكش. باشر المكتب الوطني للسكك الحديدية الأشغال الكبرى للبنية التحتية بجهة الدار البيضاء، في إطار مشروع القطار فائق السرعة القنيطرة – مراكش، بهدف توفير بنية تحتية ملائمة للاحتياجات الحالية والمستقبلية، خاصة على المحور الرابط بين المحمدية والنواصر. وأفاد المكتب الوطني للسكك الحديدية في بلاغ أن هذه الأشغال تهدف إلى إضافة مسارات جديدة ليرتفع عدد السكك إلى  بدء أشغال تهيئة خط الـTGV نحو مراكش     - هسبريس جريدة إلكترونية مغربية .', 'size': 4}, {'id': '354', 'title': 'التيجيڤي القنيطرة-مراكش.. انطلاق الأشغال الكبرى للبنية التحتية السككية في الدار البيضاء', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a7%d9%84%d8%aa%d9%8a%d8%ac%d9%8a%da%a4%d9%8a-%d8%a7%d9%84%d9%82%d9%86%d9%8a%d8%b7%d8%b1%d8%a9-%d9%85%d8%b1%d8%a7%d9%83%d8%b4-%d8%a7%d9%86%d8%b7%d9%84%d8%a7%d9%82-%d8%a7%d9%84%d8%a3%d8%b4%d8%ba/', 'summary': 'التيجيڤي القنيطرة-مراكش.. انطلاق الأشغال الكبرى للبنية التحتية السككية في الدار البيضاء. باشر المكتب الوطني للسكك الحديدية الأشغال الكبرى للبنية التحتية بجهة الدار البيضاء، في إطار مشروع القطار فائق السرعة القنيطرة – مراكش، بهدف توفير بنية تحتية ملائمة للاحتياجات الحالية والمستقبلية، خاصة على المحور الرابط بين المحمدية والنواصر. وأفاد المكتب الوطني للسكك الحديدية في بلاغ أن هذه الأشغال تهدف إلى إضافة مسارات جديدة ليرتفع عدد السكك إلى', 'size': 4}, {'id': '413', 'title': 'القطار فائق السرعة القنيطرة-مراكش.. “ONCF” يباشر الأشغال الكبرى للبنية التحتية', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/474327.html', 'summary': 'القطار فائق السرعة القنيطرة-مراكش.. “ONCF” يباشر الأشغال الكبرى للبنية التحتية. باشر المكتب الوطني للسكك الحديدية الأشغال الكبرى للبنية التحتية بجهة الدار البيضاء، في إطار مشروع القطار فائق السرعة القنيطرة – مراكش، بهدف توفير بنية تحتية ملائمة للاحتياجات الحالية والمستقبلية، خاصة على المحور الرابط بين المحمدية والنواصر.', 'size': 4}, {'id': '439', 'title': 'القطار فائق السرعة القنيطرة – مراكش يدخل مرحلة الأشغال بجهة الدار البيضاء', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d9%82%d8%b7%d8%a7%d8%b1-%d9%81%d8%a7%d8%a6%d9%82-%d8%a7%d9%84%d8%b3%d8%b1%d8%b9%d8%a9-%d8%a7%d9%84%d9%82%d9%86%d9%8a%d8%b7%d8%b1%d8%a9-%d9%85%d8%b1%d8%a7%d9%83%d8%b4-%d9%8a/', 'summary': 'القطار فائق السرعة القنيطرة – مراكش يدخل مرحلة الأشغال بجهة الدار البيضاء. باشر المكتب الوطني للسكك الحديدية الأشغال الكبرى للبنية التحتية بجهة الدار البيضاء، في إطار مشروع القطار فائق السرعة القنيطرة – مراكش، بهدف توفير بنية تحتية ملائمة للاحتياجات الحالية والمستقبلية، خاصة على المحور الرابط بين المحمدية والنواصر. وأفاد المكتب الوطني للسكك الحديدية في بلاغ، أن هذه الأشغال تهدف إلى إضافة مسارات جديدة ليرتفع عدد …  القطار فائق السرعة القنيطرة – مراكش يدخل مرحلة الأشغال بجهة الدار البيضاء     .', 'size': 5}, {'id': '450', 'title': 'مشروع القطار فائق السرعة القنيطرة – مراكش يواصل تقدمه بخطى ثابتة نحو الربط بين الشمال والجنوب', 'source': 'www.alousboue.ma', 'link': 'https://www.alousboue.ma/123457/', 'summary': 'مشروع القطار فائق السرعة القنيطرة – مراكش يواصل تقدمه بخطى ثابتة نحو الربط بين الشمال والجنوب. يشكل مشروع القطار فائق السرعة القنيطرة – مراكش أحد أبرز الأوراش الاستراتيجية التي تعكس إرادة المغرب في ترسيخ موقعه كقطب جهوي للتنقل المستدام والحديث. فبعد إطلاقه الرسمي من طرف جلالة الملك محمد السادس يوم 24 أبريل 2025، دخل المشروع مرحلة مفصلية عنوانها الأشغال الكبرى على مستوى البنية التحتية السككية، خاصة بجهة الدار البيضاء، …  مشروع القطار فائق السرعة القنيطرة – مراكش يواصل تقدمه بخطى ثابتة نحو الربط بين الشمال والجنوب     .', 'size': 2}], 'main_title': 'القطار فائق السرعة القنيطرة – مراكش يدخل مرحلة الأشغال بجهة الدار البيضاء'}, {'community_id': '10', 'articles': [{'id': '375', 'title': 'أكثر من ألف قتيل في انزلاق أرضي ضخم يمحو قرية بأكملها بالسودان', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1096725.html', 'summary': 'أكثر من ألف قتيل في انزلاق أرضي ضخم يمحو قرية بأكملها بالسودان. لقي أكثر من ألف شخص مصرعهم في كارثة طبيعية مروعة بقرية “ترسين” في إقليم دارفور غرب السودان، إثر انزلاق أرضي ضخم أتى على القرية بالكامل، فيما وصف بأنه أحد أسوأ الكوارث الطبيعية في تاريخ البلاد الحديث. وأعلنت حركة جيش تحرير السودان التي تسيطر على المنطقة، أن ناجيا واحدا فقط تم العثور عليه حتى الآن. وقالت ظهرت المقالة أكثر من ألف قتيل في انزلاق أرضي ضخم يمحو قرية بأكملها بالسودان  .', 'size': 2}, {'id': '441', 'title': 'السودان.. أكثر من ألف قتيل في انزلاق أرضي مدمّر يبتلع قرية كاملة بدارفور', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d8%b3%d9%88%d8%af%d8%a7%d9%86-%d8%a3%d9%83%d8%ab%d8%b1-%d9%85%d9%86-%d8%a3%d9%84%d9%81-%d9%82%d8%aa%d9%8a%d9%84-%d9%81%d9%8a-%d8%a7%d9%86%d8%b2%d9%84%d8%a7%d9%82-%d8%a3%d8%b1%d8%b6/', 'summary': 'السودان.. أكثر من ألف قتيل في انزلاق أرضي مدمّر يبتلع قرية كاملة بدارفور. لقي أكثر من ألف شخص مصرعهم في انزلاق أرضي ضخم أتى على قرية بأكملها في إقليم دارفور غرب السودان، بما وصف أنه واحد من أسوأ الكوارث الطبيعية في تاريخ السودان الحديث، بحسب ما أعلنت اليوم الثلاثاء 2 شتنبر 2025 حركة جيش تحرير السودان التي تسيطر على المنطقة. وقالت الحركة في بيان لها إن انزلاقات أرضية كبيرة …  السودان.. أكثر من ألف قتيل في انزلاق أرضي مدمّر يبتلع قرية كاملة بدارفور     .', 'size': 2}], 'main_title': 'أكثر من ألف قتيل في انزلاق أرضي ضخم يمحو قرية بأكملها بالسودان'}, {'community_id': '13', 'articles': [{'id': '404', 'title': 'أشبال الأطلس يستعدون لمونديال الشيلي بمبارتين وديتين أمام المنتخب الأمريكي', 'source': 'rue20.com', 'link': 'https://rue20.com/933088.html', 'summary': 'أشبال الأطلس يستعدون لمونديال الشيلي بمبارتين وديتين أمام المنتخب الأمريكي.  | الرباط يخوض المنتخب الوطني المغربي لأقل من 20 سنة مباراتين وديتين أمام نظيره الأمريكي، يومي 5 و7 شتنبر الجاري، بداية من الساعة السابعة مساء بمدينة بيناتار (قرب مورسيا) بإسبانيا. وأفاد بلاغ للجامعة الملكية المغربية لكرة القدم نشرته، اليوم الثلاثاء، على موقعها الرسمي بأن هاتين المواجهتين تندرجان في إطار برنامج تحضيرات المنتخب الوطني الخبر أشبال الأطلس يستعدون لمونديال الشيلي بمبارتين وديتين أمام المنتخب الأمريكي  .', 'size': 2}, {'id': '440', 'title': 'المنتخب الوطني المغربي لأقل من 20 سنة يجري مباراتين وديتين أمام نظيره الأمريكي', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d9%85%d9%86%d8%aa%d8%ae%d8%a8-%d8%a7%d9%84%d9%88%d8%b7%d9%86%d9%8a-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8%d9%8a-%d9%84%d8%a3%d9%82%d9%84-%d9%85%d9%86-20-%d8%b3%d9%86%d8%a9-%d9%8a%d8%ac/', 'summary': 'المنتخب الوطني المغربي لأقل من 20 سنة يجري مباراتين وديتين أمام نظيره الأمريكي. يخوض المنتخب الوطني المغربي لأقل من 20 سنة مباراتين وديتين أمام نظيره الأمريكي، يومي 5 و7 شتنبر الجاري، بداية من الساعة السابعة مساء بمدينة بيناتار (قرب مورسيا) بإسبانيا. وأفاد بلاغ للجامعة الملكية المغربية لكرة القدم نشرته، اليوم الثلاثاء 02 شتنبر 2025، على موقعها الرسمي بأن هاتين المواجهتين تندرجان في إطار برنامج تحضيرات المنتخب …  المنتخب الوطني المغربي لأقل من 20 سنة يجري مباراتين وديتين أمام نظيره الأمريكي     .', 'size': 2}], 'main_title': 'أشبال الأطلس يستعدون لمونديال الشيلي بمبارتين وديتين أمام المنتخب الأمريكي'}, {'community_id': '2', 'articles': [{'id': '408', 'title': 'رئيسة لجنة بمجلس الشيوخ الفرنسي تشيد بالدينامية اللافتة للمغرب في مجال الطاقات المتجددة', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/474340.html', 'summary': 'رئيسة لجنة بمجلس الشيوخ الفرنسي تشيد بالدينامية اللافتة للمغرب في مجال الطاقات المتجددة. أشادت رئيسة لجنة الشؤون الاقتصادية بمجلس الشيوخ الفرنسي، دومينيك استروسي ساسون، اليوم الثلاثاء بالرباط، بالدينامية اللافتة التي تطبع قطاع الطاقات المتجددة بالمغرب، مؤكدة أن المملكة تشكل نموذجا ملهما بفضل مبادراتها ومشاريعها المستقبلية.', 'size': 3}, {'id': '421', 'title': 'مسؤولة بمجلس الشيوخ الفرنسي تشيد بالدينامية اللافتة للمغرب في مجال الطاقات المتجددة', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d9%85%d8%b3%d8%a4%d9%88%d9%84%d8%a9-%d8%a8%d9%85%d8%ac%d9%84%d8%b3-%d8%a7%d9%84%d8%b4%d9%8a%d9%88%d8%ae-%d8%a7%d9%84%d9%81%d8%b1%d9%86%d8%b3%d9%8a-%d8%aa%d8%b4%d9%8a%d8%af-%d8%a8%d8%a7%d9%84%d8%af/', 'summary': 'مسؤولة بمجلس الشيوخ الفرنسي تشيد بالدينامية اللافتة للمغرب في مجال الطاقات المتجددة. أشادت رئيسة لجنة الشؤون الاقتصادية بمجلس الشيوخ الفرنسي، دومينيك استروسي ساسون، اليوم الثلاثاء بالرباط، بالدينامية اللافتة التي تطبع قطاع الطاقات المتجددة  مسؤولة بمجلس الشيوخ الفرنسي تشيد بالدينامية اللافتة للمغرب في مجال الطاقات المتجددة     .', 'size': 2}, {'id': '431', 'title': 'رئيسة لجنة الشؤون الاقتصادية بمجلس الشيوخ الفرنسي تشيد بالدينامية اللافتة للمغرب في مجال الطاقات المتجددة', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/226584/', 'summary': 'رئيسة لجنة الشؤون الاقتصادية بمجلس الشيوخ الفرنسي تشيد بالدينامية اللافتة للمغرب في مجال الطاقات المتجددة. أشادت رئيسة لجنة الشؤون الاقتصادية بمجلس الشيوخ الفرنسي، دومينيك استروسي ساسون، اليوم الثلاثاء بالرباط، بالدينامية اللافتة التي تطبع قطاع الطاقات المتجددة بالمغرب، مؤكدة أن المملكة تشكل نموذجاً ملهِماً بفضل مبادراتها ومشاريعها المستقبلية. وأكدت في تصريح صحفي عقب اجتماعها مع وزير الصناعة والتجارة، رياض مزور، أن “المغرب يظهر دينامية بارزة في مجال الطاقات المتجددة، وهو موضوع', 'size': 2}], 'main_title': 'رئيسة لجنة بمجلس الشيوخ الفرنسي تشيد بالدينامية اللافتة للمغرب في مجال الطاقات المتجددة'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    