<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 29/06/2025 - 12h24</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '8', 'articles': [{'id': '10', 'title': 'إجهاض تهريب كميات أقراص مهلوسة', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d8%a5%d8%ac%d9%87%d8%a7%d8%b6-%d8%aa%d9%87%d8%b1%d9%8a%d8%a8-%d9%83%d9%85%d9%8a%d8%a7%d8%aa-%d8%a3%d9%82%d8%b1%d8%a7%d8%b5-%d9%85%d9%87%d9%84%d9%88%d8%b3%d8%a9-1583851.html', 'summary': 'إجهاض تهريب كميات أقراص مهلوسة. أسفرت عملية أمنية مشتركة بين مصالح الأمن الوطني والجمارك بمعبر باب سبتة، مساء السبت 28 يونيو الجاري، عن إجهاض محاولة تهريب شحنة كبيرة من الأقراص المهلوسة نحو المغرب، تتكون من 102.000 قرص طبي مخدر. ومكنت هذه العملية المشتركة من ضبط سائقة سيارة مرقمة بالخارج، وهي مواطنة إسبانية من أصول مغربية برفقة ابنيها وسيدة مغربية أخرى،  إجهاض تهريب كميات أقراص مهلوسة     - هسبريس جريدة إلكترونية مغربية .', 'size': 3}, {'id': '114', 'title': 'معبر سبتة.. إجهاض محاولة تهريب أزيد من 100 ألف قرص “ريفوتريل”', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%85%d8%b9%d8%a8%d8%b1-%d8%b3%d8%a8%d8%aa%d8%a9-%d8%a5%d8%ac%d9%87%d8%a7%d8%b6-%d9%85%d8%ad%d8%a7%d9%88%d9%84%d8%a9-%d8%aa%d9%87%d8%b1%d9%8a%d8%a8-%d8%a3%d8%b2%d9%8a%d8%af-%d9%85%d9%86-100-%d8%a3/', 'summary': 'معبر سبتة.. إجهاض محاولة تهريب أزيد من 100 ألف قرص “ريفوتريل”. أسفرت عملية أمنية مشتركة بين مصالح الأمن الوطني والجمارك بمعبر باب سبتة، مساء أمس السبت (28 يونيو)، عن إجهاض محاولة تهريب شحنة كبيرة من الأقراص المهلوسة نحو المغرب، تتكون من 102.000 قرص طبي مخدر. ومكنت هذه العملية المشتركة من ضبط سائقة سيارة مرقمة بالخارج، وهي مواطنة إسبانية من أصول مغربية برفقة ابنيها وسيدة مغربية أخرى،', 'size': 4}, {'id': '279', 'title': 'اعتقال مغربيتين وابنيهما بعد محاولتهم تهريب كمية ضخمة من الأقراص المهلوسة إلى المغرب', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/408407.html', 'summary': 'اعتقال مغربيتين وابنيهما بعد محاولتهم تهريب كمية ضخمة من الأقراص المهلوسة إلى المغرب. أسفرت عملية أمنية مشتركة بين مصالح الأمن الوطني والجمارك بمعبر باب سبتة، مساء السبت 28 يونيو الجاري، عن إجهاض محاولة تهريب شحنة كبيرة من الأقراص', 'size': 4}, {'id': '303', 'title': 'إجهاض محاولة تهريب شحنة من الأقراص المهلوسة بمعبر باب سبتة', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/316870/', 'summary': 'إجهاض محاولة تهريب شحنة من الأقراص المهلوسة بمعبر باب سبتة. أسفرت عملية أمنية مشتركة بين مصالح الأمن الوطني والجمارك بمعبر باب سبتة، مساء السبت 28 يونيو الجاري، عن إجهاض محاولة تهريب شحنة كبيرة من الأقراص المهلوسة نحو المغرب، تتكون من 102.000 قرص طبي مخدر. وقد مكنت هذه العملية المشتركة من ضبط سائقة سيارة مرقمة بالخارج، وهي مواطنة إسبانية من أصول مغربية برفقة ابنيها وسيدة مغربية', 'size': 5}, {'id': '327', 'title': 'باب سبتة.. إحباط عملية تهريب شحنة ضخمة من الأقراص المخدرة', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a8%d8%a7%d8%a8-%d8%b3%d8%a8%d8%aa%d8%a9-%d8%a5%d8%ad%d8%a8%d8%a7%d8%b7-%d8%b9%d9%85%d9%84%d9%8a%d8%a9-%d8%aa%d9%87%d8%b1%d9%8a%d8%a8-%d8%b4%d8%ad%d9%86%d8%a9-%d8%b6%d8%ae%d9%85%d8%a9-%d9%85/', 'summary': 'باب سبتة.. إحباط عملية تهريب شحنة ضخمة من الأقراص المخدرة. أسفرت عملية أمنية مشتركة بين مصالح الأمن الوطني والجمارك بمعبر باب سبتة، مساء السبت 28 يونيو الجاري، عن إجهاض محاولة تهريب شحنة كبيرة من الأقراص المهلوسة نحو المغرب، تتكون من 102.000 قرص طبي مخدر. وقد مكنت هذه العملية المشتركة من ضبط سائقة سيارة مرقمة بالخارج، وهي مواطنة إسبانية من أصول مغربية برفقة ابنيها وسيدة مغربية  باب سبتة.. إحباط عملية تهريب شحنة ضخمة من الأقراص المخدرة     .', 'size': 5}], 'main_title': 'إجهاض محاولة تهريب شحنة من الأقراص المهلوسة بمعبر باب سبتة'}, {'community_id': '7', 'articles': [{'id': '65', 'title': 'الرباط.. توقيف متطرفة موالية لتنظيم “داعش” الإرهابي للاشتباه في تورطها في الإعداد والتحضير لتنفيذ مخطط إرهابي بالغ الخطورة', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/202680', 'summary': 'الرباط.. توقيف متطرفة موالية لتنظيم “داعش” الإرهابي للاشتباه في تورطها في الإعداد والتحضير لتنفيذ مخطط إرهابي بالغ الخطورة.  تمكن المكتب المركزي للأبحاث القضائية على ضوء معلومات استخباراتية دقيقة وفرتها المديرية العامة لمراقبة التراب الوطني، أمس الجمعة، من توقيف متطرفة موالية لتنظيم “داعش” الإرهابي، تبلغ من العمر 21 سنة وتتابع دراستها في أحد المعاهد التقنية العليا، وذلك للاشتباه في تورطها في الإعداد والتحضير لتنفيذ مخطط إرهابي بالغ الخطورة يستهدف المساس الخطير بالنظام العام.', 'size': 2}, {'id': '119', 'title': 'أعدت لمخطط إرهابي.. توقيف متطرفة موالية لـ”داعش” بالرباط', 'source': 'assabah.ma', 'link': 'https://assabah.ma/855987.html', 'summary': 'أعدت لمخطط إرهابي.. توقيف متطرفة موالية لـ”داعش” بالرباط. تمكن المكتب المركزي للأبحاث القضائية على ضوء معلومات استخباراتية دقيقة وفرتها المديرية العامة لمراقبة التراب الوطني، أمس الجمعة، من توقيف متطرفة موالية لتنظيم “داعش” الإرهابي، تبلغ من العمر 21 سنة وتتابع دراستها في أحد المعاهد التقنية العليا، وذلك للاشتباه في تورطها في الإعداد والتحضير لتنفيذ مخطط إرهابيأكمل القراءة » المقالة أعدت لمخطط إرهابي.. توقيف متطرفة موالية لـ”داعش” بالرباط  .', 'size': 2}], 'main_title': 'الرباط.. توقيف متطرفة موالية لتنظيم “داعش” الإرهابي للاشتباه في تورطها في الإعداد والتحضير لتنفيذ مخطط إرهابي بالغ الخطورة'}, {'community_id': '1', 'articles': [{'id': '83', 'title': 'سور ثانوية ينهار على خمسيني وقطيعه بتيموليلت ويخلف مأساة صادمة', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/408369.html', 'summary': 'سور ثانوية ينهار على خمسيني وقطيعه بتيموليلت ويخلف مأساة صادمة. لقي رجل خمسيني مصرعه، صباح السبت 28 يونيو الجاري، إثر انهيار جزء من سور ثانوية عمر بن عبد العزيز التأهيلية بجماعة تيموليلت، التابعة لإقليم أزيلال،', 'size': 2}, {'id': '214', 'title': 'مقتل راعٍ وأغنامه في انهيار سور متهالك لمؤسسة تعليمية في أزيلال', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d9%85%d9%82%d8%aa%d9%84-%d8%b1%d8%a7%d8%b9%d9%8d-%d9%88%d8%a3%d8%ba%d9%86%d8%a7%d9%85%d9%87-%d9%81%d9%8a-%d8%a7%d9%86%d9%87%d9%8a%d8%a7%d8%b1-%d8%b3%d9%88%d8%b1-%d9%85%d8%aa%d9%87%d8%a7%d9%84%d9%83/', 'summary': 'مقتل راعٍ وأغنامه في انهيار سور متهالك لمؤسسة تعليمية في أزيلال. المساء اليوم – أزيلال: لقي راعي غنم مصرعه، صباح اليوم السبت، جراء انهيار جزء من سور ثانوية عمر بن عبد العزيز التأهيلية بجماعة تيموليلت بإقليم أزيلال. كما لقي نفس المصير قطيع من الغنم كان الهالك،', 'size': 2}], 'main_title': 'سور ثانوية ينهار على خمسيني وقطيعه بتيموليلت ويخلف مأساة صادمة'}, {'community_id': '9', 'articles': [{'id': '95', 'title': 'الأمن الوطني ينجح في ضبط شحنة مهمة من الكوكايين الخالص قبل دخولها التراب الوطني', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/408382.html', 'summary': 'الأمن الوطني ينجح في ضبط شحنة مهمة من الكوكايين الخالص قبل دخولها التراب الوطني. تمكنت عناصر الأمن الوطني بمطار محمد الخامس الدولي بمدينة الدار البيضاء، يوم أمس الجمعة 27 يونيو الجاري، من توقيف مواطن ينحدر من إحدى دول إفريقيا', 'size': 2}, {'id': '129', 'title': 'الدار البيضاء.. تفتيش دقيق يطيح بمسافر إفريقي بحوزته 5,6 كلغ من الكوكايين', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/316829/', 'summary': 'الدار البيضاء.. تفتيش دقيق يطيح بمسافر إفريقي بحوزته 5,6 كلغ من الكوكايين. تمكنت عناصر الأمن الوطني بمطار محمد الخامس الدولي بمدينة الدار البيضاء، يوم أمس الجمعة 27 يونيو الجاري، من توقيف مواطن ينحدر من إحدى دول إفريقيا جنوب الصحراء، يبلغ من العمر 24 سنة، وذلك للاشتباه في تورطه في قضية تتعلق بالتهريب الدولي المخدر الكوكايين. وقد جرى توقيف المشتبه فيه مباشرة بعد وصوله على متن رحلة جوية', 'size': 4}, {'id': '159', 'title': '5.6 كيلو من الكوكايين بحوزة مسافر وصل مطار محمد الخامس قادما من أمريكا الجنوبية', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/5-6-%d9%83%d9%8a%d9%84%d9%88-%d9%85%d9%86-%d8%a7%d9%84%d9%83%d9%88%d9%83%d8%a7%d9%8a%d9%8a%d9%86-%d8%a8%d8%ad%d9%88%d8%b2%d8%a9-%d9%85%d8%b3%d8%a7%d9%81%d8%b1-%d9%88%d8%b5%d9%84-%d9%85%d8%b7%d8%a7/', 'summary': '5.6 كيلو من الكوكايين بحوزة مسافر وصل مطار محمد الخامس قادما من أمريكا الجنوبية. تمكنت عناصر الأمن الوطني بمطار محمد الخامس الدولي بمدينة الدار البيضاء، أمس الجمعة، من توقيف مواطن ينحدر من إحدى دول إفريقيا جنوب الصحراء، يبلغ من العمر 24 سنة، وذلك للاشتباه في تورطه في قضية تتعلق بالتهريب الدولي لمخدر الكوكايين. وقد جرى توقيف المشتبه فيه، وفق مصدر أمني، مباشرة بعد وصوله على متن رحلة جوية قادمة  5.6 كيلو من الكوكايين بحوزة مسافر وصل مطار محمد الخامس قادما من أمريكا الجنوبية     .', 'size': 4}, {'id': '166', 'title': 'توقيف إفريقي بمطار الدارالبيضاء بحوزته 5 كلغ من الكوكايين', 'source': 'rue20.com', 'link': 'https://rue20.com/916467.html', 'summary': 'توقيف إفريقي بمطار الدارالبيضاء بحوزته 5 كلغ من الكوكايين.  الرباط تمكنت عناصر الأمن الوطني بمطار محمد الخامس الدولي بمدينة الدار البيضاء، يوم أمس الجمعة 27 يونيو الجاري، من توقيف مواطن ينحدر من إحدى دول إفريقيا جنوب الصحراء، يبلغ من العمر 24 سنة، وذلك للاشتباه في تورطه في قضية تتعلق بالتهريب الدولي لمخدر الكوكايين. وقد جرى توقيف المشتبه فيه مباشرة بعد وصوله على متن الخبر توقيف إفريقي بمطار الدارالبيضاء بحوزته 5 كلغ من الكوكايين  .', 'size': 3}, {'id': '225', 'title': 'مطار محمد الخامس.. توقيف إفريقي قادم من أمريكا الجنوبية بحوزته كوكايين', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%85%d8%b7%d8%a7%d8%b1-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%ae%d8%a7%d9%85%d8%b3-%d8%aa%d9%88%d9%82%d9%8a%d9%81-%d8%a5%d9%81%d8%b1%d9%8a%d9%82%d9%8a-%d9%82%d8%a7%d8%af%d9%85-%d9%85%d9%86/', 'summary': 'مطار محمد الخامس.. توقيف إفريقي قادم من أمريكا الجنوبية بحوزته كوكايين. تمكنت عناصر الأمن الوطني بمطار محمد الخامس الدولي بمدينة الدار البيضاء، أمس الجمعة، من توقيف مواطن ينحدر من إحدى دول إفريقيا جنوب الصحراء، يبلغ من العمر 24 سنة، وذلك للاشتباه في تورطه في قضية تتعلق بالتهريب الدولي لمخدر الكوكايين. وقد جرى توقيف المشتبه فيه مباشرة بعد وصوله على متن رحلة جوية قادمة من …  مطار محمد الخامس.. توقيف إفريقي قادم من أمريكا الجنوبية بحوزته كوكايين     .', 'size': 2}], 'main_title': 'الدار البيضاء.. تفتيش دقيق يطيح بمسافر إفريقي بحوزته 5,6 كلغ من الكوكايين'}, {'community_id': '5', 'articles': [{'id': '115', 'title': 'يشكلان موضوع أوامر دولية بإلقاء القبض صادرة عن السلطات القضائية لبلادهما.. توقيف مواطنين بريطانيين في أكادير', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%8a%d8%b4%d9%83%d9%84%d8%a7%d9%86-%d9%85%d9%88%d8%b6%d9%88%d8%b9-%d8%a3%d9%88%d8%a7%d9%85%d8%b1-%d8%af%d9%88%d9%84%d9%8a%d8%a9-%d8%a8%d8%a5%d9%84%d9%82%d8%a7%d8%a1-%d8%a7%d9%84%d9%82%d8%a8%d8%b6/', 'summary': 'يشكلان موضوع أوامر دولية بإلقاء القبض صادرة عن السلطات القضائية لبلادهما.. توقيف مواطنين بريطانيين في أكادير. تمكنت عناصر المصلحة الولائية للشرطة القضائية بمدينة أكادير، بناء على معلومات دقيقة وفرتها مصالح المديرية العامة لمراقبة التراب الوطني، زوال اليوم السبت (28 يونيو)، من توقيف مواطنين من جنسية بريطانية، يشكلان موضوع أوامر دولية بإلقاء القبض صادرة عن السلطات القضائية لبلادهما. وذكر مصدر أمني أنه تم توقيف المواطنين الأجنبيين خلال عملية أمنية بمنطقة “أنزا” بمدينة', 'size': 5}, {'id': '125', 'title': 'أكادير.. توقيف مواطنين من جنسية بريطانية يشكلان موضوع أوامر دولية', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/316864/', 'summary': 'أكادير.. توقيف مواطنين من جنسية بريطانية يشكلان موضوع أوامر دولية. تمكنت عناصر المصلحة الولائية للشرطة القضائية بمدينة أكادير بناء على معلومات دقيقة وفرتها مصالح المديرية العامة لمراقبة التراب الوطني، زوال اليوم السبت، من توقيف مواطنين من جنسية بريطانية، يشكلان موضوع أوامر دولية بإلقاء القبض صادرة عن السلطات القضائية لبلادهما. وذكر مصدر أمني أنه تم توقيف المواطنين الأجنبيين خلال عملية أمنية بمنطقة “أنزا” بمدينة أكادير، وذلك', 'size': 5}, {'id': '172', 'title': 'أكادير.. توقيف بريطانيين يشكلان موضوع أوامر دولية بإلقاء القبض', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/467868.html', 'summary': 'أكادير.. توقيف بريطانيين يشكلان موضوع أوامر دولية بإلقاء القبض. تمكنت عناصر المصلحة الولائية للشرطة القضائية بمدينة أكادير بناء على معلومات دقيقة وفرتها مصالح المديرية العامة لمراقبة التراب الوطني، زوال اليوم السبت، من توقيف مواطنين من جنسية بريطانية، يشكلان موضوع أوامر دولية بإلقاء القبض صادرة عن السلطات القضائية لبلادهما. وذكر مصدر أمني أنه تم توقيف المواطنين الأجنبيين خلال عملية أمنية بمنطقة “أنزا” بمدينة أكادير، وذلك …', 'size': 3}, {'id': '322', 'title': 'أمن أكادير يطيح ببريطانيين مبحوث عنهما دوليا من “الإنتربول”', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1081598.html', 'summary': 'أمن أكادير يطيح ببريطانيين مبحوث عنهما دوليا من “الإنتربول”. تمكنت عناصر المصلحة الولائية للشرطة القضائية بمدينة أكادير بناء على معلومات دقيقة وفرتها مصالح المديرية العامة لمراقبة التراب الوطني، زوال أمس السبت، من توقيف مواطنين من جنسية بريطانية، يشكلان موضوع أوامر دولية بإلقاء القبض صادرة عن السلطات القضائية لبلادهما. وذكر مصدر أمني أنه تم توقيف المواطنين الأجنبيين خلال عملية أمنية بمنطقة “أنزا” بمدينة أكادير، وذلك ظهرت المقالة أمن أكادير يطيح ببريطانيين مبحوث عنهما دوليا من “الإنتربول”  .', 'size': 4}, {'id': '330', 'title': 'أكادير.. توقيف بريطانيين مطلوبين من "الأنتربول"', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a3%d9%83%d8%a7%d8%af%d9%8a%d8%b1-%d8%aa%d9%88%d9%82%d9%8a%d9%81-%d8%a8%d8%b1%d9%8a%d8%b7%d8%a7%d9%86%d9%8a%d9%8a%d9%86-%d9%85%d8%b7%d9%84%d9%88%d8%a8%d9%8a%d9%86-%d9%85%d9%86-%d8%a7%d9%84/', 'summary': 'أكادير.. توقيف بريطانيين مطلوبين من "الأنتربول". تمكنت عناصر المصلحة الولائية للشرطة القضائية بمدينة أكادير بناء على معلومات دقيقة وفرتها مصالح المديرية العامة لمراقبة التراب الوطني، أمس السبت، من توقيف مواطنين من جنسية بريطانية، يشكلان موضوع أوامر دولية بإلقاء القبض صادرة عن السلطات القضائية لبلادهما. وذكر مصدر أمني أنه تم توقيف المواطنين الأجنبيين خلال عملية أمنية بمنطقة "أنزا" بمدينة أكادير، وذلك بعدما  أكادير.. توقيف بريطانيين مطلوبين من "الأنتربول"     .', 'size': 4}], 'main_title': 'يشكلان موضوع أوامر دولية بإلقاء القبض صادرة عن السلطات القضائية لبلادهما.. توقيف مواطنين بريطانيين في أكادير'}, {'community_id': '6', 'articles': [{'id': '117', 'title': 'دعا الأمم المتحدة ومجلس الأمن إلى متابعة هذا “الاعتداء الجبان”.. “الأحرار” يدين بشدة الهجوم الإرهابي على السمارة', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%af%d8%b9%d8%a7-%d8%a7%d9%84%d8%a3%d9%85%d9%85-%d8%a7%d9%84%d9%85%d8%aa%d8%ad%d8%af%d8%a9-%d9%88%d9%85%d8%ac%d9%84%d8%b3-%d8%a7%d9%84%d8%a3%d9%85%d9%86-%d8%a5%d9%84%d9%89-%d9%85%d8%aa%d8%a7%d8%a8/', 'summary': 'دعا الأمم المتحدة ومجلس الأمن إلى متابعة هذا “الاعتداء الجبان”.. “الأحرار” يدين بشدة الهجوم الإرهابي على السمارة. عبر حزب التجمع الوطني للأحرار عن استهجانه واستنكاره البالغ لـ”لاعتداء الجبان” لميليشيا جبهة البوليساريو، بواسطة مقذوفات تستهدف المدنيين بمدينة السمارة، المدينة الروحية للصحراء المغربية. وجدد حزب التجمع الوطني للأحرار، في بلاغ له، إدانته بأشد العبارات لهذا العمل الإرهابي، الذي يعبر عن حالة اليأس التي وصلت إليها الأطروحة الانفصالية لجبهة “البوليساريو” الوهمية، بسبب النجاحات المتتالية', 'size': 4}, {'id': '137', 'title': 'حزب الأحرار يدين بشدة الهجوم الإرهابي على مدينة السمارة', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1081573.html', 'summary': 'حزب الأحرار يدين بشدة الهجوم الإرهابي على مدينة السمارة. أكد حزب التجمع الوطني للأحرار أنه تابع “باستهجان كبير واستنكار بالغ” الاعتداء الذي وصفه بـ”الجبان” الذي قامت به ميليشيا جبهة البوليساريو، باستخدام مقذوفات استهدفت المدنيين في مدينة السمارة، المدينة الروحية للصحراء المغربية. وجدّد الحزب “إدانته بأشد العبارات لهذا العمل الإرهابي”، معتبرا أنه “يعبر عن حالة اليأس التي وصلت إليها الأطروحة الانفصالية لجبهة البوليساريو الوهمية، بسبب ظهرت المقالة حزب الأحرار يدين بشدة الهجوم الإرهابي على مدينة السمارة  .', 'size': 5}, {'id': '165', 'title': '“الأحرار” الحزب الوحيد الذي يدين الهجوم الإرهابي الجبان للبوليساريو على مدينة السمارة ويدعو إلى تدخل أممي', 'source': 'rue20.com', 'link': 'https://rue20.com/916472.html', 'summary': '“الأحرار” الحزب الوحيد الذي يدين الهجوم الإرهابي الجبان للبوليساريو على مدينة السمارة ويدعو إلى تدخل أممي.  الرباط أدان حزب التجمع الوطني للأحرار، بشدة، الهجوم الإرهابي الذي استهدف، ليلة الجمعة-السبت، مدينة السمارة بمقذوفات أطلقتها ميليشيا “البوليساريو” الانفصالية، في اعتداء وصفه بـ”الجبان” يستهدف المدنيين، ويعكس حالة اليأس التي باتت تعيشها الأطروحة الانفصالية. وقال بلاغ صادر عن الحزب إن التجمع الوطني للأحرار، يدين بأشد العبارات لهذا العمل الإرهابي الذي يعبر عن حالة اليأس الخبر “الأحرار” الحزب الوحيد الذي يدين الهجوم الإرهابي الجبان للبوليساريو على مدينة السمارة ويدعو إلى تدخل أممي  .', 'size': 2}, {'id': '220', 'title': 'التجمع الوطني للأحرار يدين بشدة الاعتداء الإرهابي لمليشيا البوليساريو الإرهابية على مدينة السمارة', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d8%aa%d8%ac%d9%85%d8%b9-%d8%a7%d9%84%d9%88%d8%b7%d9%86%d9%8a-%d9%84%d9%84%d8%a3%d8%ad%d8%b1%d8%a7%d8%b1-%d9%8a%d8%af%d9%8a%d9%86-%d8%a8%d8%b4%d8%af%d8%a9-%d8%a7%d9%84%d8%a7%d8%b9%d8%aa/', 'summary': 'التجمع الوطني للأحرار يدين بشدة الاعتداء الإرهابي لمليشيا البوليساريو الإرهابية على مدينة السمارة. استنكر حزب التجمع الوطني للأحرار “الاعتداء الجبان لميليشيا جبهة البوليساريو، بواسطة مقذوفات تستهدف المدنيين بمدينة السمارة، المدينة الروحية للصحراء المغربية”. وجدد الحزب في بلاغ توصل “” بنسخة منه، “إدانته بأشد العبارات لهذا العمل الإرهابي الذي يعبر عن حالة اليأس التي وصلت إليها الأطروحة الانفصالية لجبهة “البوليساريو” الوهمية، بسبب النجاحات المتتالية التاريخية التي حققتها …  التجمع الوطني للأحرار يدين بشدة الاعتداء الإرهابي لمليشيا البوليساريو الإرهابية على مدينة السمارة     .', 'size': 3}, {'id': '356', 'title': 'التجمع الوطني للأحرار يدين الاعتداء الإرهابي لميليشيا “البوليساريو” في السمارة', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/223696/', 'summary': 'التجمع الوطني للأحرار يدين الاعتداء الإرهابي لميليشيا “البوليساريو” في السمارة. كمال عسو أدان حزب التجمع الوطني للأحرار الاعتداء الإرهابي لميليشيا جبهة البوليساريو، بواسطة مقذوفات تستهدف المدنيين بمدينة السمارة، المدينة الروحية للصحراء المغربية، والذي يعبر عن حالة اليأس التي وصلت إليها الأطروحة الانفصالية لجبهة “البوليساريو” الوهمية، بسبب النجاحات المتتالية التاريخية التي حققتها بلادنا، تحت القيادة الرشيدة لصاحب الجلالة الملك محمد السادس، في تدبير ملف الصحراء', 'size': 3}], 'main_title': 'حزب الأحرار يدين بشدة الهجوم الإرهابي على مدينة السمارة'}, {'community_id': '0', 'articles': [{'id': '161', 'title': 'توقعات أحوال الطقس لليوم السبت', 'source': 'soltana.ma', 'link': 'https://soltana.ma/1357481.html', 'summary': 'توقعات أحوال الطقس لليوم السبت. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم السبت، استمرار الطقس الحار إلى محليا جد حار بكل من السواحل والسهول الشمالية والوسطى ومناطق الأطلس الصغير، وأقصى الجنوب الشرقي للبلاد، وداخل الأقاليم الجنوبية. ويرتقب أيضا، تشكل خلايا رعدية ستعطي قطرات مطرية متفرقة أو زخات فوق كل من مناطق الأطلسين الكبير والمتوسط، وجنوب المنطقة الشرقية ومن المحتمل منطقة', 'size': 4}, {'id': '275', 'title': 'طقس الأحد: استمرار الأجواء الحارة بعدد من الجهات', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/202705', 'summary': 'طقس الأحد: استمرار الأجواء الحارة بعدد من الجهات.  تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليومه الأحد، استمرار الطقس الحار إلى محليا جد حار بكل من السواحل والسهول الشمالية والوسطى ومناطق الأطلس،وأقصى الجنوب الشرقي للبلاد، وداخل الأقاليم الجنوبية. ويرتقب أيضا، تشكل سحب غير مستقرة قد تعطي قطرات مطرية متفرقة فوق مناطق الأطلسين الكبير والصغير ومناطقهما المجاورة، مع تكون ضباب محلي خلال الصباح', 'size': 5}, {'id': '310', 'title': 'طقس الأحد.. أجواء حارة وقطرات مطرية متفرقة بهذه المناطق المغربية', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-577546.html', 'summary': 'طقس الأحد.. أجواء حارة وقطرات مطرية متفرقة بهذه المناطق المغربية. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليوم الأحد، استمرار الطقس الحار إلى محليا جد حار بكل من السواحل والسهول الشمالية والوسطى ومناطق الأطلس، وأقصى الجنوب الشرقي للبلاد، وداخل الأقاليم الجنوبية. ويرتقب أيضا، تشكل سحب غير مستقرة قد تعطي قطرات مطرية متفرقة فوق مناطق الأطلسين الكبير والصغير ومناطقهما المجاورة، مع تكون ضباب محلي', 'size': 5}, {'id': '332', 'title': 'استمرار الطقس الحار اليوم الأحد', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a7%d8%b3%d8%aa%d9%85%d8%b1%d8%a7%d8%b1-%d8%a7%d9%84%d8%b7%d9%82%d8%b3-%d8%a7%d9%84%d8%ad%d8%a7%d8%b1-%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%a3%d8%ad%d8%af-2/', 'summary': 'استمرار الطقس الحار اليوم الأحد. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الأحد، استمرار الطقس الحار إلى محليا جد حار بكل من السواحل والسهول الشمالية والوسطى ومناطق الأطلس، وأقصى الجنوب الشرقي للبلاد، وداخل الأقاليم الجنوبية. ويرتقب أيضا، تشكل سحب غير مستقرة قد تعطي قطرات مطرية متفرقة فوق مناطق الأطلسين الكبير والصغير ومناطقهما المجاورة، مع تكون ضباب محلي خلال الصباح والليل  استمرار الطقس الحار اليوم الأحد     .', 'size': 4}, {'id': '357', 'title': 'طقس الأحد.. استمرار الأجواء الحارة في عدة مناطق بالمملكة', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/223692/', 'summary': 'طقس الأحد.. استمرار الأجواء الحارة في عدة مناطق بالمملكة. كواليس اليوم تتوقع المديرية العامة للأرصاد الجوية، اليوم الأحد، استمرار الطقس الحار إلى محليا جد حار بكل من السواحل والسهول الشمالية والوسطى ومناطق الأطلس، وأقصى الجنوب الشرقي للبلاد، وداخل الأقاليم الجنوبية. ويرتقب أيضا، تشكل سحب غير مستقرة قد تعطي قطرات مطرية متفرقة فوق مناطق الأطلسين الكبير والصغير ومناطقهما المجاورة، مع تكون ضباب محلي', 'size': 3}], 'main_title': 'طقس الأحد: استمرار الأجواء الحارة بعدد من الجهات'}, {'community_id': '2', 'articles': [{'id': '212', 'title': 'إثيوبيا: انطلاق مسابقة مؤسسة محمد السادس في حفظ وتجويد القرآن الكريم', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%a5%d8%ab%d9%8a%d9%88%d8%a8%d9%8a%d8%a7-%d8%a7%d9%86%d8%b7%d9%84%d8%a7%d9%82-%d9%85%d8%b3%d8%a7%d8%a8%d9%82%d8%a9-%d9%85%d8%a4%d8%b3%d8%b3%d8%a9-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7/', 'summary': 'إثيوبيا: انطلاق مسابقة مؤسسة محمد السادس في حفظ وتجويد القرآن الكريم. المساء اليوم: أعطيت بأديس أبابا، الانطلاقة الرسمية للأطوار الإقصائية للدورة السادسة لمسابقة مؤسسة محمد السادس للعلماء الأفارقة في حفظ وتلاوة وتجويد القرآن الكريم، بمبادرة من فرع المؤسسة في إثيوبيا. ويشارك في هذه الإقصائيات، التي انطلقت', 'size': 2}, {'id': '226', 'title': 'أديس أبابا.. انطلاق التصفيات الإقصائية للدورة 6 من مسابقة مؤسسة محمد السادس للعلماء الأفارقة في القرآن الكريم', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a3%d8%af%d9%8a%d8%b3-%d8%a3%d8%a8%d8%a7%d8%a8%d8%a7-%d8%a7%d9%86%d8%b7%d9%84%d8%a7%d9%82-%d8%a7%d9%84%d8%aa%d8%b5%d9%81%d9%8a%d8%a7%d8%aa-%d8%a7%d9%84%d8%a5%d9%82%d8%b5%d8%a7%d8%a6%d9%8a%d8%a9/', 'summary': 'أديس أبابا.. انطلاق التصفيات الإقصائية للدورة 6 من مسابقة مؤسسة محمد السادس للعلماء الأفارقة في القرآن الكريم. انطلقت اليوم السبت بالعاصمة الإثيوبية أديس أبابا، بشكل رسمي، التصفيات الإقصائية للدورة السادسة من مسابقة مؤسسة محمد السادس للعلماء الأفارقة في حفظ وتلاوة وتجويد القرآن الكريم، وذلك بمبادرة من فرع المؤسسة في إثيوبيا. وتعرف هذه الإقصائيات مشاركة نحو ستين متسابقا من مختلف أنحاء البلاد، موزعين على أصناف المسابقة الثلاثة، ويتعلق الأمر بالحفظ الكامل …  أديس أبابا.. انطلاق التصفيات الإقصائية للدورة 6 من مسابقة مؤسسة محمد السادس للعلماء الأفارقة في القرآن الكريم     .', 'size': 2}], 'main_title': 'إثيوبيا: انطلاق مسابقة مؤسسة محمد السادس في حفظ وتجويد القرآن الكريم'}, {'community_id': '3', 'articles': [{'id': '252', 'title': '3 مدن مغربية بين الأكثر حرارة بالعالم', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/3-%d9%85%d8%af%d9%86-%d9%85%d8%ba%d8%b1%d8%a8%d9%8a%d8%a9-%d8%a8%d9%8a%d9%86-%d8%a7%d9%84%d8%a3%d9%83%d8%ab%d8%b1-%d8%ad%d8%b1%d8%a7%d8%b1%d8%a9-%d8%a8%d8%a7%d9%84%d8%b9%d8%a7%d9%84%d9%85-1583884.html', 'summary': '3 مدن مغربية بين الأكثر حرارة بالعالم. وضع موقع “إلدورادو ويذر”، المتخصص في قياس درجات الحرارة عبر العالم وتوقّع حالات الطقس على مدار كل يوم، ثلاث مدن مغربية ضمن قائمة أكثر 15 مدينة سجلت أعلى معدلات للحرارة على المستوى العالمي، صباح اليوم الأحد. واحتلت مدينة بن كرير المركز العاشر عالميًا، حيث سُجّلت حرارة وصلت إلى 46,4 درجة مئوية، متبوعة بمدينة القنيطرة التي  3 مدن مغربية بين الأكثر حرارة بالعالم     - هسبريس جريدة إلكترونية مغربية .', 'size': 2}, {'id': '306', 'title': 'تصنيف 3 مدن مغربية بين الأكثر حرارة بالعالم', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-577558.html', 'summary': 'تصنيف 3 مدن مغربية بين الأكثر حرارة بالعالم. صنف موقع “إلدورادو ويذر”، المتخصص في قياس درجات الحرارة عبر العالم، ثلاث مدن مغربية ضمن قائمة أكثر 15 مدينة سجلت أعلى معدلات للحرارة على المستوى العالمي، صباح اليوم الأحد. واحتلت مدينة بن جرير المركز العاشر عالميا، حيث سجلت حرارة وصلت إلى 46,4 درجة مئوية، متبوعة بمدينة القنيطرة التي جاءت في المركز الـ14 عالميا،', 'size': 2}], 'main_title': '3 مدن مغربية بين الأكثر حرارة بالعالم'}, {'community_id': '4', 'articles': [{'id': '295', 'title': 'في حال التتويج بكأس العرش.. حمد الله يوجه رسالة مؤثرة لأولمبيك آسفي ويعد اللاعبين بمكافأة خاصة', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%81%d9%8a-%d8%ad%d8%a7%d9%84-%d8%a7%d9%84%d8%aa%d8%aa%d9%88%d9%8a%d8%ac-%d8%a8%d9%83%d8%a3%d8%b3-%d8%a7%d9%84%d8%b9%d8%b1%d8%b4-%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d9%84%d9%87-%d9%8a%d9%88%d8%ac/', 'summary': 'في حال التتويج بكأس العرش.. حمد الله يوجه رسالة مؤثرة لأولمبيك آسفي ويعد اللاعبين بمكافأة خاصة. حرص الدولي المغربي عبد الرزاق حمد الله، مهاجم نادي الشباب السعودي، على توجيه رسالة دعم وتحفيز قوية لناديه السابق أولمبيك آسفي، وذلك قبل المواجهة المرتقبة أمام نهضة بركان في نهائي كأس العرش. ونشر حمد الله رسالته عبر حسابه الرسمي على “إنستغرام”، مؤكداً اعتزازه الكبير بالنادي وكل مكوناته من لاعبين وجهاز فني وإداريين وجماهير،', 'size': 3}, {'id': '296', 'title': 'حمد الله يعد لاعبي أولمبيك آسفي بمكافأة مالية قبل نهائي كأس العرش', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/316888/', 'summary': 'حمد الله يعد لاعبي أولمبيك آسفي بمكافأة مالية قبل نهائي كأس العرش. وعد عبد الرزاق حمد الله، مهاجم نادي الشباب السعودي، عناصر ناديه السابق أولمبيك آسفي، بمكافأة مالية في حال فوزهم على نادي نهضة بركان في نهائي كأس العرش، المقرر إجراءه اليوم الأحد بمدينة فاس. وكتب حمد الله، نجم نادي الشباب السعودي، في رسالة نشرها عبر حسابه الرسمي على إنستغرام، “ليس يوماً عادياً، بل هو موعد مع المجد،', 'size': 3}, {'id': '305', 'title': 'قبل نهائي كأس العرش..\xa0حمد الله يفاجئ لاعبي أولمبيك آسفي', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-577560.html', 'summary': 'قبل نهائي كأس العرش.. حمد الله يفاجئ لاعبي أولمبيك آسفي. عبر اللاعب المغربي عبد الرزاق حمد الله عن دعمه الكامل لمكونات فريقه السابق أولمبيك آسفي، قبل النهائي المرتقب أمام نهضة بركان، اليوم الأحد، على أرضية المركب الرياضي بمدينة فاس، ضمن منافسات كأس العرش. وكتب حمد الله، نجم نادي الشباب السعودي، في رسالة نشرها عبر حسابه الرسمي على إنستغرام، “ليس يوما عاديا، بل هو', 'size': 3}], 'main_title': 'في حال التتويج بكأس العرش.. حمد الله يوجه رسالة مؤثرة لأولمبيك آسفي ويعد اللاعبين بمكافأة خاصة'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    