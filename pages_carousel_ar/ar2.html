<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 06/07/2025 - 18h26</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '76', 'title': 'إعادة انتخاب المغرب عضوا في مجلس الفاو', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/divers/408758.html', 'summary': 'إعادة انتخاب المغرب عضوا في مجلس الفاو. جرى، أمس الجمعة بروما، إعادة انتخاب المملكة المغربية عضوا في مجلس منظمة الأمم المتحدة للأغذية والزراعة (الفاو)، لولاية جديدة تمتد من فاتح يوليوز 2026 إلى', 'size': 2}, {'id': '143', 'title': 'روما.. إعادة انتخاب المغرب عضوا في مجلس “الفاو”', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%b1%d9%88%d9%85%d8%a7-%d8%a5%d8%b9%d8%a7%d8%af%d8%a9-%d8%a7%d9%86%d8%aa%d8%ae%d8%a7%d8%a8-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d8%b9%d8%b6%d9%88%d8%a7-%d9%81%d9%8a-%d9%85%d8%ac%d9%84%d8%b3/', 'summary': 'روما.. إعادة انتخاب المغرب عضوا في مجلس “الفاو”. جرى، أمس الجمعة (4 يوليوز) بروما، إعادة انتخاب المملكة المغربية عضوا في مجلس منظمة الأمم المتحدة للأغذية والزراعة (الفاو)، لولاية جديدة تمتد من فاتح يوليوز 2026 إلى غاية اختتام الدورة السادسة والأربعين لمؤتمر المنظمة الأممية، المقررة في سنة 2029. وجرى انتخاب المغرب، ممثلا في شخص السفير الممثل الدائم للمملكة لدى الوكالات الأممية بروما، يوسف بلا،', 'size': 2}], 'main_title': 'إعادة انتخاب المغرب عضوا في مجلس الفاو'}, {'community_id': '1', 'articles': [{'id': '96', 'title': 'جماعة طنجة تعلن عن اعتماد نظام جديد لعملية ركن السيارات', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/economy/408780.html', 'summary': 'جماعة طنجة تعلن عن اعتماد نظام جديد لعملية ركن السيارات. أعلنت جماعة طنجة، الجمعة، عن انطلاق تنفيذ قرار تنظيمي، ابتداء من تاريخ 9 يوليوز الجاري، لتنظيم عملية ركن السيارات وفق معايير النجاعة والرقمنة والشفافية وتحسين', 'size': 2}, {'id': '199', 'title': 'نظام جديد لركن السيارات.. جماعة طنجة توقف العمل بـ “الصابو”', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/468632.html', 'summary': 'نظام جديد لركن السيارات.. جماعة طنجة توقف العمل بـ “الصابو”. متابعة أعلنت جماعة طنجة، الجمعة، عن انطلاق تنفيذ قرار تنظيمي، ابتداء من تاريخ 9 يوليوز الجاري، لتنظيم عملية ركن السيارات وفق معايير النجاعة والرقمنة والشفافية وتحسين العلاقة مع المرتفقين. وأشارت جماعة طنجة، في بيان، أن القرار التنظيمي المذكور ينص على عدم المس بحرية التنقل والتجوال، وذلك بوقف العمل بعقل السيارات المخالفة لقواعد الركن (SABOT)، بالإضافة …', 'size': 2}, {'id': '316', 'title': 'جماعة طنجة تعلن التوقف العمل بـ “الصابو”\xa0ابتداء من 9 يوليوز الجاري', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/203026', 'summary': 'جماعة طنجة تعلن التوقف العمل بـ “الصابو” ابتداء من 9 يوليوز الجاري.  أعلنت جماعة طنجة، اول امس الجمعة، عن انطلاق تنفيذ قرار تنظيمي،ابتداء من تاريخ 9 يوليوز الجاري، لتنظيم عملية ركن السيارات وفق معايير النجاعة والرقمنة والشفافية وتحسين العلاقة مع المرتفقين. و أشارت جماعة طنجة ،في بلاغ لها، أن القرار التنظيمي المذكور ينص على عدم المس بحرية التنقل والتجوال،وذلك بوقف العمل بعقل السيارات المخالفة لقواعد', 'size': 3}], 'main_title': 'جماعة طنجة تعلن التوقف العمل بـ “الصابو”\xa0ابتداء من 9 يوليوز الجاري'}, {'community_id': '2', 'articles': [{'id': '102', 'title': 'مصرع 24 شخصا إثر فيضانات في تكساس', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/divers/408787.html', 'summary': 'مصرع 24 شخصا إثر فيضانات في تكساس. لقي 24 شخصا على الأقل حتفهم جراء فيضانات ناجمة عن أمطار غزيرة في ولاية تكساس الأمريكية، حسب ما أفادته السلطات. وتم الإبلاغ عن فقدان أزيد من', 'size': 2}, {'id': '195', 'title': 'ارتفاع حصيلة فيضانات تكساس الأمريكية والبحث متواصل عن مفقودين', 'source': 'machahid24.com', 'link': 'https://machahid24.com/international/468652.html', 'summary': 'ارتفاع حصيلة فيضانات تكساس الأمريكية والبحث متواصل عن مفقودين. خلفت سيول جارفة اجتاحت وسط ولاية تكساس الأمريكية، 50 قتيلا على الأقل في وقت يتواصل البحث عن مفقودين.', 'size': 2}], 'main_title': 'مصرع 24 شخصا إثر فيضانات في تكساس'}, {'community_id': '3', 'articles': [{'id': '138', 'title': 'دراسة أمريكية حديثة تكشف عن علاج واعد لأخطر أنواع سرطان الثدي', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/health/408825.html', 'summary': 'دراسة أمريكية حديثة تكشف عن علاج واعد لأخطر أنواع سرطان الثدي. كشفت دراسة حديثة أجراها باحثون في مختبر "كولد سبرينغ هاربور" بولاية نيويورك الأمريكية عن علاج واعد يستهدف سرطان الثدي الثلاثي السلبي، أحد أكثر أنواع السرطان', 'size': 3}, {'id': '150', 'title': 'علاج واعد بأمريكا لأخطر أنواع سرطان الثدي', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/317530/', 'summary': 'علاج واعد بأمريكا لأخطر أنواع سرطان الثدي. كشفت دراسة حديثة أجراها باحثون في مختبر “كولد سبرينغ هاربور” بولاية نيويورك الأمريكية عن علاج واعد يستهدف سرطان الثدي الثلاثي السلبي، أحد أكثر أنواع السرطان شراسة وشيوعا بين الشابات. وذكرت الدراسة أن جزيئا يدعى (LINC01235)، وهو من الحمض النووي الريبي الطويل غير المشفر، يلعب دورا رئيسيا في تحفيز الخلايا السرطانية. وأظهرت التجارب أن تعطيل هذا', 'size': 3}, {'id': '177', 'title': 'دراسة أمريكية تكشف عن علاج واعد لأخطر أنواع سرطان الثدي', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%af%d8%b1%d8%a7%d8%b3%d8%a9-%d8%a3%d9%85%d8%b1%d9%8a%d9%83%d9%8a%d8%a9-%d8%aa%d9%83%d8%b4%d9%81-%d8%b9%d9%86-%d8%b9%d9%84%d8%a7%d8%ac-%d9%88%d8%a7%d8%b9%d8%af-%d9%84%d8%a3%d8%ae%d8%b7%d8%b1-%d8%a3/', 'summary': 'دراسة أمريكية تكشف عن علاج واعد لأخطر أنواع سرطان الثدي. كشفت دراسة حديثة أجراها باحثون في مختبر "كولد سبرينغ هاربور" بولاية نيويورك الأمريكية عن علاج واعد يستهدف سرطان الثدي الثلاثي السلبي، أحد أكثر أنواع السرطان شراسة وشيوعا بين الشابات. وذكرت الدراسة أن جزيئا يدعى (LINC01235)، وهو من الحمض النووي الريبي الطويل غير المشفر، يلعب دورا رئيسيا في تحفيز الخلايا السرطانية. وأظهرت التجارب أن تعطيل هذا  دراسة أمريكية تكشف عن علاج واعد لأخطر أنواع سرطان الثدي     .', 'size': 3}], 'main_title': 'دراسة أمريكية حديثة تكشف عن علاج واعد لأخطر أنواع سرطان الثدي'}, {'community_id': '4', 'articles': [{'id': '141', 'title': 'موتسيبي: هذه النسخة من كأس إفريقيا للأمم لكرة القدم للسيدات ستظل في الذاكرة', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%85%d9%88%d8%aa%d8%b3%d9%8a%d8%a8%d9%8a-%d9%87%d8%b0%d9%87-%d8%a7%d9%84%d9%86%d8%b3%d8%ae%d8%a9-%d9%85%d9%86-%d9%83%d8%a3%d8%b3-%d8%a5%d9%81%d8%b1%d9%8a%d9%82%d9%8a%d8%a7-%d9%84%d9%84%d8%a3%d9%85/', 'summary': 'موتسيبي: هذه النسخة من كأس إفريقيا للأمم لكرة القدم للسيدات ستظل في الذاكرة. أكد رئيس الاتحاد الإفريقي لكرة القدم، باتريس موتسيبي، اليوم السبت (5 يوليوز) بسلا، أن كأس إفريقيا للأمم للسيدات لكرة القدم، التي تحتضنها المملكة إلى غاية 26 يوليوز الجاري، ستظل في الذاكرة مقارنة بجميع النسخ السابقة للكان. وأضاف السيد موتسيبي، في مؤتمر صحافي بمركب محمد السادس لكرة القدم بالمعمورة بسلا، عقب اجتماع اللجنة التنفيذية للاتحاد الإفريقي', 'size': 2}, {'id': '184', 'title': 'موتسيبي : نسخة المغرب من كأس افريقيا للسيدات ستظل في الذاكرة', 'source': 'rue20.com', 'link': 'https://rue20.com/918395.html', 'summary': 'موتسيبي : نسخة المغرب من كأس افريقيا للسيدات ستظل في الذاكرة. . الرباط أكد رئيس الاتحاد الإفريقي لكرة القدم، باتريس موتسيبي، اليوم السبت بسلا، أن كأس إفريقيا للأمم للسيدات لكرة القدم، التي تحتضنها المملكة إلى غاية 26 يوليوز الجاري، ستظل في الذاكرة مقارنة بجميع النسخ السابقة للكان. وأضاف السيد موتسيبي، في مؤتمر صحافي بمركب محمد السادس لكرة القدم بالمعمورة بسلا، عقب اجتماع اللجنة التنفيذية للاتحاد الخبر موتسيبي : نسخة المغرب من كأس افريقيا للسيدات ستظل في الذاكرة  .', 'size': 2}], 'main_title': 'موتسيبي: هذه النسخة من كأس إفريقيا للأمم لكرة القدم للسيدات ستظل في الذاكرة'}, {'community_id': '5', 'articles': [{'id': '146', 'title': 'بنعبد الله يفتح النار على “أحزاب القفف” ويتهم الحكومة بتزييف الواقع', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/317541/', 'summary': 'بنعبد الله يفتح النار على “أحزاب القفف” ويتهم الحكومة بتزييف الواقع. دق نبيل بنعبد الله، الأمين العام لحزب التقدم والاشتراكية، ناقوس الخطر حول ما وصفه بـ”الاختلالات العميقة” التي تعرفها الساحة السياسية المغربية. بنعبد الله انتقد العزوف الانتخابي، و”الخطاب الرسمي المضلل” الذي تتبناه الحكومة. ولفت الأمين العام لحزب التقدم والاشتراكية، خلال لقاء تواصلي احتضنته مدينة الرباط، وجمع منتخبي الحزب السبت، إلى أن أكثر من 19 مليون', 'size': 2}, {'id': '364', 'title': 'بنعبد الله: ملتمس الرقابة سقط بـ”حسابات تافهة” والحكومة أجهضت “لجنة دعم الفراقشية”', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1083480.html', 'summary': 'بنعبد الله: ملتمس الرقابة سقط بـ”حسابات تافهة” والحكومة أجهضت “لجنة دعم الفراقشية”. عبر الأمين العام لحزب التقدم والاشتراكية، محمد نبيل بنعبد الله، عن أسفه لـ”إجهاض” مبادرة تقديم ملتمس الرقابة ضد حكومة عزيز أخنوش، رعم جهود قام بها حزبه لتقريب وجهات النظر بين مكونات المعارضة، مرجعا ذلك لأسباب وصفها بـ”تافهة وحسابات ثانوية وشكلية، وربما لخلفيات أخرى”. وشدد بنعبد الله، في تقرير المكتب السياسي الذي تلاه أمام أمام الدورة ظهرت المقالة بنعبد الله: ملتمس الرقابة سقط بـ”حسابات تافهة” والحكومة أجهضت “لجنة دعم الفراقشية”  .', 'size': 2}], 'main_title': 'بنعبد الله يفتح النار على “أحزاب القفف” ويتهم الحكومة بتزييف الواقع'}, {'community_id': '6', 'articles': [{'id': '149', 'title': 'دراسة: شرب الصودا يزيد خطر الإصابة بالسكري أكثر من الأطعمة المحلاة', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/non-classes/317533/', 'summary': 'دراسة: شرب الصودا يزيد خطر الإصابة بالسكري أكثر من الأطعمة المحلاة. أظهرت دراسة حديثة أجراها باحثون من جامعة “بريغهام يونغ” في الولايات المتحدة، أن تناول المشروبات المحلاة بالسكر، مثل الصودا، قد يزيد من خطر الإصابة بالنوع الثاني من داء السكري بشكل أكبر مقارنة بتناول الأطعمة المحلاة بالسكر مثل الكعك والبسكويت. وقالت الدكتورة كارين ديلا كورتي، المؤلفة الرئيسية للدراسة وأستاذة التغذية في الجامعة، إن هذا البحث يسلط', 'size': 2}, {'id': '175', 'title': 'دراسة: المشروبات المحلاة بالسكر تزيد خطر الإصابة بالسكري أكثر من الأطعمة', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%af%d8%b1%d8%a7%d8%b3%d8%a9-%d8%a7%d9%84%d9%85%d8%b4%d8%b1%d9%88%d8%a8%d8%a7%d8%aa-%d8%a7%d9%84%d9%85%d8%ad%d9%84%d8%a7%d8%a9-%d8%a8%d8%a7%d9%84%d8%b3%d9%83%d8%b1-%d8%aa%d8%b2%d9%8a%d8%af-%d8%ae/', 'summary': 'دراسة: المشروبات المحلاة بالسكر تزيد خطر الإصابة بالسكري أكثر من الأطعمة. أظهرت دراسة حديثة أجراها باحثون من جامعة "بريغهام يونغ" في الولايات المتحدة، أن تناول المشروبات المحلاة بالسكر، مثل الصودا، قد يزيد من خطر الإصابة بالنوع الثاني من داء السكري بشكل أكبر مقارنة بتناول الأطعمة المحلاة بالسكر مثل الكعك والبسكويت. وقالت الدكتورة كارين ديلا كورتي، المؤلفة الرئيسية للدراسة وأستاذة التغذية في الجامعة، إن هذا البحث يسلط  دراسة: المشروبات المحلاة بالسكر تزيد خطر الإصابة بالسكري أكثر من الأطعمة     .', 'size': 2}], 'main_title': 'دراسة: شرب الصودا يزيد خطر الإصابة بالسكري أكثر من الأطعمة المحلاة'}, {'community_id': '7', 'articles': [{'id': '152', 'title': 'حكيمي يخلد اسمه في التاريخ بتحطيمه الرقم الأسطوري لداني ألفيس', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/317516/', 'summary': 'حكيمي يخلد اسمه في التاريخ بتحطيمه الرقم الأسطوري لداني ألفيس. سطّر الدولي المغربي أشرف حكيمي إنجازًا تاريخيًا جديدًا يضاف إلى رصيده الحافل، بعدما قاد فريقه باريس سان جيرمان لتحقيق فوز ثمين على بايرن ميونخ بهدفين دون رد، في مباراة مثيرة جرت لحساب نصف نهائي كأس العالم للأندية، الجارية في الولايات المتحدة الأمريكية. ولم يكتف حكيمي بالمساهمة في الأداء الدفاعي القوي للفريق الباريسي، بل وقع على', 'size': 2}, {'id': '190', 'title': 'حكيمي يصنع هدفاً خرافياً ويقود باريس سان جيرمان لنصف نهائي كأس العالم للأندية', 'source': 'rue20.com', 'link': 'https://rue20.com/918309.html', 'summary': 'حكيمي يصنع هدفاً خرافياً ويقود باريس سان جيرمان لنصف نهائي كأس العالم للأندية. . الرباط ساهم الدولي المغربي أشرف حكيمي في تأهل فريقه باريس سان جيرمان الفرنسي إلى المربع الذهبي لكأس العالم للأندية لكرة القدم، بصناعة الهدف الثاني الحاسم ضد بايرن ميونخ الألماني، اليوم السبت بملعب ميرسيديس بانز بأتالانتا بالولايات المتحدة الأمريكية. وراوغ الظهير الأيمن المتألق ثلاثة لاعبين من الفريق البافاري ليمنح تمريرة حاسمة لزميله عثمان ديمبيلي، الخبر حكيمي يصنع هدفاً خرافياً ويقود باريس سان جيرمان لنصف نهائي كأس العالم للأندية  .', 'size': 2}, {'id': '229', 'title': 'كأس العالم للأندية.. حكيمي يساهم في تأهل باريس سان جيرمان إلى المربع الذهبي', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/224179/', 'summary': 'كأس العالم للأندية.. حكيمي يساهم في تأهل باريس سان جيرمان إلى المربع الذهبي. كواليس اليوم ساهم الدولي المغربي أشرف حكيمي في تأهل فريقه باريس سان جيرمان الفرنسي إلى المربع الذهبي لكأس العالم للأندية لكرة القدم، بصناعة الهدف الثاني الحاسم ضد بايرن ميونخ الألماني، اليوم السبت بملعب ميرسيديس بانز بأتالانتا بالولايات المتحدة الأمريكية. وراوغ الظهير الأيمن المتألق ثلاثة لاعبين من الفريق البافاري ليمنح تمريرة حاسمة لزميله عثمان ديمبيلي،', 'size': 3}], 'main_title': 'كأس العالم للأندية.. حكيمي يساهم في تأهل باريس سان جيرمان إلى المربع الذهبي'}, {'community_id': '8', 'articles': [{'id': '157', 'title': 'تحرير الملك العمومي: قراءة سوسيو-اقتصادية في ضوء أهداف التنمية البشرية', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1083456.html', 'summary': 'تحرير الملك العمومي: قراءة سوسيو-اقتصادية في ضوء أهداف التنمية البشرية. شهدت السنوات الأخيرة في المغرب سلسلة من التدخلات الميدانية التي باشرتها السلطات العمومية لتحرير الملك العمومي من مظاهر الاستغلال غير القانوني، خاصة من طرف الباعة المتجولين. وتأتي هذه العمليات في سياق الجهود الرامية إلى تأهيل الفضاءات العمومية، وتحسين النظام الحضري، والحد من الفوضى والعشوائية. غير أن هذا التوجه، وإن كان منسجماً مع متطلبات التنظيم العمراني، ظهرت المقالة تحرير الملك العمومي: قراءة سوسيو-اقتصادية في ضوء أهداف التنمية البشرية  .', 'size': 2}, {'id': '397', 'title': 'الذكاء الإصطناعي والعدالة المجالية في المغرب: بين فرص التمكين ومخاطر التهميش', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d8%b0%d9%83%d8%a7%d8%a1-%d8%a7%d9%84%d8%a5%d8%b5%d8%b7%d9%86%d8%a7%d8%b9%d9%8a-%d9%88%d8%a7%d9%84%d8%b9%d8%af%d8%a7%d9%84%d8%a9-%d8%a7%d9%84%d9%85%d8%ac%d8%a7%d9%84%d9%8a%d8%a9-%d9%81/', 'summary': 'الذكاء الإصطناعي والعدالة المجالية في المغرب: بين فرص التمكين ومخاطر التهميش. يعيش العالم اليوم على إيقاع الثورة الرقمية، وتعد تقنيات الذكاء الإصطناعي من أبرز معالم هذه الثورة، إذ باتت تؤثر في مختلف القطاعات، من الإقتصاد والصحة إلى التعليم والإدارة، وفي السياق المغربي، تبرز الحاجة إلى طرح سؤال محوري: هل يمكن للذكاء الإصطناعي أن يساهم في تحقيق العدالة المجالية، أم أنه سيعيد إنتاج التفاوتات الموجودة …  الذكاء الإصطناعي والعدالة المجالية في المغرب: بين فرص التمكين ومخاطر التهميش     .', 'size': 2}], 'main_title': 'تحرير الملك العمومي: قراءة سوسيو-اقتصادية في ضوء أهداف التنمية البشرية'}, {'community_id': '9', 'articles': [{'id': '179', 'title': 'استمرار الطقس الحار اليوم الأحد', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a7%d8%b3%d8%aa%d9%85%d8%b1%d8%a7%d8%b1-%d8%a7%d9%84%d8%b7%d9%82%d8%b3-%d8%a7%d9%84%d8%ad%d8%a7%d8%b1-%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%a3%d8%ad%d8%af-3/', 'summary': 'استمرار الطقس الحار اليوم الأحد. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الأحد، أن يظل الطقس حارا بالجنوب-الشرقي للبلاد، وداخل الأقاليم الجنوبية، وبالمنطقة الشرقية، وبالسايس وبسهول تادلة والرحامنة. ومن المرتقب ظهور سحب منخفضة نسبيا كثيفة مصحوبة بكتل ضبابية أو بضباب بالقرب من السواحل، وسحب غير مستقرة مرفوقة بقطرات مطرية أو بزخات رعدية ستهم مرتفعات الأطلسين الكبير والمتوسط والمنطقة الشرقية. ويتوقع  استمرار الطقس الحار اليوم الأحد     .', 'size': 3}, {'id': '194', 'title': 'طقس حار اليوم الأحد بالمملكة مع ضباب وزخات رعدية في بعض المناطق', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/468655.html', 'summary': 'طقس حار اليوم الأحد بالمملكة مع ضباب وزخات رعدية في بعض المناطق. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الأحد، أن يظل الطقس حارا بالجنوب الشرقي للبلاد، وداخل الأقاليم الجنوبية، وبالمنطقة الشرقية، وبالسايس وبسهول تادلة والرحامنة.', 'size': 4}, {'id': '227', 'title': 'طقس الأحد.. أجواء حارة في بعض المناطق بالمملكة', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/224190/', 'summary': 'طقس الأحد.. أجواء حارة في بعض المناطق بالمملكة. كواليس اليوم تتوقع المديرية العامة للأرصاد الجوية، اليوم الأحد، أن يظل الطقس حارا بالجنوب-الشرقي للبلاد، وداخل الأقاليم الجنوبية، وبالمنطقة الشرقية، وبالسايس وبسهول تادلة والرحامنة. ومن المرتقب ظهور سحب منخفضة نسبيا كثيفة مصحوبة بكتل ضبابية أو بضباب بالقرب من السواحل، وسحب غير مستقرة مرفوقة بقطرات مطرية أو بزخات رعدية ستهم مرتفعات الأطلسين الكبير والمتوسط والمنطقة', 'size': 2}, {'id': '244', 'title': 'توقعات أحوال الطقس اليوم الأحد', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%aa%d9%88%d9%82%d8%b9%d8%a7%d8%aa-%d8%a3%d8%ad%d9%88%d8%a7%d9%84-%d8%a7%d9%84%d8%b7%d9%82%d8%b3-%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%a3%d8%ad%d8%af-39/', 'summary': 'توقعات أحوال الطقس اليوم الأحد. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليومه الأحد، أن يظل الطقس حارا بالجنوب-الشرقي للبلاد، وداخل الأقاليم الجنوبية، وبالمنطقة الشرقية، وبالسايس وبسهول تادلة والرحامنة. ومن المرتقب ظهور سحب منخفضة نسبيا كثيفة مصحوبة بكتل ضبابية أو بضباب بالقرب من السواحل، وسحب غير مستقرة مرفوقة بقطرات مطرية أو بزخات رعدية ستهم مرتفعات الأطلسين الكبير والمتوسط والمنطقة الشرقية. …  توقعات أحوال الطقس اليوم الأحد     .', 'size': 3}], 'main_title': 'طقس حار اليوم الأحد بالمملكة مع ضباب وزخات رعدية في بعض المناطق'}, {'community_id': '10', 'articles': [{'id': '186', 'title': 'لبؤات الأطلس يتعادلن أمام زامبيا في أول مباراة لنهائيات كأس أفريقيا', 'source': 'rue20.com', 'link': 'https://rue20.com/918383.html', 'summary': 'لبؤات الأطلس يتعادلن أمام زامبيا في أول مباراة لنهائيات كأس أفريقيا. . الرباط تعادل المنتخب الوطني المغربي لكرة القدم للسيدات مع نظيره الزامبي، بهدفين لمثلهما، في المباراة التي جمعتهما على أرضية الملعب الأولمبي بالرباط، اليوم السبت، برسم الجولة الأولى من المجموعة الأولى لكأس إفريقيا للأمم لكرة القدم (المغرب – 2024). وأحرز المنتخب الزامبي الهدف الأول منذ الدقيقة الأولى عبر باربارا باندا، فيما أدركت ابتسام الجرايدي الخبر لبؤات الأطلس يتعادلن أمام زامبيا في أول مباراة لنهائيات كأس أفريقيا  .', 'size': 2}, {'id': '198', 'title': 'كأس إفريقيا.. “سيدات الأطلس” يتعادلن في أول مباراة', 'source': 'machahid24.com', 'link': 'https://machahid24.com/sport/468635.html', 'summary': 'كأس إفريقيا.. “سيدات الأطلس” يتعادلن في أول مباراة. و.م.ع تعادل المنتخب الوطني المغربي أمام نظيره الزامبي، بهدفين لمثلهما، في المباراة التي جمعتهما على أرضية الملعب الأولمبي بالرباط، اليوم السبت، برسم الجولة الأولى من المجموعة الأولى لكأس إفريقيا للأمم لكرة القدم للسيدات (المغرب – 2024). وبادر المنتخب الزامبي للسيدات لهز الشباك منذ الدقيقة الأولى من المباراة عبر المتألقة باربارا باندا، لكن رد لبؤات الأطلس …', 'size': 2}, {'id': '226', 'title': 'كأس إفريقيا للسيدات.. لبؤات الأطلس يتعادلن أمام نظيرهن الزامبي', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/224194/', 'summary': 'كأس إفريقيا للسيدات.. لبؤات الأطلس يتعادلن أمام نظيرهن الزامبي. كواليس اليوم تعادل المنتخب الوطني المغربي أمام نظيره الزامبي، بهدفين لمثلهما، في المباراة التي جمعتهما على أرضية الملعب الأولمبي بالرباط، أمس السبت، برسم الجولة الأولى من المجموعة الأولى لكأس إفريقيا للأمم لكرة القدم للسيدات (المغرب – 2024). وبادر المنتخب الزامبي للسيدات لهز الشباك منذ الدقيقة الأولى من المباراة عبر المتألقة باربارا باندا، لكن رد', 'size': 3}], 'main_title': 'كأس إفريقيا للسيدات.. لبؤات الأطلس يتعادلن أمام نظيرهن الزامبي'}, {'community_id': '11', 'articles': [{'id': '270', 'title': 'جيش المغرب في استعراض بموروني', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d8%ac%d9%8a%d8%b4-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d9%81%d9%8a-%d8%a7%d8%b3%d8%aa%d8%b9%d8%b1%d8%a7%d8%b6-%d8%a8%d9%85%d9%88%d8%b1%d9%88%d9%86%d9%8a-1588306.html', 'summary': 'جيش المغرب في استعراض بموروني. تنفيذا لتعليمات الملك محمد السادس، القائد الأعلى ورئيس أركان الحرب العامة للقوات المسلحة الملكية، شاركت تجريدة من القوات المسلحة الملكية في إحياء الذكرى الخمسين لاستقلال جمهورية القمر الاتحادية؛ وذلك استجابة لدعوة وجهت إلى المغرب. وذكر بلاغ للقيادة العامة للقوات المسلحة الملكية أن هذه التجريدة، المكونة من فرقة تابعة للواء الثاني للمشاة المظليين، شاركت في الاستعراض  جيش المغرب في استعراض بموروني     - هسبريس جريدة إلكترونية مغربية .', 'size': 2}, {'id': '351', 'title': 'تجريدة من القوات المسلحة الملكية تشارك في احتفالات استقلال جزر القمر', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1083534.html', 'summary': 'تجريدة من القوات المسلحة الملكية تشارك في احتفالات استقلال جزر القمر. تنفيذا للتعليمات السامية للملك محمد السادس، ظهرت المقالة تجريدة من القوات المسلحة الملكية تشارك في احتفالات استقلال جزر القمر  .', 'size': 2}, {'id': '377', 'title': 'تجريدة من القوات المسلحة الملكية تشارك في احتفالات الذكرى الخمسين لاستقلال جمهورية القمر', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/468663.html', 'summary': 'تجريدة من القوات المسلحة الملكية تشارك في احتفالات الذكرى الخمسين لاستقلال جمهورية القمر. تنفيذا للتعليمات السامية للملك محمد السادس، القائد الأعلى ورئيس أركان الحرب العامة للقوات المسلحة الملكية، شاركت تجريدة من القوات المسلحة الملكية في إحياء الذكرى الخمسين لاستقلال جمهورية القمر الاتحادية، وذلك استجابة لدعوة وجهت إلى المغرب.', 'size': 4}, {'id': '384', 'title': 'تجريدة من القوات المسلحة الملكية تشارك في احتفالات الذكرى 50 لاستقلال جمهوية القمر الاتحادية', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%aa%d8%ac%d8%b1%d9%8a%d8%af%d8%a9-%d9%85%d9%86-%d8%a7%d9%84%d9%82%d9%88%d8%a7%d8%aa-%d8%a7%d9%84%d9%85%d8%b3%d9%84%d8%ad%d8%a9-%d8%a7%d9%84%d9%85%d9%84%d9%83%d9%8a%d8%a9-%d8%aa%d8%b4%d8%a7%d8%b1/', 'summary': 'تجريدة من القوات المسلحة الملكية تشارك في احتفالات الذكرى 50 لاستقلال جمهوية القمر الاتحادية.  – و م ع تنفيذا للتعليمات السامية لصاحب الجلالة الملك محمد السادس، القائد الأعلى ورئيس أركان الحرب العامة للقوات المسلحة الملكية، شاركت تجريدة من القوات المسلحة الملكية في...  تجريدة من القوات المسلحة الملكية تشارك في احتفالات الذكرى 50 لاستقلال جمهوية القمر الاتحادية     .', 'size': 2}, {'id': '388', 'title': 'بتعليمات ملكية.. القوات المسلحة الملكية تشارك في احتفالات الذكرى 50 لاستقلال جمهوية القمر الاتحادية', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/224210/', 'summary': 'بتعليمات ملكية.. القوات المسلحة الملكية تشارك في احتفالات الذكرى 50 لاستقلال جمهوية القمر الاتحادية. و م ع تنفيذا للتعليمات السامية لصاحب الجلالة الملك محمد السادس، القائد الأعلى ورئيس أركان الحرب العامة للقوات المسلحة الملكية، شاركت تجريدة من القوات المسلحة الملكية في إحياء الذكرى الخمسين لاستقلال جمهورية القمر الاتحادية، وذلك استجابة لدعوة وجهت إلى المغرب. وذكر بلاغ للقيادة العامة للقوات المسلحة الملكية أن هذه التجريدة المكونة من فرقة تابعة', 'size': 3}], 'main_title': 'تجريدة من القوات المسلحة الملكية تشارك في احتفالات الذكرى الخمسين لاستقلال جمهورية القمر'}, {'community_id': '12', 'articles': [{'id': '284', 'title': 'الدار البيضاء.. انتشال جثة طفل غرق في حوض للصرف الصحي بأولاد عزوز (فيديو)', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-637549.html', 'summary': 'الدار البيضاء.. انتشال جثة طفل غرق في حوض للصرف الصحي بأولاد عزوز (فيديو). هبة بريس - الدار البيضاء انتشلت فرقة الغطس التابعة للوقاية المدنية، اليوم الأحد 6 يوليوز، جثة طفل قاصر بعد غرقه في بركة مائية لتجميع المياه العادمة بمنطقة “دار 16” التابعة لجماعة أولاد عزوز نواحي الدار البيضاء، في حادث مأساوي أعاد إلى الواجهة خطر الإهمال في محيط المنشآت المائية غير المؤمنة. الطفل الضحية، البالغ من العمر حوالي 15 سنة، كان في طريقه رفقة والدته لزيارة أحد الأقرباء بمقبرة محلية بمناسبة يوم عاشوراء، قبل أن تبتلعه البركة المجاورة لإحدى المقاولات، وسط صدمة كبيرة في صفوف الساكنة المحلية. http://www.youtube.com/watch?v=DMN16tM4zp وقد واجهت فرق الإنقاذ صعوبات كبيرة في عملية الانتشال، بسبب عمق البركة وكثافة الأوحال وتراكم الأعشاب، في وقت تجمهر فيه العشرات من المواطنين الذين تابعوا المشهد بحزن واستياء. وباشرت عناصر الدرك الملكي، رفقة ممثل السلطة المحلية، الإجراءات القانونية لمعاينة الحادث، فيما تم نقل جثة الضحية إلى مشرحة الرحمة، بناءً على تعليمات النيابة العامة، التي أمرت بفتح تحقيق للكشف عن ظروف الحادث، وتحديد المسؤوليات بشأن غياب وسائل الحماية حول بركة مائية تُعد مصيدة قاتلة للأطفال.', 'size': 2}, {'id': '354', 'title': 'مصرع طفل في بركة للصرف الصحي بـ”أولاد عزوز” نواحي الدار البيضاء', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1083521.html', 'summary': 'مصرع طفل في بركة للصرف الصحي بـ”أولاد عزوز” نواحي الدار البيضاء. لقي طفل يبلغ من العمر 15 عاما مصرعه غرقا في بركة للصرف الصحي تابعة لإحدى الشركات الخاصة، وذلك صباح اليوم الأحد الموافق 6 يوليو 2025، في فاجعة مؤلمة بمنطقة العراقي (دار 16) بأولاد عزوز نواحي الدار البيضاء. وحسب المعطيات التي حصلت عليها جريدة “العمق” من مصادر محلية فإن الضحية كان برفقة عائلته في زيارة لقبر ظهرت المقالة مصرع طفل في بركة للصرف الصحي بـ”أولاد عزوز” نواحي الدار البيضاء  .', 'size': 2}], 'main_title': 'الدار البيضاء.. انتشال جثة طفل غرق في حوض للصرف الصحي بأولاد عزوز (فيديو)'}, {'community_id': '13', 'articles': [{'id': '322', 'title': 'أوناجم ينضم إلى نادي كهرباء الإسماعيلية', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/sport/proplayers/408831.html', 'summary': 'أوناجم ينضم إلى نادي كهرباء الإسماعيلية. أعلن نادي كهرباء الإسماعيلية المصري لكرة القدم، اليوم الأحد، تعاقده مع اللاعب المغربي محمد أوناجم.ووقع اللاعب السابق للوداد المغربي والزمالك المصري والصقور الليبي على عقد', 'size': 2}, {'id': '343', 'title': 'أوناجم يعزز صفوف نادي كهرباء الإسماعيلية المصري', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/317555/', 'summary': 'أوناجم يعزز صفوف نادي كهرباء الإسماعيلية المصري. أعلن نادي كهرباء الإسماعيلية المصري لكرة القدم، اليوم الأحد، تعاقده مع اللاعب المغربي محمد أوناجم. ووقع اللاعب السابق للوداد المغربي والزمالك المصري والصقور الليبي على عقد للعب مع نادي كهرباء الإسماعلية الذي صعد إلى الدوري المصري الممتاز لأول مرة في تاريخه، لمدة موسمين. ولعب أوناجم في صفوف الوداد البيضاوي لتسع سنوات حقق معه فيها العديد', 'size': 2}], 'main_title': 'أوناجم ينضم إلى نادي كهرباء الإسماعيلية'}, {'community_id': '14', 'articles': [{'id': '341', 'title': 'جلالة الملك يهنئ رئيس القمر الاتحادية بمناسبة العيد الوطني لبلاده', 'source': 'assabah.ma', 'link': 'https://assabah.ma/857594.html', 'summary': 'جلالة الملك يهنئ رئيس القمر الاتحادية بمناسبة العيد الوطني لبلاده. بعث صاحب الجلالة الملك محمد السادس برقية تهنئة إلى عثمان غزالي، رئيس جمهورية القمر الاتحادية، بمناسبة احتفال بلاده بعيدها الوطني. ومما جاء في برقية جلالة الملك “يسرني في غمرة إحياء جمهورية القمر الاتحادية لذكرى عيدها الوطني، أن أتوجه إلى فخامتكم، باسمي الخاص وباسم الشعب المغربي، بأحر التهانيأكمل القراءة » المقالة جلالة الملك يهنئ رئيس القمر الاتحادية بمناسبة العيد الوطني لبلاده  .', 'size': 2}, {'id': '395', 'title': 'الملك محمد السادس يهنئ رئيس جمهورية القمر الاتحادية بمناسبة العيد الوطني لبلاده', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7%d8%af%d8%b3-%d9%8a%d9%87%d9%86%d8%a6-%d8%b1%d8%a6%d9%8a%d8%b3-%d8%ac%d9%85%d9%87%d9%88%d8%b1%d9%8a%d8%a9-%d8%a7-23/', 'summary': 'الملك محمد السادس يهنئ رئيس جمهورية القمر الاتحادية بمناسبة العيد الوطني لبلاده. بعث الملك محمد السادس برقية تهنئة إلى عثمان غزالي، رئيس جمهورية القمر الاتحادية، بمناسبة احتفال بلاده بعيدها الوطني. ومما جاء في برقية الملك محمد السادس “يسرني في غمرة إحياء جمهورية القمر الاتحادية لذكرى عيدها الوطني، أن أتوجه إلى فخامتكم، باسمي الخاص وباسم الشعب المغربي، بأحر التهاني مقرونة بأصدق المتمنيات للشعب القمري الشقيق بمزيد …  الملك محمد السادس يهنئ رئيس جمهورية القمر الاتحادية بمناسبة العيد الوطني لبلاده     .', 'size': 2}], 'main_title': 'جلالة الملك يهنئ رئيس القمر الاتحادية بمناسبة العيد الوطني لبلاده'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    