<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 21/09/2025 - 06h14</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '9', 'title': 'طوابير وإلغاء رحلات بمطارات أوروبية', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d9%81%d9%88%d8%b6%d9%89-%d9%88%d8%a5%d9%84%d8%ba%d8%a7%d8%a1-%d8%b1%d8%ad%d9%84%d8%a7%d8%aa-%d9%81%d9%8a-%d9%85%d8%b7%d8%a7%d8%b1%d8%a7%d8%aa-%d8%a3%d9%88%d8%b1%d9%88%d8%a8%d9%8a%d8%a9-%d9%83%d8%a8-1627240.html', 'summary': 'طوابير وإلغاء رحلات بمطارات أوروبية. تشهد مطارات أوروبية كبرى، من بينها مطارات بروكسل وبرلين وهيثرو في لندن، اضطرابات اليوم السبت بسبب هجوم سيبراني على برمجيات من تصميم شركة كولينز أيروسبايس لتسجيل الركاب الذين انتظروا ساعات طويلة قبل إتمام معاملتهم. وقالت شركة كولينز أيروسبايس في بيان مقتضب: “أُبلغنا بعطل إلكتروني في برنامجنا ‘ميوز’ (MUSE) في مطارات عدة”، مضيفة أنّ التأثير “يقتصر  طوابير وإلغاء رحلات بمطارات أوروبية     - هسبريس جريدة إلكترونية مغربية .', 'size': 2}, {'id': '165', 'title': 'هجوم سيبراني يُربك مطارات كبرى في أوروبا', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%87%d8%ac%d9%88%d9%85-%d8%b3%d9%8a%d8%a8%d8%b1%d8%a7%d9%86%d9%8a-%d9%8a%d9%8f%d8%b1%d8%a8%d9%83-%d9%85%d8%b7%d8%a7%d8%b1%d8%a7%d8%aa-%d9%83%d8%a8%d8%b1%d9%89-%d9%81%d9%8a-%d8%a3%d9%88%d8%b1%d9%88/', 'summary': 'هجوم سيبراني يُربك مطارات كبرى في أوروبا. تشهد مطارات أوروبية كبرى، من بينها بروكسل وبرلين وهيثرو في لندن، اضطرابات السبت بسبب هجوم سيبراني على برنامج تسجيل الركاب "ميوز" (MUSE) لشركة كولينز أيروسبايس. وأوضحت الشركة أن العطل يقتصر على التسجيل الإلكتروني للمسافرين وتسليم الأمتعة. وأكد مطار بروكسل أن الهجوم وقع مساء الجمعة، ما أثر على جدول الرحلات، وأدى إلى إلغاء 10 رحلات وتأخير  هجوم سيبراني يُربك مطارات كبرى في أوروبا     .', 'size': 2}, {'id': '233', 'title': 'هجوم سيبراني يتسبب في اضطرابات بمطارات أوروبية كبرى', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%87%d8%ac%d9%88%d9%85-%d8%b3%d9%8a%d8%a8%d8%b1%d8%a7%d9%86%d9%8a-%d9%8a%d8%aa%d8%b3%d8%a8%d8%a8-%d9%81%d9%8a-%d8%a7%d8%b6%d8%b7%d8%b1%d8%a7%d8%a8%d8%a7%d8%aa-%d8%a8%d9%85%d8%b7%d8%a7%d8%b1%d8%a7/', 'summary': 'هجوم سيبراني يتسبب في اضطرابات بمطارات أوروبية كبرى. شهدت العديد من المطارات الأوروبية الكبرى من بينها مطارات بروكسل وهيثرو في لندن وبرلين، اضطرابات اليوم السبت 20 شتنبر 2025، بسبب مشكلة “إلكترونية” أثّرت على برمجيات تزوّدها بها شركة كولينز أيروسبايس. وقالت الشركة لوكالة فرانس بريس،”أُبلغنا بعطل إلكتروني في برنامجنا +ميوز+ (MUSE) في مطارات عدة”، مضيفة أنّ التأثير “يقتصر على التسجيل الإلكتروني للمسافرين …  هجوم سيبراني يتسبب في اضطرابات بمطارات أوروبية كبرى     .', 'size': 3}], 'main_title': 'هجوم سيبراني يتسبب في اضطرابات بمطارات أوروبية كبرى'}, {'community_id': '1', 'articles': [{'id': '11', 'title': '"أحرار مراكش" يشيدون بنتائج ملموسة للحكومة في القطاعات الأساسية', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d8%a3%d8%ad%d8%b1%d8%a7%d8%b1-%d9%85%d8%b1%d8%a7%d9%83%d8%b4-%d9%8a%d8%b4%d9%8a%d8%af%d9%88%d9%86-%d8%a8%d9%86%d8%aa%d8%a7%d8%a6%d8%ac-%d9%85%d9%84%d9%85%d9%88%d8%b3%d8%a9-%d9%84%d9%84%d8%ad-1627183.html', 'summary': '"أحرار مراكش" يشيدون بنتائج ملموسة للحكومة في القطاعات الأساسية. أكد مسؤولون منتمون لحزب التجمع الوطني للأحرار دعمهم وتشبّثهم بالخطوات التي تواصل الحكومة الحالية القيام بها على مستوى القطاعات الأساسية، سواء تعلق الأمر بالصحة أو التعليم أو الماء. وقال محمد القباج، المنسق الجهوي للحزب بجهة مراكش-آسفي، إن “من بين إنجازات الحكومة الحالية أنها وطّدت الديمقراطية بالبلاد، بعد أن نالت شرعيتها عقب انتخابات 2021”. وأكد القباج،  "أحرار مراكش" يشيدون بنتائج ملموسة للحكومة في القطاعات الأساسية     - هسبريس جريدة إلكترونية مغربية .', 'size': 2}, {'id': '98', 'title': '"مسار الإنجازات".. القباج يؤكد نجاح "التجمع" في قيادة إصلاحات أفرزت نتائج يلمسها المواطنون في عدة قطاعات', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/politic/413063.html', 'summary': '"مسار الإنجازات".. القباج يؤكد نجاح "التجمع" في قيادة إصلاحات أفرزت نتائج يلمسها المواطنون في عدة قطاعات. أكد محمد القباج المنسق الجهوي للتجمع الوطني للأحرار بجهة مراكش آسفي، اليوم السبت بمدينة مراكش، أن الحزب نجح بفضل التحالف الحكومي في قيادة إصلاحات اقتصادية', 'size': 2}, {'id': '152', 'title': 'القباج: الحكومة تنجز إصلاحات واقعية والأحرار يراهن على تقليص الفوارق الاجتماعية', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1101295.html', 'summary': 'القباج: الحكومة تنجز إصلاحات واقعية والأحرار يراهن على تقليص الفوارق الاجتماعية. أكد محمد القباج، المنسق الجهوي لحزب التجمع الوطني للأحرار بجهة مراكش آسفي، اليوم السبت بمدينة مراكش، أن الحزب تمكن، بفضل التحالف الحكومي، من قيادة إصلاحات اقتصادية واجتماعية أفرزت نتائج ملموسة في عدد من القطاعات. وأوضح في كلمته خلال المحطة الخامسة من برنامج “مسار الإنجازات” بجهة مراكش آسفي، أن عمل الحكومة أسفر عن نتائج واضحة للمواطنين، ظهرت المقالة القباج: الحكومة تنجز إصلاحات واقعية والأحرار يراهن على تقليص الفوارق الاجتماعية  .', 'size': 3}], 'main_title': 'القباج: الحكومة تنجز إصلاحات واقعية والأحرار يراهن على تقليص الفوارق الاجتماعية'}, {'community_id': '3', 'articles': [{'id': '56', 'title': 'حموشي يجري زيارة عمل إلى دولة تركيا', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-658821.html', 'summary': 'حموشي يجري زيارة عمل إلى دولة تركيا. هبة بريس – وكالات يجري المدير العام للأمن الوطني ولمراقبة التراب الوطني عبد اللطيف حموشي زيارة عمل إلى دولة تركيا، على رأس وفد أمني رفيع المستوى، وذلك على هامش مشاركته في المنتدى الدولي الخاص بعرض تجهيزات الأمن الداخلي والمستجدات التكنولوجية والابتكارات العلمية ذات الصلة بالعمل الأمني ¨IGEF 2025¨، الذي تحتضنه العاصمة التركية أنقرة، خلال الفترة', 'size': 2}, {'id': '66', 'title': 'حموشي يجري زيارة عمل إلى تركيا', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/206470', 'summary': 'حموشي يجري زيارة عمل إلى تركيا.  يجري المدير العام للأمن الوطني ولمراقبة التراب الوطني عبد اللطيف حموشي زيارة عمل إلى دولة تركيا، على رأس وفد أمني رفيع المستوى، وذلك على هامش مشاركته في المنتدى الدولي الخاص بعرض تجهيزات الأمن الداخلي والمستجدات التكنولوجية والابتكارات العلمية ذات الصلة بالعمل الأمني ¨IGEF 2025¨، الذي تحتضنه العاصمة التركية أنقرة، خلال الفترة الممتدة ما بين', 'size': 5}, {'id': '121', 'title': 'حموشي بتركيا … المغرب يعزز شراكاته الأمنية الدولية', 'source': 'assabah.ma', 'link': 'https://assabah.ma/872150.html', 'summary': 'حموشي بتركيا … المغرب يعزز شراكاته الأمنية الدولية. يجري المدير العام للأمن الوطني ولمراقبة التراب الوطني عبد اللطيف حموشي زيارة عمل إلى دولة تركيا، على رأس وفد أمني رفيع المستوى، وذلك على هامش مشاركته في المنتدى الدولي الخاص بعرض تجهيزات الأمن الداخلي والمستجدات التكنولوجية والابتكارات العلمية ذات الصلة بالعمل الأمني ¨IGEF 2025¨، الذي تحتضنهأكمل القراءة » المقالة حموشي بتركيا … المغرب يعزز شراكاته الأمنية الدولية  .', 'size': 4}, {'id': '180', 'title': 'حموشي يلتقي كبار المسؤولين الأمنيين في منتدى الأمن الداخلي بتركيا', 'source': 'rue20.com', 'link': 'https://rue20.com/938003.html', 'summary': 'حموشي يلتقي كبار المسؤولين الأمنيين في منتدى الأمن الداخلي بتركيا.  ا الرباط يجري المدير العام للأمن الوطني ولمراقبة التراب الوطني عبد اللطيف حموشي زيارة عمل إلى دولة تركيا، على رأس وفد أمني رفيع المستوى، وذلك على هامش مشاركته في المنتدى الدولي الخاص بعرض تجهيزات الأمن الداخلي والمستجدات التكنولوجية والابتكارات العلمية ذات الصلة بالعمل الأمني ¨IGEF 2025¨، الذي تحتضنه العاصمة التركية أنقرة، خلال الفترة الخبر حموشي يلتقي كبار المسؤولين الأمنيين في منتدى الأمن الداخلي بتركيا  .', 'size': 4}, {'id': '214', 'title': 'السيد حموشي يترأس وفدا رفيعا إلى المنتدى الدولي لتجهيزات الأمن الداخلي والمستجدات التكنولوجية والابتكارات العلمية', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/227317/', 'summary': 'السيد حموشي يترأس وفدا رفيعا إلى المنتدى الدولي لتجهيزات الأمن الداخلي والمستجدات التكنولوجية والابتكارات العلمية. يجري المدير العام للأمن الوطني ولمراقبة التراب الوطني عبد اللطيف حموشي زيارة عمل إلى دولة تركيا، على رأس وفد أمني رفيع المستوى، وذلك على هامش مشاركته في المنتدى الدولي الخاص بعرض تجهيزات الأمن الداخلي والمستجدات التكنولوجية والابتكارات العلمية ذات الصلة بالعمل الأمني ¨IGEF 2025¨، الذي تحتضنه العاصمة التركية أنقرة، خلال الفترة الممتدة ما بين 18', 'size': 4}], 'main_title': 'حموشي يجري زيارة عمل إلى تركيا'}, {'community_id': '5', 'articles': [{'id': '101', 'title': 'المحكمة التجارية بالدار البيضاء تأمر بتفكيك سفينة “LINDEN” المهجورة قبالة المحمدية', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/413066.html', 'summary': 'المحكمة التجارية بالدار البيضاء تأمر بتفكيك سفينة “LINDEN” المهجورة قبالة المحمدية. أصدرت المحكمة التجارية بالدار البيضاء، مؤخرًا، حكمًا يقضي بتفكيك سفينة الشحن “LINDEN” التي ترفع علم سانت كيتس ونيفيس، بعدما ظلت عالقة في وضعية مهجورة قبالة', 'size': 2}, {'id': '267', 'title': 'المحكمة التجارية بالدار البيضاء تقضي بتفكيك سفينة مهجورة قرب ميناء المحمدية', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-659069.html', 'summary': 'المحكمة التجارية بالدار البيضاء تقضي بتفكيك سفينة مهجورة قرب ميناء المحمدية. هبة بريس – الدار البيضاء قضت المحكمة التجارية بالدار البيضاء بتفكيك سفينة الشحن “LINDEN”، التي ترفع علم سانت كيتس ونيفيس، بعدما تُركت في حالة إهمال قبالة ميناء المحمدية منذ يناير الماضي. وجاء هذا الحكم استنادًا إلى تقرير المسح البحري، الذي أكد أن السفينة، التي يتجاوز عمرها 40 عامًا، لم تعد صالحة للإبحار أو لأي نشاط', 'size': 2}], 'main_title': 'المحكمة التجارية بالدار البيضاء تأمر بتفكيك سفينة “LINDEN” المهجورة قبالة المحمدية'}, {'community_id': '4', 'articles': [{'id': '109', 'title': 'أخنوش من مراكش: الحكومة أولت أهمية "قصوى" لقطاعي الصحة والتعليم', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/national/413075.html', 'summary': 'أخنوش من مراكش: الحكومة أولت أهمية "قصوى" لقطاعي الصحة والتعليم. أكد رئيس حزب التجمع الوطني للأحرار، عزيز أخنوش، اليوم السبت بمراكش، أن الحكومة أولت أهمية "قصوى" لقطاعي الصحة والتعليم، وجعلتهما في صلب الأولويات، باعتبارهما الدعامة', 'size': 3}, {'id': '182', 'title': 'أخنوش: الحكومة أولت أهمية قصوى للصحة والتعليم وجعلتهما في صلب الأولويات', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/476187.html', 'summary': 'أخنوش: الحكومة أولت أهمية قصوى للصحة والتعليم وجعلتهما في صلب الأولويات. بحضور قيادات حزب التجمع الوطني للأحرار وعدد من المنتخبين المحليين والجهويين بجهة مراكش آسفي، قال رئيس الحزب، عزيز أخنوش، اليوم السبت بمراكش، إن الحكومة أولت أهمية "قصوى" لقطاعي الصحة والتعليم، وجعلتهما في صلب الأولويات باعتبارهما الدعامة الأساسية لأي مشروع تنموي يروم تحقيق العدالة الاجتماعية وتقليص الفوارق المجالية.', 'size': 2}, {'id': '285', 'title': 'أمام الآلاف بمراكش.. أخنوش يؤكد استمرار حكومته حتى آخر ولايتها في تنزيل المشاريع الكبرى', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-659011.html', 'summary': 'أمام الآلاف بمراكش.. أخنوش يؤكد استمرار حكومته حتى آخر ولايتها في تنزيل المشاريع الكبرى. هبة بريس – مراكش أكد رئيس حزب التجمع الوطني للأحرار، عزيز أخنوش، أن ما يهمه خلال السنة الأخيرة من عمر الولاية الحكومية الحالية، هو الدفع قدما بالمشاريع الكبرى لإتمام إنجازها كما يجب لمصلحة البلاد والمواطنين، مجددا دعوته إلى الحرص على تجنب هدر الزمن الحكومي. وأضاف في كلمته اليوم السبت بمراكش، خلال المحطة الخامسة من الجولة', 'size': 2}], 'main_title': 'أخنوش من مراكش: الحكومة أولت أهمية "قصوى" لقطاعي الصحة والتعليم'}, {'community_id': '2', 'articles': [{'id': '320', 'title': 'إنفانتينو: الملعب الكبير لطنجة مثال على التقدم الذي أحرزه المغرب هذا البلد الكبير في مجال كرة القدم', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a5%d9%86%d9%81%d8%a7%d9%86%d8%aa%d9%8a%d9%86%d9%88-%d8%a7%d9%84%d9%85%d9%84%d8%b9%d8%a8-%d8%a7%d9%84%d9%83%d8%a8%d9%8a%d8%b1-%d9%84%d8%b7%d9%86%d8%ac%d8%a9-%d9%85%d8%ab%d8%a7%d9%84-%d8%b9%d9%84/', 'summary': 'إنفانتينو: الملعب الكبير لطنجة مثال على التقدم الذي أحرزه المغرب هذا البلد الكبير في مجال كرة القدم. قام رئيس الاتحاد الدولي لكرة القدم جياني إنفانتينو بزيارة للملعب الكبير لطنجة بهدف الاطلاع على تقدم الأشغال الجارية، والتي “أشرفت على نهايتها في زمن قياسي”، بحسب ما أفادت به الجامعة الملكية المغربية لكرة القدم، اليوم السبت. وخلال هذه الزيارة التي قام بها إنفانتينو، إلى جانب رئيس الجامعة الملكية المغربية لكرة القدم، فوزي لقجع، ووالي جهة', 'size': 2}, {'id': '332', 'title': 'رئيس الاتحاد الدولي لكرة القدم يزور الملعب الكبير بطنجة', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/323933/', 'summary': 'رئيس الاتحاد الدولي لكرة القدم يزور الملعب الكبير بطنجة. قام رئيس الاتحاد الدولي لكرة القدم (فيفا) جياني إنفانتينو بزيارة للملعب الكبير بطنجة للوقوف على تقدم الأشغال الجارية، والتي “على وشك الانتهاء في وقت قياسي”، حسب ما أعلنته الجامعة الملكية المغربية لكرة القدم، السبت. وخلال هذه الزيارة، التي قام بها السيد إنفانتينو رفقة السادة فوزي لقجع، رئيس الجامعة الملكية المغربية لكرة القدم، ويونس التازي، والي', 'size': 2}], 'main_title': 'إنفانتينو: الملعب الكبير لطنجة مثال على التقدم الذي أحرزه المغرب هذا البلد الكبير في مجال كرة القدم'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    