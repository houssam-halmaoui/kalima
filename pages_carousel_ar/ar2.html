<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 21/06/2025 - 12h25</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '3', 'articles': [{'id': '67', 'title': 'المغرب: تراجع ملحوظ في حرائق الغابات خلال سنة 2025 وسط دعوات لتعزيز اليقظة', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/202281', 'summary': 'المغرب: تراجع ملحوظ في حرائق الغابات خلال سنة 2025 وسط دعوات لتعزيز اليقظة. الأحداث نت – مراسلة: م.ع. الإدريسي أعلنت الوكالة الوطنية للمياه والغابات، في بلاغ رسمي توصلت به جريدة “الأحداث”، عن الوضعية الراهنة لحرائق الغابات على الصعيد الوطني، مرفقة بمعطيات دقيقة حول عدد الحرائق، المساحات المتضررة، والإجراءات الاستباقية المتخذة في ظل استمرار موجات الحرارة والجفاف. ووفقاً للوكالة، تم تسجيل ثمانية حرائق جديدة خلال الـ24 ساعة الماضية من', 'size': 2}, {'id': '100', 'title': 'السيطرة على ثمانية حرائق سجلت على الصعيد الوطني أمس الخميس', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/national/407913.html', 'summary': 'السيطرة على ثمانية حرائق سجلت على الصعيد الوطني أمس الخميس. أفادت الوكالة الوطنية للمياه والغابات أنه تم تسجيل ثمانية حرائق على الصعيد الوطني أمس الخميس، منها ستة حرائق في المجال الغابوي وحريقان خارجه، مؤكدة أنه', 'size': 3}, {'id': '119', 'title': '“المياه والغابات” تدعو إلى الحيطة والحذر.. السيطرة الكاملة على 8 حرائق على الصعيد الوطني في يوم واحد!', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a7%d9%84%d9%85%d9%8a%d8%a7%d9%87-%d9%88%d8%a7%d9%84%d8%ba%d8%a7%d8%a8%d8%a7%d8%aa-%d8%aa%d8%af%d8%b9%d9%88-%d8%a5%d9%84%d9%89-%d8%a7%d9%84%d8%ad%d9%8a%d8%b7%d8%a9-%d9%88%d8%a7%d9%84%d8%ad/', 'summary': '“المياه والغابات” تدعو إلى الحيطة والحذر.. السيطرة الكاملة على 8 حرائق على الصعيد الوطني في يوم واحد!. أفادت الوكالة الوطنية للمياه والغابات أنه تم تسجيل ثمانية حرائق على الصعيد الوطني، أمس الخميس (19 يونيو)، منها ستة حرائق في المجال الغابوي وحريقان خارجه، مؤكدة أنه تمت السيطرة عليها بالكامل. وأوضحت الوكالة، في بلاغ لها حول “الوضعية الراهنة لحرائق الغابات”، أنه تمت السيطرة على جميع هذه الحرائق بفضل يقظة وتدخلات المصالح المختصة السريعة والمنسقة،', 'size': 4}, {'id': '185', 'title': 'الوكالة الوطنية للمياه والغابات تعلن السيطرة على 8 حرائق', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/467112.html', 'summary': 'الوكالة الوطنية للمياه والغابات تعلن السيطرة على 8 حرائق. أعلنت الوكالة الوطنية للمياه والغابات أنه تم تسجيل ثمانية حرائق على الصعيد الوطني أمس الخميس، منها ستة حرائق في المجال الغابوي وحريقان خارجه، مؤكدة أنه تمت السيطرة عليها بالكامل. وأوضحت الوكالة، في بلاغ لها حول “الوضعية الراهنة لحرائق الغابات”، أنه تمت السيطرة على جميع هذه الحرائق بفضل يقظة وتدخلات المصالح المختصة السريعة والمنسقة، مشيرة إلى …', 'size': 3}], 'main_title': '“المياه والغابات” تدعو إلى الحيطة والحذر.. السيطرة الكاملة على 8 حرائق على الصعيد الوطني في يوم واحد!'}, {'community_id': '2', 'articles': [{'id': '118', 'title': 'نيويورك.. تفاصيل لقاء بوعياش والأمين العام للأمم المتحدة', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%86%d9%8a%d9%88%d9%8a%d9%88%d8%b1%d9%83-%d8%aa%d9%81%d8%a7%d8%b5%d9%8a%d9%84-%d9%84%d9%82%d8%a7%d8%a1-%d8%a8%d9%88%d8%b9%d9%8a%d8%a7%d8%b4-%d9%88%d8%a7%d9%84%d8%a3%d9%85%d9%8a%d9%86-%d8%a7%d9%84/', 'summary': 'نيويورك.. تفاصيل لقاء بوعياش والأمين العام للأمم المتحدة. استقبل الأمين العام للأمم المتحدة، أنطونيو غوتيريش، أمس الخميس (19 يونيو)، رئيسة التحالف العالمي للمؤسسات الوطنية لحقوق الإنسان، آمنة بوعياش، وذلك في إطار سعيها وفريق التحالف لتعزيز دور المؤسسات الوطنية وحقوق الإنسان في صنع القرار الدولي. وذكر بلاغ للمجلس الوطني لحقوق الإنسان أنه في سياق ترافع دولي حثيث تقوده بنيويورك، التقت رئيسة المجلس، بوعياش، بصفتها', 'size': 2}, {'id': '190', 'title': 'في لقاء بغوتيريش.. بوعياش تبرز بنيويورك دور المؤسسات الوطنية لحقوق الإنسان', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/467103.html', 'summary': 'في لقاء بغوتيريش.. بوعياش تبرز بنيويورك دور المؤسسات الوطنية لحقوق الإنسان. استقبل الأمين العام للأمم المتحدة، أنطونيو غوتيريش، رئيسة التحالف العالمي للمؤسسات الوطنية لحقوق الإنسان، آمنة بوعياش، وذلك في إطار سعيها وفريق التحالف لتعزيز دور المؤسسات الوطنية وحقوق الإنسان في صنع القرار الدولي. وذكر بلاغ للمجلس الوطني لحقوق الإنسان أنه في سياق ترافع دولي حثيث تقوده بنيويورك، التقت رئيسة المجلس، بوعياش، بصفتها رئيسة التحالف العالمي، غوتيريش …', 'size': 2}], 'main_title': 'نيويورك.. تفاصيل لقاء بوعياش والأمين العام للأمم المتحدة'}, {'community_id': '0', 'articles': [{'id': '180', 'title': 'ارتفاع الاستثمارات الأجنبية المباشرة في المغرب سنة 2024 لتبلغ 1,6 مليار دولار', 'source': 'rue20.com', 'link': 'https://rue20.com/914547.html', 'summary': 'ارتفاع الاستثمارات الأجنبية المباشرة في المغرب سنة 2024 لتبلغ 1,6 مليار دولار.  الرباط ارتفعت الاستثمارات الأجنبية المباشرة في المغرب بنسبة 55 في المائة سنة 2024 لتصل إلى 1,64 مليار دولار، مقارنة بـ 1,05 مليار دولار في العام السابق، وذلك حسب ما أفاد به مؤتمر الأمم المتحدة للتجارة والتنمية (الأونكتاد). وأوضحت الوكالة الأممية، في تقريرها الأخير حول الاستثمار العالمي لسنة 2025، الذي صدر أمس الخميس، أن رصيد الخبر ارتفاع الاستثمارات الأجنبية المباشرة في المغرب سنة 2024 لتبلغ 1,6 مليار دولار  .', 'size': 2}, {'id': '332', 'title': 'تقرير أممي: المغرب يعزز جاذبيته الاستثمارية ويحقق قفزة في تدفقات الاستثمار الأجنبي', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1079282.html', 'summary': 'تقرير أممي: المغرب يعزز جاذبيته الاستثمارية ويحقق قفزة في تدفقات الاستثمار الأجنبي. ارتفعت الاستثمارات الأجنبية المباشرة في المغرب بنسبة 55 في المائة سنة 2024 لتصل إلى 1,64 مليار دولار، مقارنة بـ 1,05 مليار دولار في العام السابق، وذلك حسب ما أفاد به مؤتمر الأمم المتحدة للتجارة والتنمية (الأونكتاد). وأوضحت الوكالة الأممية، في تقريرها الأخير حول الاستثمار العالمي لسنة 2025، الذي صدر أمس الخميس، أن رصيد الاستثمارات الأجنبية ظهرت المقالة تقرير أممي: المغرب يعزز جاذبيته الاستثمارية ويحقق قفزة في تدفقات الاستثمار الأجنبي  .', 'size': 2}], 'main_title': 'ارتفاع الاستثمارات الأجنبية المباشرة في المغرب سنة 2024 لتبلغ 1,6 مليار دولار'}, {'community_id': '1', 'articles': [{'id': '308', 'title': 'طقس السبت.. أجواء حارة بعدد من المناطق وزخات في أخرى', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/national/407946.html', 'summary': 'طقس السبت.. أجواء حارة بعدد من المناطق وزخات في أخرى. تتوقع المديرية العامة للأرصاد الجوية، اليوم السبت، استمرار موجة الحر بكل من جنوب الريف والسايس ووادي ملوية وهضاب الفوسفاط ووالماس وسهول تادلة والرحامنة والجنوب الشرقي', 'size': 3}, {'id': '342', 'title': 'موجة حر.. توقعات أحوال الطقس اليوم السبت', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%85%d9%88%d8%ac%d8%a9-%d8%ad%d8%b1-%d8%aa%d9%88%d9%82%d8%b9%d8%a7%d8%aa-%d8%a3%d8%ad%d9%88%d8%a7%d9%84-%d8%a7%d9%84%d8%b7%d9%82%d8%b3-%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%b3%d8%a8%d8%aa/', 'summary': 'موجة حر.. توقعات أحوال الطقس اليوم السبت. تتوقع المديرية العامة للأرصاد الجوية، اليوم السبت، استمرار موجة الحر بكل من جنوب الريف والسايس ووادي ملوية وهضاب الفوسفاط ووالماس وسهول تادلة والرحامنة والجنوب الشرقي للبلاد، وداخل الأقاليم الصحراوية للمملكة. كما يرتقب تمركز سحب رعدية مصحوبة بقطرات أو زخات مطرية قد تكون مرفوقة بتساقط البرد محليا و بهبات الرياح تحت العواصف الرعدية، وذلك فوق مرتفعات  موجة حر.. توقعات أحوال الطقس اليوم السبت     .', 'size': 3}, {'id': '375', 'title': 'توقعات أحوال الطقس اليوم السبت', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%aa%d9%88%d9%82%d8%b9%d8%a7%d8%aa-%d8%a3%d8%ad%d9%88%d8%a7%d9%84-%d8%a7%d9%84%d8%b7%d9%82%d8%b3-%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%b3%d8%a8%d8%aa-25/', 'summary': 'توقعات أحوال الطقس اليوم السبت. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليومه السبت، استمرار موجة الحر بكل من جنوب الريف والسايس ووادي ملوية وهضاب الفوسفاط ووالماس وسهول تادلة والرحامنة والجنوب الشرقي للبلاد، وداخل الأقاليم الصحراوية للمملكة. كما يرتقب تمركز سحب رعدية مصحوبة بقطرات أو زخات مطرية قد تكون مرفوقة بتساقط البرد محليا و بهبات الرياح تحت العواصف الرعدية، …  توقعات أحوال الطقس اليوم السبت     .', 'size': 3}], 'main_title': 'طقس السبت.. أجواء حارة بعدد من المناطق وزخات في أخرى'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    