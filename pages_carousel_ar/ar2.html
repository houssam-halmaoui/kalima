<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 30/06/2025 - 12h25</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '62', 'title': 'أخنوش يمثل الملك في مؤتمر الأمم المتحدة حول تمويل التنمية', 'source': 'www.alakhbar.press.ma', 'link': 'https://www.alakhbar.press.ma/%d8%a3%d8%ae%d9%86%d9%88%d8%b4-%d9%8a%d9%85%d8%ab%d9%84-%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%81%d9%8a-%d9%85%d8%a4%d8%aa%d9%85%d8%b1-%d8%a7%d9%84%d8%a3%d9%85%d9%85-%d8%a7%d9%84%d9%85%d8%aa%d8%ad%d8%af-267938.html', 'summary': 'أخنوش يمثل الملك في مؤتمر الأمم المتحدة حول تمويل التنمية. حل رئيس الحكومة، عزيز أخنوش، اليوم الأحد بإشبيلية، لتمثيل صاحب الجلالة الملك محمد السادس، في المؤتمر الدولي الرابع حول تمويل التنمية. وحضر أخنوش مأدبة العشاء التي أقامها العاهل الإسباني الملك فليبي السادس والملكة ليتيسيا، على شرف رؤساء الدول والحكومات المشاركين في هذا الحدث. ويضم الوفد المغربي المشارك في هذا المؤتمر أيضا، وزيرة الاقتصاد والمالية، نادية …  أخنوش يمثل الملك في مؤتمر الأمم المتحدة حول تمويل التنمية     .', 'size': 4}, {'id': '172', 'title': 'أخنوش يمثل جلالة الملك في مؤتمر الأمم المتحدة حول تمويل التنمية بإشبيلية', 'source': 'rue20.com', 'link': 'https://rue20.com/916716.html', 'summary': 'أخنوش يمثل جلالة الملك في مؤتمر الأمم المتحدة حول تمويل التنمية بإشبيلية. . مالقا حل رئيس الحكومة، السيد عزيز أخنوش، اليوم الأحد بإشبيلية، لتمثيل صاحب الجلالة الملك محمد السادس، في المؤتمر الدولي الرابع حول تمويل التنمية. وحضر السيد أخنوش مأدبة العشاء التي أقامها العاهل الإسباني الملك فليبي السادس والملكة ليتيسيا، على شرف رؤساء الدول والحكومات المشاركين في هذا الحدث. ويضم الوفد المغربي المشارك في هذا المؤتمر الخبر أخنوش يمثل جلالة الملك في مؤتمر الأمم المتحدة حول تمويل التنمية بإشبيلية  .', 'size': 5}, {'id': '213', 'title': 'أخنوش يمثل جلالة الملك في مؤتمر الأمم المتحدة حول تمويل التنمية بإسبانيا', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/223737/', 'summary': 'أخنوش يمثل جلالة الملك في مؤتمر الأمم المتحدة حول تمويل التنمية بإسبانيا. و م ع حل رئيس الحكومة، عزيز أخنوش، اليوم الأحد بإشبيلية، لتمثيل صاحب الجلالة الملك محمد السادس، في المؤتمر الدولي الرابع حول تمويل التنمية. وحضر أخنوش مأدبة العشاء التي أقامها العاهل الإسباني الملك فليبي السادس والملكة ليتيسيا، على شرف رؤساء الدول والحكومات المشاركين في هذا الحدث. ويضم الوفد المغربي المشارك في هذا المؤتمر أيضا،', 'size': 4}, {'id': '393', 'title': 'رئيس الحكومة يمثل الملك محمد السادس في المؤتمر الرابع حول التنمية بإشبيلية', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%b1%d8%a6%d9%8a%d8%b3-%d8%a7%d9%84%d8%ad%d9%83%d9%88%d9%85%d8%a9-%d9%8a%d9%85%d8%ab%d9%84-%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7%d8%af%d8%b3-%d9%81%d9%8a-2/', 'summary': 'رئيس الحكومة يمثل الملك محمد السادس في المؤتمر الرابع حول التنمية بإشبيلية. المساء اليوم: حل رئيس الحكومة، عزيز أخنوش، بإشبيلية، لتمثيل الملك محمد السادس، في المؤتمر الدولي الرابع حول تمويل التنمية. وحضر أخنوش مأدبة العشاء التي أقامها العاهل الإسباني الملك فليبي السادس والملكة ليتيسيا، مساء الأحد، على', 'size': 3}, {'id': '397', 'title': 'رئيس الحكومة يمثل الملك محمد السادس في مؤتمر الأمم المتحدة حول تمويل التنمية بإشبيلية', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%b1%d8%a6%d9%8a%d8%b3-%d8%a7%d9%84%d8%ad%d9%83%d9%88%d9%85%d8%a9-%d9%8a%d9%85%d8%ab%d9%84-%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7%d8%af%d8%b3-%d9%81%d9%8a-8/', 'summary': 'رئيس الحكومة يمثل الملك محمد السادس في مؤتمر الأمم المتحدة حول تمويل التنمية بإشبيلية. وصل رئيس الحكومة، عزيز أخنوش، يوم أمس الأحد إلى إشبيلية، لتمثيل الملك محمد السادس، في المؤتمر الدولي الرابع حول تمويل التنمية. وفي هذا الإطار، حضر أخنوش مأدبة العشاء التي أقامها العاهل الإسباني الملك فليبي السادس والملكة ليتيسيا، على شرف رؤساء الدول والحكومات المشاركين في هذا الحدث. ويشار إلى أن الوفد المغربي المشارك في …  رئيس الحكومة يمثل الملك محمد السادس في مؤتمر الأمم المتحدة حول تمويل التنمية بإشبيلية     .', 'size': 3}], 'main_title': 'أخنوش يمثل جلالة الملك في مؤتمر الأمم المتحدة حول تمويل التنمية بإشبيلية'}, {'community_id': '1', 'articles': [{'id': '71', 'title': 'اعتقال مغربيتين وابنيهما بعد محاولتهم تهريب كمية ضخمة من الأقراص المهلوسة إلى المغرب', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/408407.html', 'summary': 'اعتقال مغربيتين وابنيهما بعد محاولتهم تهريب كمية ضخمة من الأقراص المهلوسة إلى المغرب. أسفرت عملية أمنية مشتركة بين مصالح الأمن الوطني والجمارك بمعبر باب سبتة، مساء السبت 28 يونيو الجاري، عن إجهاض محاولة تهريب شحنة كبيرة من الأقراص', 'size': 2}, {'id': '168', 'title': 'باب سبتة.. إحباط عملية تهريب شحنة ضخمة من الأقراص المخدرة', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a8%d8%a7%d8%a8-%d8%b3%d8%a8%d8%aa%d8%a9-%d8%a5%d8%ad%d8%a8%d8%a7%d8%b7-%d8%b9%d9%85%d9%84%d9%8a%d8%a9-%d8%aa%d9%87%d8%b1%d9%8a%d8%a8-%d8%b4%d8%ad%d9%86%d8%a9-%d8%b6%d8%ae%d9%85%d8%a9-%d9%85/', 'summary': 'باب سبتة.. إحباط عملية تهريب شحنة ضخمة من الأقراص المخدرة. أسفرت عملية أمنية مشتركة بين مصالح الأمن الوطني والجمارك بمعبر باب سبتة، مساء السبت 28 يونيو الجاري، عن إجهاض محاولة تهريب شحنة كبيرة من الأقراص المهلوسة نحو المغرب، تتكون من 102.000 قرص طبي مخدر. وقد مكنت هذه العملية المشتركة من ضبط سائقة سيارة مرقمة بالخارج، وهي مواطنة إسبانية من أصول مغربية برفقة ابنيها وسيدة مغربية  باب سبتة.. إحباط عملية تهريب شحنة ضخمة من الأقراص المخدرة     .', 'size': 2}], 'main_title': 'اعتقال مغربيتين وابنيهما بعد محاولتهم تهريب كمية ضخمة من الأقراص المهلوسة إلى المغرب'}, {'community_id': '2', 'articles': [{'id': '94', 'title': 'سوريا تعلق على محاولة اغتيال الرئيس أحمد الشرع', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/world/408431.html', 'summary': 'سوريا تعلق على محاولة اغتيال الرئيس أحمد الشرع. نفت وزارة الإعلام السورية اليوم الأحد ما تم تداوله عن إحباط محاولة لاغتيال الرئيس أحمد الشرع. ونقلت الوكالة العربية السورية للأنباء (سانا) اليوم الأحد عن مصدر', 'size': 2}, {'id': '207', 'title': 'محاولة اغتيال أحمد الشرع.. سوريا توضح', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d9%85%d8%ad%d8%a7%d9%88%d9%84%d8%a9-%d8%a7%d8%ba%d8%aa%d9%8a%d8%a7%d9%84-%d8%a3%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b4%d8%b1%d8%b9-%d8%b3%d9%88%d8%b1%d9%8a%d8%a7-%d8%aa%d9%88%d8%b6%d8%ad/', 'summary': 'محاولة اغتيال أحمد الشرع.. سوريا توضح.  – متابعات نفت وزارة الإعلام السورية اليوم الأحد ما تم تداوله عن إحباط محاولة لاغتيال الرئيس أحمد الشرع. ونقلت الوكالة العربية السورية للأنباء (سانا) اليوم الأحد عن مصدر...  محاولة اغتيال أحمد الشرع.. سوريا توضح     .', 'size': 2}], 'main_title': 'سوريا تعلق على محاولة اغتيال الرئيس أحمد الشرع'}, {'community_id': '3', 'articles': [{'id': '103', 'title': 'المنتخب المغربي لأقل من 17 سنة يتوج بلقب دوري دولي بعد تفوقه على فرنسا وإسبانيا وأمريكا', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/sport/lionatlas/408440.html', 'summary': 'المنتخب المغربي لأقل من 17 سنة يتوج بلقب دوري دولي بعد تفوقه على فرنسا وإسبانيا وأمريكا. فاز المنتخب الوطني المغربي لكرة القدم داخل القاعة لأقل من 17 سنة بلقب الدوري الدولي الودي "كاسترو يل ريو"، الذي اختتم اليوم الأحد بإسبانيا، وذلك', 'size': 2}, {'id': '162', 'title': 'كرة القدم داخل القاعة.. منتخب أقل من 17 سنة يفوز بدوري "كاسترو يل ريو" بإسبانيا', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%83%d8%b1%d8%a9-%d8%a7%d9%84%d9%82%d8%af%d9%85-%d8%af%d8%a7%d8%ae%d9%84-%d8%a7%d9%84%d9%82%d8%a7%d8%b9%d8%a9-%d9%85%d9%86%d8%aa%d8%ae%d8%a8-%d8%a3%d9%82%d9%84-%d9%85%d9%86-17-%d8%b3%d9%86%d8%a9/', 'summary': 'كرة القدم داخل القاعة.. منتخب أقل من 17 سنة يفوز بدوري "كاسترو يل ريو" بإسبانيا. فاز المنتخب الوطني المغربي لكرة القدم داخل القاعة لأقل من 17 سنة بلقب الدوري الدولي الودي "كاسترو يل ريو"، الذي اختتم اليوم الأحد بإسبانيا، وذلك بعد فوزه في ثلاثة مباريات. وفاز المنتخب الوطني في المباراة الأولى على منتخب فرنسا بثمانية أهداف مقابل أربعة، فيما تفوق في المباراة الثانية على منتخب إسبانيا بأربعة أهداف مقابل هدفين.  كرة القدم داخل القاعة.. منتخب أقل من 17 سنة يفوز بدوري "كاسترو يل ريو" بإسبانيا     .', 'size': 3}, {'id': '232', 'title': 'فوتسال.. منتخب أقل من 17 سنة يُتوج بلقب الدوري الدولي “كاسترو يل ريو” في إسبانيا', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%81%d9%88%d8%aa%d8%b3%d8%a7%d9%84-%d9%85%d9%86%d8%aa%d8%ae%d8%a8-%d8%a3%d9%82%d9%84-%d9%85%d9%86-17-%d8%b3%d9%86%d8%a9-%d9%8a%d9%8f%d8%aa%d9%88%d8%ac-%d8%a8%d9%84%d9%82%d8%a8-%d8%a7%d9%84%d8%af/', 'summary': 'فوتسال.. منتخب أقل من 17 سنة يُتوج بلقب الدوري الدولي “كاسترو يل ريو” في إسبانيا. تُوّج المنتخب الوطني المغربي لكرة القدم داخل القاعة لأقل من 17 سنة بلقب الدوري الدولي الودي “كاسترو يل ريو”، الذي أُسدل عليه الستار اليوم الأحد بإسبانيا، عقب تحقيقه لثلاثة انتصارات متتالية. واستهل المنتخب المغربي مشواره في البطولة بفوز كبير على نظيره الفرنسي بنتيجة 8 أهداف مقابل 4، قبل أن يواصل تألقه ويتغلب على …  فوتسال.. منتخب أقل من 17 سنة يُتوج بلقب الدوري الدولي “كاسترو يل ريو” في إسبانيا     .', 'size': 2}], 'main_title': 'كرة القدم داخل القاعة.. منتخب أقل من 17 سنة يفوز بدوري "كاسترو يل ريو" بإسبانيا'}, {'community_id': '5', 'articles': [{'id': '108', 'title': 'فنانة مصرية تدافع عن شيرين عبد الوهاب بعد أزمة حفلها في "موازين"', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/culture/408445.html', 'summary': 'فنانة مصرية تدافع عن شيرين عبد الوهاب بعد أزمة حفلها في "موازين". خرجت الفنانة المصرية شيماء سيف عن صمتها مدافعة عن مواطنتها المطربة شيرين عبد الوهاب، بعد الانتقادات التي طالت الأخيرة عقب مشاركتها في مهرجان "موازين"، والمرتبطة', 'size': 2}, {'id': '187', 'title': 'بكاء وغناء مع معجبة.. لحظات مؤثرة بحفل شيرين عبد الوهاب في ختام موازين', 'source': 'machahid24.com', 'link': 'https://machahid24.com/panorama/467880.html', 'summary': 'بكاء وغناء مع معجبة.. لحظات مؤثرة بحفل شيرين عبد الوهاب في ختام موازين. التقت الفنانة المصرية شيرين عبد الوهاب، أمس السبت، جمهورها المغربي ضمن فعاليات الدورة العشرين لمهرجان موازين.', 'size': 2}], 'main_title': 'فنانة مصرية تدافع عن شيرين عبد الوهاب بعد أزمة حفلها في "موازين"'}, {'community_id': '8', 'articles': [{'id': '113', 'title': 'أولمبيك آسفي يُسقط نهضة بركان ويتوج بكأس العرش لأول مرة في تاريخه', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/sport/footmarocain/408452.html', 'summary': 'أولمبيك آسفي يُسقط نهضة بركان ويتوج بكأس العرش لأول مرة في تاريخه. توج فريق أولمبيك آسفي بلقب كأس العرش لكرة القدم ( 2023-2024)، لأول مرة في تاريخه، عقب فوزه في نهائي شيق على نهضة بركان، اليوم الأحد،', 'size': 4}, {'id': '142', 'title': 'أولمبيك آسفي يجهض حلم ثلاثية نهضة بركان ويخطف كأس العرش', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1081727.html', 'summary': 'أولمبيك آسفي يجهض حلم ثلاثية نهضة بركان ويخطف كأس العرش. توج أولمبيك آسفي بلقب كأس العرش المغربي لكرة القدم، بعد تغلبه بركلات الترجيح على نهضة بركان، بعدما كانت النتيجة 1-1، وذلك في المباراة النهائية التي جمعتهما على أرضية الملعب الكبير بمدينة فاس مساء اليوم الأحد. وشهدت بداية اللقاء حذرا من الجانبين، قبل أن ينجح صلاح الدين الرحولي في منح التقدم لأبناء المدرب أمين الكرمة عند ظهرت المقالة أولمبيك آسفي يجهض حلم ثلاثية نهضة بركان ويخطف كأس العرش  .', 'size': 4}, {'id': '159', 'title': 'نهائي كأس العرش.. أولمبيك آسفي يحقق اللقب لأول مرة بعد الفوز أمام نهضة بركان', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%86%d9%87%d8%a7%d8%a6%d9%8a-%d9%83%d8%a3%d8%b3-%d8%a7%d9%84%d8%b9%d8%b1%d8%b4-%d8%a3%d9%88%d9%84%d9%85%d8%a8%d9%8a%d9%83-%d8%a2%d8%b3%d9%81%d9%8a-%d9%8a%d8%ad%d9%82%d9%82-%d8%a7%d9%84%d9%84%d9%82/', 'summary': 'نهائي كأس العرش.. أولمبيك آسفي يحقق اللقب لأول مرة بعد الفوز أمام نهضة بركان. تمكن نادي أولمبيك آسفي من الفوز بنهائي كأس العرش بعد فوزه مساء اليوم الأحد، أمام نهضة بركان في مباراة جرت أطورها على أرضية الملعب الكبير لمدينة فاس. وانتهى اللقاء في وقته القانوني بنتيجة هدف مقابل هدف، فيما لم يستطع أي فريق التسجيل في مرمى منافسه خلال الأشواط الإضافية، وخلال ضربات الترجيح تمكن أولمبيك آسفي من  نهائي كأس العرش.. أولمبيك آسفي يحقق اللقب لأول مرة بعد الفوز أمام نهضة بركان     .', 'size': 3}, {'id': '171', 'title': 'ألمبيك آسفي يهزم نهضة بركان ويتوج بكأس العرش لأول مرة في تاريخه', 'source': 'rue20.com', 'link': 'https://rue20.com/916729.html', 'summary': 'ألمبيك آسفي يهزم نهضة بركان ويتوج بكأس العرش لأول مرة في تاريخه. . فاس توج فريق أولمبيك آسفي لأول مرة في تاريخه بلقب كأس العرش لكرة القدم برسم (2023-2024)، عقب تغلبه على نهضة بركان بضربات الترجيح (6-5)، في المباراة النهائية التي جمعتهما، مساء اليوم الأحد، على أرضية المركب الرياضي بمدينة فاس. وانتهى الوقت الأصلي للمباراة بالتعادل بهدف لمثله بين الفريقين، حيث كان أولمبيك آسفي سباقا إلى الخبر ألمبيك آسفي يهزم نهضة بركان ويتوج بكأس العرش لأول مرة في تاريخه  .', 'size': 5}, {'id': '179', 'title': 'نهائي كأس العرش.. أولمبيك آسفي يتوج باللقب لأول مرة في تاريخه', 'source': 'machahid24.com', 'link': 'https://machahid24.com/sport/467916.html', 'summary': 'نهائي كأس العرش.. أولمبيك آسفي يتوج باللقب لأول مرة في تاريخه. توج فريق أولمبيك آسفي لأول مرة في تاريخه بلقب كأس العرش لكرة القدم برسم (2023-2024)، عقب تغلبه على نهضة بركان بضربات الترجيح (6-5)، في المباراة النهائية التي جمعتهما، مساء اليوم الأحد، على أرضية المركب الرياضي بمدينة فاس. وانتهى الوقت الأصلي للمباراة بالتعادل بهدف لمثله بين الفريقين، حيث كان أولمبيك آسفي سباقا إلى التهديف عن طريق …', 'size': 3}], 'main_title': 'ألمبيك آسفي يهزم نهضة بركان ويتوج بكأس العرش لأول مرة في تاريخه'}, {'community_id': '6', 'articles': [{'id': '136', 'title': 'الأمن الغذائي.. دبلوماسي يؤكد: المغرب معبأ بالكامل لدعم البلدان النامية', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/316921/', 'summary': 'الأمن الغذائي.. دبلوماسي يؤكد: المغرب معبأ بالكامل لدعم البلدان النامية. أكد نائب المندوب الدائم للمملكة لدى منظمات الأمم المتحدة بروما، عبد الله لغميد، اليوم الأحد بالعاصمة الإيطالية، أن المغرب معبأ بالكامل لدعم الدول الجزرية الصغيرة النامية، والبلدان الأقل نموا، والدول النامية غير الساحلية، من خلال تعاون جنوب-جنوب ملموس فعال. وقال لغميد خلال لقاء نظم في إطار المؤتمر العام الرابع والأربعين لمنظمة الأغذية والزراعة للأمم المتحدة', 'size': 2}, {'id': '212', 'title': 'المغرب معبأ بالكامل لدعم البلدان النامية من خلال تعاون جنوب-جنوب', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/223740/', 'summary': 'المغرب معبأ بالكامل لدعم البلدان النامية من خلال تعاون جنوب-جنوب. وكالات أكد نائب المندوب الدائم للمملكة لدى منظمات الأمم المتحدة بروما، عبد الله لغميد، اليوم الأحد بالعاصمة الإيطالية، أن المغرب معبأ بالكامل لدعم الدول الجزرية الصغيرة النامية، والبلدان الأقل نموا، والدول النامية غير الساحلية، من خلال تعاون جنوب-جنوب ملموس فعال. وقال لغميد خلال لقاء نظم في إطار المؤتمر العام الرابع والأربعين لمنظمة الأغذية والزراعة', 'size': 2}], 'main_title': 'الأمن الغذائي.. دبلوماسي يؤكد: المغرب معبأ بالكامل لدعم البلدان النامية'}, {'community_id': '7', 'articles': [{'id': '138', 'title': 'حموشي يطلع على ترتيبات تأمين نهائي كأس العرش بملعب فاس', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/316925/', 'summary': 'حموشي يطلع على ترتيبات تأمين نهائي كأس العرش بملعب فاس. اطلع المدير العام للأمن الوطني و لمراقبة التراب الوطني السيد عبد اللطيف حموشي، زوال اليوم الأحد 29 يونيو الجاري، على مجمل الترتيبات الأمنية وبروتوكول الأمن والسلامة الذي اعتمدته ولاية أمن فاس لتأمين مباراة نهائي كأس العرش التي سيحتضنها المركب الرياضي بفاس مساء اليوم الأحد بين فريقي أولمبيك أسفي ونهضة بركان. وقد كان المدير العام للأمن', 'size': 3}, {'id': '216', 'title': 'بالصور.. السيد حموشي يواكب الترتيبات الأمنية لمباراة نهائي كأس العرش بفاس', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/223719/', 'summary': 'بالصور.. السيد حموشي يواكب الترتيبات الأمنية لمباراة نهائي كأس العرش بفاس. اطلع المدير العام للأمن الوطني و لمراقبة التراب الوطني السيد عبد اللطيف حموشي، زوال اليوم الأحد 29 يونيو الجاري، على مجمل الترتيبات الأمنية وبروتوكول الأمن والسلامة الذي اعتمدته ولاية أمن فاس لتأمين مباراة نهائي كأس العرش التي سيحتضنها المركب الرياضي بفاس مساء اليوم الأحد بين فريقي أولمبيك أسفي ونهضة بركان. وقد كان المدير العام للأمن', 'size': 3}, {'id': '230', 'title': 'حموشي يطلع على بروتوكول تأمين نهائي كأس العرش (صور)', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%ad%d9%85%d9%88%d8%b4%d9%8a-%d9%8a%d8%b7%d9%84%d8%b9-%d8%b9%d9%84%d9%89-%d8%a8%d8%b1%d9%88%d8%aa%d9%88%d9%83%d9%88%d9%84-%d8%aa%d8%a3%d9%85%d9%8a%d9%86-%d9%86%d9%87%d8%a7%d8%a6%d9%8a-%d9%83%d8%a3/', 'summary': 'حموشي يطلع على بروتوكول تأمين نهائي كأس العرش (صور). اطلع المدير العام للأمن الوطني ولمراقبة التراب الوطني عبد اللطيف حموشي، زوال اليوم الأحد 29 يونيو الجاري ، على مجمل الترتيبات الأمنية وبروتوكول الأمن والسلامة الذي اعتمدته ولاية أمن فاس لتأمين مباراة نهائي كأس العرش، التي سيحتضنها المركب الرياضي بفاس مساء اليوم الأحد بين فريقي أولمبيك أسفي ونهضة بركان. وقد كان المدير العام …  حموشي يطلع على بروتوكول تأمين نهائي كأس العرش (صور)     .', 'size': 3}], 'main_title': 'حموشي يطلع على ترتيبات تأمين نهائي كأس العرش بملعب فاس'}, {'community_id': '4', 'articles': [{'id': '185', 'title': 'اختيار المشاركين بنهائيات مسابقة مؤسسة محمد السادس للعلماء الأفارقة في حفظ وتلاوة وتجويد القرآن الكريم', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/467887.html', 'summary': 'اختيار المشاركين بنهائيات مسابقة مؤسسة محمد السادس للعلماء الأفارقة في حفظ وتلاوة وتجويد القرآن الكريم. أسفرت نتائج المسابقة الإقصائية للدورة السادسة لمسابقة مؤسسة محمد السادس للعلماء الأفارقة في حفظ وتلاوة وتجويد القرآن الكريم، التي نظمها فرع المؤسسة بإثيوبيا أمس السبت بأديس أبابا، عن اختيار ثلاثة مرشحين للمشاركة في نهائيات هذه الدورة.', 'size': 2}, {'id': '189', 'title': 'ثلاثة مرشحين لنهائيات مسابقة حفظ وتلاوة وتجويد القرآن الكريم بإثيوبيا', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%ab%d9%84%d8%a7%d8%ab%d8%a9-%d9%85%d8%b1%d8%b4%d8%ad%d9%8a%d9%86-%d9%84%d9%86%d9%87%d8%a7%d8%a6%d9%8a%d8%a7%d8%aa-%d9%85%d8%b3%d8%a7%d8%a8%d9%82%d8%a9-%d8%ad%d9%81%d8%b8-%d9%88%d8%aa%d9%84%d8%a7/', 'summary': 'ثلاثة مرشحين لنهائيات مسابقة حفظ وتلاوة وتجويد القرآن الكريم بإثيوبيا.  – و م ع أسفرت نتائج المسابقة الإقصائية للدورة السادسة لمسابقة مؤسسة محمد السادس للعلماء الأفارقة في حفظ وتلاوة وتجويد القرآن الكريم، التي نظمها فرع المؤسسة بإثيوبيا اليوم...  ثلاثة مرشحين لنهائيات مسابقة حفظ وتلاوة وتجويد القرآن الكريم بإثيوبيا     .', 'size': 2}], 'main_title': 'اختيار المشاركين بنهائيات مسابقة مؤسسة محمد السادس للعلماء الأفارقة في حفظ وتلاوة وتجويد القرآن الكريم'}, {'community_id': '9', 'articles': [{'id': '208', 'title': 'الأمير مولاي رشيد يترأس المباراة النهائية لنيل كأس العرش لكرة القدم بفاس', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/223757/', 'summary': 'الأمير مولاي رشيد يترأس المباراة النهائية لنيل كأس العرش لكرة القدم بفاس. و م ع ترأس صاحب السمو الملكي الأمير مولاي رشيد، اليوم الأحد بالمركب الرياضي لفاس، المباراة النهائية لنيل كأس العرش لكرة القدم لموسم (2023-2024)، التي فاز بها فريق أولمبيك آسفي عقب تغلبه على فريق نهضة بركان بضربات الترجيح (6-5). ولدى وصول صاحب السمو الملكي الأمير مولاي رشيد إلى المركب الرياضي لفاس، استعرض سموه تشكيلة', 'size': 2}, {'id': '403', 'title': 'فاس.. الأمير مولاي رشيد يترأس نهائي كأس العرش بين نهضة بركان وأولمبيك آسفي', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%81%d8%a7%d8%b3-%d8%a7%d9%84%d8%a3%d9%85%d9%8a%d8%b1-%d9%85%d9%88%d9%84%d8%a7%d9%8a-%d8%b1%d8%b4%d9%8a%d8%af-%d9%8a%d8%aa%d8%b1%d8%a3%d8%b3-%d9%86%d9%87%d8%a7%d8%a6%d9%8a-%d9%83%d8%a3%d8%b3/', 'summary': 'فاس.. الأمير مولاي رشيد يترأس نهائي كأس العرش بين نهضة بركان وأولمبيك آسفي. ترأس صاحب السمو الملكي الأمير مولاي رشيد، اليوم الأحد بالمركب الرياضي لفاس، المباراة النهائية لنيل كأس العرش لكرة القدم لموسم (2023-2024)، التي فاز بها فريق أولمبيك آسفي عقب تغلبه على فريق نهضة بركان بضربات الترجيح (6-5). ولدى وصول صاحب السمو الملكي الأمير مولاي رشيد إلى المركب الرياضي لفاس، استعرض سموه تشكيلة من القوات …  فاس.. الأمير مولاي رشيد يترأس نهائي كأس العرش بين نهضة بركان وأولمبيك آسفي     .', 'size': 2}], 'main_title': 'الأمير مولاي رشيد يترأس المباراة النهائية لنيل كأس العرش لكرة القدم بفاس'}, {'community_id': '10', 'articles': [{'id': '262', 'title': 'استئنافية الرباط تؤيد إدانة المهداوي', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d8%a7%d8%b3%d8%aa%d8%a6%d9%86%d8%a7%d9%81%d9%8a%d8%a9-%d8%a7%d9%84%d8%b1%d8%a8%d8%a7%d8%b7-%d8%aa%d8%a4%d9%8a%d8%af-%d8%a7%d9%84%d8%ad%d9%83%d9%85-%d8%b6%d8%af-%d8%a7%d9%84%d9%85%d9%87%d8%af%d8%a7-1584420.html', 'summary': 'استئنافية الرباط تؤيد إدانة المهداوي. قضت محكمة الاستئناف بالرباط، اليوم الاثنين، بتأييد الحكم الابتدائي بإدانة الصحافي حميد المهداوي، مدير نشر موقع “بديل”، بسنة ونصف السنة حبسا نافذا، وأداء غرامة مالية قدرها 150 مليون سنتيم، لفائدة وزير العدل، عبد اللطيف وهبي. يشار إلى أن المحكمة الابتدائية بمدينة الرباط كانت قد أدانت المهدوي في 11 نونبر الماضي في القضية التي توبع فيها  استئنافية الرباط تؤيد إدانة المهداوي     - هسبريس جريدة إلكترونية مغربية .', 'size': 3}, {'id': '339', 'title': 'استئنافية الرباط تؤيد إدانة المهدوي بـ 18 شهرا وغرامة 150 مليون', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1081802.html', 'summary': 'استئنافية الرباط تؤيد إدانة المهدوي بـ 18 شهرا وغرامة 150 مليون. أيدت محكمة الاستئناف بالرباط الحكم الصادر في حق الصحافي حميد المهدوي، مدير نشر موقع “بديل”، والقاضي بسجنه لمدة سنة ونصف، بالإضافة إلى غرامة مالية قدرها 150 مليون سنتيم. وتعود تفاصيل القضية إلى اتهام المهدوي بالسب والقذف في حق وزير العدل عبد اللطيف وهبي، بعد نشره لفيديو على موقعه الإلكتروني يتهم فيه الوزير بالفساد، حيث تقدم ظهرت المقالة استئنافية الرباط تؤيد إدانة المهدوي بـ 18 شهرا وغرامة 150 مليون  .', 'size': 3}, {'id': '352', 'title': 'سنة ونصف حبسا.. استئنافية الرباط تؤيد الحكم ضد المهدوي', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%b3%d9%86%d8%a9-%d9%88%d9%86%d8%b5%d9%81-%d8%ad%d8%a8%d8%b3%d8%a7-%d8%a7%d8%b3%d8%aa%d8%a6%d9%86%d8%a7%d9%81%d9%8a%d8%a9-%d8%a7%d9%84%d8%b1%d8%a8%d8%a7%d8%b7-%d8%aa%d8%a4%d9%8a%d8%af-%d8%a7%d9%84/', 'summary': 'سنة ونصف حبسا.. استئنافية الرباط تؤيد الحكم ضد المهدوي. أيدت محكمة الاستئناف بالرباط، صباح الاثنين 30 يونيو 2025، الحكم الابتدائي الصادر في حق الصحافي حميد المهدوي، مدير نشر موقع "بديل"، والقاضي بإدانته بسنة ونصف حبسا نافذا، وتعويض مدني قدره 150 مليون سنتيم لفائدة وزير العدل عبد اللطيف وهبي. وصدر هذا الحكم استنادا إلى الفصول 443، 444 و447 من القانون الجنائي، بعد متابعة الصحفي حميد  سنة ونصف حبسا.. استئنافية الرباط تؤيد الحكم ضد المهدوي     .', 'size': 3}], 'main_title': 'استئنافية الرباط تؤيد إدانة المهداوي'}, {'community_id': '12', 'articles': [{'id': '334', 'title': 'طقس الاثنين…أجواء حارة في عدد من المناطق', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/316955/', 'summary': 'طقس الاثنين…أجواء حارة في عدد من المناطق. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الاثنين، أن تتميز الحالة الجوية عامة، بطقس حار إلى محليا جد حار بعدد من مناطق البلاد، بما في ذلك السهول الشمالية والوسطى والسايس وجنوب الريف، وهضاب الفوسفاط ووالماس والجنوب الشرقي للبلاد، وداخل كل من منطقة سوس والأقاليم الصحراوية. وستكون الأجواء حارة نسبيا فوق مرتفعات الأطلس المتوسط وشرق البلاد، إلى', 'size': 5}, {'id': '362', 'title': 'توقعات أحوال الطقس لليوم الاثنين', 'source': 'soltana.ma', 'link': 'https://soltana.ma/1357498.html', 'summary': 'توقعات أحوال الطقس لليوم الاثنين. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الاثنين، أن تتميز الحالة الجوية عامة، بطقس حار إلى محليا جد حار بعدد من مناطق البلاد، بما في ذلك السهول الشمالية والوسطى والسايس وجنوب الريف، وهضاب الفوسفاط ووالماس والجنوب الشرقي للبلاد، وداخل كل من منطقة سوس والأقاليم الصحراوية. وستكون الأجواء حارة نسبيا فوق مرتفعات الأطلس المتوسط وشرق البلاد،', 'size': 5}, {'id': '381', 'title': 'مديرية الأرصاد: طقس حار إلى محليا جد حار يهم مناطق المملكة اليوم الاثنين', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/467922.html', 'summary': 'مديرية الأرصاد: طقس حار إلى محليا جد حار يهم مناطق المملكة اليوم الاثنين. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الاثنين، أن تتميز الحالة الجوية عامة، بطقس حار إلى محليا جد حار بعدد من مناطق البلاد، بما في ذلك السهول الشمالية والوسطى والسايس وجنوب الريف، وهضاب الفوسفاط ووالماس والجنوب الشرقي للبلاد، وداخل كل من منطقة سوس والأقاليم الصحراوية.', 'size': 5}, {'id': '391', 'title': 'طقس الاثنين.. حرارة متواصلة في عدة مناطق بالمملكة', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/223760/', 'summary': 'طقس الاثنين.. حرارة متواصلة في عدة مناطق بالمملكة. كواليس اليوم تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الاثنين، أن تتميز الحالة الجوية عامة، بطقس حار إلى محليا جد حار بعدد من مناطق البلاد، بما في ذلك السهول الشمالية والوسطى والسايس وجنوب الريف، وهضاب الفوسفاط ووالماس والجنوب الشرقي للبلاد، وداخل كل من منطقة سوس والأقاليم الصحراوية. وستكون الأجواء حارة نسبيا فوق مرتفعات الأطلس', 'size': 5}, {'id': '402', 'title': 'موجة حر وأمطار مرتقبة اليوم الإثنين بالمغرب', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%85%d9%88%d8%ac%d8%a9-%d8%ad%d8%b1-%d9%88%d8%a3%d9%85%d8%b7%d8%a7%d8%b1-%d9%85%d8%b1%d8%aa%d9%82%d8%a8%d8%a9-%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%a5%d8%ab%d9%86%d9%8a%d9%86-%d8%a8%d8%a7/', 'summary': 'موجة حر وأمطار مرتقبة اليوم الإثنين بالمغرب. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الاثنين، أن تتميز الحالة الجوية عامة، بطقس حار إلى محليا جد حار بعدد من مناطق البلاد، بما في ذلك السهول الشمالية والوسطى والسايس وجنوب الريف، وهضاب الفوسفاط ووالماس والجنوب الشرقي للبلاد، وداخل كل من منطقة سوس والأقاليم الصحراوية. وستكون الأجواء حارة نسبيا فوق مرتفعات الأطلس المتوسط …  موجة حر وأمطار مرتقبة اليوم الإثنين بالمغرب     .', 'size': 5}], 'main_title': 'طقس الاثنين…أجواء حارة في عدد من المناطق'}, {'community_id': '11', 'articles': [{'id': '350', 'title': 'الجمعية الدولية لعلم الاجتماع تعلق عضوية إسرائيل بسبب الإبادة الجماعية في غزة', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1081750.html', 'summary': 'الجمعية الدولية لعلم الاجتماع تعلق عضوية إسرائيل بسبب الإبادة الجماعية في غزة. أعلنت الجمعية الدولية لعلم الاجتماع (ISA) الأحد 29 يونيو 2025، عن قرار لجنتها التنفيذية بتعليق العضوية الجماعية للجمعية الإسرائيلية لعلم الاجتماع (ISS). ويأتي هذا القرار في سياق موقف الجمعية الدولية الرافض لما وصفته بـ”الإبادة الجماعية للفلسطينيين في غزة”. وأفاد بيان صادر عن الجمعية الدولية لعلم الاجتماع بأنها “تكرر إعلانها، كجزء من موقفها العام ضد الإبادة ظهرت المقالة الجمعية الدولية لعلم الاجتماع تعلق عضوية إسرائيل بسبب الإبادة الجماعية في غزة  .', 'size': 2}, {'id': '360', 'title': 'بسبب صمتها عن إبادة الفلسطينيين.. الجمعية الدولية لعلم الاجتماع تجمد عضوية إسرائيل', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a8%d8%b3%d8%a8%d8%a8-%d8%b5%d9%85%d8%aa%d9%87%d8%a7-%d8%b9%d9%86-%d8%a5%d8%a8%d8%a7%d8%af%d8%a9-%d8%a7%d9%84%d9%81%d9%84%d8%b3%d8%b7%d9%8a%d9%86%d9%8a%d9%8a%d9%86-%d8%a7%d9%84%d8%ac%d9%85%d8%b9/', 'summary': 'بسبب صمتها عن إبادة الفلسطينيين.. الجمعية الدولية لعلم الاجتماع تجمد عضوية إسرائيل. قرّرت اللجنة التنفيذية للجمعية الدولية لعلم الاجتماع (ISA) تعليق العضوية الجماعية للجمعية الإسرائيلية لعلم الاجتماع (ISS)، على خلفية موقف الأخيرة من الوضع الإنساني المتدهور في قطاع غزة، وغياب إدانة واضحة لـ"الإبادة الجماعية بحق الفلسطينيين". وأوضحت الجمعية في بيان رسمي، صدر بتاريخ 29 يونيو 2025، واطلع "تيلكيل عربي" على نُسخة منه، أنها "لا تقيم أي علاقات  بسبب صمتها عن إبادة الفلسطينيين.. الجمعية الدولية لعلم الاجتماع تجمد عضوية إسرائيل     .', 'size': 2}], 'main_title': 'الجمعية الدولية لعلم الاجتماع تعلق عضوية إسرائيل بسبب الإبادة الجماعية في غزة'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    