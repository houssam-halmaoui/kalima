<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 31/07/2025 - 06h31</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '8', 'articles': [{'id': '13', 'title': 'أخنوش: الحكومة معبأة خلف جلالة الملك لتفعيل التنمية المجالية', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-645292.html', 'summary': 'أخنوش: الحكومة معبأة خلف جلالة الملك لتفعيل التنمية المجالية. أكد رئيس الحكومة، السيد عزيز أخنوش ، أن الحكومة معبأة بكل مكوناتها خلف صاحب الجلالة الملك محمد السادس، نصره الله، من أجل تنزيل وتفعيل الاستراتيجيات الوطنية الرامية إلى فتح آفاق جديدة للتنمية المجالية وتحقيق العدالة الترابية. وجاء تصريح السيد أخنوش عقب مشاركته في حفل الاستقبال الرسمي الذي ترأسه جلالة الملك محمد السادس، اليوم الأربعاء بمدينة المضيق، بمناسبة تخليد الذكرى السادسة والعشرين لعيد العرش المجيد. واعتبر رئيس الحكومة أن هذا اليوم يعد مناسبة وطنية غالية عند جميع المغاربة، وفرصة لاستحضار المنجزات التنموية الكبرى التي تحققت في عهد جلالة الملك، مشيرًا إلى أن هذه الأوراش شملت مجالات اقتصادية واجتماعية متعددة، وأسهمت في تحسين ظروف عيش المواطنين وتعزيز البنيات التحتية. كما نوه السيد أخنوش بالمضامين السامية التي تضمنها الخطاب الملكي، الذي وجهه جلالة الملك إلى الأمة أمس الثلاثاء، حيث وصفه بـ"الخطاب الموجه نحو المستقبل"، مؤكداً أنه رسم معالم جديدة للتنمية المجالية وفتح آفاقًا واعدة أمام مختلف الجهات.', 'size': 2}, {'id': '169', 'title': 'أخنوش: خطاب العرش فتح آفاقا جديدة للتنمية والحكومة معبأة لتفعيل التوجيهات الملكية', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1089500.html', 'summary': 'أخنوش: خطاب العرش فتح آفاقا جديدة للتنمية والحكومة معبأة لتفعيل التوجيهات الملكية. قال رئيس الحكومة، عزيز أخنوش، إن الحكومة معبأة خلف الملك محمد السادس، لتنزيل وتفعيل الاستراتيجيات الرامية إلى فتح آفاق جديدة للتنمية المجالية. وأوضح أخنوش، في تصريح للصحافة عقب حفل الاستقبال الذي ترأسه الملك بمناسبة عيد العرش المجيد، أن هذه الذكرى ” يوم عظيم عند المغاربة ومناسبة لاستحضار الإنجازات المهمة والأوراش الكبيرة التي تحققت في عهد ظهرت المقالة أخنوش: خطاب العرش فتح آفاقا جديدة للتنمية والحكومة معبأة لتفعيل التوجيهات الملكية  .', 'size': 3}, {'id': '377', 'title': 'أخنوش: نسير خلف التوجيهات الملكية لبلوغ تنمية مجالية عادلة ومتوازنة', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/319781/', 'summary': 'أخنوش: نسير خلف التوجيهات الملكية لبلوغ تنمية مجالية عادلة ومتوازنة. قال رئيس الحكومة، عزيز أخنوش، إن الحكومة معبأة خلف صاحب الجلالة الملك محمد السادس، نصره الله، لتنزيل وتفعيل الاستراتيجيات الرامية إلى فتح آفاق جديدة للتنمية المجالية. وأوضح أخنوش، في تصريح للصحافة عقب حفل الاستقبال الذي ترأسه جلالة الملك بمناسبة عيد العرش المجيد، أن هذه الذكرى ” يوم عظيم عند المغاربة ومناسبة لاستحضار الإنجازات المهمة والأوراش', 'size': 3}, {'id': '411', 'title': 'أخنوش يتفاعل سريعا مع الخطاب الملكي: الحكومة معبأة خلف صاحب الجلالة لفتح آفاق جديدة للتنمية المجالية', 'source': 'rue20.com', 'link': 'https://rue20.com/925385.html', 'summary': 'أخنوش يتفاعل سريعا مع الخطاب الملكي: الحكومة معبأة خلف صاحب الجلالة لفتح آفاق جديدة للتنمية المجالية.  . الرباط أكد رئيس الحكومة، عزيز أخنوش، أن الحكومة معبأة خلف صاحب الجلالة الملك محمد السادس، لتنزيل وتفعيل الاستراتيجيات الرامية إلى فتح آفاق جديدة للتنمية المجالية. وأوضح أخنوش، في تصريح للصحافة عقب حفل الاستقبال الذي ترأسه جلالة الملك بمناسبة عيد العرش المجيد، أن هذه الذكرى ” يوم عظيم عند المغاربة ومناسبة لاستحضار الإنجازات المهمة الخبر أخنوش يتفاعل سريعا مع الخطاب الملكي: الحكومة معبأة خلف صاحب الجلالة لفتح آفاق جديدة للتنمية المجالية  .', 'size': 2}], 'main_title': 'أخنوش: خطاب العرش فتح آفاقا جديدة للتنمية والحكومة معبأة لتفعيل التوجيهات الملكية'}, {'community_id': '1', 'articles': [{'id': '39', 'title': 'بوتين: “متمنياتنا للشعب المغربي بالسعادة والازدهار”', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-645170.html', 'summary': 'بوتين: “متمنياتنا للشعب المغربي بالسعادة والازدهار”. هبة بريس توصل صاحب الجلالة الملك محمد السادس ببرقية تهنئة من رئيس روسيا الاتحادية فلاديمير بوتين، وذلك بمناسبة عيد العرش المجيد. وأعرب بوتين، في هذه البرقية، عن أخلص التهاني والمتمنيات لجلالة الملك بموفور الصحة والنجاح، وللشعب المغربي بالسعادة والازدهار. وعبر الرئيس الروسي، بهذه المناسبة، عن ارتياحه للعلاقات المغربية الروسية القائمة على تقاليد متميزة من الصداقة والاحترام المتبادل، وعن اقتناعه بأن تطوير تعاون ثنائي بناء في جميع المجالات يستجيب بشكل كامل لمصالح الشعبين ويساهم في ضمان الأمن والاستقرار في إفريقيا والشرق الأوسط.', 'size': 2}, {'id': '183', 'title': 'بوتين: علاقات المغرب وروسيا ترتكز على “تقاليد متميزة من الصداقة”', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1089425.html', 'summary': 'بوتين: علاقات المغرب وروسيا ترتكز على “تقاليد متميزة من الصداقة”. توصل الملك محمد السادس ببرقية تهنئة من رئيس روسيا الاتحادية فلاديمير بوتين، وذلك بمناسبة عيد العرش المجيد. وأعرب بوتين، في هذه البرقية، عن أخلص التهاني والمتمنيات للملك بموفور الصحة والنجاح، وللشعب المغربي بالسعادة والازدهار. وعبر الرئيس الروسي، بهذه المناسبة، عن ارتياحه للعلاقات المغربية الروسية القائمة على تقاليد متميزة من الصداقة والاحترام المتبادل، وعن اقتناعه بأن ظهرت المقالة بوتين: علاقات المغرب وروسيا ترتكز على “تقاليد متميزة من الصداقة”  .', 'size': 2}], 'main_title': 'بوتين: “متمنياتنا للشعب المغربي بالسعادة والازدهار”'}, {'community_id': '2', 'articles': [{'id': '62', 'title': 'الملك يترأس بالمضيق حفل استقبال بمناسبة عيد العرش المجيد', 'source': 'www.alakhbar.press.ma', 'link': 'https://www.alakhbar.press.ma/%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%8a%d8%aa%d8%b1%d8%a3%d8%b3-%d8%a8%d8%a7%d9%84%d9%85%d8%b6%d9%8a%d9%82-%d8%ad%d9%81%d9%84-%d8%a7%d8%b3%d8%aa%d9%82%d8%a8%d8%a7%d9%84-%d8%a8%d9%85%d9%86%d8%a7%d8%b3-270179.html', 'summary': 'الملك يترأس بالمضيق حفل استقبال بمناسبة عيد العرش المجيد. الأخبار ترأس الملك محمد السادس، مرفوقا بولي العهد الأمير مولاي الحسن، والأمير مولاي رشيد، بعد زوال اليوم الأربعاء بساحة عمالة المضيق-الفنيدق، بمدينة المضيق، حفل استقبال بمناسبة الذكرى السادسة والعشرين لتربعه على عرش أسلافه المنعمين. وفي مستهل هذا الحفل، جرت تحية العلم على نغمات النشيد الوطني، بينما كانت المدفعية تطلق 21 طلقة. إثر ذلك، تقدم للسلام …  الملك يترأس بالمضيق حفل استقبال بمناسبة عيد العرش المجيد     .', 'size': 3}, {'id': '135', 'title': 'المضيق.. جلالة الملك يترأس حفل استقبال بمناسبة عيد العرش', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a7%d9%84%d9%85%d8%b6%d9%8a%d9%82-%d8%ac%d9%84%d8%a7%d9%84%d8%a9-%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%8a%d8%aa%d8%b1%d8%a3%d8%b3-%d8%ad%d9%81%d9%84-%d8%a7%d8%b3%d8%aa%d9%82%d8%a8%d8%a7%d9%84-%d8%a8-3/', 'summary': 'المضيق.. جلالة الملك يترأس حفل استقبال بمناسبة عيد العرش. ترأس صاحب الجلالة الملك محمد السادس، مرفوقا بصاحب السمو الملكي ولي العهد الأمير مولاي الحسن، وصاحب السمو الملكي الأمير مولاي رشيد، بعد زوال اليوم الأربعاء (30 يوليوز)، بساحة عمالة المضيق-الفنيدق، بمدينة المضيق، حفل استقبال بمناسبة الذكرى السادسة والعشرين لتربع جلالته على عرش أسلافه المنعمين. وفي مستهل هذا الحفل، جرت تحية العلم على نغمات النشيد الوطني،', 'size': 3}, {'id': '200', 'title': 'جلالة الملك يمنح لبؤات الأطلس أفضل تتويج…تقدير ملكي رفيع لكرة القدم المغربية', 'source': 'rue20.com', 'link': 'https://rue20.com/925323.html', 'summary': 'جلالة الملك يمنح لبؤات الأطلس أفضل تتويج…تقدير ملكي رفيع لكرة القدم المغربية. . الرباط ترأس صاحب الجلالة الملك محمد السادس، نصره الله، مرفوقا بصاحب السمو الملكي ولي العهد الأمير مولاي الحسن، وصاحب السمو الملكي الأمير مولاي رشيد، بعد زوال اليوم الأربعاء بساحة عمالة المضيق-الفنيدق، بمدينة المضيق، حفل استقبال بمناسبة الذكرى السادسة والعشرين لتربع جلالته على عرش أسلافه المنعمين. وفي مستهل هذا الحفل، جرت تحية العلم على الخبر جلالة الملك يمنح لبؤات الأطلس أفضل تتويج…تقدير ملكي رفيع لكرة القدم المغربية  .', 'size': 3}], 'main_title': 'الملك يترأس بالمضيق حفل استقبال بمناسبة عيد العرش المجيد'}, {'community_id': '3', 'articles': [{'id': '70', 'title': '“مدينة تُصغي للحجارة”: حين تُصبح الذات مرآةً لا تعكس إلا ارتجاف السؤال.', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/204349', 'summary': '“مدينة تُصغي للحجارة”: حين تُصبح الذات مرآةً لا تعكس إلا ارتجاف السؤال.. الاحداث نت – الرباط في زمنٍ تَفْرِض فيه النصوصُ إيقاعَها السريعَ وخطابَها المقولبَ، يطلّ علينا الكاتب المغربي الشاب وائل احساين بكتابٍ لا يُصنَّف، لا يُروى، ولا يُختصر، ” مدينة تُصغي للحجارة” ارتجاجٌ داخليّ لكائن يبحث عن نفسه كمن يبحث عن ظلّه في ضوء مُنطفئ، أو كمن يحدّق في مرآةٍ لا تعكس إلا ما نهرب منه.', 'size': 2}, {'id': '289', 'title': 'احساين يدخل "مدينة تصغي للحجارة"', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d8%a7%d8%ad%d8%b3%d8%a7%d9%8a%d9%86-%d9%8a%d8%af%d8%ae%d9%84-%d9%85%d8%af%d9%8a%d9%86%d8%a9-%d8%aa%d8%b5%d8%ba%d9%8a-%d9%84%d9%84%d8%ad%d8%ac%d8%a7%d8%b1%d8%a9-1601490.html', 'summary': 'احساين يدخل "مدينة تصغي للحجارة". في زمنٍ تَفْرِض النصوصُ إيقاعَها السريعَ وخطابَها المقولبَ يطلّ علينا الكاتب المغربي الشاب وائل احساين بكتابٍ لا يُصنَّف، لا يُروى، ولا يُختصر، “مدينة تُصغي للحجارة” ارتجاجٌ داخليّ لكائن يبحث عن نفسه كمن يبحث عن ظلّه في ضوء مُنطفئ، أو كمن يحدّق في مرآةٍ لا تعكس إلا ما نهرب منه. هذا العمل، الممتد بين شذرات وجدانية  احساين يدخل "مدينة تصغي للحجارة"     - هسبريس جريدة إلكترونية مغربية .', 'size': 2}], 'main_title': '“مدينة تُصغي للحجارة”: حين تُصبح الذات مرآةً لا تعكس إلا ارتجاف السؤال.'}, {'community_id': '4', 'articles': [{'id': '84', 'title': 'الملك محمد السادس يجدد تمسك المغرب بـ"اليد الممدودة" تجاه الجزائر ويؤكد: الشعب الجزائري شقيق', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/national/410165.html', 'summary': 'الملك محمد السادس يجدد تمسك المغرب بـ"اليد الممدودة" تجاه الجزائر ويؤكد: الشعب الجزائري شقيق. في خطاب العرش الذي ألقاه اليوم الثلاثاء 29 يوليوز، أعاد الملك محمد السادس التأكيد على خيار المغرب الثابت في انتهاج سياسة "اليد الممدودة" تجاه الجزائر،', 'size': 2}, {'id': '248', 'title': 'الملك في خطاب العرش: حرصت دوما على مد اليد لأشقائنا في الجزائر', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7%d8%af%d8%b3-%d9%81%d9%8a-%d8%ae%d8%b7%d8%a7%d8%a8-%d8%a7%d9%84%d8%b9%d8%b1%d8%b4-%d8%ad%d8%b1%d8%b5%d8%aa-%d8%af%d9%88/', 'summary': 'الملك في خطاب العرش: حرصت دوما على مد اليد لأشقائنا في الجزائر. المساء اليوم: أكد جلالة الملك محمد السادس التزام المغرب بالانفتاح على محيطه الجهوي، وخاصة جواره المباشر، في علاقته بالشعب الجزائري الشقيق الذي تجمعه بالشعب المغربي علاقات إنسانية وتاريخية عريقة. وقال جلالة الملك، في الخطاب السامي', 'size': 2}], 'main_title': 'الملك محمد السادس يجدد تمسك المغرب بـ"اليد الممدودة" تجاه الجزائر ويؤكد: الشعب الجزائري شقيق'}, {'community_id': '5', 'articles': [{'id': '105', 'title': 'بيان وزارة الخارجية الأمريكية بمناسبة عيد العرش المجيد', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/politic/410190.html', 'summary': 'بيان وزارة الخارجية الأمريكية بمناسبة عيد العرش المجيد. أبرز وزير الخارجية الأمريكي، ماركو روبيو، اليوم الأربعاء، ريادة صاحب الجلالة الملك محمد السادس من أجل عهد جديد من السلام والازدهار، مشيدا بالشراكة الدائمة مع', 'size': 2}, {'id': '143', 'title': 'واشنطن تشيد بريادة الملك في ترسيخ السلام والازدهار', 'source': 'assabah.ma', 'link': 'https://assabah.ma/862573.html', 'summary': 'واشنطن تشيد بريادة الملك في ترسيخ السلام والازدهار. أبرز وزير الخارجية الأمريكي، ماركو روبيو، اليوم الأربعاء، ريادة الملك محمد السادس من أجل عهد جديد من السلام والازدهار، مشيدا بالشراكة الدائمة مع المملكة المغربية. وفي بيان بمناسبة الذكرى الـ26 لتربع جلالته على عرش أسلافه المنعمين، قال رئيس الدبلوماسية الأمريكية إنه “في ظل قيادة الرئيس ترامب وصاحبأكمل القراءة » المقالة واشنطن تشيد بريادة الملك في ترسيخ السلام والازدهار  .', 'size': 3}, {'id': '173', 'title': 'الخارجية الأمريكية: الملك محمد السادس وترامب يقودان “حقبة جديدة” من الازدهار', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1089478.html', 'summary': 'الخارجية الأمريكية: الملك محمد السادس وترامب يقودان “حقبة جديدة” من الازدهار. أبرز وزير الخارجية الأمريكي، ماركو روبيو، اليوم الأربعاء، ريادة الملك محمد السادس من أجل عهد جديد من السلام والازدهار، مشيدا بالشراكة الدائمة مع المملكة المغربية. وفي بيان بمناسبة الذكرى الـ26 لعيد العرش، قال رئيس الدبلوماسية الأمريكية إنه “في ظل قيادة الرئيس ترامب وصاحب الجلالة الملك محمد السادس، سنواصل بناء حقبة جديدة من السلام والازدهار في ظهرت المقالة الخارجية الأمريكية: الملك محمد السادس وترامب يقودان “حقبة جديدة” من الازدهار  .', 'size': 3}, {'id': '213', 'title': 'الخارجية الأمريكية.. واشنطن تبرز ريادة الملك لفائدة السلام والازدهار وتشيد بالشراكة الدائمة مع الرباط', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/471060.html', 'summary': 'الخارجية الأمريكية.. واشنطن تبرز ريادة الملك لفائدة السلام والازدهار وتشيد بالشراكة الدائمة مع الرباط. أبرز وزير الخارجية الأمريكي، ماركو روبيو، اليوم الأربعاء، ريادة الملك محمد السادس من أجل عهد جديد من السلام والازدهار، مشيدا بالشراكة الدائمة مع المملكة المغربية.', 'size': 4}], 'main_title': 'الخارجية الأمريكية.. واشنطن تبرز ريادة الملك لفائدة السلام والازدهار وتشيد بالشراكة الدائمة مع الرباط'}, {'community_id': '6', 'articles': [{'id': '161', 'title': 'الملك محمد السادس يستقبل المنتخب المغربي للسيدات ورئيس “الفيفا”', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-582804.html', 'summary': 'الملك محمد السادس يستقبل المنتخب المغربي للسيدات ورئيس “الفيفا”. استقبل الملك محمد السادس، مساء اليوم، رئيس الاتحاد الدولي لكرة القدم، جياني إنفانتينو، والمنتخب الوطني النسوي بعد بلوغه نهائي كأس أمم إفريقيا للسيدات. وجرى الاستقبال الملكي للمنتخب الوطني ورئيس “الفيفا” في حفل أقيم بساحة عمالة المضيق-الفنيدق بمدينة المضيق، وذلك بمناسبة الذكرى الـ26 لعيد العرش. وكان المنتخب النيجيري قد توج بلقبه', 'size': 3}, {'id': '180', 'title': 'الملك يستقبل “إنفانتينو” ومكونات المنتخب النسوي بمناسبة الذكرى الـ26 لعيد العرش', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1089434.html', 'summary': 'الملك يستقبل “إنفانتينو” ومكونات المنتخب النسوي بمناسبة الذكرى الـ26 لعيد العرش. استقبل الملك محمد السادس، رئيس الاتحاد الدولي لكرة القدم “فيفا” جياني إنفانتينو، بساحة عمالة الفنيدق بمدينة المضيق، وذلك خلال الحفل الملكي الرسمي بمناسبة تخليد الذكرى السادسة والعشرين لعيد العرش المجيد. كما استقبل الملك محمد السادس، مكونات المنتخب الوطني النسوي، وذلك بعد أيام قليلة من احتلاله وصافة كأس أمم إفريقيا، بعد أن تمكن من بلوغ المشهد ظهرت المقالة الملك يستقبل “إنفانتينو” ومكونات المنتخب النسوي بمناسبة الذكرى الـ26 لعيد العرش  .', 'size': 3}, {'id': '192', 'title': 'الملك محمد السادس يستقبل المنتخب النسوي ورئيس "الفيفا"', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7%d8%af%d8%b3-%d9%8a%d8%b3%d8%aa%d9%82%d8%a8%d9%84-%d8%a7%d9%84%d9%85%d9%86%d8%aa%d8%ae%d8%a8-%d8%a7%d9%84%d9%86%d8%b3/', 'summary': 'الملك محمد السادس يستقبل المنتخب النسوي ورئيس "الفيفا". استقبل الملك محمد السادس، مساء اليوم، رئيس الاتحاد الدولي لكرة القدم، جياني إنفانتينو، والمنتخب الوطني النسوي بعد بلوغه نهائي كأس أمم إفريقيا للسيدات. وجرى الاستقبال الملكي للمنتخب الوطني ورئيس "الفيفا" في حفل أقيم بساحة عمالة المضيق-الفنيدق بمدينة المضيق، وذلك بمناسبة الذكرى الـ26 لعيد العرش. وكان المنتخب النيجيري قد توج بلقبه العاشر في كأس أمم إفريقيا  الملك محمد السادس يستقبل المنتخب النسوي ورئيس "الفيفا"     .', 'size': 3}], 'main_title': 'الملك محمد السادس يستقبل المنتخب المغربي للسيدات ورئيس “الفيفا”'}, {'community_id': '7', 'articles': [{'id': '165', 'title': 'بنك المغرب يصدر قطعة نقدية تذكارية بمناسبة عيد العرش', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-582785.html', 'summary': 'بنك المغرب يصدر قطعة نقدية تذكارية بمناسبة عيد العرش. أصدر بنك المغرب قطعة نقدية تذكارية فضية من فئة 250 درهما، وذلك تخليدا للذكرى السادسة والعشرين لتربع صاحب الجلالة الملك محمد السادس على عرش أسلافه المنعمين. وأفاد بنك المغرب، في بلاغ له، بأن وجه القطعة النقدية يحمل صورة صاحب الجلالة الملك محمد السادس وعبارات “محمد السادس” و”المملكة المغربية – ⵜⴰⴳⵍⴷⵉⵜ ⵏ ⵍⵎⵖⵔⵉⴱ”', 'size': 2}, {'id': '244', 'title': 'بنك المغرب يصدر قطعة نقدية تذكارية فضية من فئة 250 درهما بمناسبة عيد العرش', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%a8%d9%86%d9%83-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d9%8a%d8%b5%d8%af%d8%b1-%d9%82%d8%b7%d8%b9%d8%a9-%d9%86%d9%82%d8%af%d9%8a%d8%a9-%d8%aa%d8%b0%d9%83%d8%a7%d8%b1%d9%8a%d8%a9-%d9%81%d8%b6%d9%8a/', 'summary': 'بنك المغرب يصدر قطعة نقدية تذكارية فضية من فئة 250 درهما بمناسبة عيد العرش. المساء اليوم: أصدر بنك المغرب قطعة نقدية تذكارية فضية من فئة 250 درهما، وذلك تخليدا للذكرى السادسة والعشرين لتربع الملك محمد السادس على العرش. وأفاد بنك المغرب، في بيان له، بأن وجه القطعة النقدية يحمل', 'size': 2}], 'main_title': 'بنك المغرب يصدر قطعة نقدية تذكارية بمناسبة عيد العرش'}, {'community_id': '9', 'articles': [{'id': '171', 'title': 'قادة العالم يهنئون الملك محمد السادس بالذكرى الـ26 لتوليه عرش المملكة', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1089488.html', 'summary': 'قادة العالم يهنئون الملك محمد السادس بالذكرى الـ26 لتوليه عرش المملكة. بمناسبة الذكرى السادسة والعشرين لعيد العرش ظهرت المقالة قادة العالم يهنئون الملك محمد السادس بالذكرى الـ26 لتوليه عرش المملكة  .', 'size': 2}, {'id': '422', 'title': 'فيديو.. الملك محمد السادس يُعلن موعد الانتخابات التشريعية', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d9%81%d9%8a%d8%af%d9%8a%d9%88-%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7%d8%af%d8%b3-%d9%8a%d9%8f%d8%b9%d9%84%d9%86-%d9%85%d9%88%d8%b9%d8%af-%d8%a7%d9%84%d8%a7/', 'summary': 'فيديو.. الملك محمد السادس يُعلن موعد الانتخابات التشريعية. فيديو.. الملك محمد السادس يُعلن موعد الانتخابات التشريعية  فيديو.. الملك محمد السادس يُعلن موعد الانتخابات التشريعية     .', 'size': 2}], 'main_title': 'قادة العالم يهنئون الملك محمد السادس بالذكرى الـ26 لتوليه عرش المملكة'}, {'community_id': '10', 'articles': [{'id': '182', 'title': 'خطاب العرش 2025: الملك يرسم معالم مرحلة جديدة بين التنمية والعدالة المجالية والانفتاح السياسي', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1089430.html', 'summary': 'خطاب العرش 2025: الملك يرسم معالم مرحلة جديدة بين التنمية والعدالة المجالية والانفتاح السياسي. وجه جلالة الملك محمد السادس، مساء الثلاثاء، خطابا ساميا إلى الأمة بمناسبة الذكرى السادسة والعشرين لاعتلائه العرش، رسم من خلاله ملامح المرحلة المقبلة على المستويين الاقتصادي والسياسي، مؤكدا على أولوية العدالة الاجتماعية والمجالية، والاستعداد للاستحقاقات الانتخابية المقبلة، مع التمسك بخيار الانفتاح الإقليمي والدفاع عن الوحدة الترابية للمملكة. أولا: انجازات اقتصادية وتحديات اجتماعية أكد جلالته أن ظهرت المقالة خطاب العرش 2025: الملك يرسم معالم مرحلة جديدة بين التنمية والعدالة المجالية والانفتاح السياسي  .', 'size': 4}, {'id': '233', 'title': 'خطاب العرش 2025 بين وضوح المقاربة الاقتصادية وصرامة التوجيه التنموي', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/225407/', 'summary': 'خطاب العرش 2025 بين وضوح المقاربة الاقتصادية وصرامة التوجيه التنموي. ياسيــن كحلـي مستشار قانوني وباحث في العلوم القانونية يشكل الخطاب الملكي السامي، الذي وجهه جلالة الملك محمد السادس إلى الشعب المغربي بمناسبة الذكرى السادسة والعشرين لتربع جلالته على عرش أسلافه، لحظة سيادية حاسمة تتجاوز بعدها الرمزي والاحتفالي لتؤسس لمنظور جديد لتدبير الشأن الوطني، ولتجديد العلاقة التعاقدية بين الملك وشعبه. فليست العبرة فقط في مناسبة', 'size': 4}, {'id': '271', 'title': 'عيد العرش: الملك يقر على جدول الترقية لسنة 2025 المتعلق بأفراد القوات المسلحة الملكية والدرك الملكي والحرس الملكي والقوات المساعدة', 'source': 'www.alalam.ma', 'link': 'https://www.alalam.ma/عيد-العرش-الملك-يقر-على-جدول-الترقية-لسنة-2025-المتعلق-بأفراد_a28929.html', 'summary': 'عيد العرش: الملك يقر على جدول الترقية لسنة 2025 المتعلق بأفراد القوات المسلحة الملكية والدرك الملكي والحرس الملكي والقوات المساعدة. *العلم الإلكترونية: متابعة* استقبل جلالة الملك محمد السادس، القائد الأعل...', 'size': 3}, {'id': '376', 'title': 'إجماع سياسي واسع على دعم خطاب العرش.. رؤية ملكية لإصلاح شامل وتنمية عادلة', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/319777/', 'summary': 'إجماع سياسي واسع على دعم خطاب العرش.. رؤية ملكية لإصلاح شامل وتنمية عادلة. عبّرت مختلف الأحزاب السياسية المغربية، سواء المنضوية تحت لواء الأغلبية الحكومية أو المصطفة في صفوف المعارضة، عن إشادتها الواسعة بمضامين الخطاب الملكي الذي وجهه الملك محمد السادس إلى الأمة بمناسبة الذكرى السادسة والعشرين لتربعه على العرش. الخطاب، الذي حمل رسائل استراتيجية على المستويين الداخلي والخارجي، اعتبرته القوى الحزبية خارطة طريق واضحة لتطوير السياسات العمومية، وتعزيز', 'size': 3}], 'main_title': 'خطاب العرش 2025: الملك يرسم معالم مرحلة جديدة بين التنمية والعدالة المجالية والانفتاح السياسي'}, {'community_id': '11', 'articles': [{'id': '356', 'title': 'لفائدة الشعب الفلسطيني.. جلالة الملك يعطي تعليماته السامية من أجل إرسال مساعدة إنسانية وطبية عاجلة', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%84%d9%81%d8%a7%d8%a6%d8%af%d8%a9-%d8%a7%d9%84%d8%b4%d8%b9%d8%a8-%d8%a7%d9%84%d9%81%d9%84%d8%b3%d8%b7%d9%8a%d9%86%d9%8a-%d8%ac%d9%84%d8%a7%d9%84%d8%a9-%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%8a%d8%b9/', 'summary': 'لفائدة الشعب الفلسطيني.. جلالة الملك يعطي تعليماته السامية من أجل إرسال مساعدة إنسانية وطبية عاجلة. أفاد بلاغ لوزارة الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج، اليوم الأربعاء (30 يوليوز)، بأن صاحب الجلالة الملك محمد السادس، رئيس لجنة القدس، أعطى تعليماته السامية من أجل إرسال مساعدة إنسانية وطبية عاجلة لفائدة الشعب الفلسطيني الشقيق، وخاصة ساكنة قطاع غزة. وتتكون هذه المساعدة، التي يبلغ حجمها الإجمالي نحو 180 طنا، من مواد غذائية أساسية،', 'size': 5}, {'id': '369', 'title': 'الملك يأمر بإرسال مساعدة إنسانية وطبية عاجلة لفائدة الشعب الفلسطيني', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/319816/', 'summary': 'الملك يأمر بإرسال مساعدة إنسانية وطبية عاجلة لفائدة الشعب الفلسطيني. أفاد بلاغ لوزارة الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج، اليوم الأربعاء، بأن صاحب الجلالة الملك محمد السادس، نصره الله، رئيس لجنة القدس، أعطى تعليماته السامية من أجل إرسال مساعدة إنسانية وطبية عاجلة لفائدة الشعب الفلسطيني الشقيق، وخاصة ساكنة قطاع غزة. وتتكون هذه المساعدة، التي يبلغ حجمها الإجمالي نحو 180 طنا، من مواد غذائية أساسية،', 'size': 5}, {'id': '401', 'title': 'تعليمات ملكية لإرسال 180 طنا من المساعدات إلى غزة', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%aa%d8%b9%d9%84%d9%8a%d9%85%d8%a7%d8%aa-%d9%85%d9%84%d9%83%d9%8a%d8%a9-%d9%84%d8%a5%d8%b1%d8%b3%d8%a7%d9%84-180-%d8%b7%d9%86%d8%a7-%d9%85%d9%86-%d8%a7%d9%84%d8%b3%d8%a7%d8%b9%d8%af%d8%a7%d8%aa/', 'summary': 'تعليمات ملكية لإرسال 180 طنا من المساعدات إلى غزة. أعطى الملك محمد السادس، رئيس لجنة القدس، تعليماته السامية من أجل إرسال مساعدة إنسانية وطبية عاجلة لفائدة الشعب الفلسطيني الشقيق، وخاصة ساكنة قطاع غزة. تتكون هذه المساعدة، التي يبلغ حجمها الإجمالي نحو 180 طنا، من مواد غذائية أساسية، ومن الحليب ومواد موجهة بالخصوص للأطفال، وكذا أدوية ومعدات جراحية لفائدة السكان الأكثر هشاشة. كما  تعليمات ملكية لإرسال 180 طنا من المساعدات إلى غزة     .', 'size': 5}, {'id': '413', 'title': 'الملك يعطي تعليماته لإرسال مساعدة إنسانية وطبية عاجلة لفائدة الشعب الفلسطيني', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/471118.html', 'summary': 'الملك يعطي تعليماته لإرسال مساعدة إنسانية وطبية عاجلة لفائدة الشعب الفلسطيني. أفاد بلاغ لوزارة الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج، اليوم الأربعاء، بأن الملك محمد السادس، رئيس لجنة القدس، أعطى تعليماته السامية من أجل إرسال مساعدة إنسانية وطبية عاجلة لفائدة الشعب الفلسطيني الشقيق، وخاصة ساكنة قطاع غزة. وتتكون هذه المساعدة، التي يبلغ حجمها الإجمالي نحو 180 طنا، من مواد غذائية أساسية، ومن الحليب ومواد موجهة …', 'size': 5}, {'id': '423', 'title': 'الملك يعطي تعليماته من أجل إرسال مساعدة إنسانية وطبية عاجلة لفائدة غزة', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%8a%d8%b9%d8%b7%d9%8a-%d8%aa%d8%b9%d9%84%d9%8a%d9%85%d8%a7%d8%aa%d9%87-%d9%85%d9%86-%d8%a3%d8%ac%d9%84-%d8%a5%d8%b1%d8%b3%d8%a7%d9%84-%d9%85%d8%b3%d8%a7%d8%b9%d8%af/', 'summary': 'الملك يعطي تعليماته من أجل إرسال مساعدة إنسانية وطبية عاجلة لفائدة غزة. في بلاغ لوزارة الشؤون الخارجية أعطى الملك محمد السادس، رئيس لجنة القدس، تعليماته السامية من أجل إرسال مساعدة إنسانية وطبية عاجلة لفائدة الشعب  الملك يعطي تعليماته من أجل إرسال مساعدة إنسانية وطبية عاجلة لفائدة غزة     .', 'size': 5}], 'main_title': 'لفائدة الشعب الفلسطيني.. جلالة الملك يعطي تعليماته السامية من أجل إرسال مساعدة إنسانية وطبية عاجلة'}, {'community_id': '12', 'articles': [{'id': '371', 'title': 'بعد سنوات من التهميش.. حكم قضائي إسباني ينصف المئات من العاملات المغربيات', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/319806/', 'summary': 'بعد سنوات من التهميش.. حكم قضائي إسباني ينصف المئات من العاملات المغربيات. أصدرت المحكمة العليا للعدل في إقليم الأندلس حكما قضائيا يُنصف عشرات العاملات المغربيات اللواتي وجدن أنفسهن عالقات داخل مدينة سبتة المحتلة، عقب إغلاق الحدود بين المغرب وإسبانيا في سياق تدابير الطوارئ الصحية التي فرضتها جائحة كوفيد-19. ويأتي هذا الحكم، وفقًا لما تناقلته الصحافة الإسبانية، ليعترف بحق هؤلاء النساء في تسوية أوضاعهن القانونية والإدارية، عبر مسطرة', 'size': 2}, {'id': '404', 'title': 'حكم قضائي إسباني يُنصف العاملات المغربيات العالقات في سبتة بسبب الجائحة', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%ad%d9%83%d9%85-%d9%82%d8%b6%d8%a7%d8%a6%d9%8a-%d8%a5%d8%b3%d8%a8%d8%a7%d9%86%d9%8a-%d9%8a%d9%8f%d9%86%d8%b5%d9%81-%d8%a7%d9%84%d8%b9%d8%a7%d9%85%d9%84%d8%a7%d8%aa-%d8%a7%d9%84%d9%85%d8%ba%d8%b1/', 'summary': 'حكم قضائي إسباني يُنصف العاملات المغربيات العالقات في سبتة بسبب الجائحة. انتصار قانوني جديد لصالح النساء المغربيات العاملات بصفة عابرة للحدود ، بعد أن أصدرت محكمة العدل العليا في إقليم الأندلس حكمًا يخول لهن تسوية أوضاعهن القانونية عبر مسطرة "الاندماج المهني" (arraigo laboral)، بعد معاناة دامت سنوات بسبب تداعيات إغلاق الحدود خلال جائحة كوفيد-19. واحتفت جمعية الدفاع عن حقوق الإنسان بالأندلس (APDHA) بهذا الحكم، معتبرة إياه  حكم قضائي إسباني يُنصف العاملات المغربيات العالقات في سبتة بسبب الجائحة     .', 'size': 2}], 'main_title': 'بعد سنوات من التهميش.. حكم قضائي إسباني ينصف المئات من العاملات المغربيات'}, {'community_id': '0', 'articles': [{'id': '375', 'title': 'دبلوماسيون: المغرب بقيادة الملك محمد السادس بات نموذجا للتنمية والاستقرار', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/319791/', 'summary': 'دبلوماسيون: المغرب بقيادة الملك محمد السادس بات نموذجا للتنمية والاستقرار. أكد عدد من الدبلوماسيين الأجانب المعتمدين بالرباط، اليوم الأربعاء، أن المملكة المغربية حققت، بقيادة صاحب الجلالة الملك محمد السادس، إنجازات هامة في مختلف المجالات جعلت منها نموذجا للتنمية متعددة الأبعاد. وعبر هؤلاء الدبلوماسيون، في تصريحات للصحافة، على هامش حفل الاستقبال الذي ترأسه جلالة الملك بمناسبة عيد العرش، عن أحر تهانئهم وأصدق متمنياتهم لجلالة الملك، مؤكدين', 'size': 2}, {'id': '445', 'title': 'دبلوماسيون: المغرب نموذج للتنمية متعددة الأبعاد تحت قيادة الملك محمد السادس', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%af%d8%a8%d9%84%d9%88%d9%85%d8%a7%d8%b3%d9%8a%d9%88%d9%86-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d9%86%d9%85%d9%88%d8%b0%d8%ac-%d9%84%d9%84%d8%aa%d9%86%d9%85%d9%8a%d8%a9-%d9%85%d8%aa%d8%b9%d8%af/', 'summary': 'دبلوماسيون: المغرب نموذج للتنمية متعددة الأبعاد تحت قيادة الملك محمد السادس. شدّد عدد من الدبلوماسيين الأجانب المعتمدين بالرباط، اليوم الأربعاء، أن المملكة المغربية حققت، بقيادة الملك محمد السادس، إنجازات هامة في مختلف المجالات جعلت منها نموذجا للتنمية متعددة الأبعاد. وفي هذا الصدد، أعرب هؤلاء الدبلوماسيون، في تصريحات للصحافة، على هامش حفل الاستقبال الذي ترأسه الملك محمد السادس بمناسبة عيد العرش، عن أحر تهانئهم وأصدق …  دبلوماسيون: المغرب نموذج للتنمية متعددة الأبعاد تحت قيادة الملك محمد السادس     .', 'size': 2}], 'main_title': 'دبلوماسيون: المغرب بقيادة الملك محمد السادس بات نموذجا للتنمية والاستقرار'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    