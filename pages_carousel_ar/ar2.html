<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 19/08/2025 - 18h28</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '19', 'title': 'السياقة الاستعراضية تجر ثلاثينيا للاعتقال بالقنيطرة', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-650494.html', 'summary': 'السياقة الاستعراضية تجر ثلاثينيا للاعتقال بالقنيطرة. هبة بريس تمكنت عناصر الشرطة بولاية أمن القنيطرة، زوال أمس الاثنين، من توقيف شخص يبلغ من العمر 34 سنة، وذلك للاشتباه في تورطه في السياقة بطريقة استعراضية بالشارع العام وتعريض أمن المواطنين وسلامة مستعملي الطريق للخطر. وكان المشتبه فيه قد تورط في قيادة سيارات بسرعة مفرطة وبطريقة استعراضية وخطيرة بالشارع العام وبداخل محطة لبيع المحروقات، علاوة على استعمال هذه السيارات لخوض سباقات خطيرة، وهي الأفعال الإجرامية التي شكلت موضوع شرائط فيديو منشورة على صفحات مواقع التواصل الاجتماعي. وقد أسفرت الأبحاث والتحريات المنجزة في هذه القضية عن تحديد هوية المشتبه فيه وتوقيفه بمدينة القنيطرة، فضلا عن ضبط سيارتين يشتبه في استعمالهما في ارتكاب هذه الأفعال الإجرامية. وقد تم إخضاع المشتبه فيه للبحث القضائي الذي تشرف عليه النيابة العامة المختصة، وذلك للكشف عن جميع ظروف وملابسات هذه القضية، وكذا تحديد الخلفيات الحقيقية وراء ارتكاب هذه الأفعال الإجرامية.', 'size': 2}, {'id': '95', 'title': 'فيديو سياقة استعراضية خطيرة داخل محطة محروقات والشارع العام يطيح بشاب ثلاثيني بالقنيطرة', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/411284.html', 'summary': 'فيديو سياقة استعراضية خطيرة داخل محطة محروقات والشارع العام يطيح بشاب ثلاثيني بالقنيطرة. تمكنت عناصر الشرطة بولاية أمن القنيطرة، زوال يوم الاثنين 18 غشت الجاري، من توقيف شخص يبلغ من العمر 34 سنة، وذلك للاشتباه في تورطه في', 'size': 4}, {'id': '137', 'title': 'توقيف ثلاثيني بسبب السياقة الاستعراضية بالقنيطرة', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/321311/', 'summary': 'توقيف ثلاثيني بسبب السياقة الاستعراضية بالقنيطرة. تمكنت عناصر الشرطة بولاية أمن القنيطرة، زوال يوم الاثنين 18 غشت الجاري، من توقيف شخص يبلغ من العمر 34 سنة، وذلك للاشتباه في تورطه في السياقة بطريقة استعراضية بالشارع العام وتعريض أمن المواطنين وسلامة مستعملي الطريق للخطر. وكان المشتبه فيه قد تورط في قيادة سيارات بسرعة مفرطة وبطريقة استعراضية وخطيرة بالشارع العام وبداخل محطة', 'size': 5}, {'id': '166', 'title': 'بعد تداول فيديو.. السياقة الاستعراضية تقود شابا بالقنيطرة إلى الاعتقال', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a8%d8%b9%d8%af-%d8%aa%d8%af%d8%a7%d9%88%d9%84-%d9%81%d9%8a%d8%af%d9%8a%d9%88-%d8%a7%d9%84%d8%b3%d9%8a%d8%a7%d9%82%d8%a9-%d8%a7%d9%84%d8%a7%d8%b3%d8%aa%d8%b9%d8%b1%d8%a7%d8%b6%d9%8a%d8%a9-%d8%aa/', 'summary': 'بعد تداول فيديو.. السياقة الاستعراضية تقود شابا بالقنيطرة إلى الاعتقال. أفاد مصدر أمني أن "عناصر الشرطة بولاية أمن القنيطرة تمكنت، زوال يوم الاثنين 18 غشت الجاري، من توقيف شخص يبلغ من العمر 34 سنة، للاشتباه في تورطه في السياقة بطريقة استعراضية في الشارع العام وتعريض أمن المواطنين وسلامة مستعملي الطريق للخطر". وأضاف المصدر ذاته أن المشتبه فيه كان قد تورط في قيادة سيارات بسرعة مفرطة  بعد تداول فيديو.. السياقة الاستعراضية تقود شابا بالقنيطرة إلى الاعتقال     .', 'size': 4}, {'id': '233', 'title': 'توقيف شخص بالقنيطرة للاشتباه في تورطه في السياقة بطريقة استعراضية بالشارع العام', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%aa%d9%88%d9%82%d9%8a%d9%81-%d8%b4%d8%ae%d8%b5-%d8%a8%d8%a7%d9%84%d9%82%d9%86%d9%8a%d8%b7%d8%b1%d8%a9-%d9%84%d9%84%d8%a7%d8%b4%d8%aa%d8%a8%d8%a7%d9%87-%d9%81%d9%8a-%d8%aa%d9%88%d8%b1%d8%b7%d9%87/', 'summary': 'توقيف شخص بالقنيطرة للاشتباه في تورطه في السياقة بطريقة استعراضية بالشارع العام. تمكنت عناصر الشرطة بولاية أمن القنيطرة، أمس الاثنين، من توقيف شخص يبلغ من العمر 34 سنة، وذلك للاشتباه في تورطه في السياقة بطريقة استعراضية بالشارع العام وتعريض أمن المواطنين وسلامة مستعملي الطريق للخطر. وكشفت مصادر أمنية، أن المشتبه فيه كان قد تورط في قيادة سيارات بسرعة مفرطة وبطريقة استعراضية وخطيرة بالشارع العام وبداخل …  توقيف شخص بالقنيطرة للاشتباه في تورطه في السياقة بطريقة استعراضية بالشارع العام     .', 'size': 4}], 'main_title': 'توقيف ثلاثيني بسبب السياقة الاستعراضية بالقنيطرة'}, {'community_id': '1', 'articles': [{'id': '26', 'title': 'الملك محمد السادس يوجه مساعدات إنسانية إضافية عاجلة لسكان غزة', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-650472.html', 'summary': 'الملك محمد السادس يوجه مساعدات إنسانية إضافية عاجلة لسكان غزة. أصدر الملك محمد السادس ، رئيس لجنة القدس، تعليماته السامية اليوم الإثنين 18 غشت، بإرسال مساعدات إنسانية إضافية لفائدة سكان قطاع غزة، تجسيدًا للدعم الدائم والتضامن المستمر مع الشعب الفلسطيني الشقيق. وأوضح بلاغ لوزارة الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج أن هذه المساعدات تشمل حوالي 100 طن من المواد الغذائية والأدوية، موجهة بشكل خاص للفئات الهشة، لا سيما الأطفال والرضع. وأشار البلاغ إلى حرص الملك على أن تصل هذه المساعدات الإنسانية جواً عبر الطائرات، لتصل بسرعة وبشكل مباشر إلى المستفيدين من أبناء الشعب الفلسطيني، كما جرت العادة في المساعدات السابقة. وأكد المصدر أن هذه المبادرة الملكية تعكس انشغال جلالة الملك بالوضع الإنساني الحرج في غزة، وانخراطه الثابت في التخفيف من معاناة السكان، وتقديم الدعم العاجل لهم في ظل الظروف الإنسانية الصعبة التي يعيشونها.', 'size': 4}, {'id': '62', 'title': 'الملك محمد السادس يرسل مساعدات للشعب الفلسطيني', 'source': 'www.alakhbar.press.ma', 'link': 'https://www.alakhbar.press.ma/%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7%d8%af%d8%b3-%d9%8a%d8%b1%d8%b3%d9%84-%d9%85%d8%b3%d8%a7%d8%b9%d8%af%d8%a7%d8%aa-%d9%84%d9%84%d8%b4%d8%b9%d8%a8-%d8%a7-271399.html', 'summary': 'الملك محمد السادس يرسل مساعدات للشعب الفلسطيني. الأخبار أفاد بلاغ لوزارة الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج، أول أمس الاثنين، بأنه تجسيدا للدعم الدائم والتضامن الملموس للملك محمد السادس، رئيس لجنة القدس، مع الشعب الفلسطيني الشقيق، أصدر الملك تعليماته السامية بإرسال مساعدات إنسانية إضافية لفائدة ساكنة غزة. وأوضح البلاغ أن هذه المساعدات تشمل حوالي 100 طن من المواد الغذائية والأدوية …  الملك محمد السادس يرسل مساعدات للشعب الفلسطيني     .', 'size': 5}, {'id': '133', 'title': 'وصول المساعدات الإنسانية الإضافية التي أمر بها الملك لساكنة غزة', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/321323/', 'summary': 'وصول المساعدات الإنسانية الإضافية التي أمر بها الملك لساكنة غزة. أفاد بلاغ لوزارة الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج، بأنه تجسيدا للدعم الدائم والتضامن الملموس للملك محمد السادس، رئيس لجنة القدس، مع الشعب الفلسطيني الشقيق، أصدر جلالته، تعليماته السامية بإرسال مساعدات إنسانية إضافية لفائدة ساكنة غزة. وأوضح البلاغ أن هذه المساعدات تشمل حوالي 100 طن من المواد الغذائية والأدوية الموجهة بصفة خاصة للفئات الهشة،', 'size': 5}, {'id': '190', 'title': 'الملك محمد السادس يصدر تعليماته بإرسال مساعدات إنسانية إضافية لساكنة غزة', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/473062.html', 'summary': 'الملك محمد السادس يصدر تعليماته بإرسال مساعدات إنسانية إضافية لساكنة غزة. و.م.ع أفاد بلاغ لوزارة الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج، اليوم الاثنين، بأنه تجسيدا للدعم الدائم والتضامن الملموس للملك محمد السادس، رئيس لجنة القدس، مع الشعب الفلسطيني الشقيق، أصدر جلالته، تعليماته السامية بإرسال مساعدات إنسانية إضافية لفائدة ساكنة غزة. وأوضح البلاغ أن هذه المساعدات تشمل حوالي 100 طن من المواد الغذائية والأدوية الموجهة بصفة …', 'size': 4}, {'id': '212', 'title': 'صاحب الجلالة، رئيس لجنة القدس، يأمر بإرسال مساعدات إضافية لساكنة غزة', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/226063/', 'summary': 'صاحب الجلالة، رئيس لجنة القدس، يأمر بإرسال مساعدات إضافية لساكنة غزة. أفاد بلاغ لوزارة الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج، اليوم الاثنين، بأنه تجسيدا للدعم الدائم والتضامن الملموس لصاحب الجلالة الملك محمد السادس، نصره الله، رئيس لجنة القدس، مع الشعب الفلسطيني الشقيق، أصدر جلالته، حفظه الله، تعليماته السامية بإرسال مساعدات إنسانية إضافية لفائدة ساكنة غزة. وأوضح البلاغ أن هذه المساعدات تشمل حوالي 100 طن من', 'size': 5}], 'main_title': 'الملك محمد السادس يرسل مساعدات للشعب الفلسطيني'}, {'community_id': '2', 'articles': [{'id': '83', 'title': 'الشرطة الإسبانية توقف عنصرين موالين لـ"داعش" بالتعاون مع المديرية العامة لمراقبة التراب الوطني', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/411272.html', 'summary': 'الشرطة الإسبانية توقف عنصرين موالين لـ"داعش" بالتعاون مع المديرية العامة لمراقبة التراب الوطني. أعلنت الشرطة الوطنية الإسبانية، اليوم الاثنين، عن توقيف شخصين يشتبه في انتمائهما للتنظيم الإرهابي "داعش"، خلال عملية نفذت بإقليم كتالونيا، وذلك بالتعاون مع المديرية العامة', 'size': 2}, {'id': '157', 'title': 'معلومات استخباراتية مغربية تقود إسبانيا لاعتقال مواليين لـ”داعش” في كتالونيا', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1093597.html', 'summary': 'معلومات استخباراتية مغربية تقود إسبانيا لاعتقال مواليين لـ”داعش” في كتالونيا. أعلنت الشرطة الوطنية الإسبانية، اليوم الاثنين ظهرت المقالة معلومات استخباراتية مغربية تقود إسبانيا لاعتقال مواليين لـ”داعش” في كتالونيا  .', 'size': 2}, {'id': '210', 'title': 'إسبانيا توقف عنصرين موالين لـ”داعش” بالتعاون مع المديرية العامة لمراقبة التراب الوطني', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%a5%d8%b3%d8%a8%d8%a7%d9%86%d9%8a%d8%a7-%d8%aa%d9%88%d9%82%d9%81-%d8%b9%d9%86%d8%b5%d8%b1%d9%8a%d9%86-%d9%85%d9%88%d8%a7%d9%84%d9%8a%d9%86-%d9%84%d9%80%d8%af%d8%a7%d8%b9%d8%b4/', 'summary': 'إسبانيا توقف عنصرين موالين لـ”داعش” بالتعاون مع المديرية العامة لمراقبة التراب الوطني. أعلنت الشرطة الوطنية الإسبانية، اليوم الاثنين، عن توقيف شخصين يشتبه في انتمائهما للتنظيم الإرهابي “داعش”، خلال عملية نفذت بإقليم كتالونيا،  إسبانيا توقف عنصرين موالين لـ”داعش” بالتعاون مع المديرية العامة لمراقبة التراب الوطني     .', 'size': 3}], 'main_title': 'إسبانيا توقف عنصرين موالين لـ”داعش” بالتعاون مع المديرية العامة لمراقبة التراب الوطني'}, {'community_id': '3', 'articles': [{'id': '117', 'title': 'موجات حر متتالية.. لهيب الصيف يهدد الواحات', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%85%d9%88%d8%ac%d8%a7%d8%aa-%d8%ad%d8%b1-%d9%85%d8%aa%d8%aa%d8%a7%d9%84%d9%8a%d8%a9-%d9%84%d9%87%d9%8a%d8%a8-%d8%a7%d9%84%d8%b5%d9%8a%d9%81-%d9%8a%d9%87%d8%af%d8%af-%d8%a7%d9%84%d9%88%d8%a7%d8%ad/', 'summary': 'موجات حر متتالية.. لهيب الصيف يهدد الواحات. تشهد واحات المغرب، خاصة في الجنوب والجنوب الشرقي، تحديات غير مسبوقة بفعل التغيرات المناخية وارتفاع درجات الحرارة. وتشكل هذه الفضاءات رئة بيئية وموطنا للتنوع البيولوجي ومصدرا للرزق بالنسبة لآلاف الأسر، غير أنها اليوم أصبحت مهددة بالجفاف ونقص المياه. ومع توالي سنوات الجفاف وارتفاع درجات الحرارة إلى مستويات قياسية تتراجع الموارد المائية، وتجف العيون والآبار التي', 'size': 2}, {'id': '338', 'title': 'التنمر الرقمي يثير المخاوف.. وباء صامت يهدد المغاربة وسط غياب ردع قانوني', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1093655.html', 'summary': 'التنمر الرقمي يثير المخاوف.. وباء صامت يهدد المغاربة وسط غياب ردع قانوني. شهدت مواقع التواصل الاجتماعي في المغرب في السنوات الأخيرة انتشارا متزايدا لظاهرة التنمر الإلكتروني، التي تحولت من حالات معزولة إلى ظاهرة متنامية، حيث تستعمل الصور والتعليقات والفيديوهات كسلاح للإيذاء النفسي والاجتماعي. ويثير هذا السلوك الإلكتروني الذي بات يقابل في كثير من الأحيان بالتطبيع أو الصمت، مخاوف حقيقية من انعكاساته على الضحايا، خصوصا النساء والفتيات اللواتي ظهرت المقالة التنمر الرقمي يثير المخاوف.. وباء صامت يهدد المغاربة وسط غياب ردع قانوني  .', 'size': 2}], 'main_title': 'موجات حر متتالية.. لهيب الصيف يهدد الواحات'}, {'community_id': '4', 'articles': [{'id': '135', 'title': 'القنيطرة على خريطة صناعة السيارات العالمية: ميلاد “Mafaco Tesca Textile”', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/321319/', 'summary': 'القنيطرة على خريطة صناعة السيارات العالمية: ميلاد “Mafaco Teca Textile”. خطا قطاع النسيج الموجه لصناعة السيارات في المغرب خطوة جديدة نحو تعزيز موقعه العالمي، بعد موافقة مجلس المنافسة على إحداث منشأة صناعية مشتركة بين الشركة المغربية Fabricati de Cotnière Marocaine SA والمجموعة الفرنسية Teca Group Covering Material SAS، تحت اسم “Mafaco Teca Textile SA”. المنشأة الجديدة ستقام بالحي الصناعي بمدينة القنيطرة، وستتخصص في إنتاج', 'size': 2}, {'id': '152', 'title': 'مجلس المنافسة يوافق على إحداث منشأة مشتركة مغربية-فرنسية بقطاع صناعة السيارات', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1093470.html', 'summary': 'مجلس المنافسة يوافق على إحداث منشأة مشتركة مغربية-فرنسية بقطاع صناعة السيارات. وافق مجلس المنافسة المغربي على إحداث منشأة مشتركة جديدة تحمل اسم “Mafaco Teca Textile SA”. وتأتي هذه المنشأة نتيجة اتفاق بين شركتين رائدتين في قطاع النسيج المخصص لصناعة السيارات، وهما الشركة المغربية “Fabricati de Cotnière Marocaine SA” والشركة الفرنسية “Teca Group Covering Material SAS”. ويأتي هذا القرار المنشور بالعدد الأخير للجريدة الرسمية، بعد دراسة دقيقة ظهرت المقالة مجلس المنافسة يوافق على إحداث منشأة مشتركة مغربية-فرنسية بقطاع صناعة السيارات  .', 'size': 2}], 'main_title': 'القنيطرة على خريطة صناعة السيارات العالمية: ميلاد “Mafaco Tesca Textile”'}, {'community_id': '5', 'articles': [{'id': '139', 'title': 'توقيف سيدة وابنتها بمطار محمد الخامس بتهمة النصب', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/321309/', 'summary': 'توقيف سيدة وابنتها بمطار محمد الخامس بتهمة النصب. تمكنت عناصر الأمن الوطني بمطار محمد الخامس الدولي بمدينة الدار البيضاء، يوم الأحد 17 غشت الجاري، من توقيف سيدة وابنتها للاشتباه في ارتباطهما بشبكة إجرامية تنشط في النصب والاحتيال. وقد جرى توقيف المشتبه فيهما مباشرة بعد وصولهما على متن رحلة جوية قادمة من إحدى دول جنوب آسيا، وذلك لكونهما تشكلان موضوع مذكرات بحث على', 'size': 5}, {'id': '167', 'title': 'توقيف سيدة وابنتها بتهمة النصب بعروض وهمية على منصات التواصل', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%aa%d9%88%d9%82%d9%8a%d9%81-%d8%b3%d9%8a%d8%af%d8%a9-%d9%88%d8%a7%d8%a8%d9%86%d8%aa%d9%87%d8%a7-%d8%a8%d8%aa%d9%87%d9%85%d8%a9-%d8%a7%d9%84%d9%86%d8%b5%d8%a8-%d8%a8%d8%b9%d8%b1%d9%88%d8%b6-%d9%88/', 'summary': 'توقيف سيدة وابنتها بتهمة النصب بعروض وهمية على منصات التواصل. أفاد مصدر أمني أن "عناصر الأمن الوطني بمطار محمد الخامس الدولي بمدينة الدار البيضاء، تمكنت، الأحد 17 غشت الجاري، من توقيف سيدة وابنتها للاشتباه في ارتباطهما بشبكة إجرامية تنشط في النصب والاحتيال. وحسب نفس المصدر، جرى توقيف المشتبه فيهما مباشرة بعد وصولهما على متن رحلة جوية قادمة من إحدى دول جنوب آسيا، لكونهما تشكلان موضوع  توقيف سيدة وابنتها بتهمة النصب بعروض وهمية على منصات التواصل     .', 'size': 4}, {'id': '235', 'title': 'توقيف سيدة وابنتها بمطار محمد الخامس للاشتباه في ارتباطهما بشبكة إجرامية تنشط في النصب والاحتيال', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%aa%d9%88%d9%82%d9%8a%d9%81-%d8%b3%d9%8a%d8%af%d8%a9-%d9%88%d8%a7%d8%a8%d9%86%d8%aa%d9%87%d8%a7-%d8%a8%d9%85%d8%b7%d8%a7%d8%b1-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%ae%d8%a7%d9%85%d8%b3-%d9%84/', 'summary': 'توقيف سيدة وابنتها بمطار محمد الخامس للاشتباه في ارتباطهما بشبكة إجرامية تنشط في النصب والاحتيال. تمكنت عناصر الأمن الوطني بمطار محمد الخامس الدولي بمدينة الدار البيضاء، يوم الأحد المنصرم، من توقيف سيدة وابنتها للاشتباه في ارتباطهما بشبكة إجرامية تنشط في النصب والاحتيال. وكشفت مصادر أمنية، أنه جرى توقيف المشتبه فيهما مباشرة بعد وصولهما على متن رحلة جوية قادمة من إحدى دول جنوب آسيا، وذلك لكونهما تشكلان موضوع مذكرات …  توقيف سيدة وابنتها بمطار محمد الخامس للاشتباه في ارتباطهما بشبكة إجرامية تنشط في النصب والاحتيال     .', 'size': 3}, {'id': '308', 'title': 'توقيف سيدة وابنتها بمطار محمد الخامس بعد تورطهما في عمليات نصب بالملايين', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/411309.html', 'summary': 'توقيف سيدة وابنتها بمطار محمد الخامس بعد تورطهما في عمليات نصب بالملايين. تمكنت عناصر الأمن الوطني بمطار محمد الخامس الدولي بمدينة الدار البيضاء، يوم الأحد 17 غشت الجاري، من توقيف سيدة وابنتها للاشتباه في ارتباطهما بشبكة إجرامية', 'size': 2}, {'id': '363', 'title': 'اعتقال يوتيوبر وابنتها بمطار محمد الخامس بتهم النصب والإحتيال', 'source': 'rue20.com', 'link': 'https://rue20.com/929741.html', 'summary': 'اعتقال يوتيوبر وابنتها بمطار محمد الخامس بتهم النصب والإحتيال.  ا الرباط تمكنت عناصر الأمن الوطني بمطار محمد الخامس الدولي بمدينة الدار البيضاء، من توقيف سيدة وابنتها للاشتباه في ارتباطهما بشبكة إجرامية تنشط في النصب والاحتيال. وقد جرى توقيف المشتبه فيهما مباشرة بعد وصولهما على متن رحلة جوية قادمة من إحدى دول جنوب آسيا يوم الأحد 17 غشت الجاري، وذلك لكونهما تشكلان موضوع الخبر اعتقال يوتيوبر وابنتها بمطار محمد الخامس بتهم النصب والإحتيال  .', 'size': 3}], 'main_title': 'توقيف سيدة وابنتها بمطار محمد الخامس بتهمة النصب'}, {'community_id': '6', 'articles': [{'id': '142', 'title': 'اليابان تؤكد مجددا عدم اعترافها بـ”البوليساريو” في مؤتمر “تيكاد”', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1093685.html', 'summary': 'اليابان تؤكد مجددا عدم اعترافها بـ”البوليساريو” في مؤتمر “تيكاد”. حرص وزير الشؤون الخارجية الياباني، تاكيشي إيوايا، اليوم الثلاثاء بيوكوهاما، مرة أخرى، خلال افتتاح الاجتماع الوزاري للدورة التاسعة للمؤتمر الدولي لطوكيو حول التنمية بإفريقيا (تيكاد-9)، على توضيح الموقف الرسمي الياباني المتعلق بالكيان الانفصالي. وقال إيوايا، أمام الوزراء الأفارقة وممثلي المنظمات الدولية المجتمعة بمناسبة المؤتمر “أود أن أؤكد أن حضور أي كيان لا تعترف به اليابان ظهرت المقالة اليابان تؤكد مجددا عدم اعترافها بـ”البوليساريو” في مؤتمر “تيكاد”  .', 'size': 2}, {'id': '394', 'title': 'وزير الخارجية الياباني: طوكيو لا تعترف بشيء اسمه البوليساريو', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/226097/', 'summary': 'وزير الخارجية الياباني: طوكيو لا تعترف بشيء اسمه البوليساريو. حرص وزير الشؤون الخارجية الياباني، تاكيشي إيوايا، اليوم الثلاثاء بيوكوهاما، مرة أخرى، خلال افتتاح الاجتماع الوزاري للدورة التاسعة للمؤتمر الدولي لطوكيو حول التنمية بإفريقيا (تيكاد-9)، على توضيح الموقف الرسمي الياباني المتعلق بالكيان الانفصالي. وقال السيد إيوايا، أمام الوزراء الأفارقة وممثلي المنظمات الدولية المجتمعة بمناسبة المؤتمر “أود أن أؤكد أن حضور أي كيان لا تعترف به', 'size': 2}], 'main_title': 'اليابان تؤكد مجددا عدم اعترافها بـ”البوليساريو” في مؤتمر “تيكاد”'}, {'community_id': '7', 'articles': [{'id': '143', 'title': 'الوكيل العام يعلن إيقاف مشتبه به باغتصاب قاصر بالجديدة والبحث عن باقي الجناة', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1093673.html', 'summary': 'الوكيل العام يعلن إيقاف مشتبه به باغتصاب قاصر بالجديدة والبحث عن باقي الجناة. أصدر الوكيل العام للملك لدى محكمة الاستئناف بالجديدة تعليماته بوضع شخص راشد تحت تدبير الحراسة النظرية، للاشتباه في ضلوعه في الاعتداء الجنسي الجماعي على طفل قاصر خلال موسم مولاي عبد الله أمغار. كما تم تحديد هويات مشتبه فيهم آخرين ما تزال الأبحاث جارية بخصوصهم. وفي السياق ذاته، فتحت النيابة العامة بحثا قضائيا موسعا حول واقعة ظهرت المقالة الوكيل العام يعلن إيقاف مشتبه به باغتصاب قاصر بالجديدة والبحث عن باقي الجناة  .', 'size': 2}, {'id': '173', 'title': 'النيابة العامة تحقق في اغتصاب طفل موسم مولاي عبد الله.. ماتقيش ولدي تستنكر وتدخل على الخط', 'source': 'rue20.com', 'link': 'https://rue20.com/929584.html', 'summary': 'النيابة العامة تحقق في اغتصاب طفل موسم مولاي عبد الله.. ماتقيش ولدي تستنكر وتدخل على الخط.  ا الرباط أصدر الوكيل العام للملك لدى محكمة الاستئناف بالجديدة تعليماته بوضع شخص راشد تحت تدبير الحراسة النظرية، للاشتباه في تورطه في قضية هتك عرض طفل قاصر بموسم مولاي عبدالله بالجديدة. كما جرى تحديد هويات مشتبه فيهم آخرين ما تزال الأبحاث متواصلة بشأنهم. وفي السياق نفسه، فتحت النيابة العامة بحثاً قضائياً بخصوص الحادث، الخبر النيابة العامة تحقق في اغتصاب طفل موسم مولاي عبد الله.. ماتقيش ولدي تستنكر وتدخل على الخط  .', 'size': 2}], 'main_title': 'الوكيل العام يعلن إيقاف مشتبه به باغتصاب قاصر بالجديدة والبحث عن باقي الجناة'}, {'community_id': '8', 'articles': [{'id': '226', 'title': 'غابة المعمورة بسلا الجديدة تقاوم الإهمال وعبث البشر', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%ba%d8%a7%d8%a8%d8%a9-%d8%a7%d9%84%d9%85%d8%b9%d9%85%d9%88%d8%b1%d8%a9-%d8%a8%d8%b3%d9%84%d8%a7-%d8%a7%d9%84%d8%ac%d8%af%d9%8a%d8%af%d8%a9-%d8%aa%d9%82%d8%a7%d9%88%d9%85-%d8%a7%d9%84%d8%a5%d9%87/', 'summary': 'غابة المعمورة بسلا الجديدة تقاوم الإهمال وعبث البشر. المساء اليوم – سلا: قالت الوكالة الوطنية للمياه والغابات إن تهيئة غابة المعمورة بسلا الجديدة تعد جزءا من دينامية وطنية طموحة تقوم على التجديد البيئي، وتوفير تجهيزات عصرية، وتعزيز الشراكات. وأوضحت الوكالة في بيان أن', 'size': 2}, {'id': '300', 'title': 'غابة سلا الجديدة بين الانتقادات وتوضيحات الوكالة الوطنية للمياه والغابات', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/205176', 'summary': 'غابة سلا الجديدة بين الانتقادات وتوضيحات الوكالة الوطنية للمياه والغابات.  سلا – لا يزال مشروع تأهيل غابة سلا الجديدة يثير نقاشاً واسعاً بين المهتمين بالشأن البيئي والسكاني، حيث انقسمت الآراء بين من يرى فيه فرصة لإعادة الاعتبار لهذا المجال الطبيعي، وبين من يعتبر أن التدخل لم يرقَ إلى مستوى انتظارات الساكنة والمهتمين. في مواجهة هذه الانتقادات، خرجت الوكالة الوطنية للمياه والغابات بتوضيحات رسمية، مؤكدة', 'size': 2}], 'main_title': 'غابة المعمورة بسلا الجديدة تقاوم الإهمال وعبث البشر'}, {'community_id': '9', 'articles': [{'id': '227', 'title': 'تمديد قابل للتجديد: الحر والشركي إلى غاية الأربعاء', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%aa%d9%85%d8%af%d9%8a%d8%af-%d9%82%d8%a7%d8%a8%d9%84-%d9%84%d9%84%d8%aa%d8%ac%d8%af%d9%8a%d8%af-%d8%a7%d9%84%d8%ad%d8%b1-%d9%88%d8%a7%d9%84%d8%b4%d8%b1%d9%83%d9%8a-%d8%a5%d9%84%d9%89-%d8%ba%d8%a7/', 'summary': 'تمديد قابل للتجديد: الحر والشركي إلى غاية الأربعاء. المساء اليوم: أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل موجة حر مع “الشركي” وزخات رعدية مصحوبة بتساقط للبرد وبهبات رياح من اليوم الاثنين إلى بعد غد الأربعاء، بعدد من مناطق المملكة. وأوضحت المديرية، في', 'size': 2}, {'id': '395', 'title': 'موجة “الشركي” مع زخات رعدية مصحوبة بالبرد وبهبات رياح من الاثنين إلى الأربعاء', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/226095/', 'summary': 'موجة “الشركي” مع زخات رعدية مصحوبة بالبرد وبهبات رياح من الاثنين إلى الأربعاء. أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل موجة حر مع “الشركي” وزخات رعدية مصحوبة بتساقط للبرد وبهبات رياح من اليوم الاثنين إلى بعد غد الأربعاء، بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة برتقالي، أنه من المرتقب تسجيل زخات رعدية مصحوبة بتساقط البرد وبهبات رياح اليوم الاثنين من الثالثة بعد', 'size': 2}], 'main_title': 'تمديد قابل للتجديد: الحر والشركي إلى غاية الأربعاء'}, {'community_id': '10', 'articles': [{'id': '324', 'title': 'درديخ : إرسال مساعدات إنسانية لساكنة غزة يعكس الالتزام الراسخ للملك تجاه القضية الفلسطينية', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/321353/', 'summary': 'درديخ : إرسال مساعدات إنسانية لساكنة غزة يعكس الالتزام الراسخ للملك تجاه القضية الفلسطينية. قالت مديرة التواصل بمؤسسة محمد الخامس للتضامن، سناء درديخ، إن إرسال مساعدات إنسانية إضافية لفائدة ساكنة غزة، يعكس مرة أخرى الالتزام الراسخ للملك محمد السادس، رئيس لجنة القدس، تجاه القضية الفلسطينية. وأبرزت درديخ، في تصريح للصحافة، أن تعبئة المملكة المغربية، بقيادة الملك محمد السادس، مستمرة لتقديم الدعم للشعب الفلسطيني، لا سيما السكان المدنيين في قطاع', 'size': 2}, {'id': '373', 'title': 'درديخ: إرسال مساعدات إنسانية إضافية لفائدة ساكنة غزة يعكس الالتزام الراسخ للملك تجاه القضية الفلسطينية', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/473139.html', 'summary': 'درديخ: إرسال مساعدات إنسانية إضافية لفائدة ساكنة غزة يعكس الالتزام الراسخ للملك تجاه القضية الفلسطينية. قالت مديرة التواصل بمؤسسة محمد الخامس للتضامن، سناء درديخ، إن إرسال مساعدات إنسانية إضافية لفائدة ساكنة غزة، يعكس مرة أخرى الالتزام الراسخ للملك محمد السادس، رئيس لجنة القدس، تجاه القضية الفلسطينية. وأبرزت درديخ، في تصريح للصحافة، أن تعبئة المملكة المغربية، بقيادة الملك محمد السادس، مستمرة لتقديم الدعم للشعب الفلسطيني، لا سيما السكان المدنيين في قطاع …', 'size': 2}], 'main_title': 'درديخ : إرسال مساعدات إنسانية لساكنة غزة يعكس الالتزام الراسخ للملك تجاه القضية الفلسطينية'}, {'community_id': '11', 'articles': [{'id': '327', 'title': 'الوكيل العام يكشف تفاصيل قضية “أسدون”', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/321345/', 'summary': 'الوكيل العام يكشف تفاصيل قضية “أسدون”. كشف الوكيل العام للملك لدى محكمة الاستئناف بالدار البيضاء عن تفاصيل ما تم تداوله بخصوص الحقوقي سيون شمعون حريم بروخ أسدون. وأصدر الوكيل العام للملك لدى محكمة الاستئناف بالدار البيضاء بلاغا يوضح للرأي العام ملابسات قضية “سيون شمعون حريم بروخ أسدون”، التي أثارت نقاشا واسعا على مواقع التواصل الاجتماعي خلال الأيام الأخيرة. ولفت الوكيل', 'size': 3}, {'id': '342', 'title': 'الوكيل العام يكشف تفاصيل العثور على “أسدون” مغمى عليه ويستبعد فرضية الاعتداء', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1093744.html', 'summary': 'الوكيل العام يكشف تفاصيل العثور على “أسدون” مغمى عليه ويستبعد فرضية الاعتداء. أصدر الوكيل العام للملك لدى محكمة الاستئناف بالدار البيضاء، اليوم الثلاثاء، بلاغا يوضح فيه تفاصيل قضية “سيون شمعون حريم بروخ أسدون”، التي أثارت اهتماما على وسائط التواصل الاجتماعي، مؤكدا أن الأبحاث لا تزال جارية لتحديد كافة ملابسات الواقعة. ووفقا للبلاغ، فقد انطلقت القضية بتاريخ 11 غشت 2025، حين تقدم شخصان ببلاغ للشرطة حول تغيب مشغلهما ظهرت المقالة الوكيل العام يكشف تفاصيل العثور على “أسدون” مغمى عليه ويستبعد فرضية الاعتداء  .', 'size': 3}, {'id': '368', 'title': 'الوكيل العام للملك يكشف ملابسات العثور على سيون أسدون مغمى عليه داخل منزله', 'source': 'machahid24.com', 'link': 'https://machahid24.com/home/473144.html', 'summary': 'الوكيل العام للملك يكشف ملابسات العثور على سيون أسدون مغمى عليه داخل منزله. أفاد الوكيل العام للملك لدى محكمة الاستئناف بالدار البيضاء، اليوم الثلاثاء، بأن الأبحاث بخصوص قضية سيون شمعون حريم بروخ أسدون لا تزال جارية وسيتم ترتيب الآثار القانونية المناسبة فور انتهائها. وأوضح بلاغ للوكيل العام للملك لدى محكمة الاستئناف بالدار البيضاء أنه علاقة بما يتم تداوله عبر بعض وسائط التواصل الاجتماعي بخصوص “قضية سيون شمعون حريم …', 'size': 2}, {'id': '392', 'title': 'عاجل.. بلاغ الوكيل العام للملك حول قضية “سيون شمعون حريم بروخ أسدون”', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/226101/', 'summary': 'عاجل.. بلاغ الوكيل العام للملك حول قضية “سيون شمعون حريم بروخ أسدون”. علاقة بما يتم تداوله عبر بعض وسائط التواصل الاجتماعي بخصوص قضية السيد “سيون شمعون حريم بروخ أسدون”، وتنويراً للرأي العام حول هذه الواقعة، يعلن الوكيل العام للملك لدى محكمة الاستئناف بالدار البيضاء ما يلي: – بتاريخ 11 غشت 2025، تقدم شخصان أمام مصالح الشرطة وأفادا بأن مشغلهما تغيب عن العمل وانقطع الاتصال به هاتفياً.', 'size': 2}], 'main_title': 'الوكيل العام يكشف تفاصيل قضية “أسدون”'}, {'community_id': '12', 'articles': [{'id': '343', 'title': 'الرجاء الرياضي يطوي صفحة النزاعات.. 31 مليون درهم تعيد “النسور” إلى الواجهة', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1093637.html', 'summary': 'الرجاء الرياضي يطوي صفحة النزاعات.. 31 مليون درهم تعيد “النسور” إلى الواجهة. أعلن نادي الرجاء الرياضي تسوية جميع النزاعات المحلية والدولية التي كانت وراء قرارات المنع من تسجيل اللاعبين، والتي أثرت بشكل واضح على وضعية ومسار الفريق خلال المواسم الماضية. وأكد نادي العاصمة الاقتصادية في بلاغ رسمي أن إنهاء جميع الملفات المتعلقة بالنزاعات الوطنية والدولية، قد تم بفضل تعبئة منسقة والدعم الهيكلي المقدم من المستثمر المؤسساتي Port4Impact، ظهرت المقالة الرجاء الرياضي يطوي صفحة النزاعات.. 31 مليون درهم تعيد “النسور” إلى الواجهة  .', 'size': 2}, {'id': '391', 'title': 'الرجاء يعلن تسوية نزاعات بقيمة 31 مليون درهم ويرفع عقوبة المنع', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/226104/', 'summary': 'الرجاء يعلن تسوية نزاعات بقيمة 31 مليون درهم ويرفع عقوبة المنع. أعلن نادي الرجاء الرياضي أنه تمكن، من تسوية جميع النزاعات المحلية والدولية التي كانت وراء قرارات المنع من تسجيل اللاعبين. وأفاد النادي، في بلاغ ، الاثنين 18 غشت 2025، أن هذه الخطوة قد تحققت بفضل تعبئة منسقة والدعم الهيكلي المقدم من المستثمر المؤسساتي Port4Impact، مؤكدا أنها تفتح الباب أمام تسجيل الوافدين الجدد استعدادا لموسم 2025-2026،', 'size': 2}], 'main_title': 'الرجاء الرياضي يطوي صفحة النزاعات.. 31 مليون درهم تعيد “النسور” إلى الواجهة'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    