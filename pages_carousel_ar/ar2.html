<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 28/08/2025 - 06h13</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '5', 'articles': [{'id': '3', 'title': 'أطفال القدس يثمنون الدعم الملكي', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d8%a3%d8%b7%d9%81%d8%a7%d9%84-%d8%a7%d9%84%d9%82%d8%af%d8%b3-%d9%8a%d8%ab%d9%85%d9%86%d9%88%d9%86-%d8%a7%d9%84%d8%af%d8%b9%d9%85-%d8%a7%d9%84%d9%85%d9%84%d9%83%d9%8a-1615146.html', 'summary': 'أطفال القدس يثمنون الدعم الملكي. وصل أطفال القدس المشاركون في الدورة السادسة عشرة للمخيم الصيفي في المغرب مع مؤطريهم، فجر اليوم الأربعاء إلى مدينة القدس، بعد قضائهم أسبوعين في مخيمهم الصيفي “حارة المغاربة” الذي نظم تحت الرعاية السامية للملك محمد السادس، رئيس لجنة القدس. وعبّر أطفال القدس، لدى وصولهم إلى مكان تجمع العائلات في حي الشيخ جراح في القدس حيث  أطفال القدس يثمنون الدعم الملكي     - هسبريس جريدة إلكترونية مغربية .', 'size': 2}, {'id': '322', 'title': 'بعد أسبوعين في مخيمهم الصيفي بالمغرب.. أطفال القدس يعودون إلى ديارهم', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a8%d8%b9%d8%af-%d8%a3%d8%b3%d8%a8%d9%88%d8%b9%d9%8a%d9%86-%d9%81%d9%8a-%d9%85%d8%ae%d9%8a%d9%85%d9%87%d9%85-%d8%a7%d9%84%d8%b5%d9%8a%d9%81%d9%8a-%d8%a8%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d8%a3/', 'summary': 'بعد أسبوعين في مخيمهم الصيفي بالمغرب.. أطفال القدس يعودون إلى ديارهم. وصل أطفال القدس المشاركون في الدورة الـ16 للمخيم الصيفي في المغرب مع مؤطريهم، فجر اليوم الأربعاء (27 غشت) إلى مدينة القدس، بعد قضائهم أسبوعين في مخيمهم الصيفي “حارة المغاربة” الذي نظم تحت الرعاية السامية لصاحب الجلالة الملك محمد السادس، رئيس لجنة القدس. وعبر أطفال القدس، لدى وصولهم إلى مكان تجمع العائلات في حي الشيخ جراح', 'size': 2}], 'main_title': 'أطفال القدس يثمنون الدعم الملكي'}, {'community_id': '6', 'articles': [{'id': '108', 'title': 'محاكمة ابتسام لشكر ..الدفاع يطلب السراح المؤقت لإجراء عملية عاجلة', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/411740.html', 'summary': 'محاكمة ابتسام لشكر ..الدفاع يطلب السراح المؤقت لإجراء عملية عاجلة. مثلت ابتسام لشكر، الناشطة المغربية المتابعة في ملف “الإساءة للذات الإلهية”، أمام المحكمة الابتدائية بالرباط، حيث طلب دفاعها المكوّن من ثلاثة محامين، تمتيعها بالسراح المؤقت', 'size': 2}, {'id': '166', 'title': 'هيئة الدفاع: ابتسام لشكر تحتاج إلى متابعة في حالة سراح لأسباب صحية', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%87%d9%8a%d8%a6%d8%a9-%d8%a7%d9%84%d8%af%d9%81%d8%a7%d8%b9-%d8%a7%d8%a8%d8%aa%d8%b3%d8%a7%d9%85-%d9%84%d8%b4%d9%83%d8%b1-%d8%aa%d8%ad%d8%aa%d8%a7%d8%ac-%d8%a5%d9%84%d9%89-%d9%85%d8%aa%d8%a7%d8%a8/', 'summary': 'هيئة الدفاع: ابتسام لشكر تحتاج إلى متابعة في حالة سراح لأسباب صحية. طالبت هيئة دفاع الناشطة الحقوقية ابتسام لشكر، صباح اليوم الأربعاء، خلال جلسة محاكمتها بالمحكمة الابتدائية بالرباط، بتمتيعها بالسراح المؤقت. وأوضحت هيئة الدفاع في مرافعتها، أن موكلتها تعاني من مرض السرطان، وأنها مقبلة على عملية جراحية على مستوى إحدى يديها. في المقابل، عارضت النيابة العامة تمتيع لشكر بالسراح المؤقت. وقررت هيئة الحكم تأجيل النظر في الملف  هيئة الدفاع: ابتسام لشكر تحتاج إلى متابعة في حالة سراح لأسباب صحية     .', 'size': 2}, {'id': '344', 'title': 'مستجدات محاكمة ابتسام لشكر', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-586750.html', 'summary': 'مستجدات محاكمة ابتسام لشكر. التمست النيابة العامة لدى المحكمة الابتدائية بالرباط، اليوم الأربعاء، رفض طلب تمتيع الناشطة الحقوقية ابتسام لشكر بالسراح المؤقت، وذلك في إطار متابعتها على خلفية قضية تتعلق بـ”الإساءة للذات الإلهية”. وقد قررت المحكمة تأجيل النظر في هذا الطلب إلى الأسبوع المقبل. وخلال جلسة المحاكمة، قدم دفاع ابتسام لشكر، الذي يتكون من', 'size': 3}], 'main_title': 'مستجدات محاكمة ابتسام لشكر'}, {'community_id': '2', 'articles': [{'id': '120', 'title': 'إقبال كبير.. تيكي ماتش المغرب والنيجر سالاو!', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a5%d9%82%d8%a8%d8%a7%d9%84-%d9%83%d8%a8%d9%8a%d8%b1-%d8%aa%d9%8a%d9%83%d9%8a-%d9%85%d8%a7%d8%aa%d8%b4-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d9%88%d8%a7%d9%84%d9%86%d9%8a%d8%ac%d8%b1-%d8%b3%d8%a7/', 'summary': 'إقبال كبير.. تيكي ماتش المغرب والنيجر سالاو!. أعلنت اللجنة المنظمة للمباراة الودية الرسمية التي ستجمع بين المنتخب الوطني المغربي ونظيره منتخب النيجر، المقررة يوم الجمعة 5 شتنبر القادم بالمجمع الرياضي الأمير مولاي عبد الله في الرباط، ابتداء من الساعة الثامنة مساء، أن جميع التذاكر المطروحة للبيع قد نفدت بالكامل. وأكد البلاغ أن المواجهة ستجرى بشبابيك مغلقة، مع عدم طرح أي تذاكر إضافية،', 'size': 3}, {'id': '139', 'title': 'رسميا.. نفاد كل تذاكر مباراة المغرب والنيجر وسط جدل السوق السوداء', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/321791/', 'summary': 'رسميا.. نفاد كل تذاكر مباراة المغرب والنيجر وسط جدل السوق السوداء. أعلنت اللجنة المنظمة للمباراة التي ستجمع بين المنتخب الوطني المغربي ونظيره منتخب النيجر برسم اقصائيات كأس العالم 2026 لكرة القدم، يوم الجمعة 5 شتنبر 2025 بالمجمع الرياضي الأمير مولاي عبد الله بمدينة الرباط، عن نفاد جميع التذاكر المخصصة للقاء في أقل من 24 ساعة من فتح شبابيك البيع، بعد الإقبال الكبير للجماهير المغربية. وأكدت اللجنة', 'size': 4}, {'id': '218', 'title': 'نفاد تذاكر مباراة المغرب والنيجر في أقل من 24 ساعة من طرحها', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/226364/', 'summary': 'نفاد تذاكر مباراة المغرب والنيجر في أقل من 24 ساعة من طرحها. السعيد بنلباه في أقل من 24 من طرح تذاكر مباراة المغرب النيجر عبر المنصة المخصصة للمباراة التي ستجمع بين المنتخب الوطني المغربي ونظيره منتخب النيجر، والتي ستجرى يوم الجمعة 5 شتنبر 2025 بالمجمع الرياضي الأمير مولاي عبد الله بمدينة الرباط، انطلاقا من الساعة الثامنة مساء اعلنت الجامعة الملكية المغربية لكرة القدم أن المباراة ستجرى بشبابيك', 'size': 4}, {'id': '242', 'title': 'نفاد تذاكر مباراة المغرب والنيجر التي ستقام بالمجمع الرياضي الأمير مولاي عبد الله', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%86%d9%81%d8%a7%d8%af-%d8%aa%d8%b0%d8%a7%d9%83%d8%b1-%d9%85%d8%a8%d8%a7%d8%b1%d8%a7%d8%a9-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d9%88%d8%a7%d9%84%d9%86%d9%8a%d8%ac%d8%b1-%d8%a7%d9%84%d8%aa%d9%8a/', 'summary': 'نفاد تذاكر مباراة المغرب والنيجر التي ستقام بالمجمع الرياضي الأمير مولاي عبد الله. أعلنت اللجنة المنظمة للمباراة التي ستجمع المنتخب الوطني المغربي بنظيره منتخب النيجر، يوم الجمعة 5 شتنبر 2025 بالمجمع الرياضي الأمير مولاي عبد الله بالرباط، في إطار الجولة السادسة من تصفيات مونديال 2026، عن نفاد جميع التذاكر المطروحة للبيع، مؤكدة أن المواجهة ستُجرى بشبابيك مغلقة دون طرح أي تذاكر إضافية. وأعربت اللجنة عن شكرها …  نفاد تذاكر مباراة المغرب والنيجر التي ستقام بالمجمع الرياضي الأمير مولاي عبد الله     .', 'size': 3}], 'main_title': 'رسميا.. نفاد كل تذاكر مباراة المغرب والنيجر وسط جدل السوق السوداء'}, {'community_id': '4', 'articles': [{'id': '122', 'title': 'لفائدة موظفي الأمن الوطني.. افتتاح قاعة رياضية متعددة التخصصات في الحسيمة', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%84%d9%81%d8%a7%d8%a6%d8%af%d8%a9-%d9%85%d9%88%d8%b8%d9%81%d9%8a-%d8%a7%d9%84%d8%a3%d9%85%d9%86-%d8%a7%d9%84%d9%88%d8%b7%d9%86%d9%8a-%d8%a7%d9%81%d8%aa%d8%aa%d8%a7%d8%ad-%d9%82%d8%a7%d8%b9%d8%a9/', 'summary': 'لفائدة موظفي الأمن الوطني.. افتتاح قاعة رياضية متعددة التخصصات في الحسيمة. أعلنت المديرية العامة للأمن الوطني، اليوم الأربعاء (27 غشت)، عن افتتاح قاعة رياضية جديدة متعددة التخصصات بمدينة الحسيمة، وذلك في إطار تنزيلها لمخطط تعزيز الخدمات الرياضية والاجتماعية التي يستفيد منها منخرطو مؤسسة محمد السادس للأعمال الاجتماعية لموظفي الأمن الوطني. وحسب البلاغ الذي توصل به موقع “كيفاش”، فقد تم تدشين القاعة الرياضية الجديدة على مستوى مقر', 'size': 2}, {'id': '306', 'title': 'مديرية الأمن تفتتح قاعة للرياضة بمدينة الحسيمة', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/205400', 'summary': 'مديرية الأمن تفتتح قاعة للرياضة بمدينة الحسيمة.  افتتحت المديرية العامة للأمن الوطني، يومه الأربعاء 27 غشت الجاري، قاعة رياضية جديدة متعددة التخصصات بمدينة الحسيمة، وذلك في إطار تنزيلها لمخطط تعزيز الخدمات الرياضية والاجتماعية التي يستفيد منها منخرطو مؤسسة محمد السادس للأعمال الاجتماعية لموظفي الأمن الوطني. وقد تم تدشين القاعة الرياضية الجديدة على مستوى مقر الأمن الجهوي بمدينة الحسيمة، وتم تجهيزها بمعدات', 'size': 3}, {'id': '308', 'title': 'افتتاح قاعة رياضية جديدة متعددة التخصصات بمدينة الحسيمة لفائدة أسرة الأمن الوطني', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/divers/411752.html', 'summary': 'افتتاح قاعة رياضية جديدة متعددة التخصصات بمدينة الحسيمة لفائدة أسرة الأمن الوطني. افتتحت المديرية العامة للأمن الوطني، يوم الأربعاء 27 غشت 2025، قاعة رياضية جديدة متعددة التخصصات بمدينة الحسيمة، وذلك في إطار تنزيل مخططها الرامي إلى تعزيز', 'size': 2}], 'main_title': 'مديرية الأمن تفتتح قاعة للرياضة بمدينة الحسيمة'}, {'community_id': '3', 'articles': [{'id': '163', 'title': 'المغرب يدعو إلى اعتبار البحر فضاء للربط والتكامل وليس مجرد حدود سيادية', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1095445.html', 'summary': 'المغرب يدعو إلى اعتبار البحر فضاء للربط والتكامل وليس مجرد حدود سيادية. أكد وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقیمین بالخارج، ناصر بوريطة، أمس الثلاثاء بالرباط، أن الرؤية الملكية تكرس البحر كرافعة أساسية للازدهار الوطني والربط القاري والدفاع عن السيادة. وأبرز بوريطة، في كلمة تليت نيابة عنه خلال افتتاح ندوة حول موضوع “الممارسات الدولية في ترسيم المجالات البحرية”، نظمت بشراكة مع معهد القانون الدولي، وهي منظمة مرموقة ظهرت المقالة المغرب يدعو إلى اعتبار البحر فضاء للربط والتكامل وليس مجرد حدود سيادية  .', 'size': 2}, {'id': '240', 'title': 'بوريطة: الرؤية الملكية تكرس البحر كرافعة أساسية للازدهار الوطني والربط القاري والدفاع عن السيادة', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a8%d9%88%d8%b1%d9%8a%d8%b7%d8%a9-%d8%a7%d9%84%d8%b1%d8%a4%d9%8a%d8%a9-%d8%a7%d9%84%d9%85%d9%84%d9%83%d9%8a%d8%a9-%d8%aa%d9%83%d8%b1%d8%b3-%d8%a7%d9%84%d8%a8%d8%ad%d8%b1-%d9%83%d8%b1%d8%a7%d9%81/', 'summary': 'بوريطة: الرؤية الملكية تكرس البحر كرافعة أساسية للازدهار الوطني والربط القاري والدفاع عن السيادة. قال وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقیمین بالخارج، ناصر بوريطة، أمس الثلاثاء بالرباط، إن الرؤية الملكية تكرس البحر كرافعة أساسية للازدهار الوطني والربط القاري والدفاع عن السيادة. وأوضح بوريطة، في كلمة تليت نيابة عنه خلال افتتاح ندوة حول موضوع “الممارسات الدولية في ترسيم المجالات البحرية”، نظمت بشراكة مع معهد القانون الدولي، وهي …  بوريطة: الرؤية الملكية تكرس البحر كرافعة أساسية للازدهار الوطني والربط القاري والدفاع عن السيادة     .', 'size': 2}], 'main_title': 'المغرب يدعو إلى اعتبار البحر فضاء للربط والتكامل وليس مجرد حدود سيادية'}, {'community_id': '1', 'articles': [{'id': '170', 'title': 'إقبال قياسي على تذاكر مباراة الأسود ضد النيجر', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a5%d9%82%d8%a8%d8%a7%d9%84-%d9%82%d9%8a%d8%a7%d8%b3%d9%8a-%d8%b9%d9%84%d9%89-%d8%aa%d8%b0%d8%a7%d9%83%d8%b1-%d9%85%d8%a8%d8%a7%d8%b1%d8%a7%d8%a9-%d8%a7%d9%84%d8%a3%d8%b3%d9%88%d8%af-%d8%b6%d8%af/', 'summary': 'إقبال قياسي على تذاكر مباراة الأسود ضد النيجر. أعلنت اللجنة المنظمة للمباراة التي ستجمع المنتخب الوطني المغربي بنظيره النيجري، يوم الجمعة 5 شتنبر 2025 بالمجمع الرياضي الأمير مولاي عبد الله بالرباط، أن التذاكر نفدت بالكامل، ما يعني أن اللقاء سيقام بشبابيك مغلقة دون طرح أي تذاكر إضافية. وشكرت اللجنة الجماهير المغربية على الإقبال الكبير الذي يعكس دعمها المتواصل للمنتخب في هذه المواجهة الحاسمة  إقبال قياسي على تذاكر مباراة الأسود ضد النيجر     .', 'size': 2}, {'id': '225', 'title': 'ملعب الرباط: التذاكر نفذت.. والمباراة أمام النيجر ستجري بشبابيك مغلقة', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d9%85%d9%84%d8%b9%d8%a8-%d8%a7%d9%84%d8%b1%d8%a8%d8%a7%d8%b7-%d8%a7%d9%84%d8%aa%d8%b0%d8%a7%d9%83%d8%b1-%d9%86%d9%81%d8%b0%d8%aa-%d9%88%d8%a7%d9%84%d9%85%d8%a8%d8%a7%d8%b1%d8%a7%d8%a9-%d8%a3%d9%85/', 'summary': 'ملعب الرباط: التذاكر نفذت.. والمباراة أمام النيجر ستجري بشبابيك مغلقة. المساء اليوم – الرباط: أعلنت اللجنة المنظمة للمباراة التي ستجمع يوم 5 شتنبر المقبل بين المنتخب الوطني المغربي، ونظيره النيجري، على أرضية المجمع الرياضي الأمير مولاي عبد الله بالرباط، برسم التصفيات الإفريقية المؤهلة لنهائيات كأس العالم', 'size': 2}], 'main_title': 'إقبال قياسي على تذاكر مباراة الأسود ضد النيجر'}, {'community_id': '0', 'articles': [{'id': '176', 'title': 'الملك معزيا في محمد حسن: صحفي اتصف بالخلق الحميد وبالكفاءة الرفيعة', 'source': 'soltana.ma', 'link': 'https://soltana.ma/1357696.html', 'summary': 'الملك معزيا في محمد حسن: صحفي اتصف بالخلق الحميد وبالكفاءة الرفيعة. بعث الملك محمد السادس برقية تعزية ومواساة إلى أفراد أسرة المرحوم الإعلامي محمد حسن الوالي. وجاء في برقية الملك “تلقينا ببالغ التأثر نعي المشمول يعفو الله وغفرانه، الإعلامي القدير المرحوم محمد حسن الوالي، تغمده سبحانه بواسع رحمته وأسكنه فسيح جنانه”. وقال الملك “وبهذه المناسبة المحزنة، نعرب لكم ولكافة أهلكم وذويكم، ومن خلالكم لأسرة الراحل الإعلامية', 'size': 2}, {'id': '223', 'title': 'برقية تعزية مؤثرة من جلالة الملك إلى أسرة الإعلامي الراحل “علي حسن”', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/226350/', 'summary': 'برقية تعزية مؤثرة من جلالة الملك إلى أسرة الإعلامي الراحل “علي حسن”. بعث صاحب الجلالة الملك محمد السادس برقية تعزية ومواساة إلى أفراد أسرة المرحوم الإعلامي محمد حسن الوالي. وجاء في برقية جلالة الملك “تلقينا ببالغ التأثر نعي المشمول يعفو الله وغفرانه، الإعلامي القدير المرحوم محمد حسن الوالي، تغمده سبحانه بواسع رحمته وأسكنه فسيح جنانه”. وقال جلالة الملك “وبهذه المناسبة المحزنة، نعرب لكم ولكافة أهلكم وذويكم، ومن', 'size': 2}], 'main_title': 'الملك معزيا في محمد حسن: صحفي اتصف بالخلق الحميد وبالكفاءة الرفيعة'}, {'community_id': '7', 'articles': [{'id': '337', 'title': '7500 مليونير بالمغرب.. والمملكة في مقدمة عدد المليونيرات بالقارة', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-586766.html', 'summary': '7500 مليونير بالمغرب.. والمملكة في مقدمة عدد المليونيرات بالقارة. حلّ المغرب في المرتبة الثالثة إفريقيا من حيث عدد المليونيرات، وفقاً لتقرير “الثروة في إفريقيا لسنة 2025” الصادر عن شركة Henley & Partner الدولية المتخصصة في الاستشارات المالية، بشراكة مع مؤسسة New World Wealth. وبحسب التقرير، فإن عدد المليونيرات المقيمين في المملكة يبلغ نحو 7500 شخص، ما يضعها خلف كل من جنوب', 'size': 2}, {'id': '350', 'title': 'المغرب ثالث أغنى بلد إفريقي بـ7500 مليونير.. وبنجلون على رأس قائمة الأثرياء', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1095559.html', 'summary': 'المغرب ثالث أغنى بلد إفريقي بـ7500 مليونير.. وبنجلون على رأس قائمة الأثرياء. كشف تقرير “الثروة في إفريقيا 2024” (Africa Wealth Report 2024)، الصادر عن شركة استشارات الجنسية والإقامة العالمية “Henley & Partner” بالتعاون مع شركة استخبارات الثروة “New World Wealth”، عن ترسيخ المغرب لمكانته ضمن أغنى خمس دول في القارة، حيث حل في المرتبة الثالثة بإجمالي ثروة قابلة للاستثمار تقدر بـ127 مليار دولار. وأظهر التقرير أن المغرب ظهرت المقالة المغرب ثالث أغنى بلد إفريقي بـ7500 مليونير.. وبنجلون على رأس قائمة الأثرياء  .', 'size': 2}], 'main_title': '7500 مليونير بالمغرب.. والمملكة في مقدمة عدد المليونيرات بالقارة'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    