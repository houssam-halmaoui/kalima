<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 17/10/2025 - 06h14</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '4', 'title': 'بورصة البيضاء ترتفع بنسبة 1,31 بالمائة', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d8%a8%d9%88%d8%b1%d8%b5%d8%a9-%d8%a7%d9%84%d8%a8%d9%8a%d8%b6%d8%a7%d8%a1-%d8%aa%d8%b1%d8%aa%d9%81%d8%b9-%d8%a8%d9%86%d8%b3%d8%a8%d8%a9-131-%d8%a8%d8%a7%d9%84%d9%85%d8%a7%d8%a6%d8%a9-1640972.html', 'summary': 'بورصة البيضاء ترتفع بنسبة 1,31 بالمائة. أنهت بورصة الدار البيضاء تداولاتها، اليوم الخميس، على وقع الارتفاع، حيث سجل مؤشرها الرئيسي “مازي” تقدما بنسبة 1,31 في المائة، ليستقر بذلك عند 18.438,26 نقطة. من جانبه، سجل مؤشر “MASI.20″، الذي يعكس أداء 20 مقاولة مدرجة بالبورصة، ارتفاعا بنسبة 1,69 في المائة إلى 1.493,47 نقطة، فيما سجل MASI.ESG، مؤشر الشركات الحاصلة على أفضل تصنيف ESG،  بورصة البيضاء ترتفع بنسبة 1,31 بالمائة     - هسبريس جريدة إلكترونية مغربية .', 'size': 2}, {'id': '13', 'title': 'بورصة الدار البيضاء تنهي تداولاتها على وقع الارتفاع', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-666641.html', 'summary': 'بورصة الدار البيضاء تنهي تداولاتها على وقع الارتفاع. هبة بريس أنهت بورصة الدار البيضاء تداولاتها، اليوم الخميس، على وقع الارتفاع، حيث سجل مؤشرها الرئيسي “مازي” تقدما بنسبة 1,31 في المائة، ليستقر بذلك عند 18.438,26 نقطة. من جانبه، سجل مؤشر “MASI.20″، الذي يعكس أداء 20 مقاولة مدرجة بالبورصة، ارتفاعا بنسبة 1,69 في المائة إلى 1.493,47 نقطة، فيما سجل MASI.ESG، مؤشر الشركات الحاصلة على أفضل', 'size': 2}], 'main_title': 'بورصة البيضاء ترتفع بنسبة 1,31 بالمائة'}, {'community_id': '1', 'articles': [{'id': '7', 'title': 'عبد النباوي يحدد ركائز العدالة الحديثة', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d8%b9%d8%a8%d8%af-%d8%a7%d9%84%d9%86%d8%a8%d8%a7%d9%88%d9%8a-%d9%8a%d8%ad%d8%af%d8%af-%d8%b1%d9%83%d8%a7%d8%a6%d8%b2-%d8%a7%d9%84%d8%b9%d8%af%d8%a7%d9%84%d8%a9-%d8%a7%d9%84%d8%ad%d8%af%d9%8a%d8%ab-1640929.html', 'summary': 'عبد النباوي يحدد ركائز العدالة الحديثة. أكد الرئيس الأول لمحكمة النقض، الرئيس المنتدب للمجلس الأعلى للسلطة القضائية، محمد عبد النباوي، اليوم الخميس بمراكش، أن الاستقلال والأخلاقيات والتواصل تشكل الركائز الثلاث لأي عدالة حديثة وشرعية وإنسانية. وقال عبد النباوي، خلال الجلسة الافتتاحية لمؤتمر الشبكة الفرانكفونية للمجالس العليا للقضاء، إن “تلاحم هذه الركائز الثلاث هو ما يجعل العدالة مؤسسة محل احترام وتقدير”، وأضاف  عبد النباوي يحدد ركائز العدالة الحديثة     - هسبريس جريدة إلكترونية مغربية .', 'size': 2}, {'id': '184', 'title': 'عبد النباوي: الاستقلال يفقد معناه إن لم يكن مؤطرا بالأخلاقيات', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%b9%d8%a8%d8%af-%d8%a7%d9%84%d9%86%d8%a8%d8%a7%d9%88%d9%8a-%d8%a7%d9%84%d8%a7%d8%b3%d8%aa%d9%82%d9%84%d8%a7%d9%84-%d9%8a%d9%81%d9%82%d8%af-%d9%85%d8%b9%d9%86%d8%a7%d9%87-%d8%a5%d9%86-%d9%84%d9%85/', 'summary': 'عبد النباوي: الاستقلال يفقد معناه إن لم يكن مؤطرا بالأخلاقيات. أكد الرئيس الأول لمحكمة النقض، الرئيس المنتدب للمجلس الأعلى للسلطة القضائية، محمد عبد النباوي، اليوم الخميس بمراكش، أن الاستقلال والأخلاقيات والتواصل تشكل الركائز الثلاث لأساس أي عدالة حديثة وشرعية وإنسانية. وقال عبد النباوي، خلال الجلسة الافتتاحية لمؤتمر الشبكة الفرنكفونية للمجالس العليا للقضاء، إن "تلاحم هذه الركائز الثلاث هو ما يجعل العدالة مؤسسة محل احترام وتقدير".  عبد النباوي: الاستقلال يفقد معناه إن لم يكن مؤطرا بالأخلاقيات     .', 'size': 2}], 'main_title': 'عبد النباوي يحدد ركائز العدالة الحديثة'}, {'community_id': '2', 'articles': [{'id': '9', 'title': 'الكاف: "أشبال المغرب" يكتبون التاريخ', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d8%a7%d9%84%d9%83%d8%a7%d9%81-%d8%a3%d8%b4%d8%a8%d8%a7%d9%84-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d8%aa%d8%b5%d9%86%d8%b9-%d8%a7%d9%84%d8%aa%d8%a7%d8%b1%d9%8a%d8%ae-1640940.html', 'summary': 'الكاف: "أشبال المغرب" يكتبون التاريخ. وصف الاتحاد الإفريقي لكرة القدم (الكاف)، اليوم الخميس، بـ”الانتصار الرمزي والتاريخي” تأهل المنتخب الوطني على حساب نظيره الفرنسي إلى نهائي كأس العالم لأقل من 20 سنة، المقامة حاليا في الشيلي. وكتب “الكاف”، على موقعه الرسمي، أنه “بعد 120 دقيقة من صراع قوي ومفتوح على جميع الاحتمالات ضمن المنتخب المغربي تأهله إلى النهائي بفضل ركلات الترجيح  الكاف: "أشبال المغرب" يكتبون التاريخ     - هسبريس جريدة إلكترونية مغربية .', 'size': 2}, {'id': '195', 'title': 'كاف يبارك التأهل التاريخي للمغرب إلى نهائي مونديال الشباب على حساب فرنسا', 'source': 'rue20.com', 'link': 'https://rue20.com/945733.html', 'summary': 'كاف يبارك التأهل التاريخي للمغرب إلى نهائي مونديال الشباب على حساب فرنسا.  ا الرباط وصف الاتحاد الإفريقي لكرة القدم (الكاف)، اليوم الخميس، بـ”الانتصار الرمزي والتاريخي” تأهل المنتخب الوطني على حساب نظيره الفرنسي إلى نهائي كأس العالم لأقل من 20 سنة، المقامة حاليا في الشيلي. وكتب (الكاف)، على موقعه الرسمي، أنه “بعد 120 دقيقة من صراع قوي ومفتوح على جميع الاحتمالات، ضمن المنتخب المغربي تأهله إلى الخبر كاف يبارك التأهل التاريخي للمغرب إلى نهائي مونديال الشباب على حساب فرنسا  .', 'size': 2}, {'id': '246', 'title': 'الكاف: تأهل المغرب إلى نهائي المونديال انتصار رمزي وتاريخي', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d9%83%d8%a7%d9%81-%d8%aa%d8%a3%d9%87%d9%84-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d8%a5%d9%84%d9%89-%d9%86%d9%87%d8%a7%d8%a6%d9%8a-%d8%a7%d9%84%d9%85%d9%88%d9%86%d8%af%d9%8a%d8%a7%d9%84/', 'summary': 'الكاف: تأهل المغرب إلى نهائي المونديال انتصار رمزي وتاريخي. وصف الاتحاد الإفريقي لكرة القدم (الكاف)، اليوم الخميس 16 أكتوبر 2025، تأهل المنتخب الوطني على حساب نظيره الفرنسي إلى نهائي كأس العالم لأقل من 20 سنة، المقامة حاليا في الشيلي، بـ”الانتصار الرمزي والتاريخي”. وكتب (الكاف)، على موقعه الرسمي، أنه “بعد 120 دقيقة من صراع قوي ومفتوح على جميع الاحتمالات، ضمن المنتخب المغربي تأهله …  الكاف: تأهل المغرب إلى نهائي المونديال انتصار رمزي وتاريخي     .', 'size': 3}], 'main_title': 'الكاف: تأهل المغرب إلى نهائي المونديال انتصار رمزي وتاريخي'}, {'community_id': '3', 'articles': [{'id': '35', 'title': 'موسكو.. بوريطة يتباحث مع نظيره الروسي تطوير العلاقات الثنائية – صور', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-666570.html', 'summary': 'موسكو.. بوريطة يتباحث مع نظيره الروسي تطوير العلاقات الثنائية – صور. هبة بريس أجرى وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج ناصر بوريطة، اليوم الخميس بموسكو، مباحثات مع نظيره الروسي سيرغي لافروف. ويندرج هذا اللقاء في إطار الشراكة الاستراتيجية المعمقة التي وقعها صاحب الجلالة الملك محمد السادس نصره الله، والرئيس فلاديمير بوتين في مارس 2016. وأشاد الوزيران بالزخم القوي الذي أضفاه عليها قائدا البلدين، حيث', 'size': 3}, {'id': '136', 'title': 'موسكو.. بوريطة يتباحث مع نظيره الروسي سيرغي لافروف', 'source': 'kifache.com', 'link': 'https://kifache.com/%d9%85%d9%88%d8%b3%d9%83%d9%88-%d8%a8%d9%88%d8%b1%d9%8a%d8%b7%d8%a9-%d9%8a%d8%aa%d8%a8%d8%a7%d8%ad%d8%ab-%d9%85%d8%b9-%d9%86%d8%b8%d9%8a%d8%b1%d9%87-%d8%a7%d9%84%d8%b1%d9%88%d8%b3%d9%8a-%d8%b3%d9%8a/', 'summary': 'موسكو.. بوريطة يتباحث مع نظيره الروسي سيرغي لافروف. أجرى وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج ناصر بوريطة، اليوم الخميس بموسكو، مباحثات مع نظيره الروسي سيرغي لافروف. ويندرج هذا اللقاء في إطار الشراكة الاستراتيجية المعمقة التي وقعها صاحب الجلالة الملك محمد السادس، والرئيس فلاديمير بوتين في مارس 2016. وأشاد الوزيران بالزخم القوي الذي أضفاه عليها قائدا البلدين، حيث تواصل رؤيتهما تقوية وتوجيه', 'size': 5}, {'id': '175', 'title': 'لجنة عمل جديدة بين المغرب وروسيا لتعميق الشراكة الاستراتيجية', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1108661.html', 'summary': 'لجنة عمل جديدة بين المغرب وروسيا لتعميق الشراكة الاستراتيجية. أجرى وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج ناصر بوريطة، اليوم الخميس بموسكو، مباحثات مع نظيره الروسي سيرغي لافروف. ويندرج هذا اللقاء في إطار الشراكة الاستراتيجية المعمقة التي وقعها الملك محمد السادس والرئيس فلاديمير بوتين في مارس 2016. وأشاد الوزيران بالزخم القوي الذي أضفاه عليها قائدا البلدين، حيث تواصل رؤيتهما تقوية وتوجيه هذه الشراكة ظهرت المقالة لجنة عمل جديدة بين المغرب وروسيا لتعميق الشراكة الاستراتيجية  .', 'size': 4}, {'id': '186', 'title': 'بوريطة يتباحث بموسكو مع نظيره الروسي سيرغي لافروف', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a8%d9%88%d8%b1%d9%8a%d8%b7%d8%a9-%d9%8a%d8%aa%d8%a8%d8%a7%d8%ad%d8%ab-%d8%a8%d9%85%d9%88%d8%b3%d9%83%d9%88-%d9%85%d8%b9-%d9%86%d8%b8%d9%8a%d8%b1%d9%87-%d8%a7%d9%84%d8%b1%d9%88%d8%b3%d9%8a-%d8%b3/', 'summary': 'بوريطة يتباحث بموسكو مع نظيره الروسي سيرغي لافروف. أجرى وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج ناصر بوريطة، اليوم الخميس بموسكو، مباحثات مع نظيره الروسي سيرغي لافروف. ويندرج هذا اللقاء في إطار الشراكة الاستراتيجية المعمقة التي وقعها الملك محمد السادس، والرئيس فلاديمير بوتين في مارس 2016. وأشاد الوزيران بالزخم القوي الذي أضفاه عليها قائدا البلدين، حيث تواصل رؤيتهما تقوية وتوجيه هذه الشراكة  بوريطة يتباحث بموسكو مع نظيره الروسي سيرغي لافروف     .', 'size': 4}, {'id': '450', 'title': 'السيد ناصر بوريطة يتباحث بموسكو مع نظيره الروسي سيرغي لافروف', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/228565/', 'summary': 'السيد ناصر بوريطة يتباحث بموسكو مع نظيره الروسي سيرغي لافروف. موسكو – أجرى وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج ناصر بوريطة، اليوم الخميس بموسكو، مباحثات مع نظيره الروسي سيرغي لافروف. ويندرج هذا اللقاء في إطار الشراكة الاستراتيجية المعمقة التي وقعها صاحب الجلالة الملك محمد السادس نصره الله، والرئيس فلاديمير بوتين في مارس 2016. وأشاد الوزيران بالزخم القوي الذي أضفاه عليها قائدا البلدين، حيث', 'size': 5}], 'main_title': 'موسكو.. بوريطة يتباحث مع نظيره الروسي سيرغي لافروف'}, {'community_id': '4', 'articles': [{'id': '93', 'title': 'المغرب والأرجنتين في النهائي..موعد مباراة الحلم في كأس العالم للشباب', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/sport/lionatlas/414586.html', 'summary': 'المغرب والأرجنتين في النهائي..موعد مباراة الحلم في كأس العالم للشباب. ضرب المنتخب المغربي لأقل من 20 سنة موعدا مع نظيره الارجنتيني في نهائي كأس العالم لهذه الفئة، المقامة حاليا في الشيلي، عقب تأهلهما في نصف', 'size': 2}, {'id': '205', 'title': 'إعلام عربي: نهائي المغرب والأرجنتين مباراة تاريخية وننتظر اللقب من الشيلي', 'source': 'machahid24.com', 'link': 'https://machahid24.com/sport/478836.html', 'summary': 'إعلام عربي: نهائي المغرب والأرجنتين مباراة تاريخية وننتظر اللقب من الشيلي. أشاد الإعلام الرياضي العربي، بإنجاز المنتخب الوطني المغربي لأقل من 20 سنة لكرة القدم، المتمثل في بلوغ نهائي كأس العالم للشباب.', 'size': 2}], 'main_title': 'المغرب والأرجنتين في النهائي..موعد مباراة الحلم في كأس العالم للشباب'}, {'community_id': '5', 'articles': [{'id': '99', 'title': 'هلال أمام الأمم المتحدة: بعد 50 عاما على استرجاعها، الصحراء المغربية أضحت واحة سلام وقطبا للاندماج الإفريقي والتنمية المشتركة', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/national/414593.html', 'summary': 'هلال أمام الأمم المتحدة: بعد 50 عاما على استرجاعها، الصحراء المغربية أضحت واحة سلام وقطبا للاندماج الإفريقي والتنمية المشتركة. أكد السفير الممثل الدائم للمغرب لدى الأمم المتحدة، عمر هلال، الأربعاء بنيويورك، أنه في غمرة استعدادات المغرب لتخليد الذكرى الخمسين للمسيرة الخضراء المظفرة، التي مكنت', 'size': 2}, {'id': '452', 'title': 'عمر هلال أمام الأمم المتحدة: بعد 50 عاما على استرجاعها، الصحراء المغربية أضحت واحة سلام وقطبا للاندماج الإفريقي والتنمية المشتركة', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/228560/', 'summary': 'عمر هلال أمام الأمم المتحدة: بعد 50 عاما على استرجاعها، الصحراء المغربية أضحت واحة سلام وقطبا للاندماج الإفريقي والتنمية المشتركة. الأمم المتحدة (نيويورك) – أكد السفير الممثل الدائم للمغرب لدى الأمم المتحدة، عمر هلال، الأربعاء بنيويورك، أنه في غمرة استعدادات المغرب لتخليد الذكرى الخمسين للمسيرة الخضراء المظفرة، التي مكنت من استكمال الوحدة الترابية للمملكة، أضحت الصحراء المغربية واحة للسلام والاندماج الإفريقي والتنمية المشتركة. وفي مداخلة أمام اللجنة الرابعة للجمعية العامة للأمم المتحدة، أبرز السيد هلال', 'size': 2}], 'main_title': 'هلال أمام الأمم المتحدة: بعد 50 عاما على استرجاعها، الصحراء المغربية أضحت واحة سلام وقطبا للاندماج الإفريقي والتنمية المشتركة'}, {'community_id': '6', 'articles': [{'id': '106', 'title': 'نشرة إنذارية: زخات رعدية قوية مصحوبة بهبات رياح مرتقبة اليوم الخميس بعدد من مناطق المملكة', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/national/414601.html', 'summary': 'نشرة إنذارية: زخات رعدية قوية مصحوبة بهبات رياح مرتقبة اليوم الخميس بعدد من مناطق المملكة. أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل زخات رعدية محليا قوية (ما بين 15 و 30 ملم) مصحوبة بهبات رياح، اليوم الخميس، بعدد من', 'size': 2}, {'id': '216', 'title': 'زخات رعدية بعدد من مناطق المملكة (نشرة إنذارية)', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%b2%d8%ae%d8%a7%d8%aa-%d8%b1%d8%b9%d8%af%d9%8a%d8%a9-%d8%a8%d8%b9%d8%af%d8%af-%d9%85%d9%86-%d9%85%d9%86%d8%a7%d8%b7%d9%82-%d8%a7%d9%84%d9%85%d9%85%d9%84%d9%83%d8%a9-%d9%86%d8%b4%d8%b1%d8%a9-%d8%a5/', 'summary': 'زخات رعدية بعدد من مناطق المملكة (نشرة إنذارية).  – متابعة زخات رعدية بعدد من مناطق المملكة (نشرة إنذارية) أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل زخات رعدية محليا قوية (ما بين 15 و 30 ملم)...  زخات رعدية بعدد من مناطق المملكة (نشرة إنذارية)     .', 'size': 2}], 'main_title': 'نشرة إنذارية: زخات رعدية قوية مصحوبة بهبات رياح مرتقبة اليوم الخميس بعدد من مناطق المملكة'}, {'community_id': '7', 'articles': [{'id': '135', 'title': 'المدير العام لشركة سافران: المغرب بقيادة جلالة الملك يمتلك كفاءات ودينامية صناعية حقيقية', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a7%d9%84%d9%85%d8%af%d9%8a%d8%b1-%d8%a7%d9%84%d8%b9%d8%a7%d9%85-%d9%84%d8%b4%d8%b1%d9%83%d8%a9-%d8%b3%d8%a7%d9%81%d8%b1%d8%a7%d9%86-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d8%a8%d9%82%d9%8a%d8%a7/', 'summary': 'المدير العام لشركة سافران: المغرب بقيادة جلالة الملك يمتلك كفاءات ودينامية صناعية حقيقية. أكد المدير العام وعضو مجلس إدارة مجموعة “سافران”، أوليفييه أندرييس، اليوم الخميس (16 أكتوبر)، أن المغرب، تحت قيادة صاحب الجلالة الملك محمد السادس، ي عد خيارا واضحا للاستثمار في قطاع الطيران، لما يوفره من كفاءات، ودينامية صناعية حقيقية، وبنيات تحتية حديثة للغاية. وقال أندرييس، الذي حل ضيفا على برنامج “Good Morning Buine” بقناة BFM Buine', 'size': 3}, {'id': '138', 'title': 'المدير العام لمجموعة سافران على قناة BFM-TV: بقيادة جلالة الملك المغرب يمتلك كفاءات دينامية صناعية حقيقية وبنيات تحتية حديثة', 'source': 'assabah.ma', 'link': 'https://assabah.ma/877289.html', 'summary': 'المدير العام لمجموعة سافران على قناة BFM-TV: بقيادة جلالة الملك المغرب يمتلك كفاءات دينامية صناعية حقيقية وبنيات تحتية حديثة. أكد المدير العام وعضو مجلس إدارة مجموعة “سافران”، أوليفييه أندرييس، اليوم الخميس، أن المغرب، تحت قيادة صاحب الجلالة الملك محمد السادس، يعد خيارا واضحا للاستثمار في قطاع الطيران، لما يوفره من كفاءات، ودينامية صناعية حقيقية، وبنيات تحتية حديثة للغاية. وقال أندرييس، الذي حل ضيفا على برنامج “Goodأكمل القراءة » المقالة المدير العام لمجموعة سافران على قناة BFM-TV: بقيادة جلالة الملك المغرب يمتلك كفاءات دينامية صناعية حقيقية وبنيات تحتية حديثة  .', 'size': 3}, {'id': '451', 'title': 'بقيادة جلالة الملك، المغرب يمتلك كفاءات، دينامية صناعية حقيقية، وبنيات تحتية حديثة', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/228563/', 'summary': 'بقيادة جلالة الملك، المغرب يمتلك كفاءات، دينامية صناعية حقيقية، وبنيات تحتية حديثة. باريس – أكد المدير العام وعضو مجلس إدارة مجموعة “سافران”، أوليفييه أندرييس، اليوم الخميس، أن المغرب، تحت قيادة صاحب الجلالة الملك محمد السادس، يُعد خيارا واضحا للاستثمار في قطاع الطيران، لما يوفره من كفاءات، ودينامية صناعية حقيقية، وبنيات تحتية حديثة للغاية. وقال السيد أندرييس، الذي حل ضيفا على برنامج “Good Morning Buine” بقناة BFM Buine', 'size': 3}], 'main_title': 'المدير العام لشركة سافران: المغرب بقيادة جلالة الملك يمتلك كفاءات ودينامية صناعية حقيقية'}, {'community_id': '8', 'articles': [{'id': '158', 'title': 'الصندوق الوطني للضمان الاجتماعي يعلن بدء تطبيق قرار جديد حول وعاء الاشتراكات', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1108741.html', 'summary': 'الصندوق الوطني للضمان الاجتماعي يعلن بدء تطبيق قرار جديد حول وعاء الاشتراكات. أعلن الصندوق الوطني للضمان الاجتماعي عن دخوله حيز تطبيق القرار رقم 1314.25 المتعلق بوعاء الاشتراكات الاجتماعية ابتداء من فاتح أكتوبر 2025. وأوضح الصندوق في بلاغ صحفي أن هذا القرار الجديد يهدف بشكل أساسي إلى توضيح عناصر الأجر والتعويضات التي لا يتم إدراجها ضمن وعاء الاشتراك مع العمل على تحديد سقوف وشروط إعفائها. وأشار المصدر ذاته ظهرت المقالة الصندوق الوطني للضمان الاجتماعي يعلن بدء تطبيق قرار جديد حول وعاء الاشتراكات  .', 'size': 3}, {'id': '273', 'title': '“CNSS” يشرع في تطبيق القرار الجديد حول وعاء الاشتراكات الاجتماعية', 'source': 'www.alousboue.ma', 'link': 'https://www.alousboue.ma/125243/', 'summary': '“CNSS” يشرع في تطبيق القرار الجديد حول وعاء الاشتراكات الاجتماعية. يعلن الصندوق الوطني للضمان الاجتماعي عن الشروع في تطبيق القرار رقم 1314.25 المتعلق بوعاء الاشتراكات الاجتماعية، انطلاقا من فاتح أكتوبر 2025. ويهدف هذا القرار إلى توضيح عناصر الأجر والتعويضات التي لا تدرج ضمن وعاء الاشتراك، مع تحديد سقوف وشروط إعفائها، كما يسعى إلى إزالة أي غموض يشوب بعض النصوص التنظيمية الحالية، وتوحيد ممارسات …  “CNSS” يشرع في تطبيق القرار الجديد حول وعاء الاشتراكات الاجتماعية     .', 'size': 3}, {'id': '383', 'title': '“CNSS” يطبق وعاء الاشتراكات الاجتماعية', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/326427/', 'summary': '“CNSS” يطبق وعاء الاشتراكات الاجتماعية. أعلن الصندوق الوطني للضمان الاجتماعي عن الشروع في تطبيق القرار رقم 1314.25 المتعلق بوعاء الاشتراكات الاجتماعية، انطلاقا من فاتح أكتوبر 2025. وأوضح بلاغ للصندوق الوطني للضمان الاجتماعي، أن هذا القرار يهدف إلى توضيح عناصر الأجر والتعويضات التي لا تدرج ضمن وعاء الاشتراك، مع تحديد سقوف وشروط إعفائها، كما يسعى إلى إزالة أي غموض يشوب بعض', 'size': 3}], 'main_title': 'الصندوق الوطني للضمان الاجتماعي يعلن بدء تطبيق قرار جديد حول وعاء الاشتراكات'}, {'community_id': '9', 'articles': [{'id': '192', 'title': 'دمار السوق البلدي بتارودانت.. حضر العامل وغاب رئيس الجماعة', 'source': 'rue20.com', 'link': 'https://rue20.com/945766.html', 'summary': 'دمار السوق البلدي بتارودانت.. حضر العامل وغاب رئيس الجماعة.  / متابعة اندلع فجر اليوم الخميس، حريق مهول بسوق “جنان الجامع” بمدينة تارودانت، مخلفًا خسائر مادية جسيمة همت نحو 700 محل تجاري. وشهدت المنطقة استنفارًا غير مسبوق من قبل السلطات، حيث حضر إلى عين المكان عامل الإقليم رفقة السلطات المحلية وباشا المدينة، بالإضافة إلى عناصر الوقاية المدنية والأمن الوطني والدرك الملكي والقوات المساعدة، الخبر دمار السوق البلدي بتارودانت.. حضر العامل وغاب رئيس الجماعة  .', 'size': 2}, {'id': '226', 'title': 'تارودانت: حريق يأتي على اغلب محلات السوق البلدي', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/228555/', 'summary': 'تارودانت: حريق يأتي على اغلب محلات السوق البلدي. السعيد بنلباه شب صباح اليوم الخميس 16 اكتوبر 2025 حريق مهول بالسوق البلدي بتارودانت المسمى ” جنان الجامع ” وفي وقت وجيز اتى على اغلب المحلات التجارية المتخصصة في بيع الملابس والمواد الغذائية المختلفة وبعض المحلات الحرفية ، مخلفا خسائر مادية كبيرة . وحسب بعض المعلومات المتداولة فإن الحريق قد تكون اندلعت اولى شراراته من', 'size': 2}], 'main_title': 'دمار السوق البلدي بتارودانت.. حضر العامل وغاب رئيس الجماعة'}, {'community_id': '10', 'articles': [{'id': '296', 'title': 'اتفاق لإطلاق برنامج تأهيلي للمدينة العتيقة بتارودانت بعد حريق سوق “جنان الجامع”', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-666810.html', 'summary': 'اتفاق لإطلاق برنامج تأهيلي للمدينة العتيقة بتارودانت بعد حريق سوق “جنان الجامع”. هبة بريس – تارودانت في إطار الحد من تداعيات الحريق الذي اندلع صباح اليوم الخميس في سوق “جنان الجامع” بالمدينة العتيقة لتارودانت، تم الاتفاق بين عبد اللطيف وهبي، رئيس المجلس الجماعي لتارودانت، وفاطمة الزهراء المنصوري، وزيرة إعداد التراب الوطني والتعمير والإسكان وسياسة المدينة، على إطلاق برنامج تأهيلي للمدينة العتيقة، يشمل ترميم سوق “جنان الجامع” خلال', 'size': 2}, {'id': '359', 'title': 'شعلات فيه العافية.. وهبي والمنصوري يتفقان على إعادة تأهيل سوق “جنان الجامع” في تارودانت', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%b4%d8%b9%d9%84%d8%a7%d8%aa-%d9%81%d9%8a%d9%87-%d8%a7%d9%84%d8%b9%d8%a7%d9%81%d9%8a%d8%a9-%d9%88%d9%87%d8%a8%d9%8a-%d9%88%d8%a7%d9%84%d9%85%d9%86%d8%b5%d9%88%d8%b1%d9%8a-%d9%8a%d8%aa%d9%81%d9%82/', 'summary': 'شعلات فيه العافية.. وهبي والمنصوري يتفقان على إعادة تأهيل سوق “جنان الجامع” في تارودانت. في إطار تطويق خسائر الحريق الذي شب، صباح اليوم الخميس (16 أكتوبر)، في سوق “جنان الجامع” بالمدينة العتيقة بتارودانت، اتفق كل من عبد اللطيف وهبي، رئيس المجلس الجماعي لتارودانت، وفاطمة الزهراء المنصوري، وزيرة إعداد التراب الوطني والتعمير والإسكان وسياسة المدينة، على انطلاق البرنامج التأهيلي للمدينة العتيقة بتارودانت، من إعادة ترميم سوق “جنان الجامع” وذلك خلال', 'size': 3}, {'id': '393', 'title': 'بعد الحريق المدمر.. وهبي والمنصوري يعلنان انطلاق إعادة تأهيل سوق “جنان الجامع” بتارودانت', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1108799.html', 'summary': 'بعد الحريق المدمر.. وهبي والمنصوري يعلنان انطلاق إعادة تأهيل سوق “جنان الجامع” بتارودانت. علمت جريدة “العمق” من مصادرها أن وزيرة إعداد التراب الوطني والتعمير والإسكان وسياسة المدينة، فاطمة الزهراء المنصوري، ورئيس المجلس الجماعي لتارودانت، عبد اللطيف وهبي، اتفقا على إعطاء الانطلاقة الفورية لبرنامج إعادة تأهيل سوق “جنان الجامع” التاريخي خلال الأيام المقبلة. وأوضحت المصادر أن هذا القرار جاء كاستجابة سريعة لتطويق الخسائر الفادحة التي خلفها الحريق الذي شب ظهرت المقالة بعد الحريق المدمر.. وهبي والمنصوري يعلنان انطلاق إعادة تأهيل سوق “جنان الجامع” بتارودانت  .', 'size': 3}, {'id': '407', 'title': 'برنامج "مستعجل" لإعادة ترميم سوق "جنان الجامع" بتارودانت بعد الحريق', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%88%d9%87%d8%a8%d9%8a-%d9%88%d8%a7%d9%84%d9%85%d9%86%d8%b5%d9%88%d8%b1%d9%8a-%d9%8a%d8%b7%d9%84%d9%82%d8%a7%d9%86-%d8%a8%d8%b1%d9%86%d8%a7%d9%85%d8%ac%d8%a7-%d9%84%d8%a5%d8%b9%d8%a7%d8%af%d8%a9/', 'summary': 'برنامج "مستعجل" لإعادة ترميم سوق "جنان الجامع" بتارودانت بعد الحريق. في خطوة تهدف إلى احتواء تداعيات الحريق الذي اندلع صباح اليوم الخميس في أحد أعرق الأسواق بالمدينة العتيقة لتارودانت، أعلن كل من عبد اللطيف وهبي، رئيس المجلس الجماعي للمدينة، وزميلته في الحزب والحكومة، فاطمة الزهراء المنصوري، وزيرة إعداد التراب الوطني والتعمير والإسكان وسياسة المدينة، عن اتفاقهما على إطلاق برنامج استعجالي لإعادة ترميم وتأهيل سوق "جنان  برنامج "مستعجل" لإعادة ترميم سوق "جنان الجامع" بتارودانت بعد الحريق     .', 'size': 2}], 'main_title': 'شعلات فيه العافية.. وهبي والمنصوري يتفقان على إعادة تأهيل سوق “جنان الجامع” في تارودانت'}, {'community_id': '11', 'articles': [{'id': '304', 'title': 'روسيا تشيد بدور الملك محمد السادس في دعم القضية الفلسطينية', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-666785.html', 'summary': 'روسيا تشيد بدور الملك محمد السادس في دعم القضية الفلسطينية. هبة بريس أشادت روسيا الفدرالية، اليوم الخميس، بدور صاحب الجلالة الملك محمد السادس، رئيس لجنة القدس، التابعة لمنظمة التعاون الإسلامي، من أجل التسوية السلمية للقضية الفلسطينية. وقال وزير الشؤون الخارجية الروسي، سيرغي لافروف، في ندوة صحفية مع نظيره المغربي ناصر بوريطة عقب مباحثاتهما بموسكو، إن “المغرب يضطلع تقليديا بدور مهم في دعم الجهود الرامية إلى', 'size': 3}, {'id': '363', 'title': 'القضية الفلسطينية.. روسيا تشيد بدور جلالة الملك رئيس لجنة القدس من أجل التسوية السلمية', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a7%d9%84%d9%82%d8%b6%d9%8a%d8%a9-%d8%a7%d9%84%d9%81%d9%84%d8%b3%d8%b7%d9%8a%d9%86%d9%8a%d8%a9-%d8%b1%d9%88%d8%b3%d9%8a%d8%a7-%d8%aa%d8%b4%d9%8a%d8%af-%d8%a8%d8%af%d9%88%d8%b1-%d8%ac%d9%84%d8%a7/', 'summary': 'القضية الفلسطينية.. روسيا تشيد بدور جلالة الملك رئيس لجنة القدس من أجل التسوية السلمية. أشادت روسيا الفدرالية، اليوم الخميس (16 أكتوبر)، بدور صاحب الجلالة الملك محمد السادس، رئيس لجنة القدس، التابعة لمنظمة التعاون الإسلامي، من أجل التسوية السلمية للقضية الفلسطينية. وقال وزير الشؤون الخارجية الروسي، سيرغي لافروف، في ندوة صحفية مع نظيره المغربي ناصر بوريطة عقب مباحثاتهما بموسكو، إن “المغرب يضطلع تقليديا بدور مهم في دعم الجهود الرامية إلى', 'size': 3}, {'id': '375', 'title': 'روسيا تشيد بدور الملك محمد السادس في دعم التسوية السلمية للقضية الفلسطينية', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/326446/', 'summary': 'روسيا تشيد بدور الملك محمد السادس في دعم التسوية السلمية للقضية الفلسطينية. أشادت روسيا الفدرالية، اليوم الخميس، بدور صاحب الجلالة الملك محمد السادس، رئيس لجنة القدس، التابعة لمنظمة التعاون الإسلامي، من أجل التسوية السلمية للقضية الفلسطينية. وقال وزير الشؤون الخارجية الروسي، سيرغي لافروف، في ندوة صحفية مع نظيره المغربي ناصر بوريطة عقب مباحثاتهما بموسكو، إن “المغرب يضطلع تقليديا بدور مهم في دعم الجهود الرامية إلى التوصل لتسوية', 'size': 3}], 'main_title': 'روسيا تشيد بدور الملك محمد السادس في دعم القضية الفلسطينية'}, {'community_id': '12', 'articles': [{'id': '319', 'title': 'بوريطة: المغرب وروسيا متفقان على عدم تأويل القانون الدولي بما يعرقل حل قضية الصحراء المغربية', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-666740.html', 'summary': 'بوريطة: المغرب وروسيا متفقان على عدم تأويل القانون الدولي بما يعرقل حل قضية الصحراء المغربية. هبة بريس أكد وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج ناصر بوريطة، اليوم الخميس بموسكو، أن المغرب وروسيا متفقان على أنه لا يمكن تأويل القانون والمبادئ الدولية بشكل يعرقل التقدم نحو تسوية قضية الصحراء المغربية. وقال بوريطة، في ندوة صحفية أعقبت مباحثاته مع نظيره الروسي سيرغي لافروف، أن هذا اللقاء شكل فرصة للتطرق إلى', 'size': 5}, {'id': '347', 'title': 'بوريطة: المغرب وروسيا متفقان على أنه لا يمكن تأويل القانون الدولي بشكل يعرقل تسوية قضية الصحراء المغربية', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/politic/414634.html', 'summary': 'بوريطة: المغرب وروسيا متفقان على أنه لا يمكن تأويل القانون الدولي بشكل يعرقل تسوية قضية الصحراء المغربية. أكد وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج ناصر بوريطة، اليوم الخميس بموسكو، أن المغرب وروسيا متفقان على أنه لا يمكن تأويل القانون والمبادئ', 'size': 5}, {'id': '381', 'title': 'بوريطة من روسيا: لا يمكن تأويل القانون الدولي بما يعرقل تسوية قضية الصحراء المغربية', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/326437/', 'summary': 'بوريطة من روسيا: لا يمكن تأويل القانون الدولي بما يعرقل تسوية قضية الصحراء المغربية. أكد وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج ناصر بوريطة، اليوم الخميس بموسكو، أن المغرب وروسيا متفقان على أنه لا يمكن تأويل القانون والمبادئ الدولية بشكل يعرقل التقدم نحو تسوية قضية الصحراء المغربية. وقال بوريطة، في ندوة صحفية أعقبت مباحثاته مع نظيره الروسي سيرغي لافروف، أن هذا اللقاء شكل فرصة للتطرق إلى القضايا الإقليمية', 'size': 5}, {'id': '420', 'title': 'بوريطة: المغرب وروسيا متفقان على أنه لا يمكن تأويل القانون الدولي بشكل يعرقل تسوية قضية الصحراء', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/478891.html', 'summary': 'بوريطة: المغرب وروسيا متفقان على أنه لا يمكن تأويل القانون الدولي بشكل يعرقل تسوية قضية الصحراء. و.م.ع أكد وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج ناصر بوريطة، الخميس بموسكو، أن المغرب وروسيا متفقان على أنه لا يمكن تأويل القانون والمبادئ الدولية بشكل يعرقل التقدم نحو تسوية قضية الصحراء المغربية. وقال بوريطة، في ندوة صحفية أعقبت مباحثاته مع نظيره الروسي سيرغي لافروف، أن هذا اللقاء شكل فرصة للتطرق إلى القضايا الإقليمية …', 'size': 5}, {'id': '445', 'title': 'بوريطة: المغرب وروسيا متفقان على أن القانون الدولي لا يمكن تأويله بشكل يعرقل تسوية قضية الصحراء المغربية', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/228579/', 'summary': 'بوريطة: المغرب وروسيا متفقان على أن القانون الدولي لا يمكن تأويله بشكل يعرقل تسوية قضية الصحراء المغربية. موسكو – أكد وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج ناصر بوريطة، اليوم الخميس بموسكو، أن المغرب وروسيا متفقان على أنه لا يمكن تأويل القانون والمبادئ الدولية بشكل يعرقل التقدم نحو تسوية قضية الصحراء المغربية. وقال السيد بوريطة، في ندوة صحفية أعقبت مباحثاته مع نظيره الروسي سيرغي لافروف، أن هذا اللقاء شكل فرصة للتطرق', 'size': 5}], 'main_title': 'بوريطة: المغرب وروسيا متفقان على عدم تأويل القانون الدولي بما يعرقل حل قضية الصحراء المغربية'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    