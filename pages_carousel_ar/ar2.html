<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 18/06/2025 - 18h30</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '0', 'title': 'وهبي: مراجعة مدونة الأسرة خيار سياسي شجاع ينسجم مع ثوابت الإسلام', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d9%88%d9%87%d8%a8%d9%8a-%d9%85%d8%b1%d8%a7%d8%ac%d8%b9%d8%a9-%d9%85%d8%af%d9%88%d9%86%d8%a9-%d8%a7%d9%84%d8%a3%d8%b3%d8%b1%d8%a9-%d8%ae%d9%8a%d8%a7%d8%b1-%d8%b3%d9%8a%d8%a7%d8%b3%d9%8a-%d8%b4%d8%ac-1577991.html', 'summary': 'وهبي: مراجعة مدونة الأسرة خيار سياسي شجاع ينسجم مع ثوابت الإسلام. أفاد وزير العدل عبد اللطيف وهبي بأن خيار المغرب، بقيادة الملك محمد السادس، مراجعة مدونة الأسرة يعد “اختيارا سياسيا شجاعا، يعكس الإرادة العليا لجعل الإنصاف والعدالة أساساً لكل علاقة داخل الأسرة المغربية”، معتبرا أن “الجرأة السياسية التي تمارس اليوم في هذا الموضوع لا تتناقض والثوابت الإسلامية”. وأضاف وهبي في كلمته خلال الندوة الدولية حول “نظام  وهبي: مراجعة مدونة الأسرة خيار سياسي شجاع ينسجم مع ثوابت الإسلام     - هسبريس جريدة إلكترونية مغربية .', 'size': 2}, {'id': '411', 'title': 'وهبي: إصلاح المدونة جرأة سياسية وإنصاف المرأة المغربية ليس خروجا عن الدين', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1078673.html', 'summary': 'وهبي: إصلاح المدونة جرأة سياسية وإنصاف المرأة المغربية ليس خروجا عن الدين. أكد وزير العدل، عبد اللطيف وهبي، أن المغرب انخرط في ورش استراتيجي لإصلاح مدونة الأسرة، يجسد الإرادة السياسية العليا لترسيخ قيم العدالة والإنصاف داخل الأسرة المغربية، مشيرا إلى أن هذا التوجه الإصلاحي يعكس التزام الدولة، بقيادة الملك محمد السادس، بمساءلة القوانين الاجتماعية وتحيينها وفق تحولات المجتمع وثوابته الدينية والدستورية. جاء ذلك خلال الكلمة التي ألقاها ظهرت المقالة وهبي: إصلاح المدونة جرأة سياسية وإنصاف المرأة المغربية ليس خروجا عن الدين  .', 'size': 2}], 'main_title': 'وهبي: مراجعة مدونة الأسرة خيار سياسي شجاع ينسجم مع ثوابت الإسلام'}, {'community_id': '1', 'articles': [{'id': '70', 'title': 'الرباط: توقيع عقد اتفاق لطبع 3 آلاف نسخة من المصحف الشريف بطريقة“برايل”موجهة للمكفوفين وطنيا وقاريا', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/202213', 'summary': 'الرباط: توقيع عقد اتفاق لطبع 3 آلاف نسخة من المصحف الشريف بطريقة“برايل”موجهة للمكفوفين وطنيا وقاريا. الأحداث من الرباط تم، اليوم الثلاثاء بالرباط، التوقيع على عقد اتفاق بين المنظمة العلوية لرعاية المكفوفين بالمغرب ومؤسسة محمد السادس لنشر المصحف الشريف من أجل طبع 3 آلاف نسخة من المصحف المحمدي الشريف بطريقة “برايل” موجهة للمكفوفين وطنيا وقاريا. وذكر بلاغ مشترك أن هذا الاتفاق،الذي جرى بحضور مسؤولي المؤسستين،يأتي في إطار الجهود المستمرة من أجل', 'size': 2}, {'id': '261', 'title': 'طبع 3 آلاف نسخة من المصحف بطريقة “برايل” موجهة للمكفوفين', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%b7%d8%a8%d8%b9-3-%d8%a2%d9%84%d8%a7%d9%81-%d9%86%d8%b3%d8%ae%d8%a9-%d9%85%d9%86-%d8%a7%d9%84%d9%85%d8%b5%d8%ad%d9%81-%d8%a8%d8%b7%d8%b1%d9%8a%d9%82%d8%a9-%d8%a8%d8%b1%d8%a7%d9%8a%d9%84-%d9%85/', 'summary': 'طبع 3 آلاف نسخة من المصحف بطريقة “برايل” موجهة للمكفوفين. المساء اليوم – الرباط: جرى أمس الثلاثاء بالرباط، التوقيع على عقد اتفاق بين المنظمة العلوية لرعاية المكفوفين بالمغرب ومؤسسة محمد السادس لنشر المصحف الشريف من أجل طبع 3 آلاف نسخة من المصحف المحمدي الشريف بطريقة', 'size': 2}], 'main_title': 'الرباط: توقيع عقد اتفاق لطبع 3 آلاف نسخة من المصحف الشريف بطريقة“برايل”موجهة للمكفوفين وطنيا وقاريا'}, {'community_id': '2', 'articles': [{'id': '103', 'title': 'كوثر بودراجة بخير وعلى قيد الحياة.. شائعة وفاتها تثير جدلًا واسعًا وردود فعل غاضبة', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/culture/407740.html', 'summary': 'كوثر بودراجة بخير وعلى قيد الحياة.. شائعة وفاتها تثير جدلًا واسعًا وردود فعل غاضبة. ضجّت منصات التواصل الاجتماعي مساء اليوم الثلاثاء بخبر كاذب عن وفاة الإعلامية المغربية كوثر بودراجة، ما أثار موجة من القلق والحزن وسط متابعيها ورواد الإعلام،', 'size': 2}, {'id': '423', 'title': 'شائعة وفاة بودراجة..أسرتها تتوعد بالقضاء وفنانون يدعون  بالشفاء', 'source': 'soltana.ma', 'link': 'https://soltana.ma/1357446.html', 'summary': 'شائعة وفاة بودراجة..أسرتها تتوعد بالقضاء وفنانون يدعون بالشفاء. انتشرت خلال الساعات الماضية شائعة وفاة الإعلامية والممثلة المغربية كوثر بودراجة، الأمر الذي أثار موجة من القلق والحزن على مواقع التواصل الاجتماعي، قبل أن يتبين أن الخبر لا أساس له من الصحة. وفي هذا الصدد، خرجت أسرة بودراجة عن صمتها، مؤكدة في بلاغ رسمي على أن كوثر لا تزال على قيد الحياة، لكنها تمر بوعكة', 'size': 2}], 'main_title': 'كوثر بودراجة بخير وعلى قيد الحياة.. شائعة وفاتها تثير جدلًا واسعًا وردود فعل غاضبة'}, {'community_id': '3', 'articles': [{'id': '159', 'title': 'تشغيل الاطفالب المغرب.. تراجع في الأرقام لكن الخطر مستمر', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/315858/', 'summary': 'تشغيل الاطفالب المغرب.. تراجع في الأرقام لكن الخطر مستمر. رغم التراجع الملحوظ في أعداد الأطفال المشتغلين بالمغرب خلال السنوات الأخيرة، إلا أن معضلة تشغيل القاصرين لا تزال تؤرق الضمير الجماعي، خصوصا حينما تكشف الأرقام عن ارتباطها العميق بالفقر، والهشاشة الاجتماعية، وانقطاع التمدرس، بل وأحيانا بتطبيع مجتمعي يجعل من “العمل المبكر” وسيلة للعيش وليس مأساة يجب تداركها. وبحسب مذكرة حديثة للمندوبية السامية للتخطيط، بمناسبة', 'size': 2}, {'id': '406', 'title': 'توجيه جديد لتقييم التعليم الابتدائي بالمغرب..\xa0نحو تبسيط وتقليص العبء على التلاميذ', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1078725.html', 'summary': 'توجيه جديد لتقييم التعليم الابتدائي بالمغرب.. نحو تبسيط وتقليص العبء على التلاميذ. يواصل المغرب تنظيم امتحانات جهوية في نهاية المرحلة الابتدائية، رغم أن هذه الامتحانات لا تمثل سوى 25% فقط من المجموع النهائي للنقط المحصل عليها من طرف التلميذ. هذه الممارسة التي تثقل كاهل ميزانية الدولة وتستنزف موارد بشرية ومادية كبيرة، تثير نقاشاً مستحقاً حول فعاليتها الحقيقية. نهاك تأثيرها النفسي على الأطفال، وتكاليفها اللوجستيكية والاقتصادية، وملاءمتها التربوية ظهرت المقالة توجيه جديد لتقييم التعليم الابتدائي بالمغرب.. نحو تبسيط وتقليص العبء على التلاميذ  .', 'size': 2}], 'main_title': 'تشغيل الاطفالب المغرب.. تراجع في الأرقام لكن الخطر مستمر'}, {'community_id': '4', 'articles': [{'id': '169', 'title': 'هذا ماقاله مدرب الوداد عن مباراة السيتي', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-575738.html', 'summary': 'هذا ماقاله مدرب الوداد عن مباراة السيتي. قال محمد أمين بنهاشم، مدرب الوداد الرياضي، إن فريقه لن يكون لقمة سهلة لخصومه في كأس العالم للأندية، مؤكدا أن كتيبته تسعى لتقديم أداء جيد أمام مانشستر سيتي، في المباراة التي ستجمع بين الطرفين اليوم الأربعاء ابتداء من الساعة الخامسة بالتوقيت المغربي، لحساب الجولة الأولى من دور مجموعات المسابقة. وأضاف بنهاشم، في المؤتمر الصحفي', 'size': 2}, {'id': '476', 'title': 'قبيل مواجهة “السيتي”.. بنهاشم واثق من قدرة الوداد على “المنافسة والقتال”', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d9%82%d8%a8%d9%8a%d9%84-%d9%85%d9%88%d8%a7%d8%ac%d9%87%d8%a9-%d8%a7%d9%84%d8%b3%d9%8a%d8%aa%d9%8a-%d8%a8%d9%86%d9%87%d8%a7%d8%b4%d9%85-%d9%88%d8%a7%d8%ab%d9%82-%d9%85%d9%86-%d9%82%d8%af%d8%b1/', 'summary': 'قبيل مواجهة “السيتي”.. بنهاشم واثق من قدرة الوداد على “المنافسة والقتال”. المساء اليوم: يخوض فريق الوداد الرياضي البيضاوي، مساء اليوم الأربعاء، أولى مبارياته في منافسات كأس العالم للأندية المقامة في الولايات المتحدة الأمريكية، والتي سيواجه فيها فريق مانشستر سيتي الإنجليزي. وقال محمد أمين بنهاشم مدرب الوداد،', 'size': 2}], 'main_title': 'هذا ماقاله مدرب الوداد عن مباراة السيتي'}, {'community_id': '11', 'articles': [{'id': '177', 'title': 'طقس الأربعاء.. زخات رعدية ورياح قوية بهذه المناطق', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-575685.html', 'summary': 'طقس الأربعاء.. زخات رعدية ورياح قوية بهذه المناطق. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الأربعاء، أن تتميز الحالة الجوية عامة، بطقس حار بكل من السهول الداخلية الشمالية والوسطى والجنوب الشرقي وداخل الأقاليم الجنوبية للبلاد. كما سيلاحظ تمركز خلايا رعدية مرفوقة بقطرات مطرية أو بزخات وبرد مع هبوب رياح قوية تحت الرعد فوق كل من مرتفعات الأطلس وسفوح الأطلس الكبير', 'size': 3}, {'id': '207', 'title': 'استمرار الطقس الحار اليوم الأربعاء', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a7%d8%b3%d8%aa%d9%85%d8%b1%d8%a7%d8%b1-%d8%a7%d9%84%d8%b7%d9%82%d8%b3-%d8%a7%d9%84%d8%ad%d8%a7%d8%b1-%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%a3%d8%b1%d8%a8%d8%b9%d8%a7%d8%a1-2/', 'summary': 'استمرار الطقس الحار اليوم الأربعاء. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الأربعاء، أن تتميز الحالة الجوية عامة، بطقس حار بكل من السهول الداخلية الشمالية والوسطى والجنوب الشرقي وداخل الأقاليم الجنوبية للبلاد. كما سيلاحظ تمركز خلايا رعدية مرفوقة بقطرات مطرية أو بزخات وبرد مع هبوب رياح قوية تحت الرعد فوق كل من مرتفعات الأطلس وسفوح الأطلس الكبير وولماس وشمال السايس  استمرار الطقس الحار اليوم الأربعاء     .', 'size': 4}, {'id': '208', 'title': 'توقعات أحوال الطقس لليوم الأربعاء', 'source': 'soltana.ma', 'link': 'https://soltana.ma/1357440.html', 'summary': 'توقعات أحوال الطقس لليوم الأربعاء. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليومه الأربعاء، أن تتميز الحالة الجوية عامة، بطقس حار بكل من السهول الداخلية الشمالية والوسطى والجنوب الشرقي وداخل الأقاليم الجنوبية للبلاد. كما سيلاحظ تمركز خلايا رعدية مرفوقة بقطرات مطرية أو بزخات وبرد مع هبوب رياح قوية تحت الرعد فوق كل من مرتفعات الأطلس وسفوح الأطلس الكبير وولماس وشمال السايس', 'size': 5}, {'id': '251', 'title': 'طقس الأربعاء.. حار مع قطرات مطرية رعدية في بعض المناطق', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/223053/', 'summary': 'طقس الأربعاء.. حار مع قطرات مطرية رعدية في بعض المناطق. كواليس اليوم تتوقع المديرية العامة للأرصاد الجوية، اليوم الأربعاء، أن تتميز الحالة الجوية عامة، بطقس حار بكل من السهول الداخلية الشمالية والوسطى والجنوب الشرقي وداخل الأقاليم الجنوبية للبلاد. كما سيلاحظ تمركز خلايا رعدية مرفوقة بقطرات مطرية أو بزخات وبرد مع هبوب رياح قوية تحت الرعد فوق كل من مرتفعات الأطلس وسفوح الأطلس الكبير وولماس', 'size': 5}, {'id': '277', 'title': 'توقعات أحوال الطقس اليوم الأربعاء', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%aa%d9%88%d9%82%d8%b9%d8%a7%d8%aa-%d8%a3%d8%ad%d9%88%d8%a7%d9%84-%d8%a7%d9%84%d8%b7%d9%82%d8%b3-%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%a3%d8%b1%d8%a8%d8%b9%d8%a7%d8%a1-24/', 'summary': 'توقعات أحوال الطقس اليوم الأربعاء. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليومه الأربعاء، أن تتميز الحالة الجوية عامة، بطقس حار بكل من السهول الداخلية الشمالية والوسطى والجنوب الشرقي وداخل الأقاليم الجنوبية للبلاد. كما سيلاحظ تمركز خلايا رعدية مرفوقة بقطرات مطرية أو بزخات وبرد مع هبوب رياح قوية تحت الرعد فوق كل من مرتفعات الأطلس وسفوح الأطلس الكبير وولماس …  توقعات أحوال الطقس اليوم الأربعاء     .', 'size': 4}], 'main_title': 'توقعات أحوال الطقس لليوم الأربعاء'}, {'community_id': '9', 'articles': [{'id': '220', 'title': 'وزير خارجية بنما يؤكد أن المغرب شريك هام لدول أمريكا الوسطى', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/466826.html', 'summary': 'وزير خارجية بنما يؤكد أن المغرب شريك هام لدول أمريكا الوسطى. أكد وزير خارجية جمهورية بنما، خافيير مارتينيز-آشا فاسكيز، أن الدينامية الجديدة التي تشهدها العلاقات الثنائية من شأنها أن تجعل من بنما جسرا لانفتاح المغرب على أمريكا الوسطى،', 'size': 2}, {'id': '456', 'title': 'وزير الخارجية البنمي يؤكد أن المغرب شريك هام لدول أمريكا الوسطى', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d9%88%d8%b2%d9%8a%d8%b1-%d8%a7%d9%84%d8%ae%d8%a7%d8%b1%d8%ac%d9%8a%d8%a9-%d8%a7%d9%84%d8%a8%d9%86%d9%85%d9%8a-%d9%8a%d8%a4%d9%83%d8%af-%d8%a3%d9%86-%d8%a7%d9%84%d9%85%d8%ba%d8%b1%d8%a8-%d8%b4%d8%b1/', 'summary': 'وزير الخارجية البنمي يؤكد أن المغرب شريك هام لدول أمريكا الوسطى.  – و م ع أكد وزير خارجية جمهورية بنما، خافيير مارتينيز-آشا فاسكيز، أن الدينامية الجديدة التي تشهدها العلاقات الثنائية من شأنها أن تجعل من بنما جسرا لانفتاح المغرب...  وزير الخارجية البنمي يؤكد أن المغرب شريك هام لدول أمريكا الوسطى     .', 'size': 2}], 'main_title': 'وزير خارجية بنما يؤكد أن المغرب شريك هام لدول أمريكا الوسطى'}, {'community_id': '12', 'articles': [{'id': '376', 'title': 'لقجع: المغرب ملتزم بجعل مونديال 2030 نموذجا للاندماج والاستدامة البيئية', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/315883/', 'summary': 'لقجع: المغرب ملتزم بجعل مونديال 2030 نموذجا للاندماج والاستدامة البيئية. أكد الوزير المنتدب المكلف بالميزانية، ورئيس الجامعة الملكية المغربية لكرة القدم، فوزي لقجع، اليوم الأربعاء بسلا الجديدة، أن المغرب ملتزم بشكل حازم بجعل كأس العالم 2030 نموذجا للاستدامة البيئية والاندماج الاجتماعي، وبتنظيم هذا المونديال في إطار دينامية شاملة للانتقال البيئي. وقال لقجع، وهو رئيس لجنة كأس العالم 2030، خلال لقاء نظم بجامعة محمد السادس متعددة', 'size': 2}, {'id': '424', 'title': 'لقجع: مونديال 2030 صديق للبيئة والمغرب أصبح فاعلا رئيسيا في كرة القدم العالمية', 'source': 'rue20.com', 'link': 'https://rue20.com/913962.html', 'summary': 'لقجع: مونديال 2030 صديق للبيئة والمغرب أصبح فاعلا رئيسيا في كرة القدم العالمية.  | الرباط أكد الوزير المنتدب المكلف بالميزانية، ورئيس الجامعة الملكية المغربية لكرة القدم، فوزي لقجع، اليوم الأربعاء بسلا الجديدة، أن المغرب ملتزم بشكل حازم بجعل كأس العالم 2030 نموذجا للاستدامة البيئية والاندماج الاجتماعي، وبتنظيم هذا المونديال في إطار دينامية شاملة للانتقال البيئي. وقال لقجع، وهو رئيس لجنة كأس العالم 2030، خلال لقاء نظم الخبر لقجع: مونديال 2030 صديق للبيئة والمغرب أصبح فاعلا رئيسيا في كرة القدم العالمية  .', 'size': 2}], 'main_title': 'لقجع: المغرب ملتزم بجعل مونديال 2030 نموذجا للاندماج والاستدامة البيئية'}, {'community_id': '7', 'articles': [{'id': '400', 'title': 'المغرب يسجل رقما قياسيا جديدا باستقبال 7,2 مليون سائح بنهاية ماي 2025', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1078741.html', 'summary': 'المغرب يسجل رقما قياسيا جديدا باستقبال 7,2 مليون سائح بنهاية ماي 2025. أعلنت وزارة السياحة والصناعة التقليدية والاقتصاد الاجتماعي والتضامني أن قطاع السياحة بالمغرب سجل رقما قياسيا جديدا باستقبال 7,2 مليون سائح حتى نهاية ماي 2025، بنمو ملحوظ نسبته 22 في المائة مقارنة بنفس الفترة من سنة 2024. وأبرزت الوزارة، في بلاغ لها اليوم الأربعاء، أن “هذا الأداء يمثل 1,3 مليون سائح إضافي ونموا كبيرا بنسبة 68 ظهرت المقالة المغرب يسجل رقما قياسيا جديدا باستقبال 7,2 مليون سائح بنهاية ماي 2025  .', 'size': 3}, {'id': '420', 'title': 'رقم قياسي جديد.. 7.2 ملايين سائح يصلون المغرب حتى نهاية ماي', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%b1%d9%82%d9%85-%d9%82%d9%8a%d8%a7%d8%b3%d9%8a-%d8%ac%d8%af%d9%8a%d8%af-7-2-%d9%85%d9%84%d8%a7%d9%8a%d9%8a%d9%86-%d8%b3%d8%a7%d8%a6%d8%ad-%d9%8a%d8%b5%d9%84%d9%88%d9%86-%d8%a7%d9%84%d9%85%d8%ba/', 'summary': 'رقم قياسي جديد.. 7.2 ملايين سائح يصلون المغرب حتى نهاية ماي. أعلنت وزارة السياحة والصناعة التقليدية والاقتصاد الاجتماعي والتضامني أن قطاع السياحة بالمغرب سجل رقما قياسيا جديدا باستقبال 7,2 ملايين سائح حتى نهاية ماي 2025، بنمو ملحوظ نسبته 22 في المائة مقارنة بنفس الفترة من سنة 2024. وأبرزت الوزارة، في بلاغ لها اليوم الأربعاء، أن "هذا الأداء يمثل 1,3 مليون سائح إضافي ونموا كبيرا بنسبة 68  رقم قياسي جديد.. 7.2 ملايين سائح يصلون المغرب حتى نهاية ماي     .', 'size': 3}, {'id': '464', 'title': 'المغرب يسجل رقما قياسيا جديدا في القطاع السياحي', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/223079/', 'summary': 'المغرب يسجل رقما قياسيا جديدا في القطاع السياحي. وكالات أعلنت وزارة السياحة والصناعة التقليدية والاقتصاد الاجتماعي والتضامني أن قطاع السياحة بالمغرب سجل رقما قياسيا جديدا باستقبال 7,2 مليون سائح حتى نهاية ماي 2025، بنمو ملحوظ نسبته 22 في المائة مقارنة بنفس الفترة من سنة 2024. وأبرزت الوزارة، في بلاغ لها اليوم الأربعاء، أن “هذا الأداء يمثل 1,3 مليون سائح إضافي ونموا كبيرا', 'size': 3}], 'main_title': 'المغرب يسجل رقما قياسيا جديدا باستقبال 7,2 مليون سائح بنهاية ماي 2025'}, {'community_id': '6', 'articles': [{'id': '401', 'title': 'رئيس النيابة العامة: الكد والسعاية مبدأ أصيل ينصف المرأة داخل مؤسسة الزواج', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1078713.html', 'summary': 'رئيس النيابة العامة: الكد والسعاية مبدأ أصيل ينصف المرأة داخل مؤسسة الزواج. أكد هشام بلاوي، الوكيل العام للملك لدى محكمة النقض ورئيس النيابة العامة، أن الكد والسعاية شكّل عبر التاريخ أحد الحلول الفقهية الأصيلة التي استجاب بها العلماء والقضاة للنوازل المجتمعية، مبرزين من خلالها فهماً عميقاً لمقاصد الشريعة الإسلامية، ومؤسسين لقاعدة فقهية تقوم على قيم الإنصاف والعدل، بالاعتراف بالجهد الذي تبذله المرأة في تنمية المال الأسري، خاصة ظهرت المقالة رئيس النيابة العامة: الكد والسعاية مبدأ أصيل ينصف المرأة داخل مؤسسة الزواج  .', 'size': 2}, {'id': '418', 'title': 'نظام الكد والسعاية.. بلاوي: رصيد العمل القضائي ينسجم مع تطور القانون الدولي لحقوق الإنسان', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%86%d8%b8%d8%a7%d9%85-%d8%a7%d9%84%d9%83%d8%af-%d9%88%d8%a7%d9%84%d8%b3%d8%b9%d8%a7%d9%8a%d8%a9-%d8%a8%d9%84%d8%a7%d9%88%d9%8a-%d8%b1%d8%b5%d9%8a%d8%af-%d8%a7%d9%84%d8%b9%d9%85%d9%84-%d8%a7/', 'summary': 'نظام الكد والسعاية.. بلاوي: رصيد العمل القضائي ينسجم مع تطور القانون الدولي لحقوق الإنسان. كشف هشام بلاوي أن موضوع الكد والسعاية بالنسبة للمرأة شكل أحد الحلول الفقهية التي تعكس الاجتهاد المنفتح في إطار النوازل التي كانت تُعْرض على الفقهاء والقضاة، الذين كانوا يجتهدون لإيجاد حلول لها في إطار مقاصد الشريعة الإسلامية السمحاء، حيث أسَّسُوا لهذا المبدأ، الذي يعتبر تجسيدا لقيم العدالة والإنصاف، وتكريسا للاعتراف بقيمة المجهودات المبذولة من طرف  نظام الكد والسعاية.. بلاوي: رصيد العمل القضائي ينسجم مع تطور القانون الدولي لحقوق الإنسان     .', 'size': 2}], 'main_title': 'رئيس النيابة العامة: الكد والسعاية مبدأ أصيل ينصف المرأة داخل مؤسسة الزواج'}, {'community_id': '13', 'articles': [{'id': '405', 'title': 'وزير الفلاحة يعلن عن نظام رقمي جديد لإنهاء التلاعب في بيانات الثروة الحيوانية', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1078717.html', 'summary': 'وزير الفلاحة يعلن عن نظام رقمي جديد لإنهاء التلاعب في بيانات الثروة الحيوانية. كشف وزير الفلاحة والصيد البحري والتنمية القروية والمياه والغابات، أحمد البواري، عن اعتماد منظومة رقمية متطورة لإحصاء إناث الأغنام والماعز، في خطوة تهدف إلى تحديث تدبير الثروة الحيوانية وتحسين نجاعة الدعم الموجه للكسابة، وذلك في إطار الاستراتيجية الوطنية الرامية إلى تحقيق السيادة الغذائية وتحديث أساليب العمل داخل القطاع الفلاحي. وأكد الوزير، خلال عرض قدمه أمام ظهرت المقالة وزير الفلاحة يعلن عن نظام رقمي جديد لإنهاء التلاعب في بيانات الثروة الحيوانية  .', 'size': 2}, {'id': '444', 'title': 'وزير الفلاحة: الشروع في تنزيل برنامج دعم مربي الماشية وإعادة تكوين القطيع الوطني', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d9%88%d8%b2%d9%8a%d8%b1-%d8%a7%d9%84%d9%81%d9%84%d8%a7%d8%ad%d8%a9-%d8%a7%d9%84%d8%b4%d8%b1%d9%88%d8%b9-%d9%81%d9%8a-%d8%aa%d9%86%d8%b2%d9%8a%d9%84-%d8%a8%d8%b1%d9%86%d8%a7%d9%85%d8%ac-%d8%af%d8%b9/', 'summary': 'وزير الفلاحة: الشروع في تنزيل برنامج دعم مربي الماشية وإعادة تكوين القطيع الوطني.  – و م ع أكد وزير الفلاحة والصيد البحري والتنمية القروية والمياه والغابات، أحمد البواري، اليوم الأربعاء بمجلس النواب، أنه تم الشروع في تنزيل برنامج دعم مربي الماشية...  وزير الفلاحة: الشروع في تنزيل برنامج دعم مربي الماشية وإعادة تكوين القطيع الوطني     .', 'size': 2}, {'id': '471', 'title': 'الشروع في تنزيل برنامج دعم مربي الماشية وإعادة تكوين القطيع', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%a7%d9%84%d8%b4%d8%b1%d9%88%d8%b9-%d9%81%d9%8a-%d8%aa%d9%86%d8%b2%d9%8a%d9%84-%d8%a8%d8%b1%d9%86%d8%a7%d9%85%d8%ac-%d8%af%d8%b9%d9%85-%d9%85%d8%b1%d8%a8%d9%8a-%d8%a7%d9%84%d9%85%d8%a7%d8%b4%d9%8a/', 'summary': 'الشروع في تنزيل برنامج دعم مربي الماشية وإعادة تكوين القطيع. المساء اليوم: قال وزير الفلاحة والصيد البحري والتنمية القروية والمياه والغابات، أحمد البواري، اليوم الأربعاء بمجلس النواب، إنه تم الشروع في تنزيل برنامج دعم مربي الماشية وإعادة تكوين القطيع الوطني، بتعاون وثيق بين الوزارات المعنية.', 'size': 3}], 'main_title': 'الشروع في تنزيل برنامج دعم مربي الماشية وإعادة تكوين القطيع'}, {'community_id': '8', 'articles': [{'id': '407', 'title': 'المجلس الاقتصادي يحذر: العمل عن بعد وبالمنصات الرقمية خارج حماية القانون', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1078670.html', 'summary': 'المجلس الاقتصادي يحذر: العمل عن بعد وبالمنصات الرقمية خارج حماية القانون. أكد المجلس الاقتصادي والاجتماعي والبيئي أن الأشكال اللانمطية للتشغيل خصوصا منها العمل عن بُعد، والعمل عبر المنصات الرقمية، والعمل لبعض الوقت، رغم ما تحمله من مزايا، تطرح إشكالات جدية تتعلق بعدم ملاءمة الإطار القانوني السائد مع هذه الأشكال الناشئة، والهشاشة الأجرية، وغياب الحماية الاجتماعية، والتأثير على التوازن بين الحياة المهنية والشخصية، داعياً إلى إعادة النظر ظهرت المقالة المجلس الاقتصادي يحذر: العمل عن بعد وبالمنصات الرقمية خارج حماية القانون  .', 'size': 2}, {'id': '421', 'title': 'المجلس الاقتصادي يوصي الحكومة بالتأطير القانوني للعمل عن بعد وعبر المنصات والتطبيقات الرقمية', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a7%d9%84%d9%85%d8%ac%d9%84%d8%b3-%d8%a7%d9%84%d8%a7%d9%82%d8%aa%d8%b5%d8%a7%d8%af%d9%8a-%d9%8a%d9%88%d8%b5%d9%8a-%d8%a7%d9%84%d8%ad%d9%83%d9%88%d9%85%d8%a9-%d8%a8%d8%a7%d9%84%d8%aa%d8%a3%d8%b7/', 'summary': 'المجلس الاقتصادي يوصي الحكومة بالتأطير القانوني للعمل عن بعد وعبر المنصات والتطبيقات الرقمية. أوصى المجلس الاقتصادي والاجتماعي والبيئي، اليوم الأربعاء، بالتأطير القانوني للأشكال اللانمطية للتشغيل بما يضمن تنافسية المقاولة ومعايير العمل اللائق. وشدد المجلس، خلال لقاء تواصلي نظمه بالرباط لتقديم مخرجات رأيه حول موضوع "الأشكال اللانمطية للتشغيل والعلاقات المهنية: تحديات جديدة وفرص ناشئة"، على أهمية الاعتراف القانوني بالأشكال اللانمطية للتشغيل وضمان معايير العمل اللائق فيها، وتمكين العاملات والعاملين  المجلس الاقتصادي يوصي الحكومة بالتأطير القانوني للعمل عن بعد وعبر المنصات والتطبيقات الرقمية     .', 'size': 3}, {'id': '463', 'title': 'مجلس عمارة يوصي بالتأطير القانوني للأشكال اللانمطية للتشغيل', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/223084/', 'summary': 'مجلس عمارة يوصي بالتأطير القانوني للأشكال اللانمطية للتشغيل. كواليس اليوم أوصى المجلس الاقتصادي والاجتماعي والبيئي، اليوم الأربعاء، بالتأطير القانوني للأشكال اللانمطية للتشغيل بما يضمن تنافسية المقاولة ومعايير العمل اللائق. وشدد المجلس، خلال لقاء تواصلي نظمه بالرباط لتقديم مخرجات رأيه حول موضوع “الأشكال اللانمطية للتشغيل والعلاقات المهنية: تحديات جديدة وفرص ناشئة”، على أهمية الاعتراف القانوني بالأشكال اللانمطية للتشغيل وضمان معايير العمل اللائق فيها،', 'size': 2}], 'main_title': 'المجلس الاقتصادي يوصي الحكومة بالتأطير القانوني للعمل عن بعد وعبر المنصات والتطبيقات الرقمية'}, {'community_id': '5', 'articles': [{'id': '433', 'title': 'بعد مالي وإثيوبيا.. رواندا تستعين بالمغرب في المجال العسكري', 'source': 'rue20.com', 'link': 'https://rue20.com/913931.html', 'summary': 'بعد مالي وإثيوبيا.. رواندا تستعين بالمغرب في المجال العسكري.  | الرباط تنفيذا للتعليمات الملكية السامية، استقبل الوزير المنتدب لدى رئيس الحكومة المكلف بإدارة الدفاع الوطني، عبد اللطيف لوديي، اليوم الأربعاء بمقر هذه الإدارة، وزير الدفاع بجمهورية رواندا، جوفينال ماريزاموندا، مرفوقا بوفد هام يقوم بزيارة عمل للمملكة، بمشاركة سفيرة جمهورية رواندا المعتمدة بالرباط. وذكر بلاغ لإدارة الدفاع الوطني أن هذه الزيارة، التي تندرج الخبر بعد مالي وإثيوبيا.. رواندا تستعين بالمغرب في المجال العسكري  .', 'size': 2}, {'id': '465', 'title': 'تنفيذا للتعليمات الملكية.. لوديي يستقبل وزير الدفاع الرواندي', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/223076/', 'summary': 'تنفيذا للتعليمات الملكية.. لوديي يستقبل وزير الدفاع الرواندي. كواليس اليوم تنفيذا للتعليمات الملكية السامية، استقبل الوزير المنتدب لدى رئيس الحكومة المكلف بإدارة الدفاع الوطني، عبد اللطيف لوديي، اليوم الأربعاء بمقر هذه الإدارة، وزير الدفاع بجمهورية رواندا، جوفينال ماريزاموندا، مرفوقا بوفد هام يقوم بزيارة عمل للمملكة، بمشاركة سفيرة جمهورية رواندا المعتمدة بالرباط. وذكر بلاغ لإدارة الدفاع الوطني أن هذه الزيارة، التي تندرج في', 'size': 3}, {'id': '478', 'title': 'لوديي يستقبل بالرباط وزير الدفاع بجمهورية رواندا', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%84%d9%88%d8%af%d9%8a%d9%8a-%d9%8a%d8%b3%d8%aa%d9%82%d8%a8%d9%84-%d8%a8%d8%a7%d9%84%d8%b1%d8%a8%d8%a7%d8%b7-%d9%88%d8%b2%d9%8a%d8%b1-%d8%a7%d9%84%d8%af%d9%81%d8%a7%d8%b9-%d8%a8%d8%ac%d9%85%d9%87/', 'summary': 'لوديي يستقبل بالرباط وزير الدفاع بجمهورية رواندا. استقبل الوزير المنتدب لدى رئيس الحكومة المكلف بإدارة الدفاع الوطني، عبد اللطيف لوديي، اليوم الأربعاء، بمقر هذه الإدارة، وزير الدفاع بجمهورية رواندا، جوفينال ماريزاموندا، مرفوقا بوفد هام يقوم بزيارة عمل للمملكة، بمشاركة سفيرة جمهورية رواندا المعتمدة بالرباط، وذلك تنفيذا للتعليمات الملكية السامية. وذكر بلاغ لإدارة الدفاع الوطني، أن هذه الزيارة، التي تندرج في …  لوديي يستقبل بالرباط وزير الدفاع بجمهورية رواندا     .', 'size': 2}], 'main_title': 'تنفيذا للتعليمات الملكية.. لوديي يستقبل وزير الدفاع الرواندي'}, {'community_id': '10', 'articles': [{'id': '466', 'title': 'نشرة إنذارية.. زخات رعدية مع رياح مرتقبة اليوم الأربعاء وغد الخميس', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/223073/', 'summary': 'نشرة إنذارية.. زخات رعدية مع رياح مرتقبة اليوم الأربعاء وغد الخميس. كواليس اليوم أفادت المديرية العامة للأرصاد الجوية بأنه يرتقب تسجيل طقس حار، وزخات رعدية مصحوبة بتساقط للبرد وبهبات رياح، من اليوم الأربعاء إلى الخميس، بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة “برتقالي”، أنه يرتقب تسجيل زخات رعدية مصحوبة بتساقط للبرد وبهبات رياح (من 15 إلى 25 ملم) ستهم عمالات', 'size': 2}, {'id': '480', 'title': 'نشرة إنذارية..طقس حار وزخات رعدية مصحوبة بتساقط للبرد وبهبات رياح مرتقبة بعدد من مناطق المملكة', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%86%d8%b4%d8%b1%d8%a9-%d8%a5%d9%86%d8%b0%d8%a7%d8%b1%d9%8a%d8%a9-%d8%b7%d9%82%d8%b3-%d8%ad%d8%a7%d8%b1-%d9%88%d8%b2%d8%ae%d8%a7%d8%aa-%d8%b1%d8%b9%d8%af%d9%8a%d8%a9-%d9%85%d8%b5%d8%ad%d9%88%d8%a8/', 'summary': 'نشرة إنذارية..طقس حار وزخات رعدية مصحوبة بتساقط للبرد وبهبات رياح مرتقبة بعدد من مناطق المملكة. أفادت المديرية العامة للأرصاد الجوية، بأنه يرتقب تسجيل طقس حار، وزخات رعدية مصحوبة بتساقط للبرد وبهبات رياح، من اليوم الأربعاء إلى الخميس، بعدد من مناطق المملكة. وأوضحت المديرية، في نشرة إنذارية من مستوى يقظة “برتقالي”، أنه يرتقب تسجيل زخات رعدية مصحوبة بتساقط للبرد وبهبات رياح (من 15 إلى 25 ملم) ستهم عمالات وأقاليم …  نشرة إنذارية..طقس حار وزخات رعدية مصحوبة بتساقط للبرد وبهبات رياح مرتقبة بعدد من مناطق المملكة     .', 'size': 2}], 'main_title': 'نشرة إنذارية.. زخات رعدية مع رياح مرتقبة اليوم الأربعاء وغد الخميس'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    