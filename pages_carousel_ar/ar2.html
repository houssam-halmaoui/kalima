<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 30/07/2025 - 12h27</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '10', 'title': '"حزب الأحرار" يشيد بالأوراش الملكية', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d8%ad%d8%b2%d8%a8-%d8%a7%d9%84%d8%a3%d8%ad%d8%b1%d8%a7%d8%b1-%d9%8a%d8%b4%d9%8a%d8%af-%d8%a8%d8%a7%d9%84%d8%a3%d9%88%d8%b1%d8%a7%d8%b4-%d8%a7%d9%84%d9%85%d9%84%d9%83%d9%8a%d8%a9-1601285.html', 'summary': '"حزب الأحرار" يشيد بالأوراش الملكية. قال حزب “التجمع الوطني للأحرار” إنه تتبع باعتزاز كبير نص الخطاب السامي الذي وجهه الملك محمد السادس، مساء الثلاثاء، إلى شعبه الوفي بمناسبة الذكرى السادسة والعشرين لتربعه على عرش أسلافه المنعمين. وأشار حزب التجمع الوطني للأحرار، في بلاغ له، إلى أنه يتشرف، بهذه المناسبة المجيدة، بتقديم أسمى عبارات الولاء والإخلاص، وأحر التهاني وأصدق المتمنيات للملك  "حزب الأحرار" يشيد بالأوراش الملكية     - هسبريس جريدة إلكترونية مغربية .', 'size': 3}, {'id': '158', 'title': 'الأحرار: خطاب العرش رسم معالم التنمية الشاملة.. والحزب يعلن التزامه بالتنفيذ', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1089345.html', 'summary': 'الأحرار: خطاب العرش رسم معالم التنمية الشاملة.. والحزب يعلن التزامه بالتنفيذ. عبّر حزب التجمع الوطني للأحرار عن اعتزازه الكبير بمضامين الخطاب الذي وجهه الملك محمد السادس، إلى الشعب المغربي مساء الثلاثاء 29 يوليوز 2025، بمناسبة الذكرى السادسة والعشرين لتربعه على العرش. وفي بلاغ صحفي صادر عن الحزب، أبدى “الأحرار” اعتزازه العميق بالإنجازات التي راكمتها المملكة المغربية خلال 26 سنة من حكم الملك محمد السادس، معبرا عن ظهرت المقالة الأحرار: خطاب العرش رسم معالم التنمية الشاملة.. والحزب يعلن التزامه بالتنفيذ  .', 'size': 3}, {'id': '182', 'title': 'الأحرار يشيد بخطاب العرش ويسجل بافتخار الإنجازات المحققة خلال 26 سنة تحت قيادة جلالة الملك', 'source': 'rue20.com', 'link': 'https://rue20.com/925059.html', 'summary': 'الأحرار يشيد بخطاب العرش ويسجل بافتخار الإنجازات المحققة خلال 26 سنة تحت قيادة جلالة الملك.  الرباط عبر حزب التجمع الوطني للأحرار عن اعتزازه الكبير بمضامين الخطاب الملكي السامي، الذي وجهه جلالة الملك محمد السادس يومه الثلاثاء إلى الشعب المغربي بمناسبة الذكرى الـ26 لعيد العرش، مثمناً ما حمله من توجيهات استراتيجية ترسم ملامح المرحلة المقبلة. وفي بلاغ له تقدم الحزب بـ”أسمى عبارات التهاني والولاء والإخلاص إلى جلالة الملك، مرفوقة بمشاعر الخبر الأحرار يشيد بخطاب العرش ويسجل بافتخار الإنجازات المحققة خلال 26 سنة تحت قيادة جلالة الملك  .', 'size': 4}, {'id': '237', 'title': 'حزب التجمع الوطني للأحرار يشيد بخطاب العرش ويجدد الولاء للملك محمد السادس', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%ad%d8%b2%d8%a8-%d8%a7%d9%84%d8%aa%d8%ac%d9%85%d8%b9-%d8%a7%d9%84%d9%88%d8%b7%d9%86%d9%8a-%d9%84%d9%84%d8%a3%d8%ad%d8%b1%d8%a7%d8%b1-%d9%8a%d8%b4%d9%8a%d8%af-%d8%a8%d8%ae%d8%b7%d8%a7%d8%a8-%d8%a7/', 'summary': 'حزب التجمع الوطني للأحرار يشيد بخطاب العرش ويجدد الولاء للملك محمد السادس. أصدر حزب التجمع الوطني للأحرار بلاغا صحفيا أشاد فيه بمضامين الخطاب الملكي السامي الذي وجهه الملك محمد السادس بمناسبة الذكرى السادسة والعشرين لتربعه على العرش، مؤكدًا أسمى عبارات الولاء والإخلاص للعرش العلوي الشريف، وأعرب الحزب عن فخره واعتزازه بالإنجازات المتعددة التي تحققت في المملكة خلال الـ 26 سنة الماضية، بفضل الرؤية الملكية بعيدة …  حزب التجمع الوطني للأحرار يشيد بخطاب العرش ويجدد الولاء للملك محمد السادس     .', 'size': 2}], 'main_title': 'الأحرار يشيد بخطاب العرش ويسجل بافتخار الإنجازات المحققة خلال 26 سنة تحت قيادة جلالة الملك'}, {'community_id': '1', 'articles': [{'id': '64', 'title': 'الملك يشيد بمواقف بريطانيا والبرتغال الداعمة لمبادرة الحكم الذاتي', 'source': 'www.alakhbar.press.ma', 'link': 'https://www.alakhbar.press.ma/%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%8a%d8%b4%d9%8a%d8%af-%d8%a8%d9%85%d9%88%d8%a7%d9%82%d9%81-%d8%a8%d8%b1%d9%8a%d8%b7%d8%a7%d9%86%d9%8a%d8%a7-%d9%88%d8%a7%d9%84%d8%a8%d8%b1%d8%aa%d8%ba%d8%a7%d9%84-270137.html', 'summary': 'الملك يشيد بمواقف بريطانيا والبرتغال الداعمة لمبادرة الحكم الذاتي. النعمان اليعلاوي أشاد الملك محمد السادس بالمواقف الإيجابية للمملكة المتحدة وجمهورية البرتغال بشأن قضية الصحراء المغربية، مثمنا دعمهما لمبادرة الحكم الذاتي كحل وحيد لهذا النزاع الإقليمي. وأوضح الملك في خطاب العرش الذي ألقاه قبل قليل بمناسبة الذكرى السادسة والعشرون لعيد العرش، أن الدعم المتزايد لهذه المبادرة يعزز الموقف المغربي ويؤكد وجاهة الطرح الذي تقدمه المملكة …  الملك يشيد بمواقف بريطانيا والبرتغال الداعمة لمبادرة الحكم الذاتي     .', 'size': 2}, {'id': '241', 'title': 'الملك محمد السادس: نعتز بالدعم الدولي المتزايد لمبادرة الحكم الذاتي كحل وحيد للنزاع حول الصحراء المغربية', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7%d8%af%d8%b3-%d9%86%d8%b9%d8%aa%d8%b2-%d8%a8%d8%a7%d9%84%d8%af%d8%b9%d9%85-%d8%a7%d9%84%d8%af%d9%88%d9%84%d9%8a-%d8%a7/', 'summary': 'الملك محمد السادس: نعتز بالدعم الدولي المتزايد لمبادرة الحكم الذاتي كحل وحيد للنزاع حول الصحراء المغربية. قال الملك محمد السادس، يومه الثلاثاء، في خطابه بمناسبة تخليد الذكرى السادسة والعشرين لتربعه، على عرش أسلافه الميامين، “إننا نعتز بالدعم الدولي المتزايد لمبادرة الحكم الذاتي، كحل وحيد للنزاع حول الصحراء المغربية”. وتقدم الملك محمد السادس في خطابه، بعبارات الشكر والتقدير للمملكة المتحدة الصديقة، وجمهورية البرتغال، على موقفهما البناء، الذي يساند مبادرة الحكم …  الملك محمد السادس: نعتز بالدعم الدولي المتزايد لمبادرة الحكم الذاتي كحل وحيد للنزاع حول الصحراء المغربية     .', 'size': 2}], 'main_title': 'الملك يشيد بمواقف بريطانيا والبرتغال الداعمة لمبادرة الحكم الذاتي'}, {'community_id': '3', 'articles': [{'id': '68', 'title': 'أمن أسفي ينجح في إحباط محاولة تهريب كبرى لمخدر الشيرا ويوقف شبكة إجرامية', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/204296', 'summary': 'أمن أسفي ينجح في إحباط محاولة تهريب كبرى لمخدر الشيرا ويوقف شبكة إجرامية.  تمكنت عناصر الشرطة بالأمن الإقليمي بمدينة أسفي بناءً على معلومات دقيقة وفرتها مصالح المديرية العامة لمراقبة التراب الوطني، مساء اليوم الثلاثاء 29 يوليوز الجاري، من توقيف ثلاثة أشخاص تتراوح أعمارهم ما بين 28 و54 سنة، وذلك للاشتباه في ارتباطهم بشبكة إجرامية تنشط في التهريب الدولي للمخدرات والمؤثرات العقلية. وقد جرى توقيف المشتبه فيهم بإحدى', 'size': 3}, {'id': '224', 'title': 'بناءً على معلومات دقيقة من الديستي: حجز طنين و460 كيلوغراما من الشيرا معدة للتهريب الدولي بآسفي', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/225361/', 'summary': 'بناءً على معلومات دقيقة من الديستي: حجز طنين و460 كيلوغراما من الشيرا معدة للتهريب الدولي بآسفي. تمكنت عناصر الشرطة بالأمن الإقليمي بمدينة أسفي بناءً على معلومات دقيقة وفرتها مصالح المديرية العامة لمراقبة التراب الوطني، مساء اليوم الثلاثاء 29 يوليوز الجاري، من توقيف ثلاثة أشخاص تتراوح أعمارهم ما بين 28 و54 سنة، وذلك للاشتباه في ارتباطهم بشبكة إجرامية تنشط في التهريب الدولي للمخدرات والمؤثرات العقلية. وقد جرى توقيف المشتبه فيهم بإحدى المناطق', 'size': 2}, {'id': '340', 'title': 'آسفي…تفكيك شبكة للتهريب الدولي للمخدرات', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/319727/', 'summary': 'آسفي…تفكيك شبكة للتهريب الدولي للمخدرات. تمكنت عناصر الشرطة بالأمن الإقليمي بمدينة أسفي بناءً على معلومات دقيقة وفرتها مصالح المديرية العامة لمراقبة التراب الوطني، مساء اليوم الثلاثاء 29 يوليوز الجاري، من توقيف ثلاثة أشخاص تتراوح أعمارهم ما بين 28 و54 سنة، وذلك للاشتباه في ارتباطهم بشبكة إجرامية تنشط في التهريب الدولي للمخدرات والمؤثرات العقلية. وقد جرى توقيف المشتبه فيهم بإحدى', 'size': 2}], 'main_title': 'أمن أسفي ينجح في إحباط محاولة تهريب كبرى لمخدر الشيرا ويوقف شبكة إجرامية'}, {'community_id': '7', 'articles': [{'id': '93', 'title': 'مجموعة أكديطال تعلن عن استحواذها على مستشفى عبد الرحمن المشاري بالرياض بالمملكة العربية السعودية', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/economy/410138.html', 'summary': 'مجموعة أكديطال تعلن عن استحواذها على مستشفى عبد الرحمن المشاري بالرياض بالمملكة العربية السعودية. أعلنت مجموعة أكديطال، الفاعل الرائد في مجال الرعاية الصحية الخاصة بالمغرب، عن توقيع مذكرة تفاهم للاستحواذ على مستشفى عبد الرحمن المشاري في العاصمة السعودية الرياض،', 'size': 2}, {'id': '228', 'title': 'مجموعة أكديطال تعلن عن استحواذها على مستشفى عبد الرحمن المشاري بالمملكة العربية السعودية', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/225347/', 'summary': 'مجموعة أكديطال تعلن عن استحواذها على مستشفى عبد الرحمن المشاري بالمملكة العربية السعودية. الدار البيضاء – تعلن مجموعة أكديطال، الشركة الرائدة في مجال الرعاية الصحية الخاصة في المغرب، عن توقيع مذكرة تفاهم مع شركة الدكتور عبد الرحمن المشاري للتنمية ذ.م.م لتأجير وإدارة مستشفى عبد الرحمن المشاري، وهي مؤسسة مستشفيات خاصة رائدة متعددة التخصصات تقع في الرياض، في قلب حي العليا، المركز العصبي للمركز الاقتصادي لعاصمة المملكة العربية السعودية.', 'size': 2}], 'main_title': 'مجموعة أكديطال تعلن عن استحواذها على مستشفى عبد الرحمن المشاري بالرياض بالمملكة العربية السعودية'}, {'community_id': '4', 'articles': [{'id': '119', 'title': 'الملك محمد السادس يجدد تمسك المغرب بـ"اليد الممدودة" تجاه الجزائر ويؤكد: الشعب الجزائري شقيق', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/national/410165.html', 'summary': 'الملك محمد السادس يجدد تمسك المغرب بـ"اليد الممدودة" تجاه الجزائر ويؤكد: الشعب الجزائري شقيق. في خطاب العرش الذي ألقاه اليوم الثلاثاء 29 يوليوز، أعاد الملك محمد السادس التأكيد على خيار المغرب الثابت في انتهاج سياسة "اليد الممدودة" تجاه الجزائر،', 'size': 4}, {'id': '129', 'title': 'اليد الممدوة في خطاب العرش.. رسائل قوية والتزام بالثوابت الوطنية', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a7%d9%84%d9%8a%d8%af-%d8%a7%d9%84%d9%85%d9%85%d8%af%d9%88%d8%a9-%d9%81%d9%8a-%d8%ae%d8%b7%d8%a7%d8%a8-%d8%a7%d9%84%d8%b9%d8%b1%d8%b4-%d8%b1%d8%b3%d8%a7%d8%a6%d9%84-%d9%82%d9%88%d9%8a%d8%a9/', 'summary': 'اليد الممدوة في خطاب العرش.. رسائل قوية والتزام بالثوابت الوطنية. \u200eفي خطاب ملكي يعكس الحكمة والرزانة الدبلوماسية الملكية، مد جلالة الملك محمد السادس يده للشعب الجزائري، مؤكدا: “حرصت دوما على مد اليد لأشقائنا في الجزائر، وعبرت عن استعداد المغرب لحوار صريح ومسؤول؛ حوار أخوي وصادق، حول مختلف القضايا العالقة بين البلدين”. وقال جلالة الملك في خطاب الذكرى الـ26 لتخليد عيد العرش، اليوم الثلاثاء (29 يوليوز)،', 'size': 5}, {'id': '194', 'title': 'الملك: التزامنا الراسخ باليد الممدودة لأشقائنا في الجزائر نابع من إيماننا بوحدة شعوبنا', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/470994.html', 'summary': 'الملك: التزامنا الراسخ باليد الممدودة لأشقائنا في الجزائر نابع من إيماننا بوحدة شعوبنا. قال الملك محمد السادس، مساء اليوم الثلاثاء، إنه “بموازاة مع حرصنا على ترسیخ مكانة المغرب كبلد صاعد، نؤكد التزامنا بالانفتاح على محيطنا الجهوي، وخاصة جوارنا المباشر، في علاقتنا بالشعب الجزائري الشقيق”. وأضاف الملك في خطاب بمناسبة عيد العرش الذي يصادف الذكرى السادسة والعشرين لتربعه على عرش أسلافه، بصفتي ملك المغرب، فإن موقفي واضح وثابت؛ وهو …', 'size': 4}, {'id': '231', 'title': 'المغرب يدخل نادي الدول الصاعدة بثقة: الملك يؤكد أن المنجزات ليست صدفة بل خيار استراتيجي', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/225339/', 'summary': 'المغرب يدخل نادي الدول الصاعدة بثقة: الملك يؤكد أن المنجزات ليست صدفة بل خيار استراتيجي. في خطابه السامي بمناسبة الذكرى السادسة والعشرين لعيد العرش، حرص جلالة الملك محمد السادس على التأكيد على أن المغرب اليوم لم يعد مجرد بلد نامٍ يسعى للحاق بركب التنمية، بل أصبح فاعلًا إقليميًا صاعدًا، يتموقع بثبات داخل نادي الدول الصاعدة، بفضل اختيارات استراتيجية محكمة، واستقرار سياسي ومؤسساتي متين. وقال جلالته بصريح العبارة: “فما حققته', 'size': 3}, {'id': '232', 'title': 'الملك في خطاب العرش: حرصت دوما على مد اليد لأشقائنا في الجزائر', 'source': 'almassaa.com', 'link': 'https://almassaa.com/%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7%d8%af%d8%b3-%d9%81%d9%8a-%d8%ae%d8%b7%d8%a7%d8%a8-%d8%a7%d9%84%d8%b9%d8%b1%d8%b4-%d8%ad%d8%b1%d8%b5%d8%aa-%d8%af%d9%88/', 'summary': 'الملك في خطاب العرش: حرصت دوما على مد اليد لأشقائنا في الجزائر. المساء اليوم: أكد جلالة الملك محمد السادس التزام المغرب بالانفتاح على محيطه الجهوي، وخاصة جواره المباشر، في علاقته بالشعب الجزائري الشقيق الذي تجمعه بالشعب المغربي علاقات إنسانية وتاريخية عريقة. وقال جلالة الملك، في الخطاب السامي', 'size': 5}], 'main_title': 'اليد الممدوة في خطاب العرش.. رسائل قوية والتزام بالثوابت الوطنية'}, {'community_id': '5', 'articles': [{'id': '124', 'title': 'باب سبتة.. حجز 4,7 كيلوغرامات من الكوكايين بحوزة مغربية تقود سيارة بلوحة إسبانية', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/society/410171.html', 'summary': 'باب سبتة.. حجز 4,7 كيلوغرامات من الكوكايين بحوزة مغربية تقود سيارة بلوحة إسبانية. تمكنت عناصر الجمارك والأمن الوطني، زوال اليوم، من إحباط محاولة تهريب كمية مهمة من مخدر الكوكايين عبر معبر باب سبتة، كانت بحوزة سيدة مغربية تقود', 'size': 3}, {'id': '225', 'title': 'مركز باب سبتة.. توقيف سيدة أربعينية بحوزتها أربع كيلوغرامات و770 غراما من الكوكايين', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/225358/', 'summary': 'مركز باب سبتة.. توقيف سيدة أربعينية بحوزتها أربع كيلوغرامات و770 غراما من الكوكايين. تمكنت عناصر الأمن الوطني والجمارك بمركز باب سبتة، مساء اليوم الثلاثاء 29 يوليوز الجاري، من توقيف سيدة تبلغ من العمر 44 سنة، وذلك للاشتباه في تورطها في قضية تتعلق بالتهريب الدولي لمخدر الكوكايين. وقد جرى توقيف المشتبه فيها مباشرة بعد وصولها على متن سيارة مرقمة بالخارج إلى مركز باب سبتة، حيث أسفرت عملية التفتيش عن', 'size': 4}, {'id': '307', 'title': 'توقيف سيدة بحوزتها 4.7 كلغ كوكايين بمركز باب سبتة', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/204334', 'summary': 'توقيف سيدة بحوزتها 4.7 كلغ كوكايين بمركز باب سبتة.  تمكنت عناصر الأمن الوطني والجمارك بمركز باب سبتة، مساء اليوم الثلاثاء 29 يوليوز الجاري، من توقيف سيدة تبلغ من العمر 44 سنة، وذلك للاشتباه في تورطها في قضية تتعلق بالتهريب الدولي لمخدر الكوكايين. وقد جرى توقيف المشتبه فيها مباشرة بعد وصولها على متن سيارة مرقمة بالخارج إلى مركز باب سبتة، حيث أسفرت عملية التفتيش', 'size': 4}, {'id': '341', 'title': 'توقيف أربعينية بباب سبتة للاشتباه في تورطها في تهريب “الكوكاين”', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/319724/', 'summary': 'توقيف أربعينية بباب سبتة للاشتباه في تورطها في تهريب “الكوكاين”. تمكنت عناصر الأمن الوطني والجمارك بمركز باب سبتة، مساء اليوم الثلاثاء 29 يوليوز الجاري، من توقيف سيدة تبلغ من العمر 44 سنة، وذلك للاشتباه في تورطها في قضية تتعلق بالتهريب الدولي لمخدر الكوكايين. وقد جرى توقيف المشتبه فيها مباشرة بعد وصولها على متن سيارة مرقمة بالخارج إلى مركز باب سبتة، حيث أسفرت عملية التفتيش', 'size': 3}], 'main_title': 'مركز باب سبتة.. توقيف سيدة أربعينية بحوزتها أربع كيلوغرامات و770 غراما من الكوكايين'}, {'community_id': '6', 'articles': [{'id': '126', 'title': 'زلزال بقوة 8 درجات قبالة الساحل الشرقي لروسيا..وتحذيرات أمريكية من تسونامي', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/world/410175.html', 'summary': 'زلزال بقوة 8 درجات قبالة الساحل الشرقي لروسيا..وتحذيرات أمريكية من تسونامي. أصدرت هيئة المسح الجيولوجي الأمريكية، الأربعاء، تحذيرات من أمواج مد عاتية (تسونامي) بعد زلزال بقوة 8.0 درجات وقع قبالة الساحل الشرقي لروسيا. وكان الزلزال على بُعد', 'size': 2}, {'id': '202', 'title': 'بالفيديو.. زلزال مدمير بقوة 8 درجات يقع قبالة الساحل الشرقي لروسيا', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%a8%d8%a7%d9%84%d9%81%d9%8a%d8%af%d9%8a%d9%88-%d8%b2%d9%84%d8%b2%d8%a7%d9%84-%d9%85%d8%af%d9%85%d9%8a%d8%b1-%d8%a8%d9%82%d9%88%d8%a9-8-%d8%af%d8%b1%d8%ac%d8%a7%d8%aa-%d9%8a%d9%82%d8%b9-%d9%82/', 'summary': 'بالفيديو.. زلزال مدمير بقوة 8 درجات يقع قبالة الساحل الشرقي لروسيا. صدرت هيئة المسح الجيولوجي الأمريكية، الأربعاء، تحذيرات من أمواج مد عاتية (تسونامي) بعد زلزال بقوة 8.7 درجات وقع قبالة الساحل الشرقي لروسيا.  بالفيديو.. زلزال مدمير بقوة 8 درجات يقع قبالة الساحل الشرقي لروسيا     .', 'size': 2}], 'main_title': 'زلزال بقوة 8 درجات قبالة الساحل الشرقي لروسيا..وتحذيرات أمريكية من تسونامي'}, {'community_id': '11', 'articles': [{'id': '145', 'title': 'الملك يشدد على الإعداد المبكر لانتخابات 2026', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/319700/', 'summary': 'الملك يشدد على الإعداد المبكر لانتخابات 2026. في خطوة تؤكد حرصه على ترسيخ المسار الديمقراطي وتعزيز الثقة في المؤسسات، دعا الملك محمد السادس، مساء اليوم الثلاثاء، إلى ضرورة احترام الإطار الدستوري والقانوني في تنظيم الانتخابات التشريعية المقبلة المقررة سنة 2026، مشدداً على أهمية الإعداد المبكر والسليم لهذا الاستحقاق الوطني الحيوي. وجاءت هذه الدعوة خلال الخطاب الذي ألقاه جلالة الملك بمناسبة الذكرى السادسة', 'size': 3}, {'id': '226', 'title': 'خطاب العرش 2025: معالم تحول استراتيجي في المشروع الملكي للتنمية', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/225355/', 'summary': 'خطاب العرش 2025: معالم تحول استراتيجي في المشروع الملكي للتنمية. حفل خطاب جلالة الملك محمد السادس بمناسبة عيد العرش 2025 بمجموعة من الرسائل المحورية القوية، لترسم معالم رؤية استراتيجية جديدة لما يُنتظر من الدولة والمجتمع في السنوات المقبلة. خطاب جلالة الملك قدم قراءة مؤسسة للمرحلة القادمة، تحمل في طياتها تحولا عميقًا في فلسفة الحكم وفي طريقة التفكير في الدولة، وفي علاقة المركز بالمجال، والمواطن بالمؤسسات.', 'size': 3}, {'id': '246', 'title': 'الملك محمد السادس: لقد حان الوقت لتغيير شامل لتدارك الفوارق الاجتماعية والمجالية', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d9%85%d9%84%d9%83-%d9%85%d8%ad%d9%85%d8%af-%d8%a7%d9%84%d8%b3%d8%a7%d8%af%d8%b3-%d9%84%d9%82%d8%af-%d8%ad%d8%a7%d9%86-%d8%a7%d9%84%d9%88%d9%82%d8%aa-%d9%84%d8%aa%d8%ba%d9%8a%d9%8a%d8%b1/', 'summary': 'الملك محمد السادس: لقد حان الوقت لتغيير شامل لتدارك الفوارق الاجتماعية والمجالية. وجه الملك محمد السادس، مساء اليوم الثلاثاء 29 يوليوز الجاري، خطابا إلى شعبه الوفي، بمناسبة عيد العرش المجيد الذي يصادف الذكرى السادسة والعشرين لتربع جلالته على عرش أسلافه الميامين. وفي هذا السياق، أكد الملك محمد السادس أن ما حققته المملكة لم يكن وليد الصدفة، بل نتيجة لرؤية استراتيجية بعيدة المدى حرصت على تعزيز …  الملك محمد السادس: لقد حان الوقت لتغيير شامل لتدارك الفوارق الاجتماعية والمجالية     .', 'size': 3}], 'main_title': 'الملك يشدد على الإعداد المبكر لانتخابات 2026'}, {'community_id': '9', 'articles': [{'id': '146', 'title': 'النص الكامل لخطاب جلالة الملك في عيد العرش', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/319697/', 'summary': 'النص الكامل لخطاب جلالة الملك في عيد العرش. وجه صاحب الجلالة الملك محمد السادس، نصره الله، مساء اليوم الثلاثاء، خطابا إلى شعبه الوفي، بمناسبة عيد العرش المجيد الذي يصادف الذكرى السادسة والعشرين لتربع جلالته على عرش أسلافه الميامين. وفي ما يلي نص الخطاب الملكي السامي: “الحمد لله، والصلاة والسلام على مولانا رسول الله وآله وصحبه. شعبي العزيز، يشكل الاحتفال بعيد العرش المجيد، مناسبة', 'size': 2}, {'id': '244', 'title': 'النص الكامل للخطاب الملكي السامي بمناسبة الذكرى الـ26 لعيد العرش', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d9%86%d8%b5-%d8%a7%d9%84%d9%83%d8%a7%d9%85%d9%84-%d9%84%d9%84%d8%ae%d8%b7%d8%a7%d8%a8-%d8%a7%d9%84%d9%85%d9%84%d9%83%d9%8a-%d8%a7%d9%84%d8%b3%d8%a7%d9%85%d9%8a-%d8%a8%d9%85%d9%86%d8%a7-2/', 'summary': 'النص الكامل للخطاب الملكي السامي بمناسبة الذكرى الـ26 لعيد العرش. وجه صاحب الجلالة الملك محمد السادس، نصره الله، مساء اليوم الثلاثاء، خطابا إلى شعبه الوفي، بمناسبة عيد العرش المجيد الذي يصادف الذكرى السادسة والعشرين لتربع جلالته على عرش أسلافه الميامين. وفي ما يلي نص الخطاب الملكي السامي: “الحمد لله، والصلاة والسلام على مولانا رسول الله وآله وصحبه.شعبي العزيز،يشكل الاحتفال بعيد العرش المجيد، مناسبة …  النص الكامل للخطاب الملكي السامي بمناسبة الذكرى الـ26 لعيد العرش     .', 'size': 2}], 'main_title': 'النص الكامل لخطاب جلالة الملك في عيد العرش'}, {'community_id': '10', 'articles': [{'id': '147', 'title': 'الملك: أجدد اليد الممدودة للجزائر وملتزم بالحوار المسؤول', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/319694/', 'summary': 'الملك: أجدد اليد الممدودة للجزائر وملتزم بالحوار المسؤول. جدد الملك محمد السادس، في خطاب العرش الذي وجهه إلى الشعب المغربي بمناسبة الذكرى السادسة والعشرين لتربعه على العرش، التزامه الراسخ بنهج اليد الممدودة تجاه الجزائر، داعياً إلى حوار مسؤول وصريح لتجاوز الخلافات القائمة، ومشدداً على ضرورة اعتماد منطق الحلول الواقعية والتوافقية لإنهاء النزاع الإقليمي حول الصحراء المغربية. وأكد الملك أن العلاقات المغربية الجزائرية يجب', 'size': 2}, {'id': '320', 'title': 'القضية الوطنية خلال 26 سنة.. زخم غير مسبوق ودينامية تنموية في الأقاليم الجنوبية', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%a7%d9%84%d9%82%d8%b6%d9%8a%d8%a9-%d8%a7%d9%84%d9%88%d8%b7%d9%86%d9%8a%d8%a9-%d8%ae%d9%84%d8%a7%d9%84-26-%d8%b3%d9%86%d8%a9-%d8%b2%d8%ae%d9%85-%d8%ba%d9%8a%d8%b1-%d9%85%d8%b3%d8%a8%d9%88%d9%82/', 'summary': 'القضية الوطنية خلال 26 سنة.. زخم غير مسبوق ودينامية تنموية في الأقاليم الجنوبية. منذ اعتلائه العرش سنة 1999، قاد جلالة الملك محمد السادس تحولا عميقا عميقا في السياسة الخارجية للمملكة أساسه الحكمة والرؤية البعيدة المدى في دبلوماسية تعتمد على وضوح المواقف وتنويع الشراكات، بما يخدم المصالح العليا للوطن. وفي مقدمة أولويات الدبلوماسية المغربية، تبرز قضية الصحراء المغربية التي شهدت زخما غير مسبوق في عهد جلالة الملك، بفضل تحرك', 'size': 2}], 'main_title': 'الملك: أجدد اليد الممدودة للجزائر وملتزم بالحوار المسؤول'}, {'community_id': '8', 'articles': [{'id': '240', 'title': 'الحكم بـ6 سنوات سجنا نافذا للبدراوي و7 سنوات نافذة لكريمين', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d8%ad%d9%83%d9%85-%d8%a8%d9%806-%d8%b3%d9%86%d9%88%d8%a7%d8%aa-%d8%b3%d8%ac%d9%86%d8%a7-%d9%86%d8%a7%d9%81%d8%b0%d8%a7-%d9%84%d9%84%d8%a8%d8%af%d8%b1%d8%a7%d9%88%d9%8a-%d9%887-%d8%b3/', 'summary': 'الحكم بـ6 سنوات سجنا نافذا للبدراوي و7 سنوات نافذة لكريمين. أصدرت غرفة جرائم الأموال بمحكمة الاستئناف بالدار البيضاء، اليوم الثلاثاء 29 يوليوز الجاري، أحكاماً مشددة بلغت مجموعها 17 سنة سجناً نافذاً، في القضية المعروفة إعلامياً بملف “البدراوي وكريمين ومن معهما”. وشهدت القاعة رقم 8 باستئنافية الدار البيضاء صدور أحكام بالسجن النافذ في حق ثلاثة متهمين بارزين، أبرزهم، محمد كريمين، الرئيس السابق لجماعة بوزنيقة، …  الحكم بـ6 سنوات سجنا نافذا للبدراوي و7 سنوات نافذة لكريمين     .', 'size': 2}, {'id': '360', 'title': '17 سنة سجنا في ملف بوزنيقة.. كريمين والبدراوي في قلب تهم تبديد أموال عمومية', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/17-%d8%b3%d9%86%d8%a9-%d8%b3%d8%ac%d9%86%d8%a7-%d9%81%d9%8a-%d9%85%d9%84%d9%81-%d8%a8%d9%88%d8%b2%d9%86%d9%8a%d9%82%d8%a9-%d9%83%d8%b1%d9%8a%d9%85%d9%8a%d9%86-%d9%88%d8%a7%d9%84%d8%a8%d8%af%d8%b1/', 'summary': '17 سنة سجنا في ملف بوزنيقة.. كريمين والبدراوي في قلب تهم تبديد أموال عمومية. أصدرت غرفة جرائم الأموال بمحكمة الاستئناف بالدار البيضاء، مساء أمس الثلاثاء 29 يوليو 2025، أحكامها في ملف فساد تدبير جماعة بوزنيقة، حيث قضت بما مجموعه 17 سنة سجنا نافذا في حق ثلاثة متهمين رئيسيين في القضية التي شغلت الرأي العام الوطني. وقضت المحكمة بسبع سنوات سجنا نافذا في حق محمد كريمين، الرئيس السابق لجماعة بوزنيقة،  17 سنة سجنا في ملف بوزنيقة.. كريمين والبدراوي في قلب تهم تبديد أموال عمومية     .', 'size': 2}], 'main_title': 'الحكم بـ6 سنوات سجنا نافذا للبدراوي و7 سنوات نافذة لكريمين'}, {'community_id': '12', 'articles': [{'id': '279', 'title': 'نقابة التمثيل المصرية تنعى لطفي لبيب', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d9%86%d9%82%d8%a7%d8%a8%d8%a9-%d8%a7%d9%84%d8%aa%d9%85%d8%ab%d9%8a%d9%84-%d8%a7%d9%84%d9%85%d8%b5%d8%b1%d9%8a%d8%a9-%d8%aa%d9%86%d8%b9%d9%89-%d9%84%d8%b7%d9%81%d9%8a-%d9%84%d8%a8%d9%8a%d8%a8-1601337.html', 'summary': 'نقابة التمثيل المصرية تنعى لطفي لبيب. توفي الممثل المصري لطفي لبيب عن عمر يناهز 78 سنة، اليوم الأربعاء، بعد صراع مع المرض. ونقل الفنان الراحل لطفي لبيب، الذي نعته نقابة المهن التمثيلية، خلال الأيام الماضية إلى المستشفى بعد تعرضه لوعكة صحية شديدة؛ أدت إلى تدهور حالته بشكل ملحوظ خلال الساعات الأخيرة. وتخرج الراحل من المعهد العالي للفنون المسرحية سنة 1970، وقدم  نقابة التمثيل المصرية تنعى لطفي لبيب     - هسبريس جريدة إلكترونية مغربية .', 'size': 3}, {'id': '321', 'title': 'عن عمر يناهز 78 سنة.. وفاة الممثل المصري لطفي لبيب', 'source': 'kifache.com', 'link': 'https://kifache.com/%d8%b9%d9%86-%d8%b9%d9%85%d8%b1-%d9%8a%d9%86%d8%a7%d9%87%d8%b2-78-%d8%b3%d9%86%d8%a9-%d9%88%d9%81%d8%a7%d8%a9-%d8%a7%d9%84%d9%85%d9%85%d8%ab%d9%84-%d8%a7%d9%84%d9%85%d8%b5%d8%b1%d9%8a-%d9%84%d8%b7/', 'summary': 'عن عمر يناهز 78 سنة.. وفاة الممثل المصري لطفي لبيب. توفي اليوم الأربعاء (30 يوليوز)، الممثل المصري لطفي لبيب عن عمر يناهز 78 سنة، بعد صراع مع المرض. ونقل الفنان الراحل لطفي لبيب، الذي نعته نقابة المهن التمثيلية، خلال الأيام الماضية إلى المستشفى بعد تعرضه لوعكة صحية شديدة أدت إلى تدهور حالته بشكل ملحوظ خلال الساعات الأخيرة. وتخرج الراحل من المعهد العالي للفنون المسرحية سنة', 'size': 3}, {'id': '358', 'title': '"جوكر الدراما المصرية".. وفاة الممثل لطفي لبيب', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%ac%d9%88%d9%83%d8%b1-%d8%a7%d9%84%d8%af%d8%b1%d8%a7%d9%85%d8%a7-%d8%a7%d9%84%d9%85%d8%b5%d8%b1%d9%8a%d8%a9-%d9%88%d9%81%d8%a7%d8%a9-%d8%a7%d9%84%d9%85%d9%85%d8%ab%d9%84-%d9%84%d8%b7%d9%81/', 'summary': '"جوكر الدراما المصرية".. وفاة الممثل لطفي لبيب. توفي، اليوم الأربعاء، الممثل المصري لطفي لبيب عن عمر يناهز 78 سنة، بعد صراع مع المرض. ونقل الفنان الراحل لطفي لبيب، الذي نعته نقابة المهن التمثيلية، خلال الأيام الماضية إلى المستشفى بعد تعرضه لوعكة صحية شديدة أدت إلى تدهور حالته بشكل ملحوظ خلال الساعات الأخيرة. وتخرج الراحل من المعهد العالي للفنون المسرحية سنة 1970، وقدم  "جوكر الدراما المصرية".. وفاة الممثل لطفي لبيب     .', 'size': 3}], 'main_title': 'نقابة التمثيل المصرية تنعى لطفي لبيب'}, {'community_id': '2', 'articles': [{'id': '300', 'title': 'طقس الأربعاء.. أجواء حارة بعموم مناطق المملكة', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-645092.html', 'summary': 'طقس الأربعاء.. أجواء حارة بعموم مناطق المملكة. هبة بريس تتوقع المديرية العامة للأرصاد الجوية، اليوم الأربعاء، أن تتميز الحالة الجوية عامة، بطقس نسبي حار بالجنوب الشرقي للبلاد، وبداخل الأقاليم الصحراوية، وسهول غرب الأطلس، إلى جانب قطرات مطرية خلال الليل والصباح بالواجهة المتوسطية مابين سيدي إفني وطرفاية. كما يرتقب تشكل سحب منخفضة مصحوبة بكتل ضبابية خلال الليل والصباح بالسهول المحيطية، فضلا عن تسجيل هبات رياح قوية نوعا ما بكل من منطقة طنجة، ومحليا قوية بالمنطقة الشرقية، ومرتفعات الأطلس والجنوب الشرقي، والجنوب. وستتراوح درجات الحرارة الدنيا، ما بين 25 و31 درجة بالجنوب الشرقي و بشرق الأقاليم الصحراوية، وما بين 18 و 25 درجة بباقي الأرجاء الأخرى. أما درجات الحرارة خلال النهار، فستشهد بعض الارتفاع بالسهول الداخلية الشمالية. وسيكون البحر قليل الهيجان إلى هائج بالواجهة المتوسطية والبوغاز وعلى طول الساحل الأطلسي.', 'size': 2}, {'id': '343', 'title': 'طقس الأربعاء…أجواء حارة بعدد من المناطق', 'source': 'aljarida24.ma', 'link': 'https://aljarida24.ma/p/actualites/319713/', 'summary': 'طقس الأربعاء…أجواء حارة بعدد من المناطق. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الأربعاء، أن تتميز الحالة الجوية عامة، بطقس نسبي حار بالجنوب الشرقي للبلاد، وبداخل الأقاليم الصحراوية، وسهول غرب الأطلس، إلى جانب قطرات مطرية خلال الليل والصباح بالواجهة المتوسطية مابين سيدي إفني وطرفاية. كما يرتقب تشكل سحب منخفضة مصحوبة بكتل ضبابية خلال الليل والصباح بالسهول المحيطية، فضلا عن تسجيل هبات', 'size': 3}, {'id': '401', 'title': 'توقعات أحوال الطقس اليوم الأربعاء', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%aa%d9%88%d9%82%d8%b9%d8%a7%d8%aa-%d8%a3%d8%ad%d9%88%d8%a7%d9%84-%d8%a7%d9%84%d8%b7%d9%82%d8%b3-%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%a3%d8%b1%d8%a8%d8%b9%d8%a7%d8%a1-30/', 'summary': 'توقعات أحوال الطقس اليوم الأربعاء. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليومه الأربعاء، أن تتميز الحالة الجوية عامة، بطقس نسبي حار بالجنوب الشرقي للبلاد، وبداخل الأقاليم الصحراوية، وسهول غرب الأطلس، إلى جانب قطرات مطرية خلال الليل والصباح بالواجهة المتوسطية مابين سيدي إفني وطرفاية. كما يرتقب تشكل سحب منخفضة مصحوبة بكتل ضبابية خلال الليل والصباح بالسهول المحيطية، فضلا عن …  توقعات أحوال الطقس اليوم الأربعاء     .', 'size': 2}], 'main_title': 'طقس الأربعاء…أجواء حارة بعدد من المناطق'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    