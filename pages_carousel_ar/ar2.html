<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>أهم الأخبار - Treemap Carousel</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.4.1/swiper-bundle.min.js"></script>
    
    
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f4f4f4;
              
        }
        
        .swiper {
            width: 100%;
            height: 90vh;
            margin-top: 10px;
        }
        
        .swiper-slide {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 10px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            margin: 10px;
            width: calc(100% - 20px); /* Utilisez calc pour soustraire les marges */
            margin-left: auto;
            margin-right: auto;

        }
        
        .treemap-container {
           width: 100%;
            height: 100%;
            margin-bottom: 10px;
            direction: rtl; /* Changez rtl en ltr */
            position: relative;
          z-index: 1;

        }
        
        .community-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            position: relative;
              z-index: 10;
              padding: 10px;
              background: rgba(255, 255, 255, 0.8); /* Fond semi-transparent pour contraste */
              text-align: center;
        }
        
        .node {
            overflow: hidden;
            border: 1px solid white;
            position: absolute;
            transition: all 0.3s;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .node:hover {
            opacity: 0.9;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        
        .node-content {
            padding: 8px;
            overflow: hidden;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .node-title {
            font-size: 14px;  
            font-weight: bold;
            margin-bottom: 4px;
        }
        
        .node-source {
            font-size: 12px;  
            color: #666;
        }
        
        .tooltip {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 0 15px rgba(0,0,0,0.3);
            font-size: 16px; 
            max-width: 90%;
            width: 350px;
            color: #333;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            direction: rtl;
            text-align: right;
        }
        
        .tooltip-title {
            font-size: 16px;  
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .tooltip-source {
            font-size: 14px;
            color: #555;
            margin-bottom: 10px;
        }
        
        .tooltip-summary {
            font-size: 15px;
            line-height: 1.4;
        }
        
        .swiper-pagination {
            position: relative;
            bottom: 0;
            margin-top: 15px;
        }
        
        .swiper-pagination-bullet {
            width: 12px;
            height: 12px;
            background-color: #ccc;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .swiper-pagination-bullet-active {
            background-color: #007aff;
            opacity: 1;
            width: 20px;
            border-radius: 6px;
        }
        
        .swiper-button-next, .swiper-button-prev {
            color: #fff;
            background-color: rgba(0, 0, 0, 0.4);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s;
        }
        
        .swiper-button-next:hover, .swiper-button-prev:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .swiper-button-next:after, .swiper-button-prev:after {
            font-size: 18px;
        }
        
        header {
            background-color: #333;
            color: white;
            text-align: center;
        }
        
        .header-title {
            font-size: 14px;
            font-weight: bold;
        }
        
        .header-subtitle {
            font-size: 12px;
            opacity: 0.8;
        }
        
        @media screen and (max-width: 768px) {
            .node-title {
                font-size: 14px;  
            }
            .node-source {
                font-size: 12px;  
            }
            .community-title {
                font-size: 16px;  
            }
            .tooltip {
                max-width: 90%;
                padding: 12px;
            }
            .tooltip-title {
                font-size: 16px;
            }
            .swiper-button-next, .swiper-button-prev {
                width: 36px;
                height: 36px;
            }
        }
    </style>
    
    
    
</head>
<body>
    <header> 
        <div class="header-title">أهم الأخبار لآخر 24 ساعة

</div>    
        <div class="header-subtitle"> آخر تحديث : 19/09/2025 - 18h26</div>  
    </header>
    
    

    <div class="swiper mySwiper">
        <div class="swiper-wrapper" id="treemap-carousel"> </div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <div id="tooltip" class="tooltip"></div>

    <script>
        const treemapData = [{'community_id': '0', 'articles': [{'id': '69', 'title': 'الملك محمد السادس يدشن مشاريع كبرى لتطوير المركب المينائي للدار البيضاء', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/206402', 'summary': 'الملك محمد السادس يدشن مشاريع كبرى لتطوير المركب المينائي للدار البيضاء.  أشرف صاحب الجلالة الملك محمد السادس، نصره الله، اليوم الخميس بالدار البيضاء، على تدشين وزيارة عدد من المشاريع الكبرى المندرجة في إطار إعادة هيكلة وتطوير المركب المينائي للدار البيضاء، والرامية إلى تعزيز الإشعاع الاقتصادي والسياحي للعاصمة الاقتصادية للمملكة. وتهدف هذه المشاريع إلى ترسيخ مكانة الدار البيضاء كقطب اقتصادي ومالي رائد على المستوى القاري، منفتح', 'size': 3}, {'id': '95', 'title': 'الملك يدشن ويزور عددا من المشاريع الكبرى بالمركب المينائي للدار البيضاء (صور)', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/economy/412972.html', 'summary': 'الملك يدشن ويزور عددا من المشاريع الكبرى بالمركب المينائي للدار البيضاء (صور). أشرف صاحب الجلالة الملك محمد السادس، نصره الله، اليوم الخميس بالدار البيضاء، على تدشين وزيارة عدد من المشاريع الكبرى المندرجة في إطار إعادة هيكلة وتطوير', 'size': 2}, {'id': '189', 'title': 'جلالة الملك بصحة جيدة…يدشن الميناء الترفيهي للدارالبيضاء لتصبح وجهة سياحية عالمية', 'source': 'rue20.com', 'link': 'https://rue20.com/937610.html', 'summary': 'جلالة الملك بصحة جيدة…يدشن الميناء الترفيهي للدارالبيضاء لتصبح وجهة سياحية عالمية.  . الرباط أشرف صاحب الجلالة الملك محمد السادس، اليوم الخميس بالدار البيضاء، على تدشين وزيارة عدد من المشاريع الكبرى المندرجة في إطار إعادة هيكلة وتطوير المركب المينائي للدار البيضاء، والرامية إلى تعزيز الإشعاع الاقتصادي والسياحي للعاصمة الاقتصادية للمملكة. وتهدف هذه المشاريع إلى ترسيخ مكانة الدار البيضاء كقطب اقتصادي ومالي رائد على المستوى القاري، الخبر جلالة الملك بصحة جيدة…يدشن الميناء الترفيهي للدارالبيضاء لتصبح وجهة سياحية عالمية  .', 'size': 2}], 'main_title': 'الملك محمد السادس يدشن مشاريع كبرى لتطوير المركب المينائي للدار البيضاء'}, {'community_id': '1', 'articles': [{'id': '86', 'title': 'العداءة المغربية آسية رزيقي تتأهل إلى نصف نهائي 800 م في بطولة العالم', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/sport/others/412963.html', 'summary': 'العداءة المغربية آسية رزيقي تتأهل إلى نصف نهائي 800 م في بطولة العالم. تأهلت العداءة المغربية آسية رزيقي، اليوم الخميس ،إلى نصف نهائي سباق 800 م ،المدرج ضمن فعاليات بطولة العالم لألعاب القوى التي تحتضنها حاليا العاصمة اليابانية', 'size': 2}, {'id': '266', 'title': 'رزقي تتأهل لنصف نهائي بطولة العالم', 'source': 'www.alalam.ma', 'link': 'https://www.alalam.ma/notes/رزقي-تتأهل-لنصف-نهائي-بطولة-العالم_b91180346.html', 'summary': 'رزقي تتأهل لنصف نهائي بطولة العالم. تأهلت المغربية آسية رزيقي، صباح اليوم الخميس، إلى نصف نهائي سباق 800 متر ضمن بطولة العالم لألعاب القوى المقامة حاليا في طوكيو.', 'size': 2}], 'main_title': 'العداءة المغربية آسية رزيقي تتأهل إلى نصف نهائي 800 م في بطولة العالم'}, {'community_id': '2', 'articles': [{'id': '105', 'title': 'زلزال بقوة 7.8 درجات يهز شرق روسيا وتحذيرات من تسونامي', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/world/412983.html', 'summary': 'زلزال بقوة 7.8 درجات يهز شرق روسيا وتحذيرات من تسونامي. هزّ زلزال قوي بلغت شدته 7.8 درجات على مقياس ريختر، صباح الخميس، شبه جزيرة كامتشاتكا في أقصى شرق روسيا، وفق ما أعلنت هيئة المسح الجيولوجي', 'size': 2}, {'id': '208', 'title': 'زلزال بقوة 7.8 درجات يضرب شبه جزيرة كامتشاتكا شرقي روسيا', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%b2%d9%84%d8%b2%d8%a7%d9%84-%d8%a8%d9%82%d9%88%d8%a9-7-8-%d8%af%d8%b1%d8%ac%d8%a7%d8%aa-%d9%8a%d8%b6%d8%b1%d8%a8-%d8%b4%d8%a8%d9%87-%d8%ac%d8%b2%d9%8a%d8%b1%d8%a9-%d9%83%d8%a7%d9%85%d8%aa%d8%b4/', 'summary': 'زلزال بقوة 7.8 درجات يضرب شبه جزيرة كامتشاتكا شرقي روسيا. ضرب زلزال بقوة 7.8 درجات على مقياس ريختر، الخميس، شبه جزيرة كامتشاتكا شرقي روسيا. وأفادت هيئة المسح الجيولوجي الأمريكية بأن مركز الزلزال  زلزال بقوة 7.8 درجات يضرب شبه جزيرة كامتشاتكا شرقي روسيا     .', 'size': 2}], 'main_title': 'زلزال بقوة 7.8 درجات يهز شرق روسيا وتحذيرات من تسونامي'}, {'community_id': '3', 'articles': [{'id': '122', 'title': 'توماس رايلي: المشاريع التي دشنها جلالة الملك “تعزز تموقع المغرب كجسر بين أوروبا وإفريقيا”', 'source': 'assabah.ma', 'link': 'https://assabah.ma/871965.html', 'summary': 'توماس رايلي: المشاريع التي دشنها جلالة الملك “تعزز تموقع المغرب كجسر بين أوروبا وإفريقيا”. أكد السفير السابق للمملكة المتحدة بالمغرب، توماس رايلي، أن المشاريع التي أشرف صاحب الجلالة الملك محمد السادس، على تدشينها، اليوم الخميس، في إطار إعادة هيكلة وتطوير المركب المينائي للدار البيضاء، “تعزز تموقع المغرب كجسر يربط بين أوروبا وإفريقيا”. وقال رايلي، في تصريح لوكالة المغرب العربي للأنباء، إنأكمل القراءة » المقالة توماس رايلي: المشاريع التي دشنها جلالة الملك “تعزز تموقع المغرب كجسر بين أوروبا وإفريقيا”  .', 'size': 3}, {'id': '230', 'title': 'المشاريع التي دشنها جلالة الملك “تعزز تموقع المغرب كجسر بين أوروبا وإفريقيا”', 'source': 'www.cawalisse.com', 'link': 'https://www.cawalisse.com/227255/', 'summary': 'المشاريع التي دشنها جلالة الملك “تعزز تموقع المغرب كجسر بين أوروبا وإفريقيا”. لندن – أكد السفير السابق للمملكة المتحدة بالمغرب، توماس رايلي، أن المشاريع التي أشرف صاحب الجلالة الملك محمد السادس، على تدشينها، اليوم الخميس، في إطار إعادة هيكلة وتطوير المركب المينائي للدار البيضاء، “تعزز تموقع المغرب كجسر يربط بين أوروبا وإفريقيا”. وقال السيد رايلي، في تصريح لوكالة المغرب العربي للأنباء، إن “الأمر يتعلق بمشاريع مبهرة”، مبرزا', 'size': 3}, {'id': '249', 'title': 'السفير البريطاني السابق: مشاريع الملك بالمركب المينائي للدار البيضاء تعزز تموقع المغرب كجسر بين أوروبا وإفريقيا', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%a7%d9%84%d8%b3%d9%81%d9%8a%d8%b1-%d8%a7%d9%84%d8%a8%d8%b1%d9%8a%d8%b7%d8%a7%d9%86%d9%8a-%d8%a7%d9%84%d8%b3%d8%a7%d8%a8%d9%82-%d9%85%d8%b4%d8%a7%d8%b1%d9%8a%d8%b9-%d8%a7%d9%84%d9%85%d9%84%d9%83/', 'summary': 'السفير البريطاني السابق: مشاريع الملك بالمركب المينائي للدار البيضاء تعزز تموقع المغرب كجسر بين أوروبا وإفريقيا. قال السفير السابق للمملكة المتحدة بالمغرب، توماس رايلي، إن المشاريع التي أشرف الملك محمد السادس، على تدشينها، اليوم الخميس 18 شتنبر 2025، في إطار إعادة هيكلة وتطوير المركب المينائي للدار البيضاء، “تعزز تموقع المغرب كجسر يربط بين أوروبا وإفريقيا”. وأكد رايلي، في تصريح لوكالة المغرب العربي للأنباء، أن “الأمر يتعلق بمشاريع مبهرة”، مبرزا …  السفير البريطاني السابق: مشاريع الملك بالمركب المينائي للدار البيضاء تعزز تموقع المغرب كجسر بين أوروبا وإفريقيا     .', 'size': 3}], 'main_title': 'توماس رايلي: المشاريع التي دشنها جلالة الملك “تعزز تموقع المغرب كجسر بين أوروبا وإفريقيا”'}, {'community_id': '4', 'articles': [{'id': '141', 'title': 'زلزال بقوة 7,8 درجات يضرب روسيا وتحذيرات من تسونامي', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-589938.html', 'summary': 'زلزال بقوة 7,8 درجات يضرب روسيا وتحذيرات من تسونامي. أعلن المعهد الأميركي للمسح الجيولوجي أن زلزالا بلغت قوته 7,8 درجات ضرب، الجمعة، قبالة سواحل شبه جزيرة كامشاتكا في أقصى الشرق الروسي، ما استدعى إصدار تحذيرات من احتمال حدوث موجات مد بحري (تسونامي) قبل أن يتم رفعها لاحقا. وحدد مركز الزلزال على بعد نحو 128 كيلومترا شرق مدينة بيتروبافلوسك-كامشاتسكي، وعلى عمق عشرة', 'size': 2}, {'id': '158', 'title': 'تحذيرات من تسونامي بالمحيط الهادئ بعد زلزال بقوة 7,8 درجات قبالة أقصى الشرق الروسي', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1100946.html', 'summary': 'تحذيرات من تسونامي بالمحيط الهادئ بعد زلزال بقوة 7,8 درجات قبالة أقصى الشرق الروسي. أعلن المعهد الأميركي للمسح الجيولوجي أن زلزالا بلغت قوته 7,8 درجات ضرب، اليوم الجمعة، قبالة سواحل شبه جزيرة كامشاتكا في أقصى الشرق الروسي، ما استدعى إصدار تحذيرات من احتمال حدوث موجات مد بحري (تسونامي) قبل أن يتم رفعها لاحقا. وحدد مركز الزلزال على بعد نحو 128 كيلومترا شرق مدينة بيتروبافلوسك-كامشاتسكي، وعلى عمق عشرة كيلومترات فقط، ظهرت المقالة تحذيرات من تسونامي بالمحيط الهادئ بعد زلزال بقوة 7,8 درجات قبالة أقصى الشرق الروسي  .', 'size': 2}], 'main_title': 'زلزال بقوة 7,8 درجات يضرب روسيا وتحذيرات من تسونامي'}, {'community_id': '5', 'articles': [{'id': '148', 'title': 'طقس الجمعة.. أمطار رعدية ورياح بهذه المناطق المغربية', 'source': 'www.alayam24.com', 'link': 'https://www.alayam24.com/articles-589883.html', 'summary': 'طقس الجمعة.. أمطار رعدية ورياح بهذه المناطق المغربية. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليوم الجمعة، أن تتميز الحالة الجوية عامة بطقس حار نسبيا إلى حار بكل من السهول المتواجدة غرب الأطلس، والسايس، ومنطقة سوس، والجنوب الشرقي وبالأقاليم الصحراوية. كما يرتقب تشكل سحب منخفضة وكتل ضبابية مصحوبة بأمطار جد خفيفة محليا فوق السواحل الشمالية والوسطى والواجهة المتوسطية خلال الصباح والليل،', 'size': 3}, {'id': '178', 'title': 'طقس حار مع أمطار خفيفة متوقعة اليوم الجمعة', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%b7%d9%82%d8%b3-%d8%ad%d8%a7%d8%b1-%d9%85%d8%b9-%d8%a3%d9%85%d8%b7%d8%a7%d8%b1-%d8%ae%d9%81%d9%8a%d9%81%d8%a9-%d9%85%d8%aa%d9%88%d9%82%d8%b9%d8%a9-%d8%a7%d9%84%d9%8a%d9%88%d9%85-%d8%a7%d9%84%d8%ac/', 'summary': 'طقس حار مع أمطار خفيفة متوقعة اليوم الجمعة. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة لليوم الجمعة، أن تتميز الحالة الجوية عامة بطقس حار نسبيا إلى حار بكل من السهول المتواجدة غرب الأطلس، والسايس، ومنطقة سوس، والجنوب الشرقي وبالأقاليم الصحراوية. كما يرتقب تشكل سحب منخفضة وكتل ضبابية مصحوبة بأمطار جد خفيفة محليا فوق السواحل الشمالية والوسطى والواجهة المتوسطية خلال الصباح والليل، فضلا عن انتشار  طقس حار مع أمطار خفيفة متوقعة اليوم الجمعة     .', 'size': 3}, {'id': '181', 'title': 'طقس اليوم: أجواء حارة مع أمطار رعدية بهذه المناطق', 'source': 'soltana.ma', 'link': 'https://soltana.ma/1357858.html', 'summary': 'طقس اليوم: أجواء حارة مع أمطار رعدية بهذه المناطق. تتوقع المديرية العامة للأرصاد الجوية، بالنسبة ليومه الخميس، أن تتميز الحالة الجوية عامة بطقس حار نسبيا بكل من السهول المتواجدة غرب الأطلس، ومنطقة سوس، والجنوب الشرقي والأقاليم الصحراوية. كما يرتقب تشكل سحب منخفضة مصحوبة بأمطار جد خفيفة محليا فوق السواحل الشمالية والوسطى وشرق الواجهة المتوسطية خلال الصباح والليل، فضلا عن انتشار سحب غير مستقرة مصحوبة', 'size': 3}], 'main_title': 'طقس الجمعة.. أمطار رعدية ورياح بهذه المناطق المغربية'}, {'community_id': '6', 'articles': [{'id': '168', 'title': 'الدريوش: ميناء الصيد الجديد بالدار البيضاء رافعة استراتيجية لدعم القطاع وتثمين المنتوجات البحرية', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1100901.html', 'summary': 'الدريوش: ميناء الصيد الجديد بالدار البيضاء رافعة استراتيجية لدعم القطاع وتثمين المنتوجات البحرية. أكد مسؤولون بارزون في قطاعي الصيد البحري والموانئ أن المشاريع الكبرى التي دشنها الملك محمد السادس بالمركب المينائي للدار البيضاء، اليوم الخميس، تمثل تحولا استراتيجيا يهدف إلى تعزيز مكانة المغرب كقوة بحرية إقليمية، وتطوير منظومات صناعية متكاملة قادرة على المنافسة عالميا. وفي هذا الإطار، وصفت كاتبة الدولة المكلفة بالصيد البحري، زكية الدريوش، ميناء الصيد البحري ظهرت المقالة الدريوش: ميناء الصيد الجديد بالدار البيضاء رافعة استراتيجية لدعم القطاع وتثمين المنتوجات البحرية  .', 'size': 2}, {'id': '212', 'title': 'الدريوش: ميناء الصيد البحري الجديد بالدار البيضاء رافعة استراتيجية جديدة للنهوض بالقطاع', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d8%a7%d9%84%d8%af%d8%b1%d9%8a%d9%88%d8%b4-%d9%85%d9%8a%d9%86%d8%a7%d8%a1-%d8%a7%d9%84%d8%b5%d9%8a%d8%af-%d8%a7%d9%84%d8%a8%d8%ad%d8%b1%d9%8a-%d8%a7%d9%84%d8%ac%d8%af%d9%8a%d8%af-%d8%a8%d8%a7%d9%84/', 'summary': 'الدريوش: ميناء الصيد البحري الجديد بالدار البيضاء رافعة استراتيجية جديدة للنهوض بالقطاع. أكدت كاتبة الدولة المكلفة بالصيد البحري، زكية الدريوش، أن ميناء الصيد البحري الجديد الذي دشنه صاحب الجلالة الملك محمد السادس، اليوم الخميس بالدار البيضاء،  الدريوش: ميناء الصيد البحري الجديد بالدار البيضاء رافعة استراتيجية جديدة للنهوض بالقطاع     .', 'size': 2}], 'main_title': 'الدريوش: ميناء الصيد الجديد بالدار البيضاء رافعة استراتيجية لدعم القطاع وتثمين المنتوجات البحرية'}, {'community_id': '7', 'articles': [{'id': '171', 'title': 'باستثناء حالات محدودة.. برادة: جميع الأساتذة الجدد التحقوا بمؤسساتهم', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d8%a8%d8%a7%d8%b3%d8%aa%d8%ab%d9%86%d8%a7%d8%a1-%d8%ad%d8%a7%d9%84%d8%a7%d8%aa-%d9%85%d8%ad%d8%af%d9%88%d8%af%d8%a9-%d8%a8%d8%b1%d8%a7%d8%af%d8%a9-%d8%ac%d9%85%d9%8a%d8%b9-%d8%a7%d9%84%d8%a3%d8%b3/', 'summary': 'باستثناء حالات محدودة.. برادة: جميع الأساتذة الجدد التحقوا بمؤسساتهم. أكد محمد سعد برادة، وزير التربية الوطنية والتعليم الأولي والرياضة، أن جميع الأساتذة الجدد التحقوا بمؤسساتهم التعليمية بعد 6 شتنبر، وهو موعد انتهاء الحركة الإقليمية التي نظمت لأول مرة بتشاور مع النقابات. وأوضح الوزير، خلال ندوة صحافية عقدت اليوم الجمعة بالرباط، أنه في حال عدم التحاق بعض الأساتذة فإن عددهم يظل محدودا، مؤكدا أن العمل  باستثناء حالات محدودة.. برادة: جميع الأساتذة الجدد التحقوا بمؤسساتهم     .', 'size': 2}, {'id': '374', 'title': 'برادة: لا احتكار في توزيع مقررات مدارس الريادة وأسعارها بين 4 و12 دراهم (فيديو)', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1101071.html', 'summary': 'برادة: لا احتكار في توزيع مقررات مدارس الريادة وأسعارها بين 4 و12 دراهم (فيديو). نفى وزير التربية الوطنية والتعليم الأولي والرياضة، محمد سعد برادة، احتكار أي شركة لتوزيع الكتب المدرسية الخاصة بمدارس الريادة، مؤكدا أن أسعار هذه الكتب “مناسبة”، بحيث تتراوح بين 4 و10 دراهم. وقال برادة، خلال ندوة صحفية اليوم الجمعة بالرباط للإعلان عن مستجدات الدخول المدرسي برسم 2025-2026، إن توزيع جميع الكتب المدرسية يمر عبر طلبات العروض، ظهرت المقالة برادة: لا احتكار في توزيع مقررات مدارس الريادة وأسعارها بين 4 و12 دراهم (فيديو)  .', 'size': 2}], 'main_title': 'باستثناء حالات محدودة.. برادة: جميع الأساتذة الجدد التحقوا بمؤسساتهم'}, {'community_id': '8', 'articles': [{'id': '177', 'title': 'لتدبير الكوارث الطبيعية.. تمرين مشترك بين الحرس الوطني الأمريكي والقوات المسلحة الملكية', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%84%d8%aa%d8%af%d8%a8%d9%8a%d8%b1-%d8%a7%d9%84%d9%83%d9%88%d8%a7%d8%b1%d8%ab-%d8%a7%d9%84%d8%b7%d8%a8%d9%8a%d8%b9%d9%8a%d8%a9-%d8%aa%d9%85%d8%b1%d9%8a%d9%86-%d9%85%d8%b4%d8%aa%d8%b1%d9%83-%d8%a8/', 'summary': 'لتدبير الكوارث الطبيعية.. تمرين مشترك بين الحرس الوطني الأمريكي والقوات المسلحة الملكية. في إطار التعاون العسكري بين المملكة المغربية والولايات المتحدة الأمريكية، نُظِّمت ما بين 07 و20 شتنبر 2025 النسخة السابعة من التمرين المشترك لتدبير الكوارث «ماروك مانتليت 2025»، والذي احتضنت فعالياته مدينتا القنيطرة والدار البيضاء. ويُعد هذا التمرين، المنجز بشكل مشترك بين عناصر الحرس الوطني لولاية يوتا ونظرائهم من القوات المسلحة الملكية، محطة بارزة لتعزيز أمن  لتدبير الكوارث الطبيعية.. تمرين مشترك بين الحرس الوطني الأمريكي والقوات المسلحة الملكية     .', 'size': 2}, {'id': '399', 'title': 'المغرب وأمريكا ينظمان تمرين “ماروك مانتليت 2025” لمواجهة الكوارث', 'source': 'rue20.com', 'link': 'https://rue20.com/937914.html', 'summary': 'المغرب وأمريكا ينظمان تمرين “ماروك مانتليت 2025” لمواجهة الكوارث.  الرباط ستختتم غدا فعاليات النسخة السابعة من تمرين “ماروك مانتليت” لتدبير الكوارث، الذي احتضنته مدينتا القنيطرة والدار البيضاء بين 7 و20 شتنبر، في إطار الشراكة العسكرية بين المملكة المغربية والولايات المتحدة الأمريكية. ويهدف التمرين، الذي أُنجز بتعاون بين القوات المسلحة الملكية والحرس الوطني لولاية يوتا، إلى رفع مستوى التأهب وتعزيز التنسيق في مواجهة الكوارث الخبر المغرب وأمريكا ينظمان تمرين “ماروك مانتليت 2025” لمواجهة الكوارث  .', 'size': 2}], 'main_title': 'لتدبير الكوارث الطبيعية.. تمرين مشترك بين الحرس الوطني الأمريكي والقوات المسلحة الملكية'}, {'community_id': '9', 'articles': [{'id': '242', 'title': 'قسم جرائم الأموال بجنايات فاس يُدين مختلسي أموال البرنامج الاستعجالي لإصلاح التعليم', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d9%82%d8%b3%d9%85-%d8%ac%d8%b1%d8%a7%d8%a6%d9%85-%d8%a7%d9%84%d8%a3%d9%85%d9%88%d8%a7%d9%84-%d8%a8%d8%ac%d9%86%d8%a7%d9%8a%d8%a7%d8%aa-%d9%81%d8%a7%d8%b3-%d9%8a%d9%8f%d8%af%d9%8a%d9%86-%d9%85%d8%ae/', 'summary': 'قسم جرائم الأموال بجنايات فاس يُدين مختلسي أموال البرنامج الاستعجالي لإصلاح التعليم. أصدرت الهيئة القضائية بقسم جرائم الأموال لدى محكمة الاستئناف بفاس، أول أمس الأربعاء، أحكاما بالحبس النافذ في حق أصحاب شركات ومسؤولين سابقين بالأكاديمية الجهوية للتربية والتكوين بجهة فاس بولمان، من أجل اختلاس وتبديد أموال البرنامج الاستعجالي لإصلاح التعليم على صعيد الأكاديمية. وحسب ما نشرته يومية “الأخبار”، في عددها الصادر اليوم الجمعة 19 شتنبر …  قسم جرائم الأموال بجنايات فاس يُدين مختلسي أموال البرنامج الاستعجالي لإصلاح التعليم     .', 'size': 2}, {'id': '419', 'title': 'محكمة فاس تدين مختلسي أموال البرنامج الاستعجالي لإصلاح التعليم', 'source': 'howiyapress.com', 'link': 'https://howiyapress.com/%d9%85%d8%ad%d9%83%d9%85%d8%a9-%d9%81%d8%a7%d8%b3-%d8%aa%d8%af%d9%8a%d9%86-%d9%85%d8%ae%d8%aa%d9%84%d8%b3%d9%8a-%d8%a3%d9%85%d9%88%d8%a7%d9%84-%d8%a7%d9%84%d8%a8%d8%b1%d9%86%d8%a7%d9%85%d8%ac-%d8%a7/', 'summary': 'محكمة فاس تدين مختلسي أموال البرنامج الاستعجالي لإصلاح التعليم. -متابعات أصدر قضاة قسم جرائم الأموال لدى محكمة الاستئناف بفاس، أول أمس الأربعاء، أحكاما بالحبس النافذ في حق أصحاب شركات ومسؤولين سابقين بالأكاديمية الجهوية للتربية والتكوين بجهة فاس بولمان،...  محكمة فاس تدين مختلسي أموال البرنامج الاستعجالي لإصلاح التعليم     .', 'size': 2}], 'main_title': 'قسم جرائم الأموال بجنايات فاس يُدين مختلسي أموال البرنامج الاستعجالي لإصلاح التعليم'}, {'community_id': '10', 'articles': [{'id': '263', 'title': 'دراسة: جزيئات البلاستيك تتسلل إلى مائدة الأسر عبر الخضروات', 'source': 'www.alalam.ma', 'link': 'https://www.alalam.ma/دراسة-جزيئات-البلاستيك-تتسلل-إلى-مائدة-الأسر-عبر-الخضروات_a29605.html', 'summary': 'دراسة: جزيئات البلاستيك تتسلل إلى مائدة الأسر عبر الخضروات. العلم الإلكترونية - متابعة كشفت دراسة حديثة أجرتها جامعة بليموث البريطانية أن جزيئات البلاستيك النانوية قادرة على التغلغل داخل الأجزا...', 'size': 2}, {'id': '319', 'title': 'دراسة تدق ناقوس الخطر.. "نحن نأكل البلاستيك في الخضراوات"', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/health/412987.html', 'summary': 'دراسة تدق ناقوس الخطر.. "نحن نأكل البلاستيك في الخضراوات". كشف خبراء من جامعة بليموث عن خطر جديد يهدد صحة الإنسان، بعد اكتشاف آلاف الجزيئات الدقيقة من البلاستيك في أجزاء الخضراوات القابلة للأكل. وسعى الفريق العلمي', 'size': 2}], 'main_title': 'دراسة: جزيئات البلاستيك تتسلل إلى مائدة الأسر عبر الخضروات'}, {'community_id': '11', 'articles': [{'id': '283', 'title': 'إنفانتينو يزور مقر الفيفا في الرباط', 'source': 'www.hespress.com', 'link': 'https://www.hespress.com/%d8%a5%d9%86%d9%81%d8%a7%d9%86%d8%aa%d9%8a%d9%86%d9%88-%d9%8a%d8%b2%d9%88%d8%b1-%d9%85%d9%82%d8%b1-%d8%a7%d9%84%d9%81%d9%8a%d9%81%d8%a7-%d9%81%d9%8a-%d8%a7%d9%84%d8%b1%d8%a8%d8%a7%d8%b7-1626702.html', 'summary': 'إنفانتينو يزور مقر الفيفا في الرباط. قام رئيس الاتحاد الدولي لكرة القدم (فيفا)، جياني إنفانتينو، اليوم الجمعة، بزيارة عمل إلى مقر “الفيفا إفريقيا” بالرباط. وذكر بلاغ للجامعة الملكية المغربية لكرة القدم أن إنفانتينو قام بهذه المناسبة بزيارة إلى ورشة مسار تكوين “الفيفا” للمدربات بمركب محمد السادس لكرة القدم. وإثر ذلك، يضيف المصدر ذاته، عقد رئيس الاتحاد الدولي لكرة القدم اجتماعات حول  إنفانتينو يزور مقر الفيفا في الرباط     - هسبريس جريدة إلكترونية مغربية .', 'size': 2}, {'id': '400', 'title': 'مقر الفيفا الجهوي بالرباط يتحول إلى قبلة لتكوين المدربات وتطوير كرة القدم الإفريقية', 'source': 'rue20.com', 'link': 'https://rue20.com/937933.html', 'summary': 'مقر الفيفا الجهوي بالرباط يتحول إلى قبلة لتكوين المدربات وتطوير كرة القدم الإفريقية. . الرباط قام رئيس الاتحاد الدولي لكرة القدم (الفيفا)، جياني إنفانتينو، اليوم الجمعة بزيارة عمل لمقر الفيفا إفريقيا بالرباط. وذكر بلاغ للجامعة الملكية المغربية لكرة القدم، أن السيد إنفانتينو قام بهذه المناسبة بزيارة لورشة مسار تكوين الفيفا للمدربات بمركب محمد السادس لكرة القدم. وإثر ذلك، يضيف المصدر ذاته، عقد إنفانتينو اجتماعات حول سبل تطوير الخبر مقر الفيفا الجهوي بالرباط يتحول إلى قبلة لتكوين المدربات وتطوير كرة القدم الإفريقية  .', 'size': 2}], 'main_title': 'إنفانتينو يزور مقر الفيفا في الرباط'}, {'community_id': '12', 'articles': [{'id': '305', 'title': 'بوريطة ونظيره الصيني يوقعان مذكرة تفاهم لإرساء آلية للحوار الاستراتيجي', 'source': 'ar.hibapress.com', 'link': 'https://ar.hibapress.com/details-658647.html', 'summary': 'بوريطة ونظيره الصيني يوقعان مذكرة تفاهم لإرساء آلية للحوار الاستراتيجي. هبة بريس وقع وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج، ناصر بوريطة، ونظيره الصيني، وانغ يي، الجمعة ببكين، مذكرة تفاهم يتم بموجبها إرساء آلية للحوار الاستراتيجي بين وزارتي الخارجية بالبلدين. وترتكز هذه الآلية، التي ستغني الترسانة القانونية المُنظّمة للعلاقات بين البلدين، على مضمون الإعلان المشترك للشراكة الاستراتيجية، الموقع في 11 ماي 2016 ببكين، من', 'size': 3}, {'id': '317', 'title': 'المغرب – الصين: توقيع مذكرة تفاهم يتم بموجبها إرساء آلية للحوار الاستراتيجي بين وزارتي الخارجية بالبلدين', 'source': 'www.alahdat.net', 'link': 'https://www.alahdat.net/archives/206423', 'summary': 'المغرب – الصين: توقيع مذكرة تفاهم يتم بموجبها إرساء آلية للحوار الاستراتيجي بين وزارتي الخارجية بالبلدين.  وقع وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج، ناصر بوريطة، ونظيره الصيني، وانغ يي، اليوم الجمعة ببكين، مذكرة تفاهم يتم بموجبها إرساء آلية للحوار الاستراتيجي بين وزارتي الخارجية بالبلدين. وترتكز هذه الآلية، التي ستغني الترسانة القانونية المُنظّمة للعلاقات بين البلدين، على مضمون الإعلان المشترك للشراكة الاستراتيجية، الموقع في 11 ماي 2016 ببكين،', 'size': 4}, {'id': '322', 'title': 'بوريطة يحل ببكين ويوقع اتفاقية هامة مع وزير الخارجية الصيني', 'source': 'www.akhbarona.com', 'link': 'https://www.akhbarona.com/politic/412998.html', 'summary': 'بوريطة يحل ببكين ويوقع اتفاقية هامة مع وزير الخارجية الصيني. وقع وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج، ناصر بوريطة، ونظيره الصيني، وانغ يي، اليوم الجمعة ببكين، مذكرة تفاهم يتم بموجبها إرساء آلية للحوار', 'size': 4}, {'id': '413', 'title': 'المغرب والصين يرسيان حوارا استراتيجيا بين وزارتي خارجيتهما', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/476089.html', 'summary': 'المغرب والصين يرسيان حوارا استراتيجيا بين وزارتي خارجيتهما. وقع وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج، ناصر بوريطة، ونظيره الصيني، وانغ يي، اليوم الجمعة ببكين، مذكرة تفاهم يتم بموجبها إرساء آلية للحوار الاستراتيجي بين وزارتي الخارجية بالبلدين.', 'size': 3}, {'id': '440', 'title': 'توقيع مذكرة تفاهم يتم بموجبها إرساء آلية للحوار الاستراتيجي بين المغرب والصين', 'source': 'www.barlamane.com', 'link': 'https://www.barlamane.com/%d8%aa%d9%88%d9%82%d9%8a%d8%b9-%d9%85%d8%b0%d9%83%d8%b1%d8%a9-%d8%aa%d9%81%d8%a7%d9%87%d9%85-%d9%8a%d8%aa%d9%85-%d8%a8%d9%85%d9%88%d8%ac%d8%a8%d9%87%d8%a7-%d8%a5%d8%b1%d8%b3%d8%a7%d8%a1-%d8%a2%d9%84/', 'summary': 'توقيع مذكرة تفاهم يتم بموجبها إرساء آلية للحوار الاستراتيجي بين المغرب والصين. وقع وزير الشؤون الخارجية والتعاون الإفريقي والمغاربة المقيمين بالخارج، ناصر بوريطة، ونظيره الصيني، وانغ يي، اليوم الجمعة 19 شتنبر 2025، ببكين، مذكرة تفاهم يتم بموجبها إرساء آلية للحوار الاستراتيجي بين وزارتي الخارجية بالبلدين. وترتكز هذه الآلية، التي ستغني الترسانة القانونية المُنظّمة للعلاقات بين البلدين، على مضمون الإعلان المشترك للشراكة الاستراتيجية، الموقع في 11 …  توقيع مذكرة تفاهم يتم بموجبها إرساء آلية للحوار الاستراتيجي بين المغرب والصين     .', 'size': 3}], 'main_title': 'المغرب – الصين: توقيع مذكرة تفاهم يتم بموجبها إرساء آلية للحوار الاستراتيجي بين وزارتي الخارجية بالبلدين'}, {'community_id': '13', 'articles': [{'id': '377', 'title': 'المغرب رئيسا لـ”أفرا” النووية.. وإجماع إفريقي على احتضان اجتماع 2026', 'source': 'al3omk.com', 'link': 'https://al3omk.com/1101093.html', 'summary': 'المغرب رئيسا لـ”أفرا” النووية.. وإجماع إفريقي على احتضان اجتماع 2026. اعمتدت الدول الإفريقية الأعضاء في الاتفاق التعاوني الإقليمي الإفريقي للبحث والتنمية والتدريب في مجال العلم والتكنولوجيا النوويين (أفرا)، أمس الخميس، بالإجماع، قرارا يؤيد ترشح المغرب لتنظيم الاجتماع الـ37 لمجموعة العمل التقنية للاتفاق خلال سنة 2026. وتم اتخاذ هذا القرار في إطار مشاركة الوفد المغربي في أشغال المؤتمر العام الـ69 للوكالة الدولية للطاقة الذرية، الذي ينعقد ظهرت المقالة المغرب رئيسا لـ”أفرا” النووية.. وإجماع إفريقي على احتضان اجتماع 2026  .', 'size': 2}, {'id': '407', 'title': 'فيينا.. تأييد ترشيح المغرب لرئاسة الـ”أفرا”', 'source': 'machahid24.com', 'link': 'https://machahid24.com/politique/476125.html', 'summary': 'فيينا.. تأييد ترشيح المغرب لرئاسة الـ”أفرا”. متابعة اعمتدت الدول الإفريقية الأعضاء في الاتفاق التعاوني الإقليمي الإفريقي للبحث والتنمية والتدريب في مجال العلم والتكنولوجيا النوويين (أفرا)، أمس الخميس، بالإجماع، قرارا يؤيد ترشح المغرب لتنظيم الاجتماع الـ37 لمجموعة العمل التقنية للاتفاق خلال سنة 2026. وتم اتخاذ هذا القرار في إطار مشاركة الوفد المغربي في أشغال المؤتمر العام الـ69 للوكالة الدولية للطاقة الذرية، الذي …', 'size': 2}], 'main_title': 'المغرب رئيسا لـ”أفرا” النووية.. وإجماع إفريقي على احتضان اجتماع 2026'}, {'community_id': '14', 'articles': [{'id': '389', 'title': 'نشرة إنذارية.. زخات رعدية قوية مصحوبة بهبات رياح مرتقبة اليوم الجمعة', 'source': 'ar.telquel.ma', 'link': 'https://ar.telquel.ma/%d9%86%d8%b4%d8%b1%d8%a9-%d8%a5%d9%86%d8%b0%d8%a7%d8%b1%d9%8a%d8%a9-%d8%b2%d8%ae%d8%a7%d8%aa-%d8%b1%d8%b9%d8%af%d9%8a%d8%a9-%d9%82%d9%88%d9%8a%d8%a9-%d9%85%d8%b5%d8%ad%d9%88%d8%a8%d8%a9-%d8%a8%d9%87-2/', 'summary': 'نشرة إنذارية.. زخات رعدية قوية مصحوبة بهبات رياح مرتقبة اليوم الجمعة. يرتقب تسجيل زخات رعدية قوية (من 20 إلى 30 ملم) مصحوبة بهبات رياح، اليوم الجمعة، بعدد من مناطق المملكة، وفق ما أفادت به المديرية العامة للأرصاد الجوية. وأوضحت نشرة إنذارية للمديرية من مستوى يقظة "برتقالي"، أنه من المرتقب تسجيل هذه الزخات الرعدية بكل من عمالات وأقاليم صفرو، وإفران، وبولمان، وميدلت، من الساعة 16:30 بعد الزوال  نشرة إنذارية.. زخات رعدية قوية مصحوبة بهبات رياح مرتقبة اليوم الجمعة     .', 'size': 2}, {'id': '401', 'title': 'زخات رعدية قوية مصحوبة بهبات رياح مرتقبة الجمعة', 'source': 'rue20.com', 'link': 'https://rue20.com/937930.html', 'summary': 'زخات رعدية قوية مصحوبة بهبات رياح مرتقبة الجمعة. . الرباط يرتقب تسجيل زخات رعدية قوية (من 20 إلى 30 ملم) مصحوبة بهبات رياح، اليوم الجمعة، بعدد من مناطق المملكة، وفق ما أفادت به المديرية العامة للأرصاد الجوية. وأوضحت نشرة إنذارية للمديرية من مستوى يقظة “برتقالي”، أنه من المرتقب تسجيل هذه الزخات الرعدية بكل من عمالات وأقاليم صفرو، وإفران، وبولمان، وميدلت، من الساعة الخبر زخات رعدية قوية مصحوبة بهبات رياح مرتقبة الجمعة  .', 'size': 2}], 'main_title': 'نشرة إنذارية.. زخات رعدية قوية مصحوبة بهبات رياح مرتقبة اليوم الجمعة'}];
        
        const tooltip = d3.select("#tooltip");
        
        const communityColors = d3.scaleOrdinal()
            .domain(treemapData.map(d => d.community_id))
            .range(d3.quantize(d3.interpolateRainbow, treemapData.length));
        
        let clickTimer = null;
        let clickCount = 0;
        
        function createTreemap(data, containerId) {
            const container = d3.select(`#${containerId}`);
            const width = container.node().getBoundingClientRect().width;
            const height = container.node().getBoundingClientRect().height;
            
            const sources = [...new Set(data.articles.map(d => d.source))];
            const color = d3.scaleOrdinal()
                .domain(sources)
                .range(d3.quantize(d3.interpolateHcl("#007FFF", "#FFA500"), sources.length));
            
            
            
            const hierarchyData = {
                name: "root",
                children: data.articles
            };
            
            const root = d3.hierarchy(hierarchyData)
                .sum(d => d.size || 1)
                .sort((a, b) => b.value - a.value);
            
            const treemap = d3.treemap()
                .size([width, height])
                .padding(4)
                .round(true);
            
            treemap(root);
            
            const nodes = container.selectAll(".node")
                .data(root.leaves())
                .enter()
                .append("div")
                .attr("class", "node")
                .style("left", d => `${d.x0}px`)
                .style("top", d => `${d.y0}px`)
                .style("width", d => `${d.x1 - d.x0}px`)
                .style("height", d => `${d.y1 - d.y0}px`)
                .style("background-color", d => color(d.data.source))
                .on("click", function(event, d) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        showTooltip(event, d);
                        
                        clickTimer = setTimeout(function() {
                            clickCount = 0;
                        }, 300);
                    } else {
                        // Double clic - ouvrir le lien
                        clearTimeout(clickTimer);
                        clickCount = 0;
                        if (d.data.link && d.data.link !== "#") {
                            window.open(d.data.link, '_blank');
                        }
                    }
                })
                .on("mouseover", function(event, d) {
                    if (window.innerWidth > 768) {
                        showTooltip(event, d);
                    }
                })
                .on("mousemove", function(event) {
                    if (window.innerWidth > 768) {
                        moveTooltip(event);
                    }
                })
                .on("mouseout", function() {
                    if (window.innerWidth > 768 && clickCount === 0) {
                        hideTooltip();
                    }
                });
            
            nodes.append("div")
                .attr("class", "node-content")
                .html(d => `
                    <div class="node-title">${d.data.title ?  d.data.title : 'Sans titre'}</div>
                    <div class="node-source">${d.data.source}</div>
                `);
        }
        
        function showTooltip(event, d) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = d.data.summary || '';

            const cleanSummary = tempDiv.textContent || tempDiv.innerText || '';

            tooltip.style("opacity", 1)
                .html(`
                    <div class="tooltip-title">${d.data.title}</div>
                    <div class="tooltip-source">${d.data.source}</div>
                    <div class="tooltip-summary">${cleanSummary ? cleanSummary : ''}</div>
                `);

            moveTooltip(event);
        }
        
        function moveTooltip(event) {
            const tooltipNode = tooltip.node();
            const tooltipWidth = tooltipNode.offsetWidth;
            const tooltipHeight = tooltipNode.offsetHeight;
            
            let left = event.pageX + 15;
            let top = event.pageY + 15;
            
            if (left + tooltipWidth > window.innerWidth) {
                left = event.pageX - tooltipWidth - 15;
            }
            
            if (top + tooltipHeight > window.innerHeight) {
                top = event.pageY - tooltipHeight - 15;
            }
            
            if (window.innerWidth <= 768) {
                left = (window.innerWidth - tooltipWidth) / 2;
                top = window.scrollY + (window.innerHeight - tooltipHeight) / 3;
            }
            
            tooltip.style("left", `${left}px`)
                .style("top", `${top}px`);
        }
        
        function hideTooltip() {
            tooltip.style("opacity", 0);
        }
        
        document.addEventListener('click', function(event) {
            if (window.innerWidth <= 768 && 
                !event.target.closest('.node') && 
                !event.target.closest('.tooltip')) {
                hideTooltip();
            }
        });
        
        function initCarousel() {
            const carouselContainer = document.getElementById('treemap-carousel');
            
            treemapData.forEach((data, index) => {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';
                
                const title = document.createElement('div');
                title.className = 'community-title';
                title.textContent = data.main_title;
                slide.appendChild(title);
                
                const treemapContainer = document.createElement('div');
                treemapContainer.className = 'treemap-container';
                treemapContainer.id = `treemap-${data.community_id}`;
                slide.appendChild(treemapContainer);
                
                carouselContainer.appendChild(slide);
            });
            
            const swiper = new Swiper(".mySwiper", {
                pagination: {
                    el: ".swiper-pagination",
                    clickable: true,
                    
                },
                navigation: {
                    nextEl: ".swiper-button-next",
                    prevEl: ".swiper-button-prev",
                },
                spaceBetween: 30,
                
                keyboard: {
                    enabled: true,
                },
                grabCursor: true, 
                effect: "slide", 
                speed: 600, 
                loop: true, 
                spaceBetween: 30,
                on: {
                    slideChange: function() {
                        setTimeout(function() {
                            window.dispatchEvent(new Event('resize'));
                            hideTooltip();
                        }, 300);
                    }
                }
            });
            
            setTimeout(() => {
                treemapData.forEach(data => {
                    createTreemap(data, `treemap-${data.community_id}`);
                });
            }, 300);
            
            window.addEventListener('resize', () => {
                treemapData.forEach(data => {
                    const container = document.getElementById(`treemap-${data.community_id}`);
                    container.innerHTML = ''; 
                    createTreemap(data, `treemap-${data.community_id}`);
                });
                hideTooltip();
            });
        }
        
        window.addEventListener('load', initCarousel);
        
    </script>
    
</body>



</html>
    